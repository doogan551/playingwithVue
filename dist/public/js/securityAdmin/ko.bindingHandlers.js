$(function(){ko.bindingHandlers.setHeight={update:function(a,b,c){var d=b(),e=c(),f=ko.utils.unwrapObservable(d),g=e.reduceBy||0;$(a).height(f-g)}},ko.bindingHandlers.drag={init:function(a,b,c,d){var e=$(a),f=(b(),{disabled:!0,revert:!0,helper:"clone",appendTo:"#DT_Security_main",zIndex:5e3,revertDuration:200,addClasses:!1,cursorAt:{top:20,left:20},start:function(){dorsett.draggedItem=ko.utils.unwrapObservable(b().value)}});e.draggable(f).disableSelection()}},ko.bindingHandlers.drop={init:function(a,b,c,d){var e=$(a),f=b(),g=!1,h={accept:f.accept,tolerance:"touch",activate:function(a,b){var c=$(this);console.log(f.addTo(),dorsett.draggedItem),g=!!ko.utils.arrayFirst(f.addTo(),function(a){return".user"==f.accept?a.userid==dorsett.draggedItem._id:a.groupid==dorsett.draggedItem._id}),g?(c.addClass("dropzone_deny"),b.helper.find("*").addBack().css({cursor:"not-allowed"})):(c.addClass("dropzone_active animated flash"),b.helper.find("*").addBack().css({cursor:"move"}))},over:function(a,b){var c=$(this);g?(c.find("div").addClass("animated shake"),setTimeout(function(){c.find("div").removeClass("animated shake")},2e3)):c.addClass("dropzone_hover")},out:function(a,b){var c=$(this);c.removeClass("dropzone_hover")},deactivate:function(a,b){var c=$(this);c.removeClass("dropzone_active dropzone_hover dropzone_deny animated shake flash")},drop:function(a,b){g||(b.helper.remove(),".user"==f.accept?f.addTo.push(new dorsett.models.groupUserModel({userid:dorsett.draggedItem._id,FullName:dorsett.draggedItem["First Name"]+" "+dorsett.draggedItem["Last Name"],Photo:dorsett.draggedItem.Photo,"Group Admin":!1})):f.addTo.push({groupid:dorsett.draggedItem._id,"User Group Name":dorsett.draggedItem["User Group Name"],"Group Admin":!1}),e.closest("ul").trigger("create").listview("refresh"))}};e.droppable(h)}},ko.bindingHandlers.loadImage={init:function(a,b,c,d){var e=$(a),f=c(),g="img/users/"+ko.utils.unwrapObservable(b());$("<img/>").load(function(){e.css({backgroundImage:"url("+g+")"})}).error(function(){f.errorImage&&e.css({backgroundImage:"url("+f.errorImage+")"})}).attr("src",g)}},ko.bindingHandlers.JMValidationError={update:function(a,b,c,d,e){var f=!b().isValid()&&b().isModified();f?$(a).parent().addClass("input-validation-error"):$(a).parent().removeClass("input-validation-error")}},ko.bindingHandlers.JMEnable={update:function(a,b){var c=ko.utils.unwrapObservable(b()),d=($(a),"function (){}");ko.bindingHandlers.enable.update(a,b),0!=$("#DT_Security_panelWindow").length&&("INPUT"==a.nodeName&&("text"==a.type&&(d="textinput"),"checkbox"!=a.type&&"radio"!=a.type||(d="checkboxradio"),"button"==a.type&&(d="button")),"TEXTAREA"==a.nodeName&&(d="textinput"),"SELECT"==a.nodeName&&(d="selectmenu"),"BUTTON"==a.nodeName&&(d="button"),$(a)[d](c?"enable":"disable"))}},ko.bindingHandlers.JMChecked={init:function(a,b){var c=$(a);c.checkboxradio(),c.attr("type","checkbox"),ko.utils.registerEventHandler(a,"change",function(){b()($(this).siblings("label.ui-checkbox-off").length>0)})},update:function(a,b){ko.bindingHandlers.checked.update(a,b);var c=$(a);c.checkboxradio("refresh")}},ko.bindingHandlers.JMRadio={init:function(a,b){var c=b();$(a).click(function(){$(this).hasClass("disabled")||c(""+$(this).data("value"))})},update:function(a,b){var c=b(),d=ko.utils.unwrapObservable(c);d===""+$(a).data("value")?$(a).find(".ui-icon").addClass("ui-icon-myCheckRadioOn").removeClass("ui-icon-myCheckRadioOff"):$(a).find(".ui-icon").addClass("ui-icon-myCheckRadioOff").removeClass("ui-icon-myCheckRadioOn")}},ko.bindingHandlers.mask={init:function(a,b,c,d,e){var f=b()||"",g=ko.utils.arrayFirst(dorsett.contactValidationMap,function(a){return console.log(a.type,f),a.type==f});console.log("nope",f,g.mask),g.mask&&(console.log("still here?"),$(a).mask(g.mask,{placeholder:" "}))}},ko.virtualElements.allowedBindings.listviewBinding=!0,ko.bindingHandlers.listviewBinding={update:function(a,b){ko.utils.unwrapObservable(b());var c=$(a).closest("[data-role='listview']");if(c)try{$(c).listview("refresh")}catch(d){}}}});
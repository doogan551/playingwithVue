!function(a,b){var c={};a.trafficCop=function(b,d){var e,f=b;if(2===arguments.length&&(f=a.extend(!0,d,{url:b})),e=JSON.stringify(f),e in c)for(i in{success:1,error:1,complete:1})c[e][i](f[i]);else c[e]=a.ajax(f).always(function(){delete c[e]});return c[e]}}(jQuery),function(a,b,c){var d={templates:{},storeTemplate:function(a,b){this.templates[a]=b},getTemplate:function(a){return this.templates[a]},purge:function(){this.templates={}}},e={templateIds:[],storeTemplate:function(a,b){var c=document.getElementById(a);null===c&&(this.templateIds.push(a),c=document.createElement("script"),c.type="text/html",c.id=a,document.body.appendChild(c)),c.text=b},getTemplate:function(a){return document.getElementById(a)},purge:function(){for(var a=0;a<this.templateIds.length;a++)document.body.removeChild(document.getElementById(this.templateIds[a]));this.templateIds=[]}},f="<div class='infuser-error'>The template <a href='{TEMPLATEURL}'>{TEMPLATEID}</a> could not be loaded. {STATUS}</div>",g=function(a,b,c){return f.replace("{STATUS}",a).replace("{TEMPLATEID}",b).replace("{TEMPLATEURL}",c)},h=[],i={getTemplatePath:function(a){var b=a.templatePrefix+a.templateId+a.templateSuffix;return a.templateUrl===c||""===a.templateUrl?b:a.templateUrl+"/"+b},templateGetSuccess:function(a,b){return function(c){j.store.storeTemplate(a,c),b(j.store.getTemplate(a))}},templateGetError:function(b,c,d){return function(e){a.inArray(b,h)===-1&&h.push(b);var f=g("HTTP Status code: "+e.status,b,c);j.store.storeTemplate(b,f),d(j.store.getTemplate(b))}},getAjaxOptions:function(a){}},j={storageOptions:{hash:d,script:e},store:d,defaults:{templateUrl:"",templateSuffix:".html",templatePrefix:"",ajax:{async:!0,dataType:"html",type:"GET"},target:function(a){return"#"+a},loadingTemplate:{content:'<div class="infuser-loading">Loading...</div>',transitionIn:function(b,c){var d=a(b);d.hide(),d.html(c),d.fadeIn()},transitionOut:function(b){a(b).html("")}},postRender:function(a){},preRender:function(a,b){},render:function(b,c){var d=a(b);0===d.children().length?d.append(a(c)):d.children().replaceWith(a(c))},bindingInstruction:function(a,b){return a},useLoadingTemplate:!0},get:function(b,c){var d,e=a.extend({},j.defaults,"object"==typeof b?b:{templateId:b});e.ajax.url=i.getTemplatePath(e),d=j.store.getTemplate(e.ajax.url),d&&a.inArray(e.ajax.url,h)===-1?c(d):(e.ajax.success=i.templateGetSuccess(e.ajax.url,c),e.ajax.error=i.templateGetError(e.templateId,e.ajax.url,c),a.trafficCop(e.ajax))},getSync:function(b){var c,d,e=a.extend({},j.defaults,"object"==typeof b?b:{templateId:b},{ajax:{async:!1}});return e.ajax.url=i.getTemplatePath(e),c=j.store.getTemplate(e.ajax.url),c&&a.inArray(e.ajax.url,h)===-1||(d=null,e.ajax.success=function(a){d=a},e.ajax.error=function(b){a.inArray(e.ajax.url)===-1&&h.push(e.ajax.url),d=g("HTTP Status code: exception.status",e.templateId,e.ajax.url)},a.ajax(e.ajax),null===d?d=g("An unknown error occurred.",e.templateId,e.ajax.url):(j.store.storeTemplate(e.ajax.url,d),c=j.store.getTemplate(e.ajax.url))),c},infuse:function(b,d){var e=a.extend({},j.defaults,"object"==typeof b?b:d,"string"==typeof b?{templateId:b}:c),f="function"==typeof e.target?e.target(b):e.target;e.useLoadingTemplate&&e.loadingTemplate.transitionIn(f,e.loadingTemplate.content),j.get(e,function(a){var b=a;e.preRender(f,b),b=e.bindingInstruction(b,e.model),e.useLoadingTemplate&&e.loadingTemplate.transitionOut(f),e.render(f,b),e.postRender(f)})}};b.infuser=j}(jQuery,window),function(a,b,c,d,e){var f=function(a,c){var f,g=this;g.templateId=a,g.loaded=!1,g.template=b.observable(d.defaults.useLoadingTemplate?d.defaults.loadingTemplate.content:e),g.template.data={},g.options=b.utils.extend({},c),g.options.templateId=a,g.options&&g.options.afterRender&&(f=g.options.afterRender,c.afterRender=function(){g.loaded&&f.apply(g.options,arguments)})};b.utils.extend(f.prototype,{data:function(a,b){return 1===arguments.length?("precompiled"===a&&this.template(),this.template.data[a]):void(this.template.data[a]=b)},text:function(a){return this.loaded||this.getTemplate(),0===arguments.length?this.template():void this.template(arguments[0])},getTemplate:function(){var a=this;d.get(a.options,function(b){a.data("precompiled",null),a.template(b),a.loaded=!0})}});var g=function(a){var c=a?new a:new b.nativeTemplateEngine;return c.templates={},c.makeTemplateSource=function(a,d,e){if("string"==typeof a){var g=document.getElementById(a);return g?new b.templateSources.domElement(g):(c.templates[a]||(c.templates[a]=new f(a,e)),c.templates[a])}if(1==a.nodeType||8==a.nodeType)return new b.templateSources.anonymousTemplate(a)},c.renderTemplate=function(a,b,d){var e=c.makeTemplateSource(a,b,d);return c.renderTemplateSource(e,b,d)},c};b.KoExternalTemplateEngine=g,c.tmpl&&c.tmpl.tag.tmpl.open.toString().indexOf("__")>=0?b.setTemplateEngine(new g(b.jqueryTmplTemplateEngine)):b.setTemplateEngine(new g)}(window,ko,jQuery,infuser);
!function(a){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(b){return a(b,window,document)}):"object"==typeof exports?module.exports=function(b,c){return b||(b=window),c&&c.fn.dataTable||(c=require("datatables.net")(b,c).$),a(c,b,b.document)}:a(jQuery,window,document)}(function(a,b,c,d){"use strict";var e=a.fn.dataTable,f=function(b,c){if(!e.versionCheck||!e.versionCheck("1.10.8"))throw"KeyTable requires DataTables 1.10.8 or newer";this.c=a.extend(!0,{},e.defaults.keyTable,f.defaults,c),this.s={dt:new e.Api(b),enable:!0,focusDraw:!1},this.dom={};var d=this.s.dt.settings()[0],g=d.keytable;return g?g:(d.keytable=this,void this._constructor())};return a.extend(f.prototype,{blur:function(){this._blur()},enable:function(a){this.s.enable=a},focus:function(a,b){this._focus(this.s.dt.cell(a,b))},focused:function(a){var b=this.s.lastFocus;if(!b)return!1;var c=this.s.lastFocus.index();return a.row===c.row&&a.column===c.column},_constructor:function(){this._tabInput();var b=this,d=this.s.dt,e=a(d.table().node());"static"===e.css("position")&&e.css("position","relative"),a(d.table().body()).on("click.keyTable","th, td",function(){if(b.s.enable!==!1){var a=d.cell(this);a.any()&&b._focus(a,null,!1)}}),a(c).on("keydown.keyTable",function(a){b._key(a)}),this.c.blurable&&a(c).on("click.keyTable",function(c){a(c.target).parents(".dataTables_filter").length&&b._blur(),a(c.target).parents().filter(d.table().container()).length||a(c.target).parents("div.DTE").length||b._blur()}),this.c.editor&&d.on("key.keyTable",function(a,c,d,e,f){b._editor(d,f)}),d.settings()[0].oFeatures.bStateSave&&d.on("stateSaveParams.keyTable",function(a,c,d){d.keyTable=b.s.lastFocus?b.s.lastFocus.index():null}),d.on("xhr.keyTable",function(a){if(!b.s.focusDraw){var c=b.s.lastFocus;c&&(b.s.lastFocus=null,d.one("draw",function(){b._focus(c)}))}}),d.on("destroy.keyTable",function(){d.off(".keyTable"),a(d.table().body()).off("click.keyTable","th, td"),a(c.body).off("keydown.keyTable").off("click.keyTable")});var f=d.state.loaded();f&&f.keyTable?d.one("init",function(){var a=d.cell(f.keyTable);a.any()&&a.focus()}):this.c.focus&&d.cell(this.c.focus).focus()},_blur:function(){if(this.s.enable&&this.s.lastFocus){var b=this.s.lastFocus;a(b.node()).removeClass(this.c.className),this.s.lastFocus=null,this._emitEvent("key-blur",[this.s.dt,b])}},_columns:function(){var a=this.s.dt,b=a.columns(this.c.columns).indexes(),c=[];return a.columns(":visible").every(function(a){b.indexOf(a)!==-1&&c.push(a)}),c},_editor:function(b,c){var d=this.s.dt,e=this.c.editor;c.stopPropagation(),13===b&&c.preventDefault(),e.inline(this.s.lastFocus.index());var f=a("div.DTE input, div.DTE textarea");f.length&&f[0].select(),d.keys.enable("navigation-only"),d.one("key-blur.editor",function(){e.displayed()&&e.submit()}),e.one("close",function(){d.keys.enable(!0),d.off("key-blur.editor")})},_emitEvent:function(b,c){this.s.dt.iterator("table",function(d,e){a(d.nTable).triggerHandler(b,c)})},_focus:function(e,f,g){var h=this,i=this.s.dt,j=i.page.info(),k=this.s.lastFocus;if(this.s.enable){if("number"!=typeof e){var l=e.index();f=l.column,e=i.rows({filter:"applied",order:"applied"}).indexes().indexOf(l.row),j.serverSide&&(e+=j.start)}if(j.length!==-1&&(e<j.start||e>=j.start+j.length))return this.s.focusDraw=!0,void i.one("draw",function(){h.s.focusDraw=!1,h._focus(e,f)}).page(Math.floor(e/j.length)).draw(!1);if(a.inArray(f,this._columns())!==-1){j.serverSide&&(e-=j.start);var m=i.cell(":eq("+e+")",f,{search:"applied"});if(k){if(k.node()===m.node())return;this._blur()}var n=a(m.node());if(n.addClass(this.c.className),g===d||g===!0){this._scroll(a(b),a(c.body),n,"offset");var o=i.table().body().parentNode;if(o!==i.table().header().parentNode){var p=a(o.parentNode);this._scroll(p,p,n,"position")}}this.s.lastFocus=m,this._emitEvent("key-focus",[this.s.dt,m]),i.state.save()}}},_key:function(b){if(this.s.enable&&!(0===b.keyCode||b.ctrlKey||b.metaKey||b.altKey)){var c=this.s.lastFocus;if(c){var d=this,e=this.s.dt;if(!this.c.keys||a.inArray(b.keyCode,this.c.keys)!==-1)switch(b.keyCode){case 9:this._shift(b,b.shiftKey?"left":"right",!0);break;case 27:this.s.blurable&&this.s.enable===!0&&this._blur();break;case 33:case 34:b.preventDefault();var f=e.cells({page:"current"}).nodes().indexOf(c.node());e.one("draw",function(){var a=e.cells({page:"current"}).nodes();d._focus(e.cell(f<a.length?a[f]:a[a.length-1]))}).page(33===b.keyCode?"previous":"next").draw(!1);break;case 35:case 36:b.preventDefault();var g=e.cells({page:"current"}).indexes();this._focus(e.cell(g[35===b.keyCode?g.length-1:0]));break;case 37:this._shift(b,"left");break;case 38:this._shift(b,"up");break;case 39:this._shift(b,"right");break;case 40:this._shift(b,"down");break;default:this.s.enable===!0&&this._emitEvent("key",[e,b.keyCode,this.s.lastFocus,b])}}}},_scroll:function(a,b,c,d){var e=c[d](),f=c.outerHeight(),g=c.outerWidth(),h=b.scrollTop(),i=b.scrollLeft(),j=a.height(),k=a.width();e.top<h&&b.scrollTop(e.top),e.left<i&&b.scrollLeft(e.left),e.top+f>h+j&&f<j&&b.scrollTop(e.top+f-j),e.left+g>i+k&&g<k&&b.scrollLeft(e.left+g-k)},_shift:function(b,c,d){var e=this.s.dt,f=e.page.info(),g=f.recordsDisplay,h=this.s.lastFocus,i=this._columns();if(h){var j=e.rows({filter:"applied",order:"applied"}).indexes().indexOf(h.index().row);f.serverSide&&(j+=f.start);var k=e.columns(i).indexes().indexOf(h.index().column),l=j,m=i[k];"right"===c?k>=i.length-1?(l++,m=i[0]):m=i[k+1]:"left"===c?0===k?(l--,m=i[i.length-1]):m=i[k-1]:"up"===c?l--:"down"===c&&l++,l>=0&&l<g&&a.inArray(m,i)!==-1?(b.preventDefault(),this._focus(l,m)):d&&this.c.blurable?this._blur():b.preventDefault()}},_tabInput:function(){var b=this,c=this.s.dt,d=null!==this.c.tabIndex?this.c.tabIndex:c.settings()[0].iTabIndex;if(d!=-1){var e=a('<div><input type="text" tabindex="'+d+'"/></div>').css({position:"absolute",height:1,width:0,overflow:"hidden"}).insertBefore(c.table().node());e.children().on("focus",function(){b._focus(c.cell(":eq(0)","0:visible",{page:"current"}))})}}}),f.defaults={blurable:!0,className:"focus",columns:"",editor:null,focus:null,keys:null,tabIndex:null},f.version="2.1.2",a.fn.dataTable.KeyTable=f,a.fn.DataTable.KeyTable=f,e.Api.register("cell.blur()",function(){return this.iterator("table",function(a){a.keytable&&a.keytable.blur()})}),e.Api.register("cell().focus()",function(){return this.iterator("cell",function(a,b,c){a.keytable&&a.keytable.focus(b,c)})}),e.Api.register("keys.disable()",function(){return this.iterator("table",function(a){a.keytable&&a.keytable.enable(!1)})}),e.Api.register("keys.enable()",function(a){return this.iterator("table",function(b){b.keytable&&b.keytable.enable(a===d||a)})}),e.ext.selector.cell.push(function(a,b,c){var e=b.focused,f=a.keytable,g=[];if(!f||e===d)return c;for(var h=0,i=c.length;h<i;h++)(e===!0&&f.focused(c[h])||e===!1&&!f.focused(c[h]))&&g.push(c[h]);return g}),a(c).on("preInit.dt.dtk",function(b,c,d){if("dt"===b.namespace){var g=c.oInit.keys,h=e.defaults.keys;if(g||h){var i=a.extend({},g,h);g!==!1&&new f(c,i)}}}),f});
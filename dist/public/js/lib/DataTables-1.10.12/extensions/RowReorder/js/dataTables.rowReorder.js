!function(a){"function"==typeof define&&define.amd?define(["jquery","datatables.net"],function(b){return a(b,window,document)}):"object"==typeof exports?module.exports=function(b,c){return b||(b=window),c&&c.fn.dataTable||(c=require("datatables.net")(b,c).$),a(c,b,b.document)}:a(jQuery,window,document)}(function(a,b,c,d){"use strict";var e=a.fn.dataTable,f=function(b,c){if(!e.versionCheck||!e.versionCheck("1.10.8"))throw"DataTables RowReorder requires DataTables 1.10.8 or newer";this.c=a.extend(!0,{},e.defaults.rowReorder,f.defaults,c),this.s={bodyTop:null,dt:new e.Api(b),getDataFn:e.ext.oApi._fnGetObjectDataFn(this.c.dataSrc),middles:null,scroll:{},scrollInterval:null,setDataFn:e.ext.oApi._fnSetObjectDataFn(this.c.dataSrc),start:{top:0,left:0,offsetTop:0,offsetLeft:0,nodes:[]},windowHeight:0},this.dom={clone:null,dtScroll:a("div.dataTables_scrollBody",this.s.dt.table().container())};var d=this.s.dt.settings()[0],g=d.rowreorder;return g?g:(d.rowreorder=this,void this._constructor())};return a.extend(f.prototype,{_constructor:function(){var b=this,c=this.s.dt,d=a(c.table().node());"static"===d.css("position")&&d.css("position","relative"),a(c.table().container()).on("mousedown.rowReorder touchstart.rowReorder",this.c.selector,function(d){var e=a(this).closest("tr");if(c.row(e).any())return b._mouseDown(d,e),!1}),c.on("destroy.rowReorder",function(){a(c.table().container()).off(".rowReorder"),c.off(".rowReorder")})},_cachePositions:function(){var c=this.s.dt,d=a(c.table().node()).find("thead").outerHeight(),e=a.unique(c.rows({page:"current"}).nodes().toArray()),f=a.map(e,function(b,c){return a(b).position().top-d}),g=a.map(f,function(b,d){return f.length<d-1?(b+f[d+1])/2:(b+b+a(c.row(":last-child").node()).outerHeight())/2});this.s.middles=g,this.s.bodyTop=a(c.table().body()).offset().top,this.s.windowHeight=a(b).height()},_clone:function(b){var c=this.s.dt,d=a(c.table().node().cloneNode(!1)).addClass("dt-rowReorder-float").append("<tbody/>").append(b.clone(!1)),e=b.outerWidth(),f=b.outerHeight(),g=b.children().map(function(){return a(this).width()});d.width(e).height(f).find("tr").children().each(function(a){this.style.width=g[a]+"px"}),d.appendTo("body"),this.dom.clone=d},_clonePosition:function(a){var b,c=this.s.start,d=this._eventToPage(a,"Y")-c.top,e=this._eventToPage(a,"X")-c.left,f=this.c.snapX;b=f===!0?c.offsetLeft:"number"==typeof f?c.offsetLeft+f:e+c.offsetLeft,this.dom.clone.css({top:d+c.offsetTop,left:b})},_emitEvent:function(b,c){this.s.dt.iterator("table",function(d,e){a(d.nTable).triggerHandler(b+".dt",c)})},_eventToPage:function(a,b){return a.type.indexOf("touch")!==-1?a.originalEvent.touches[0]["page"+b]:a["page"+b]},_mouseDown:function(d,e){var f=this,g=this.s.dt,h=this.s.start,i=e.offset();h.top=this._eventToPage(d,"Y"),h.left=this._eventToPage(d,"X"),h.offsetTop=i.top,h.offsetLeft=i.left,h.nodes=a.unique(g.rows({page:"current"}).nodes().toArray()),this._cachePositions(),this._clone(e),this._clonePosition(d),this.dom.target=e,e.addClass("dt-rowReorder-moving"),a(c).on("mouseup.rowReorder touchend.rowReorder",function(a){f._mouseUp(a)}).on("mousemove.rowReorder touchmove.rowReorder",function(a){f._mouseMove(a)}),a(b).width()===a(c).width()&&a(c.body).addClass("dt-rowReorder-noOverflow");var j=this.dom.dtScroll;this.s.scroll={windowHeight:a(b).height(),windowWidth:a(b).width(),dtTop:j.length?j.offset().top:null,dtLeft:j.length?j.offset().left:null,dtHeight:j.length?j.outerHeight():null,dtWidth:j.length?j.outerWidth():null}},_mouseMove:function(b){this._clonePosition(b);for(var c=this._eventToPage(b,"Y")-this.s.bodyTop,d=this.s.middles,e=null,f=this.s.dt,g=f.table().body(),h=0,i=d.length;h<i;h++)if(c<d[h]){e=h;break}if(null===e&&(e=d.length),null===this.s.lastInsert||this.s.lastInsert!==e){if(0===e)this.dom.target.prependTo(g);else{var j=a.unique(f.rows({page:"current"}).nodes().toArray());e>this.s.lastInsert?this.dom.target.insertAfter(j[e-1]):this.dom.target.insertBefore(j[e])}this._cachePositions(),this.s.lastInsert=e}this._shiftScroll(b)},_mouseUp:function(b){var d,e,f=this.s.dt,g=this.c.dataSrc;this.dom.clone.remove(),this.dom.clone=null,this.dom.target.removeClass("dt-rowReorder-moving"),a(c).off(".rowReorder"),a(c.body).removeClass("dt-rowReorder-noOverflow"),clearInterval(this.s.scrollInterval),this.s.scrollInterval=null;var h=this.s.start.nodes,i=a.unique(f.rows({page:"current"}).nodes().toArray()),j={},k=[],l=[],m=this.s.getDataFn,n=this.s.setDataFn;for(d=0,e=h.length;d<e;d++)if(h[d]!==i[d]){var o=f.row(i[d]).id(),p=f.row(i[d]).data(),q=f.row(h[d]).data();o&&(j[o]=m(q)),k.push({node:i[d],oldData:m(p),newData:m(q),newPosition:d,oldPosition:a.inArray(i[d],h)}),l.push(i[d])}var r=[k,{dataSrc:g,nodes:l,values:j,triggerRow:f.row(this.dom.target)}];if(this._emitEvent("row-reorder",r),this.c.editor&&this.c.editor.edit(l,!1,{submit:"changed"}).multiSet(g,j).submit(),this.c.update){for(d=0,e=k.length;d<e;d++){var s=f.row(k[d].node),t=s.data();n(t,k[d].newData),f.columns().every(function(){this.dataSrc()===g&&f.cell(k[d].node,this.index()).invalidate("data")})}this._emitEvent("row-reordered",r),f.draw(!1)}},_shiftScroll:function(a){var b,d,e=this,f=(this.s.dt,this.s.scroll),g=!1,h=5,i=65,j=a.pageY-c.body.scrollTop;j<i?b=h*-1:j>f.windowHeight-i&&(b=h),null!==f.dtTop&&a.pageY<f.dtTop+i?d=h*-1:null!==f.dtTop&&a.pageY>f.dtTop+f.dtHeight-i&&(d=h),b||d?(f.windowVert=b,f.dtVert=d,g=!0):this.s.scrollInterval&&(clearInterval(this.s.scrollInterval),this.s.scrollInterval=null),!this.s.scrollInterval&&g&&(this.s.scrollInterval=setInterval(function(){if(f.windowVert&&(c.body.scrollTop+=f.windowVert),f.dtVert){var a=e.dom.dtScroll[0];f.dtVert&&(a.scrollTop+=f.dtVert)}},20))}}),f.defaults={dataSrc:0,editor:null,selector:"td:first-child",snapX:!1,update:!0},f.version="1.1.2",a.fn.dataTable.RowReorder=f,a.fn.DataTable.RowReorder=f,a(c).on("init.dt.dtr",function(b,c,d){if("dt"===b.namespace){var g=c.oInit.rowReorder,h=e.defaults.rowReorder;if(g||h){var i=a.extend({},g,h);g!==!1&&new f(c,i)}}}),f});
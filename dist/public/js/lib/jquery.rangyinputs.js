!function(a){function b(a,b){var c=typeof a[b];return"function"===c||!("object"!=c||!a[b])||"unknown"==c}function c(a,b){return typeof a[b]!=r}function d(a,b){return!("object"!=typeof a[b]||!a[b])}function e(a){window.console&&window.console.log&&window.console.log("RangyInputs not supported in your browser. Reason: "+a)}function f(a,b,c){return b<0&&(b+=a.value.length),typeof c==r&&(c=b),c<0&&(c+=a.value.length),{start:b,end:c}}function g(a,b,c){return{start:b,end:c,length:c-b,text:a.value.slice(b,c)}}function h(){return d(document,"body")?document.body:document.getElementsByTagName("body")[0]}var i,j,k,l,m,n,o,p,q,r="undefined";a(document).ready(function(){function s(a,b){return function(){var c=this.jquery?this[0]:this,d=c.nodeName.toLowerCase();if(1==c.nodeType&&("textarea"==d||"input"==d&&"text"==c.type)){var e=[c].concat(Array.prototype.slice.call(arguments)),f=a.apply(this,e);if(!b)return f}if(b)return this}}var t=document.createElement("textarea");if(h().appendChild(t),c(t,"selectionStart")&&c(t,"selectionEnd"))i=function(a){var b=a.selectionStart,c=a.selectionEnd;return g(a,b,c)},j=function(a,b,c){var d=f(a,b,c);a.selectionStart=d.start,a.selectionEnd=d.end},q=function(a,b){b?a.selectionEnd=a.selectionStart:a.selectionStart=a.selectionEnd};else{if(!(b(t,"createTextRange")&&d(document,"selection")&&b(document.selection,"createRange")))return h().removeChild(t),void e("No means of finding text input caret position");i=function(a){var b,c,d,e,f=0,h=0,i=document.selection.createRange();return i&&i.parentElement()==a&&(d=a.value.length,b=a.value.replace(/\r\n/g,"\n"),c=a.createTextRange(),c.moveToBookmark(i.getBookmark()),e=a.createTextRange(),e.collapse(!1),c.compareEndPoints("StartToEnd",e)>-1?f=h=d:(f=-c.moveStart("character",-d),f+=b.slice(0,f).split("\n").length-1,c.compareEndPoints("EndToEnd",e)>-1?h=d:(h=-c.moveEnd("character",-d),h+=b.slice(0,h).split("\n").length-1))),g(a,f,h)};var u=function(a,b){return b-(a.value.slice(0,b).split("\r\n").length-1)};j=function(a,b,c){var d=f(a,b,c),e=a.createTextRange(),g=u(a,d.start);e.collapse(!0),d.start==d.end?e.move("character",g):(e.moveEnd("character",u(a,d.end)),e.moveStart("character",g)),e.select()},q=function(a,b){var c=document.selection.createRange();c.collapse(b),c.select()}}h().removeChild(t),l=function(a,b,c,d){var e;b!=c&&(e=a.value,a.value=e.slice(0,b)+e.slice(c)),d&&j(a,b,b)},k=function(a){var b=i(a);l(a,b.start,b.end,!0)},p=function(a){var b,c=i(a);return c.start!=c.end&&(b=a.value,a.value=b.slice(0,c.start)+b.slice(c.end)),j(a,c.start,c.start),c.text};var v=function(a,b,c,d){var e=b+c.length;if(d="string"==typeof d?d.toLowerCase():"",("collapsetoend"==d||"select"==d)&&/[\r\n]/.test(c)){var f=c.replace(/\r\n/g,"\n").replace(/\r/g,"\n");e=b+f.length;var g=b+f.indexOf("\n");"\r\n"==a.value.slice(g,g+2)&&(e+=f.match(/\n/g).length)}switch(d){case"collapsetostart":j(a,b,b);break;case"collapsetoend":j(a,e,e);break;case"select":j(a,b,e)}};m=function(a,b,c,d){var e=a.value;a.value=e.slice(0,c)+b+e.slice(c),"boolean"==typeof d&&(d=d?"collapseToEnd":""),v(a,c,b,d)},n=function(a,b,c){var d=i(a),e=a.value;a.value=e.slice(0,d.start)+b+e.slice(d.end),v(a,d.start,b,c||"collapseToEnd")},o=function(a,b,c,d){typeof c==r&&(c=b);var e=i(a),f=a.value;a.value=f.slice(0,e.start)+b+e.text+c+f.slice(e.end);var g=e.start+b.length;v(a,g,e.text,d||"select")},a.fn.extend({getSelection:s(i,!1),setSelection:s(j,!0),collapseSelection:s(q,!0),deleteSelectedText:s(k,!0),deleteText:s(l,!0),extractSelectedText:s(p,!1),insertText:s(m,!0),replaceSelectedText:s(n,!0),surroundSelectedText:s(o,!0)})})}(jQuery);
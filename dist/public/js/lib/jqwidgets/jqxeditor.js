!function(a){$.jqx.jqxWidget("jqxEditor","",{}),$.extend($.jqx._jqxEditor.prototype,{defineInstance:function(){this.width=null,this.height=null,this.disabled=!1,this.pasteMode="html",this.editable=!0,this.lineBreak="default",this.toolbarPosition="top",this.commands={bold:{tooltip:"Bold",command:"bold",type:"toggleButton"},italic:{tooltip:"Italic",command:"italic",type:"toggleButton"},underline:{tooltip:"Underline",command:"underline",type:"toggleButton"},format:{placeHolder:"Format Block",tooltip:"Format Block",command:"formatblock",value:[{value:"p",label:"Paragraph"},{value:"h1",label:"Header 1"},{value:"h2",label:"Header 2"},{value:"h3",label:"Header 3"},{value:"h4",label:"Header 4"}],type:"list",width:120,dropDownWidth:190,height:25},font:{placeHolder:"Font",tooltip:"Font Name",command:"fontname",value:[{label:"Arial",value:"Arial, Helvetica, sans-serif"},{label:"Comic Sans MS",value:'"Comic Sans MS", cursive, sans-serif'},{label:"Courier New",value:'"Courier New", Courier, monospace'},{label:"Georgia",value:"Georgia,serif"},{label:"Impact",value:"Impact,Charcoal,sans-serif"},{label:"Lucida Console",value:"'Lucida Console',Monaco,monospace"},{label:"Tahoma",value:"Tahoma,Geneva,sans-serif"},{label:"Times New Roman",value:"'Times New Roman',Times,serif"},{label:"Trebuchet MS",value:'"Trebuchet MS",Helvetica,sans-serif'},{label:"Verdana",value:"Verdana,Geneva,sans-serif"}],type:"list",width:160,height:25,dropDownWidth:160},size:{placeHolder:"Size",tooltip:"Font Size",command:"fontsize",value:[{label:"1 (8pt)",value:"xx-small"},{label:"2 (10pt)",value:"x-small"},{label:"3 (12pt)",value:"small"},{label:"4 (14pt)",value:"medium"},{label:"5 (18pt)",value:"large"},{label:"6 (24pt)",value:"x-large"},{label:"7 (36pt)",value:"xx-large"}],type:"list",width:45,height:25,dropDownWidth:160},color:{tooltip:"Text Color",command:"forecolor",value:"#000",type:"colorPicker"},background:{tooltip:"Fill Color",command:"backcolor",value:"#fff",type:"colorPicker"},left:{tooltip:"Align Left",command:"justifyleft",type:"toggleButton"},center:{tooltip:"Align Center",command:"justifycenter",type:"toggleButton"},right:{tooltip:"Align Right",command:"justifyright",type:"toggleButton"},outdent:{tooltip:"Indent Less",command:"outdent",type:"button"},indent:{tooltip:"Indent More",command:"indent",type:"button"},ul:{tooltip:"Insert unordered list",command:"insertunorderedlist",type:"toggleButton"},ol:{tooltip:"Insert ordered list",command:"insertorderedlist",type:"toggleButton"},image:{tooltip:"Insert image",command:"insertimage",type:"button"},link:{tooltip:"Insert link",command:"createlink",type:"toggleButton"},html:{tooltip:"View source",command:"viewsource",type:"toggleButton"},clean:{tooltip:"Remove Formatting",command:"removeformat",type:"button"}},this.createCommand=null,this.defaultLocalization={bold:"Bold",italic:"Italic",underline:"Underline",format:"Format Block",font:"Font Name",size:"Font Size",color:"Text Color",background:"Fill Color",left:"Align Left",center:"Align Center",right:"Align Right",outdent:"Indent Less",indent:"Indent More",ul:"Insert unordered list",ol:"Insert ordered list",image:"Insert image",link:"Insert link",html:"View source",clean:"Remove Formatting",Remove:"Remove",Ok:"Ok",Cancel:"Cancel",Change:"Change","Go to link":"Go to link","Open in a new window/tab":"Open in a new window/tab",Align:"Align",VSpace:"VSpace",HSpace:"HSpace",Width:"Width",Height:"Height",Title:"Title",URL:"URL","Insert Image":"Insert Image","Insert Link":"Insert Link","Alt Text":"Alt Text","not set":"&lt;not set&gt;",Left:"Left",Right:"Right",Paragraph:"Paragraph",Header:"Header",Arial:"Arial","Comic Sans MS":"Comic Sans MS","Courier New":"Courier New",Georgia:"Georgia",Impact:"Impact","Lucida Console":"Lucida Console",Tahoma:"Tahoma","Times New Roman":"Times New Roman","Trebuchet MS":"Trebuchet MS",Verdana:"Verdana"},this.localization=this.defaultLocalization,this.tools="bold italic underline | format font size | color background | left center right | outdent indent | ul ol | image | link | clean | html",this.readOnly=!1,this.stylesheets=new Array,this.rtl=!1,this.colorPickerTemplate='<div class="jqx-editor-color-picker"><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (0, 0, 0)"><div title="RGB (0, 0, 0)" style="background-color: rgb(0, 0, 0);"></div></td><td aria-label="RGB (68, 68, 68)"><div title="RGB (68, 68, 68)" style="background-color: rgb(68, 68, 68);"></div></td><td aria-label="RGB (102, 102, 102)"><div title="RGB (102, 102, 102)" style="background-color: rgb(102, 102, 102);"></div></td><td aria-label="RGB (153, 153, 153)"><div title="RGB (153, 153, 153)" style="background-color: rgb(153, 153, 153);"></div></td><td aria-label="RGB (204, 204, 204)"><div title="RGB (204, 204, 204)" style="background-color: rgb(204, 204, 204);"></div></td><td aria-label="RGB (238, 238, 238)"><div title="RGB (238, 238, 238)" style="background-color: rgb(238, 238, 238);"></div></td><td aria-label="RGB (243, 243, 243)"><div title="RGB (243, 243, 243)" style="background-color: rgb(243, 243, 243);"></div></td><td aria-label="RGB (255, 255, 255)"><div title="RGB (255, 255, 255)" style="background-color: rgb(255, 255, 255);"></div></td></tr></tbody></table></div><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (255, 0, 0)"><div title="RGB (255, 0, 0)" style="background-color: rgb(255, 0, 0);"></div></td><td aria-label="RGB (255, 153, 0)"><div title="RGB (255, 153, 0)" style="background-color: rgb(255, 153, 0);"></div></td><td aria-label="RGB (255, 255, 0)"><div title="RGB (255, 255, 0)" style="background-color: rgb(255, 255, 0);"></div></td><td aria-label="RGB (0, 255, 0)"><div title="RGB (0, 255, 0)" style="background-color: rgb(0, 255, 0);"></div></td><td aria-label="RGB (0, 255, 255)"><div title="RGB (0, 255, 255)" style="background-color: rgb(0, 255, 255);"></div></td><td aria-label="RGB (0, 0, 255)"><div title="RGB (0, 0, 255)" style="background-color: rgb(0, 0, 255);"></div></td><td aria-label="RGB (153, 0, 255)"><div title="RGB (153, 0, 255)" style="background-color: rgb(153, 0, 255);"></div></td><td aria-label="RGB (255, 0, 255)"><div title="RGB (255, 0, 255)" style="background-color: rgb(255, 0, 255);"></div></td></tr></tbody></table></div><div role="grid"><table class="jqx-editor-color-picker-table" cellspacing="0" cellpadding="0"><tbody><tr><td aria-label="RGB (244, 204, 204)"><div title="RGB (244, 204, 204)" style="background-color: rgb(244, 204, 204);"></div></td><td aria-label="RGB (252, 229, 205)"><div title="RGB (252, 229, 205)" style="background-color: rgb(252, 229, 205);"></div></td><td aria-label="RGB (255, 242, 204)"><div title="RGB (255, 242, 204)" style="background-color: rgb(255, 242, 204);"></div></td><td aria-label="RGB (217, 234, 211)"><div title="RGB (217, 234, 211)" style="background-color: rgb(217, 234, 211);"></div></td><td aria-label="RGB (208, 224, 227)"><div title="RGB (208, 224, 227)" style="background-color: rgb(208, 224, 227);"></div></td><td aria-label="RGB (207, 226, 243)"><div title="RGB (207, 226, 243)" style="background-color: rgb(207, 226, 243);"></div></td><td aria-label="RGB (217, 210, 233)"><div title="RGB (217, 210, 233)" style="background-color: rgb(217, 210, 233);"></div></td><td aria-label="RGB (234, 209, 220)"><div title="RGB (234, 209, 220)" style="background-color: rgb(234, 209, 220);"></div></td></tr><tr><td id="T-Kw-Jn88" aria-label="RGB (234, 153, 153)"><div title="RGB (234, 153, 153)" style="background-color: rgb(234, 153, 153);"></div></td><td aria-label="RGB (249, 203, 156)"><div title="RGB (249, 203, 156)" style="background-color: rgb(249, 203, 156);"></div></td><td aria-label="RGB (255, 229, 153)"><div title="RGB (255, 229, 153)" style="background-color: rgb(255, 229, 153);"></div></td><td aria-label="RGB (182, 215, 168)"><div title="RGB (182, 215, 168)" style="background-color: rgb(182, 215, 168);"></div></td><td aria-label="RGB (162, 196, 201)"><div title="RGB (162, 196, 201)" style="background-color: rgb(162, 196, 201);"></div></td><td aria-label="RGB (159, 197, 232)"><div title="RGB (159, 197, 232)" style="background-color: rgb(159, 197, 232);"></div></td><td aria-label="RGB (180, 167, 214)"><div title="RGB (180, 167, 214)" style="background-color: rgb(180, 167, 214);"></div></td><td aria-label="RGB (213, 166, 189)"><div title="RGB (213, 166, 189)" style="background-color: rgb(213, 166, 189);"></div></td></tr><tr><td aria-label="RGB (224, 102, 102)"><div title="RGB (224, 102, 102)" style="background-color: rgb(224, 102, 102);"></div></td><td aria-label="RGB (246, 178, 107)"><div title="RGB (246, 178, 107)" style="background-color: rgb(246, 178, 107);"></div></td><td aria-label="RGB (255, 217, 102)"><div title="RGB (255, 217, 102)" style="background-color: rgb(255, 217, 102);"></div></td><td aria-label="RGB (147, 196, 125)"><div title="RGB (147, 196, 125)" style="background-color: rgb(147, 196, 125);"></div></td><td aria-label="RGB (118, 165, 175)"><div title="RGB (118, 165, 175)" style="background-color: rgb(118, 165, 175);"></div></td><td aria-label="RGB (111, 168, 220)"><div title="RGB (111, 168, 220)" style="background-color: rgb(111, 168, 220);"></div></td><td aria-label="RGB (142, 124, 195)"><div title="RGB (142, 124, 195)" style="background-color: rgb(142, 124, 195);"></div></td><td aria-label="RGB (194, 123, 160)"><div title="RGB (194, 123, 160)" style="background-color: rgb(194, 123, 160);"></div></td></tr><tr><td id="T-Kw-Jn104" aria-label="RGB (204, 0, 0)"><div title="RGB (204, 0, 0)" style="background-color: rgb(204, 0, 0);"></div></td><td aria-label="RGB (230, 145, 56)"><div title="RGB (230, 145, 56)" style="background-color: rgb(230, 145, 56);"></div></td><td aria-label="RGB (241, 194, 50)"><div title="RGB (241, 194, 50)" style="background-color: rgb(241, 194, 50);"></div></td><td aria-label="RGB (106, 168, 79)"><div title="RGB (106, 168, 79)" style="background-color: rgb(106, 168, 79);"></div></td><td aria-label="RGB (69, 129, 142)"><div title="RGB (69, 129, 142)" style="background-color: rgb(69, 129, 142);"></div></td><td aria-label="RGB (61, 133, 198)"><div title="RGB (61, 133, 198)" style="background-color: rgb(61, 133, 198);"></div></td><td aria-label="RGB (103, 78, 167)"><div title="RGB (103, 78, 167)" style="background-color: rgb(103, 78, 167);"></div></td><td aria-label="RGB (166, 77, 121)"><div title="RGB (166, 77, 121)" style="background-color: rgb(166, 77, 121);"></div></td></tr><tr><td aria-label="RGB (153, 0, 0)"><div title="RGB (153, 0, 0)" style="background-color: rgb(153, 0, 0);"></div></td><td aria-label="RGB (180, 95, 6)"><div title="RGB (180, 95, 6)" style="background-color: rgb(180, 95, 6);"></div></td><td aria-label="RGB (191, 144, 0)"><div title="RGB (191, 144, 0)" style="background-color: rgb(191, 144, 0);"></div></td><td aria-label="RGB (56, 118, 29)"><div title="RGB (56, 118, 29)" style="background-color: rgb(56, 118, 29);"></div></td><td aria-label="RGB (19, 79, 92)"><div title="RGB (19, 79, 92)" style="background-color: rgb(19, 79, 92);"></div></td><td aria-label="RGB (11, 83, 148)"><div title="RGB (11, 83, 148)" style="background-color: rgb(11, 83, 148);"></div></td><td aria-label="RGB (53, 28, 117)"><div title="RGB (53, 28, 117)" style="background-color: rgb(53, 28, 117);"></div></td><td aria-label="RGB (116, 27, 71)"><div title="RGB (116, 27, 71)" style="background-color: rgb(116, 27, 71);"></div></td></tr><tr><td aria-label="RGB (102, 0, 0)"><div title="RGB (102, 0, 0)" style="background-color: rgb(102, 0, 0);"></div></td><td aria-label="RGB (120, 63, 4)"><div title="RGB (120, 63, 4)" style="background-color: rgb(120, 63, 4);"></div></td><td aria-label="RGB (127, 96, 0)"><div title="RGB (127, 96, 0)" style="background-color: rgb(127, 96, 0);"></div></td><td aria-label="RGB (39, 78, 19)"><div title="RGB (39, 78, 19)" style="background-color: rgb(39, 78, 19);"></div></td><td aria-label="RGB (12, 52, 61)"><div title="RGB (12, 52, 61)" style="background-color: rgb(12, 52, 61);"></div></td><td aria-label="RGB (7, 55, 99)"><div title="RGB (7, 55, 99)" style="background-color: rgb(7, 55, 99);"></div></td><td aria-label="RGB (32, 18, 77)"><div title="RGB (32, 18, 77)" style="background-color: rgb(32, 18, 77);"></div></td><td aria-label="RGB (76, 17, 48)"><div title="RGB (76, 17, 48)" style="background-color: rgb(76, 17, 48);"></div></td></tr></tbody></table></div></div>',this.touchMode=!1,this.events=["change"]},createInstance:function(a){var c=this;this.textArea=this.host;var d=this.host.attr("contenteditable");if(this.host.addClass(this.toThemeProperty("jqx-widget")),1==d||"true"==d){this.inline=!0,this.widget=this.host,this.editorDocument=document,this.selection=new b(this.editorDocument);var e=$("<div class='jqx-editor-toolbar-container' unselectable='on' aria-label='Formatting options' role='toolbar'><div class='jqx-editor-toolbar'></div>");e.insertBefore(this.host),this.toolbarContainer=e,this.toolbar=e.find(".jqx-editor-toolbar"),this.editor=this.host,this.contentEditableElement=this.element}else{var f=$("<div class='jqx-editor'><div class='jqx-editor-container'><div class='jqx-editor-toolbar-container' aria-label='Formatting options' role='toolbar'><div class='jqx-editor-toolbar'></div></div><div class='jqx-editor-content'><iframe  src='javascript:void(0)' allowtransparency='true' frameborder='0'></iframe></div></div></div>");this.widget=f,this.widget[0].className=this.widget[0].className+" "+this.element.className;try{this.widget[0].style=this.element.style}catch(g){}var h=$.trim(this.host.html())+"&#8203;";"default"==this.lineBreak||"div"==this.lineBreak?h="<div>"+h+"</div>":"p"==this.lineBreak&&(h="<p>"+h+"</p>"),h=h.replace(/&lt;/gi,"<"),h=h.replace(/&gt;/gi,">"),this.host.css("display","none"),this.host.after(f),f.find("iframe").after(this.host),this.container=f.find(".jqx-editor-container"),this.toolbarContainer=f.find(".jqx-editor-toolbar-container"),this.toolbar=f.find(".jqx-editor-toolbar"),this.iframe=f.find("iframe"),this.content=f.find(".jqx-editor-content"),this.editorDocument=this.iframe[0].contentWindow.document,this.selection=new b(this.editorDocument),$.jqx.browser.mozilla||(this.editorDocument.designMode="On"),this.editorDocument.open();var i=this.rtl?"direction:rtl;":"",j=$.jqx.browser.msie?"::selection{color: #fff; background: #328EFD;};::-moz-selection{color: #fff; background: #328eD;};::selection:window-inactive {background: #c7c7c7; color: #000;}::-moz-selection:window-inactive {background: #c7c7c7; color: #000;}html{font-size:13px; height:100%;}body{padding-top:1px;margin-top:-1px; padding-right: 1px; overflow-x: hidden;word-wrap: break-word;-webkit-nbsp-mode: space;-webkit-line-break: after-white-space;":"";if(this.editorDocument.write("<!DOCTYPE html><html><head><meta charset='utf-8' /><style>html,body{padding:0; margin:0; font-size: 13px; font-family:Verdana,Geneva,sans-serif; background:#fff; min-height:100%;}"+j+i+"}h1{font-size:2em;margin:.67em 0}h2{font-size: 1.5em; margin: .75em 0}h3{font-size: 1.17em; margin: .83em 0}h4{font-size:1em; margin: 1.12em 0 }h5{font-size: .83em; margin: 1.5em 0}h6{font-size: .75em; margin: 1.67em 0}p{margin: 0px;padding:0 .2em}ul,ol{padding-left:2.5em}a{color:#00a}code{font-size:1.23em}.jqx-editor-paste-element {position: absolute; left: -1000px; height: 1px; overflow: hidden; top: -1000px;}.jqx-editor-focus {border: 1px solid #aaa !important;}</style>"+$.map(this.stylesheets,function(a){return"<link rel='stylesheet' href='"+a+"'>"}).join("")+"</head><body autocorrect='off' contenteditable='true'></body></html>"),this.contentEditableElement=this.editorDocument.body,this.host.is("textarea")){this._textArea=this.element;var k=this.host.data();k.jqxEditor.host=f,k.jqxEditor.element=f[0],this.element=f[0],f[0].id=this._textArea.id,this._textArea.id=this._textArea.id+"TextArea",$(this.element).addClass(this.toThemeProperty("jqx-widget")),this.host=$(this.element),this.host.data(k)}try{this.editorDocument.execCommand("useCSS",!1,!1),this.editorDocument.execCommand("enableInlineTableEditing",null,!1)}catch(l){}try{this.editorDocument.execCommand("styleWithCSS",0,!0)}catch(l){}this.editorDocument.close(),this.editor=$(this.editorDocument.body),this.editor.html(h).attr("spellcheck",!1).attr("autocorrect","off"),$.jqx.utilities.resize(f,function(){c.widget.css("width",c.width),c.widget.css("height",c.height),c._arrange()})}},focus:function(){$.jqx.browser.mozilla&&(this.focused||(this.iframe&&this.iframe.focus(),this.selection.selectNode(this.editor[0].firstChild,!0),this.selection.getRange().collapse(!0))),this.editor.focus();var a=null!=this.range?this.range:this.getRange();this.selectRange(a)},print:function(){var a=window.open("","_blank","width=450,height=470,left=400,top=100,menubar=yes,toolbar=no,location=no,scrollbars=yes");a.document.open(),a.document.write('<!doctype html><html><head><title>Print</title></head><body onload="print();">'+this.val()+"</body></html>"),a.document.close()},refresh:function(a){var b=this;$.each(this.defaultLocalization,function(a,c){b.localization[a]||(b.localization[a]=c)}),this._removeHandlers(),this.toolbar.addClass(this.toThemeProperty("jqx-widget-header")),this.content?(this.widget.css("width",this.width),this.widget.css("height",this.height),this.widget.addClass(this.toThemeProperty("jqx-editor")),this.widget.addClass(this.toThemeProperty("jqx-widget")),this.widget.addClass(this.toThemeProperty("jqx-rc-all")),this.widget.addClass(this.toThemeProperty("jqx-widget-header")),this.content.addClass(this.toThemeProperty("jqx-widget-content")),this.container.addClass(this.toThemeProperty("jqx-editor-container"))):(this.toolbarContainer.addClass(this.toThemeProperty("jqx-widget-header")),this.toolbarContainer.addClass(this.toThemeProperty("jqx-editor-toolbar-inline")),this.toolbarContainer.addClass(this.toThemeProperty("jqx-widget")),this.toolbarContainer.addClass(this.toThemeProperty("jqx-rc-all")),this.toolbarContainer.hide(),this.toolbarContainer.css("position","absolute"),this.editor.addClass(this.toThemeProperty("jqx-editor-inline")),this.toolbarContainer.css("width",this.host.outerWidth()+"px"));var c=this.toolbarContainer.index();if("top"==this.toolbarPosition&&0!=c||"bottom"==this.toolbarPosition&&1!=c)switch(this.toolbarPosition){case"bottom":this.toolbarContainer.insertAfter(this.content);break;case"top":default:this.toolbarContainer.insertBefore(this.content)}var d=this.tools;if(d!==!1){var e=d.split(" "),f=d.split(" | "),g=function(a,c){$.each(c,function(d,e){var f=b.commands[this];if(f){if(b.createCommand){var g=b.createCommand(this.toString());f=$.extend(f,g)}}else{if(!b.createCommand)return!0;if(f=b.createCommand(this.toString()),!f)return!0;b.commands[this]||(b.commands[this]=f)}switch(b.localization[this]&&(f.tooltip=b.localization[this]),f.type){case"list":f.widget&&f.widget.jqxDropDownList("destroy");var h=function(a,b,c){return"formatblock"==f.command?"<"+c+' unselectable="on" style="padding: 0px; margin: 0px;">'+b+"</"+c+">":"fontname"==f.command?'<span unselectable="on" style="font-family: '+c+';">'+b+"<span>":"fontsize"==f.command?'<span unselectable="on" style="font-size: '+c+';">'+b+"<span>":void 0},i=function(){var a=b.toThemeProperty("jqx-editor-toolbar-icon")+" "+b.toThemeProperty("jqx-editor-toolbar-icon-"+f.command),c="<div unselectable='on' style='margin-top: 0px; padding:0px;' class='"+a+"'></div>";return c},j="formatblock"==f.command||"fontname"==f.command||"fontsize"==f.command,k=f.value||[],l=new Array,m=f.placeHolder||"Please Choose:";"fontname"==f.command?$.each(k,function(){var a=b.localization[this.label];l.push({label:a,value:this.value})}):"formatblock"==f.command?(m=b.localization.format,$.each(k,function(){if(this.label.indexOf("Header")>=0)var a=this.label.replace("Header",b.localization.Header);else var a=b.localization[this.label];l.push({label:a,value:this.value})})):l=k;var n={enableBrowserBoundsDetection:!0,touchMode:b.touchMode,width:f.width||100,height:f.height||25,dropDownWidth:f.dropDownWidth||"auto",autoDropDownHeight:(f.value&&f.value.length)<12,placeHolder:m,source:l,theme:b.theme,keyboardSelection:!1,focusable:!1,disabled:b.disabled,rtl:b.rtl,selectionRenderer:"fontsize"==f.command?i:null,renderer:j?h:null},o="jqx-disableselect "+b.toThemeProperty("jqx-editor-dropdownlist")+" "+b.toThemeProperty("jqx-editor-toolbar-item"),p=$("<div unselectable='on' class='"+o+"'></div>");p.appendTo(a),p.jqxDropDownList(n),f.init&&f.init(p);var e=null,q=null,r="";b.addHandler(p,"mousedown",function(a){if($(".jqx-editor-dropdownpicker").length>0&&$(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),$(".jqx-editor-dropdownlist").length>0){var b=$(".jqx-editor-dropdownlist");$.each(b,function(a,b){b!=p[0]&&$(b).jqxDropDownList("close")})}}),b.addHandler(p,"open",function(a){b.focused||b.focus(),b.updating=!0,b.activeElement=p,e=p.val(),r=""}),b.addHandler(p,"change",function(a){b.updating=!1,b.activeElement=null,q=p.val(),r=a.args.type,$.jqx.browser.msie&&$.jqx.browser.version<9&&b.focus()}),b.addHandler(p,"close",function(a){b.updating=!1,b.activeElement=null,e!=q&&("mouse"!=r&&"keyboard"!=r||b._refreshTools())}),b._addCommandHandler(p,"change",f.command,null,f);break;case"colorPicker":f.widget&&($(f.colorPicker).remove(),f.widget.jqxDropDownButton("destroy"));var s=$('<div unselectable="on" style="padding-top: 4px;"></div>').attr("id","picker-"+f.command),o="jqx-disableselect "+b.toThemeProperty("jqx-editor-dropdownpicker")+" "+b.toThemeProperty("jqx-editor-toolbar-item"),p=$("<div unselectable='on' class='"+o+"'></div>");p.appendTo(a),p.append(s),p.jqxDropDownButton({touchMode:b.touchMode,disabled:b.disabled,enableBrowserBoundsDetection:!0,width:f.width||45,height:f.height||25,rtl:b.rtl,focusable:!1,theme:b.theme});var t=$('<div unselectable="on" style="z-index: 55;">'),u=b.toThemeProperty("jqx-editor-toolbar-icon")+" "+b.toThemeProperty("jqx-editor-toolbar-icon-"+f.command),v=$("<div unselectable='on' class='"+u+"'></div>");t.append(v);var w=$('<div unselectable="on" class="jqx-editor-color-bar">').attr("id","bar-"+f.command).css("background-color",f.value);t.append(w),p.jqxDropDownButton("setContent",t),s.append($(b.colorPickerTemplate)),f.colorPicker=s,f.init&&f.init(p),s.find("tr").attr("role","row").attr("unselectable","on"),s.find("td").attr("role","gridcell").attr("unselectable","on").css("-webkit-user-select","none"),s.find("div").attr("unselectable","on"),b.addHandler(p,"mousedown",function(a){if($(".jqx-editor-dropdownlist").length>0&&$(".jqx-editor-dropdownlist").jqxDropDownList("close"),$(".jqx-editor-dropdownpicker").length>0){var b=$(".jqx-editor-dropdownpicker");$.each(b,function(a,b){b!=p[0]&&$(b).jqxDropDownButton("close")})}}),b.addHandler(p,"open",function(){b.focused||b.focus(),b.updating=!0,b.activeElement=s}),b.addHandler(p,"close",function(a){b.updating=!1,b.activeElement=null,e!=q&&("mouse"!=r&&"keyboard"!=r||b._refreshTools())}),b.addHandler(s,"keydown",function(a){var b=a.keyCode,c=$(s).find(".jqx-editor-color-picker-selected-cell"),d=s.find("tr"),e=d.length,g=c.parent().children().length,h=c.index(),i=-999,j=c.parent();switch($.each(d,function(a,b){if(this==j[0])return i=a,!1}),b){case 27:p.jqxDropDownButton("close");break;case 13:$(c).trigger("mousedown");break;case 38:i--;break;case 40:i++;break;case 39:h++;break;case 37:h--}if(i>=0&&i<=e&&h>=0&&h<=g){var j=s.find("tr")[i],k=$(j).children()[h],l=$(k).children().css("background-color");f.val(l)}});var x=$(s).find("td");f.val=function(a){var c=b._rgbToHex(a);$.each(x,function(){var a=$(this).children().css("background-color"),d=b._rgbToHex(a);if(d==c)return x.removeClass("jqx-editor-color-picker-selected-cell"),$(this).addClass("jqx-editor-color-picker-selected-cell"),$("#bar-"+f.command).css("background",a),!1})},f.val(f.value),b._addCommandHandler(x,"mousedown",f.command,null,f);break;case"button":case"toggleButton":default:f.widget&&("button"==f.type?f.widget.jqxButton("destroy"):f.widget.jqxToggleButton("destroy"));var y=f.command,z=f.action,u=b.toThemeProperty("jqx-editor-toolbar-icon")+" "+b.toThemeProperty("jqx-editor-toolbar-icon-"+y),v=$("<div unselectable='on' class='"+u+"'></div>"),p=$("<div unselectable='on'></div>").addClass("jqx-disableselect").addClass(b.toThemeProperty("jqx-editor-toolbar-button"));f.init?y&&p.append(v):p.append(v),p.appendTo(a),"button"==f.type?p.jqxButton({disabled:b.disabled,rtl:b.rtl,theme:b.theme}):"toggleButton"==f.type&&p.jqxToggleButton({disabled:b.disabled,rtl:b.rtl,uiToggle:!1,theme:b.theme}),f.init&&f.init(p),f.toggled=!1,f.toggle=function(){f.toggled=!f.toggled},b.addHandler(p,"mousedown",function(a){return a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),!1}),$.jqx.mobile.isTouchDevice()?b._addCommandHandler(p,"mousedown",y,z,f):b._addCommandHandler(p,"click",y,z,f)}if(f.widget=p,p){try{""!=f.tooltip&&(f.widget.attr("title",f.tooltip),f.widget.attr("data-tooltip",f.tooltip)),f.command&&f.widget.attr("data-command",f.command),f.widget.attr("aria-label",f.tooltip)}catch(A){}"button"!=f.type&&"toggleButton"!=f.type||(c.length>2&&(0==d?(p.css("border-right-radius","0px"),p.addClass(b.toThemeProperty("jqx-rc-l"))):d==c.length-1&&(p.css("border-left-radius","0px"),p.addClass(b.toThemeProperty("jqx-rc-r"))),p.removeClass(b.toThemeProperty("jqx-rc-all"))),0!=d&&d!=c.length-1&&c.length>2?(p.css("border-left-radius","0px"),p.css("border-right-radius","0px"),p.removeClass(b.toThemeProperty("jqx-rc-all"))):2==c.length?(0==d?(p.css("border-right-radius","0px"),p.addClass(b.toThemeProperty("jqx-rc-l"))):(p.css("border-left-radius","0px"),p.addClass(b.toThemeProperty("jqx-rc-r"))),p.removeClass(b.toThemeProperty("jqx-rc-all"))):1==c.length&&p.css("margin-right","0px"))}})};if(b.toolbar.css("direction",this.rtl?"rtl":"ltr"),0==f.length)g(b.toolbar,e);else{for(var h=0;h<f.length;h++){var i=f[h],e=i.split(" "),j=b.toThemeProperty("jqx-editor-toolbar-group")+" "+b.toThemeProperty("jqx-fill-state-normal"),k=$("<div class='"+j+"'></div>");k.addClass(b.toThemeProperty("jqx-rc-all")),b.toolbar.append(k),g(k,e)}for(var l=b.toolbar.find(".jqx-editor-toolbar-group"),m=l.length,h=0;h<m;h++)0==$(l[h]).children().length&&$(l[h]).remove()}$.jqx.browser.msie&&$.jqx.browser.version<8&&($(".jqx-editor-toolbar-group").css("float","left"),$(".jqx-editor-toolbar-group").children().css("float","left"),$(".jqx-editor-toolbar-group").css("zoom","1"),$(".jqx-editor-toolbar-group").children().css("zoom","1"))}this._arrange(),this._addHandlers()},_arrange:function(){this.content&&(""==this.tools||0==this.tools?(this.content.height(this.container.outerHeight()-parseInt(this.container.css("padding-top"))-parseInt(this.container.css("padding-bottom"))-6),this.content.css("margin-top","4px"),this.toolbar.hide()):(this.toolbar.show(),this.content.css("margin-top","0px"),this.content.height(this.container.outerHeight()-this.toolbar.outerHeight()-parseInt(this.container.css("padding-top"))-parseInt(this.container.css("padding-bottom"))-2),"top"!=this.toolbarPosition&&(this.content.css("margin-top","4px"),this.content.css("margin-bottom","0px"))),$.jqx.browser.msie&&$.jqx.browser.version<8&&(this.content.css("margin-top","4px"),this.content.height(this.container.height()-this.toolbar.outerHeight()-2*parseInt(this.container.css("padding-bottom"))-10),this.content.width(this.container.width()-2*parseInt(this.container.css("padding-left"))-2)),this.editor.height()<this.content.height()&&this.editor.height(this.content.height()))},propertyChangedHandler:function(a,b,c,d){if(void 0!=this.isInitialized&&0!=this.isInitialized&&"pasteMode"!=b&&"lineBreak"!=b&&"editable"!=b)return"disabled"==b&&a._refreshTools(),"width"==b||"height"==b||"toolbarPosition"==b?void a._arrange():void a.refresh()},selectRange:function(a){a||(a=this.getRange()),this.selection.selectRange(a)},getRange:function(){return this.selection.getRange()},getSelectedElement:function(){var a,b,c,d;try{if(this.editorDocument.getSelection){var e=this.editorDocument.getSelection();return a=e.getRangeAt(e.rangeCount-1),c=a.startContainer,d=a.endContainer,b=a.commonAncestorContainer,"#text"==c.nodeName&&(b=b.parentNode),"#text"==c.nodeName&&(c=c.parentNode),"body"==c.nodeName.toLowerCase()&&(c=c.firstChild),"#text"==d.nodeName&&(d=d.parentNode),"body"==d.nodeName.toLowerCase()&&(d=d.lastChild),c==d&&(b=c),d}if(this.editorDocument.selection){if(a=this.editorDocument.selection.createRange(),!a.duplicate)return null;b=a.parentElement();var f=a.duplicate(),g=a.duplicate();return f.collapse(!0),g.moveToElementText(f.parentElement()),g.setEndPoint("EndToStart",f),c=f.parentElement(),f=a.duplicate(),g=a.duplicate(),g.collapse(!1),f.moveToElementText(g.parentElement()),f.setEndPoint("StartToEnd",g),d=g.parentElement(),"body"==c.nodeName.toLowerCase()&&(c=c.firstChild),"body"==d.nodeName.toLowerCase()&&(d=d.lastChild),c==d&&(b=c),d}}catch(h){return null}return null},_addHandlers:function(){var a=this;this.addHandler(this.toolbar,"mousedown.editor"+this.element.id,function(a){return a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),!1});var b=function(){a.host.is("textarea")&&a.host.html($(this).html()),a.changed&&(a._raiseEvent("change"),a.changed=!1),a.focused=!1,a.inline&&(a.host.removeClass(a.toThemeProperty("jqx-fill-state-focus")),a.host.removeClass(a.toThemeProperty("jqx-editor-inline-focus")),a.toolbarContainer.fadeOut("fast"))},c=function(){if(a.focused=!0,a.inline){a.host.addClass(a.toThemeProperty("jqx-fill-state-focus")),a.host.addClass(a.toThemeProperty("jqx-editor-inline-focus")),a.host.addClass(a.toThemeProperty("jqx-rc-all")),a.toolbarContainer.fadeIn("fast");var b=a.host.coord();a.toolbarContainer.offset({left:b.left,top:b.top-a.toolbarContainer.outerHeight()-5})}};$.jqx.browser.mozilla&&this.addHandler($(document),"mousedown.editor"+this.element.id,function(a){b()}),this.addHandler(this.editor,"blur.editor"+this.element.id,function(a){b()}),this.addHandler(this.editor,"focus.editor"+this.element.id,function(a){c()}),this.addHandler(this.editor,"beforedeactivate.editor"+this.element.id,function(b){a.range=a.getRange()}),this.addHandler(this.editor,"mousedown.editor"+this.element.id,function(b){a.range=a.getRange(),$.jqx.browser.mozilla&&(c(),b.stopPropagation()),$(".jqx-editor-dropdownpicker").length>0&&$(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),$(".jqx-editor-dropdownlist").length>0&&$(".jqx-editor-dropdownlist").jqxDropDownList("close"),a.inline&&a.editor.focus()}),$.jqx.mobile.isTouchDevice()&&(this.addHandler($(this.editorDocument),"selectionchange.editor"+this.element.id,function(){a.editorDocument.activeElement!=a.editor[0]&&(window.focus(),a.focus())}),this.addHandler($(this.editorDocument),"keydown.editor"+this.element.id,function(){a.editorDocument.activeElement!=a.editor[0]&&(window.focus(),a.focus())})),this.addHandler(this.editor,"mouseup.editor"+this.element.id,function(b){return"source"==a._documentMode||(a.range=a.getRange(),void a._refreshTools(null,!0))}),this.addHandler(this.editor,"keydown.editor"+this.element.id,function(b){if("source"==a._documentMode)return!0;if($.jqx.browser.mozilla&&(a.focused||c()),a.disabled)return b.preventDefault&&b.preventDefault(),!1;if(a.updating){if(a.activeElement){var d=jQuery.Event("keydown");$.extend(d,b),a.activeElement.trigger(d)}return b.preventDefault&&b.preventDefault(),!1}var e=b||window.event,f=e.keyCode,g=String.fromCharCode(f).toLowerCase();if(!a.editable){var h=[8,9,33,34,35,36,37,38,39,40,40,45,46];$.inArray(e.keyCode,h)!=-1||e.ctrlKey&&"c"==g||e.ctrlKey&&"a"==g||b.preventDefault()}if(a.selection.getText().length>0||a.linkPopup){var h=[8,9,13,33,34,35,36,37,38,39,40,40,45,46];(!$.inArray(e.keyCode,h)!=-1||65==e.keyCode&&e.ctrlKey&&!e.altKey&&!e.shiftKey)&&(a._refreshToolsTimer&&clearTimeout(a._refreshToolsTimer),a._refreshToolsTimer=setTimeout(function(){a._refreshTools(null,!0,e.keyCode);
},10))}if(13==f&&"default"!=a.lineBreak){var i=a.getSelectedElement();if(i){var j=i.nodeName.toLowerCase();switch(j){case"pre":case"li":case"ul":case"ol":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return!0}for(var k=i;null!=k;){if("#document"==k.nodeName){k=a.editorDocument.body;break}if(k.parentNode==a.editorDocument.body||k==a.editorDocument.body)break;k=k.parentNode}}if(k){var l=a.getRange();"<div></div>"==a.editorDocument.body.innerHTML&&"br"!=a.lineBreak&&a.selection.insertContent("&#8203;"),"div"==a.lineBreak?k==a.editorDocument.body?$(k).append("<div>&#8203;</div><span id='INSERTION_MARKER'>&nbsp;</span>"):$("<div>&#8203;</div><span id='INSERTION_MARKER'>&nbsp;</span>").insertAfter(k):"p"==a.lineBreak?k==a.editorDocument.body?$(k).append("<p>&#8203;</p><span id='INSERTION_MARKER'>&nbsp;</span>"):$("<p>&#8203;</p><span id='INSERTION_MARKER'>&nbsp;</span>").insertAfter(k):a.execute("insertHTML","<br/>&#8203;<span id='INSERTION_MARKER'>&nbsp;</span>"),a.selectRange(l);var m=$(a.editorDocument).find("#INSERTION_MARKER");return"br"!=a.lineBreak?a.selection.selectNode($(m).prev()[0],!0):(a.selection.selectNode(m[0],!0),a.getRange().setStartAfter&&a.getRange().setStartAfter(m[0])),m.remove(),a.selection.collapse(!1),k&&k.nodeName&&"br"==a.lineBreak&&"#text"!=k.nodeName.toLowerCase()&&(a.selection.selectNode(k,!0),a.getRange().setStartAfter&&a.getRange().setStartAfter(k),a.selection.collapse(!1)),"br"!=a.lineBreak&&(l=a.getRange(),l.select&&l.select()),b.preventDefault&&b.preventDefault(),!1}}if(e.ctrlKey&&("k"==g||"u"==g||"b"==g||"i"==g)){b.preventDefault&&b.preventDefault();var n=null;switch(g){case"k":n="link";break;case"u":n="underline";break;case"b":n="bold";break;case"i":n="italic"}return a.commands[n].widget&&a.commands[n].widget.trigger("click"),!1}}),this.addHandler(this.editor,"paste.editor"+this.element.id,function(b){if("source"==a._documentMode)return!0;if(a.readOnly)return!0;a.updating=!0,a.readOnly=!0;var c=function(b,c){if(c)a.paragraphise?(b="<p>"+b+"</p>",b=b.replace(/\n/g,"</p><p>"),b=b.replace(/<p>\s<\/p>/gi,"")):b=b.replace(/\n/g,"<br />");else{if(b=b.replace(/<html[^>]*?>(.*)/gim,"$1"),b=b.replace(/<\/html>/gi,""),b=b.replace(/<body[^>]*?>(.*)/gi,"$1"),b=b.replace(/<\/body>/gi,""),b=b.replace(/<style[^>]*?>[\s\S]*?<\/style[^>]*>/gi,""),b=b.replace(/<(?:meta|link)[^>]*>\s*/gi,""),b=b.replace(/<\\?\?xml[^>]*>/gi,""),b=b.replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,""),b=b.replace(/<o:p>\s*<\/o:p>/g,""),b=b.replace(/<o:p>[\s\S]*?<\/o:p>/g,"&nbsp;"),b=b.replace(/<\/?\w+:[^>]*>/gi,""),b=b.replace(/<\!--[\s\S]*?-->/g,""),b=b.replace(/<\!\[[\s\S]*?\]>/g,""),b=b.replace(/\s*mso-[^:]+:[^;"']+;?/gi,""),b=b.replace(/<(\w[^>]*) style='([^\']*)'([^>]*)/gim,"<$1$3"),b=b.replace(/<(\w[^>]*) style="([^\"]*)"([^>]*)/gim,"<$1$3"),b=b.replace(/\s*margin: 0cm 0cm 0pt\s*;/gi,""),b=b.replace(/\s*margin: 0cm 0cm 0pt\s*"/gi,'"'),b=b.replace(/\s*text-indent: 0cm\s*;/gi,""),b=b.replace(/\s*text-indent: 0cm\s*"/gi,'"'),b=b.replace(/\s*text-align: [^\s;]+;?"/gi,'"'),b=b.replace(/\s*page-break-before: [^\s;]+;?"/gi,'"'),b=b.replace(/\s*font-variant: [^\s;]+;?"/gi,'"'),b=b.replace(/\s*tab-stops:[^;"']*;?/gi,""),b=b.replace(/\s*tab-stops:[^"']*/gi,""),b=b.replace(/\s*face="[^"']*"/gi,""),b=b.replace(/\s*face=[^ >]*/gi,""),b=b.replace(/\s*font-family:[^;"']*;?/gi,""),b=b.replace(/\s*font-size:[^;"']*;?/gi,""),b=b.replace(/<(\w[^>]*) class=([^ |>]*)([^>]*)/gi,"<$1$3"),b=b.replace(/<(\w+)[^>]*\sstyle="[^"']*display\s?:\s?none[\s \S]*?<\/\1>/gi,""),b=b.replace(/\s*style='\s*'/gi,""),b=b.replace(/\s*style="\s*"/gi,""),b=b.replace(/<span\s*[^>]*>\s*&nbsp;\s*<\/span>/gi,"&nbsp;"),b=b.replace(/<span\s*[^>]*><\/span>/gi,""),b=b.replace(/<(\w[^>]*) align=([^ |>]*)([^>]*)/gi,"<$1$3"),b=b.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,"<$1$3"),b=b.replace(/<span([^>]*)>([\s\S]*?)<\/span>/gi,"$2"),b=b.replace(/<font\s*>([\s\S]*?)<\/font>/gi,"$1"),b=b.replace(/<(u|i|strike)>&nbsp;<\/\1>/gi,"&nbsp;"),b=b.replace(/<h\d>\s*<\/h\d>/gi,""),b=b.replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,"<$1$3"),b=b.replace(/<(\w[^>]*) onmouseover="([^\"']*)"([^>]*)/gi,"<$1$3"),b=b.replace(/<(\w[^>]*) onmouseout="([^\"']*)"([^>]*)/gi,"<$1$3"),b=b.replace(/<h(\d)([^>]*)>/gi,"<h$1>"),b=b.replace(/<(h\d)><font[^>]*>([\s\S]*?)<\/font><\/\1>/gi,"<$1>$2</$1>"),b=b.replace(/<(h\d)><em>([\s\S]*?)<\/em><\/\1>/gi,"<$1>$2</$1>"),b=b.replace(/<b\b[^>]*>(.*?)<\/b[^>]*>/gi,"<strong>$1</strong>"),b=b.replace(/<i\b[^>]*>(.*?)<\/i[^>]*>/gi,"<em>$1</em>"),b=b.replace(/<\s+[^>]*>/gi,""),b=b.replace(/<span>([\s\S]*?)<\/span>/gi,"$1"),b=b.replace(/<span>([\s\S]*?)<\/span>/gi,"$1"),b=b.replace(/<div>([\s\S]*?)<\/div>/gi,"$1"),b=b.replace(/<div>([\s\S]*?)<\/div>/gi,"$1"),b=b.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,""),b=b.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,""),b=b.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,""),b.trim&&(b=b.trim()),a.paragraphise){var d=b.substr(0,2);"<p"!==d&&(b="<p>"+b+"</p>",b=b.replace(/\n/g,"</p><p>"),b=b.replace(/<br[^>]*>/gi,"</p><p>"))}else b.replace(/<p>/gi,"<br />"),b.replace(/<\/p>/gi,"");b=b.replace(/<br>/gi,"<br />"),b=b.replace(/<br[^>]*><\/p>/gim,"</p>"),b=b.replace(/<p>&nbsp;<\/p>/gi,""),b=b.replace(/<p>\s<\/p>/gi,""),b=b.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,""),b=b.replace(/MsoNormal/gi,""),b=b.replace(/<\/?meta[^>]*>/gi,""),b=b.replace(/<\/?xml[^>]*>/gi,""),b=b.replace(/<\?xml[^>]*\/>/gi,""),b=b.replace(/<!--(.*)-->/gi,""),b=b.replace(/<!--(.*)>/gi,""),b=b.replace(/<!(.*)-->/gi,""),b=b.replace(/<w:[^>]*>(.*)<\/w:[^>]*>/gi,""),b=b.replace(/<w:[^>]*\/>/gi,""),b=b.replace(/<\/?w:[^>]*>/gi,""),b=b.replace(/<m:[^>]*\/>/gi,""),b=b.replace(/<m:[^>]>(.*)<\/m:[^>]*>/gi,""),b=b.replace(/<o:[^>]*>(.*)<\/o:[^>]*>/gi,""),b=b.replace(/<o:[^>]*\/>/gi,""),b=b.replace(/<\/?m:[^>]*>/gi,""),b=b.replace(/style=\"([^>]*)\"/gi,""),b=b.replace(/style=\'([^>]*)\'/gi,""),b=b.replace(/class=\"(.*)\"/gi,""),b=b.replace(/class=\'(.*)\'/gi,""),b=b.replace(/<b>/gi,"<strong>"),b=b.replace(/<\/b>/gi,"</strong>"),b=b.replace(/<p[^>]*>/gi,"<p>"),b=b.replace(/<\/p[^>]*>/gi,"</p>"),b=b.replace(/<span[^>]*>/gi,""),b=b.replace(/<\/span[^>]*>/gi,""),b=b.replace(/<st1:[^>]*>/gi,""),b=b.replace(/<\/st1:[^>]*>/gi,""),b=b.replace(/<font[^>]*>/gi,""),b=b.replace(/<\/font[^>]*>/gi,""),b=b.replace("  ",""),b=b.replace(/<strong><\/strong>/gi,""),b=b.replace(/<p><\/p>/gi,""),b=b.replace(/\/\*(.*)\*\//gi,""),b=b.replace(/<!--/gi,""),b=b.replace(/-->/gi,""),b=b.replace(/<style[^>]*>[^<]*<\/style[^>]*>/gi,""),b=b.trim()}return b},d=a.getRange();"text"==a.pasteMode?a.selection.insertContent('<textarea cols="50" contenteditable="false" class="jqx-editor-paste-element"></textarea>'):a.selection.insertContent('<div class="jqx-editor-paste-element">&nbsp;</div>');var e=$(a.editorDocument).find(".jqx-editor-paste-element");if(a.editor[0].createTextRange){b.preventDefault();var f=a.editor[0].createTextRange();f.moveToElementText(e[0]),f.execCommand("Paste")}else{var g=a.editorDocument.createRange();g.selectNodeContents(e[0]),a.selectRange(g)}"text"==a.pasteMode&&e.select(),a.marker=e,setTimeout(function(){a.selectRange(d);var b=function(b){var c=a.editorDocument.createElement("div"),d=a.editorDocument.createDocumentFragment();for(c.innerHTML=b;c.firstChild;)d.appendChild(c.firstChild);return d};if("text"!=a.pasteMode){var e=b(a.marker.html());if(e.firstChild&&"jqx-editor-paste-element"===e.firstChild.className){for(var f=[],g=0,h=e.childNodes.length;g<h;g++)f.push(e.childNodes[g].innerHTML);e=b(f.join("<br />"))}var i=document.createElement("div");i.appendChild(e.cloneNode(!0));var j=i.innerHTML}else{var j=a.marker.val();if(""!=a.marker.html()&&a.marker.val().indexOf("\n")==-1){var j=a.marker.html();j=j.replace(/&nbsp;/gm,""),j=j.replace(/\n\n/gm,"\n"),j=j.replace(/<br[^>]*>/gi,"\n"),a.marker.html(j);var j=a.marker.text()}}var k=c(j,"text"==a.pasteMode);a.getRange();a.selection.insertContent(k+"<span id='INSERTION_MARKER'>&nbsp;</span>"),a.marker.remove();var l=$(a.editorDocument).find("#INSERTION_MARKER");a.selection.selectNode(l[0],!0),a.getRange().setStartAfter&&a.getRange().setStartAfter(l[0]),l.remove(),a.selection.collapse(!1),l.removeAttr("id"),a._refreshTools()},100),a.updating=!1,a.readOnly=!1}),this.addHandler(this.editor,"keyup.editor"+this.element.id,function(b){if("source"==a._documentMode)return!0;if(a.updating||a.disabled||!a.editable)return b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation(),!1;a.range=a.getRange(),a.changed=!0;var c=b||window.event,d=(c.keyCode,[8,9,13,33,34,35,36,37,38,39,40,40,45,46]);($.inArray(c.keyCode,d)!=-1||65==c.keyCode&&c.ctrlKey&&!c.altKey&&!c.shiftKey)&&a._refreshTools(null,!0,c.keyCode)}),this.addHandler(this.editor,"click.editor"+this.element.id,function(b){if("source"==a._documentMode)return!0;if(a.editImage&&($(a.editImage).removeClass("jqx-editor-focus"),a.editImage=null),"img"==b.target.tagName.toLowerCase()){var c=b.target;a.editImage=c,$(a.editImage).addClass("jqx-editor-focus")}}),this.addHandler(this.editor,"dblclick.editor"+this.element.id,function(b){if("source"==a._documentMode)return!0;if("img"==b.target.tagName.toLowerCase()){var c=b.target;$(".jqx-editor-image-window").length>0&&(a.editImage=c,a._updateImageWindow())}})},_updateLinkWindow:function(){var a=this,b=$(".jqx-editor-link-window");b.jqxWindow({position:{center:a.widget}}),b.jqxWindow("open");var c=b.find("input"),d=b.find(".jqx-editor-link-checkbox"),e=b.find("button:first"),f=$(b.find("button")[1]);if(a.editLink&&a.editLink.href)c[0].value=a.editLink.href||"",c[1].value=$(a.editLink).text()||a.editLink.href,d.val("_blank"==$(a.editLink).attr("target")),f.show();else{if(c[0].value="",c[1].value="",!a.selection.isCollapsed()){var g=a.selection.getText();g.match(/^(?!:\/\/)([a-zA-Z0-9]+\.)?[a-zA-Z0-9][a-zA-Z0-9-]+\.[a-zA-Z]{2,6}?$/i)?c[0].value=g:c[1].value=g}d.val(!1),f.hide()}c[0].value.length>0?e.jqxButton({disabled:!1}):e.jqxButton({disabled:!0})},_updateImageWindow:function(){var a=this,b=this.editImage;b||(b=$("<img>")[0]);var c=$(".jqx-editor-image-window");c.jqxWindow({position:{center:a.widget}}),c.jqxWindow("open");var d=c.find("input"),e=$(c.find("button")[1]);a.editImage?e.show():e.hide(),d[0].value=b.src,""==d[0].value&&(d[0].value=""),d[1].value=b.alt,"auto"!=b.style.width?d[2].value=b.style.width:d[2].value="","auto"!=b.style.height?d[3].value=b.style.height:d[3].value="",b.style.marginLeft&&"0px"!=b.style.marginLeft?d[4].value=b.style.marginLeft:d[4].value="",b.style.marginTop&&"0px"!=b.style.marginTop?d[5].value=b.style.marginTop:d[5].value="";var f=c.find(".jqx-editor-align"),g=$(b).css("float");"left"==g?f.jqxDropDownList({selectedIndex:1}):"right"==g?f.jqxDropDownList({selectedIndex:2}):f.jqxDropDownList({selectedIndex:0})},_removeHandlers:function(){this.editor&&(this.removeHandler(this.editor,"blur.editor"+this.element.id),this.removeHandler(this.editor,"focus.editor"+this.element.id),this.removeHandler(this.editor,"click.editor"+this.element.id),this.removeHandler(this.editor,"mousedown.editor"+this.element.id),this.removeHandler(this.editor,"mouseup.editor"+this.element.id),this.removeHandler(this.editor,"keyup.editor"+this.element.id),this.removeHandler(this.editor,"keydown.editor"+this.element.id),this.removeHandler(this.editor,"beforedeactivate.editor"+this.element.id),this.removeHandler(this.editor,"dblclick.editor"+this.element.id)),this.toolbar&&this.removeHandler(this.toolbar,"mousedown.editor"+this.element.id)},getParentByTag:function(a,b){var b=b.toLowerCase(),c=a;do if(""==b||c.nodeName.toLowerCase()==b)return c;while(c=c.parentNode);return a},isStyleProperty:function(a,b,c,d){var b=b.toLowerCase(),e=a;do if(e.nodeName.toLowerCase()==b&&e.style[c]==d)return!0;while(e=e.parentNode);return!1},setStyleProperty:function(a,b){this.style[b]=!1;var c=this.getParentByTag(a,b);c&&c.tagName.toLowerCase()==b&&(this.style[b]=!0),"del"==b&&this.getParentByTag(a,"strike")&&"strike"==this.getParentByTag(a,"strike").tagName.toLowerCase()&&(this.style.del=!0)},updateStyle:function(a){var a=this.getSelectedElement()?this.getSelectedElement():a;if(a&&this.setStyleProperty)try{if(window.getComputedStyle){"#text"==a.nodeName.toLowerCase()&&(a=this.editor[0]);var b=window.getComputedStyle(a,null),c=401==b.getPropertyValue("font-weight")?700:b.getPropertyValue("font-weight");this.style={fontStyle:b.getPropertyValue("font-style"),fontSize:b.getPropertyValue("font-size"),textDecoration:b.getPropertyValue("text-decoration"),fontWeight:c,fontFamily:b.getPropertyValue("font-family"),textAlign:b.getPropertyValue("text-align"),color:this._rgbToHex(b.color),backColor:this._rgbToHex(b.backgroundColor)},this.style.fontStyle=b.getPropertyValue("font-style"),this.style.vAlign=b.getPropertyValue("vertical-align"),this.style.del=this.isStyleProperty(a,"span","textDecoration","line-through"),this.style.u=this.isStyleProperty(a,"span","textDecoration","underline");var d=function(a){for(var b="transparent",c="rgba(0, 0, 0, 0)";a&&(window.getComputedStyle(a).backgroundColor==b||window.getComputedStyle(a).backgroundColor==c);)a=a.parentNode;return a?window.getComputedStyle(a).backgroundColor:b};this.style.backColor||(this.style.backColor=this._rgbToHex(d(a)))}else{var b=a.currentStyle;this.style={fontStyle:b.fontStyle,fontSize:b.fontSize,textDecoration:b.textDecoration,fontWeight:b.fontWeight,fontFamily:b.fontFamily,textAlign:b.textAlign,color:this._rgbToHex(b.color),backColor:this._rgbToHex(b.backgroundColor)}}this.setStyleProperty(a,"h1"),this.setStyleProperty(a,"h2"),this.setStyleProperty(a,"h3"),this.setStyleProperty(a,"h4"),this.setStyleProperty(a,"h5"),this.setStyleProperty(a,"h6"),this.setStyleProperty(a,"del"),this.setStyleProperty(a,"sub"),this.setStyleProperty(a,"sup"),this.setStyleProperty(a,"u"),"a"==a.nodeName.toLowerCase()&&"underline"==this.style.textDecoration&&(this.style.u=!0),(this.style.h1||this.style.h2||this.style.h3||this.style.h4||this.style.h5||this.style.h6)&&(this.style.heading=!0)}catch(e){return null}},_refreshTools:function(a,b,c){if(!this.updating){var d=this,a=this.getSelectedElement()?this.getSelectedElement():a;if(a&&this.setStyleProperty){this.updateStyle(a);var e=this.readOnly;if(this.readOnly=!0,this.tools!==!1){var f=this.tools.split(" "),g=this.tools.split(" | "),h=function(a){$.each(a,function(a,b){var c=d.commands[this];if(!c)return!0;switch(c.type){case"list":c.widget.jqxDropDownList("clearSelection"),c.widget.jqxDropDownList({disabled:d.disabled});break;case"colorPicker":c.val(c.value),c.widget.jqxDropDownButton({disabled:d.disabled});break;case"toggleButton":c.widget.jqxToggleButton("unCheck"),c.widget.jqxToggleButton({disabled:d.disabled});break;case"button":default:c.widget.jqxButton({disabled:d.disabled})}})};if(0==g.length)h(f);else for(var i=0;i<g.length;i++){var j=g[i],f=j.split(" ");h(f)}if(this.style){var k=function(c){$.each(c,function(c,e){var f=d.commands[this];if(!f)return!0;if(f.refresh)return f.refresh(f.widget,d.style),!0;switch(f.type){case"list":if("fontname"==f.command){for(var g=-1,h=999,i=0;i<f.value.length;i++){var e=f.value[i].label.toLowerCase(),j=d.style.fontFamily.toLowerCase().indexOf(e);j>=0&&(j<h&&(g=i),h=Math.min(h,j))}f.widget.jqxDropDownList("selectIndex",g)}else if("formatblock"==f.command){var e=null;d.style.h1?e="h1":d.style.h2?e="h2":d.style.h3?e="h3":d.style.h4?e="h4":d.style.h5?e="h5":d.style.h6&&(e="h6"),f.widget.jqxDropDownList("selectItem",e)}else if("fontsize"==f.command){var k="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),l=-1;try{var l=a.getAttribute("size")-1;l==-1&&(l=d.editorDocument.queryCommandValue(f.command)-1)}catch(m){}var n=k[l];f.widget.val(n)}break;case"colorPicker":var o=function(a){return"number"!=typeof a?a:"rgb("+(255&a)+", "+((65280&a)>>8)+", "+((16711680&a)>>16)+")"},p=o(d.editorDocument.queryCommandValue(f.command));"backcolor"==f.command&&null==d.style.backColor&&(p="#FFFFFF");var q=d._rgbToHex(p);q?f.val(q):"forecolor"==f.command?f.val(d.style.color):"backcolor"==f.command&&f.val(d.style.backColor);break;case"toggleButton":if("viewsource"==f.command)return;if(!f.command)return;var r=!1,s=d.editorDocument.queryCommandState(f.command)&&d.editorDocument.queryCommandEnabled(f.command);if(d.linkPopup&&d.linkPopup.remove(),"createlink"==f.command&&"a"==a.nodeName.toLowerCase()){var t=!0;if($(a).text().indexOf(d.selection.getText())==-1&&""!=d.selection.getText()&&(t=!1),t){s=!0,d.linkPopup=$("<div class='jqx-editor-link-popup' contentEditable='false' style='overflow: hidden; white-space: nowrap; padding: 5px; height: 17px; font-size: 12px; color: #222222; background: #F5F5F5; position: absolute; z-index: 9999;'>"+d.localization["Go to link"]+": <a target='_blank' style='color:#222222;' href='"+a.href+"'>"+a.href+"</a> - <a style='color:#222222;' href='#change'>"+d.localization.Change+"</a> - <a style='color:#222222;' href='#remove'>"+d.localization.Remove+"</a></div>").appendTo(d.editor);var u=$(a).coord(),v=u.left;u.left+d.linkPopup.width()>d.editor.width()&&(v=d.editor.width()-d.linkPopup.width()-15),d.linkPopup.offset({top:$(a).height()+u.top+5,left:v}),d.addHandler(d.linkPopup,"mousedown",function(b){if(b.target&&b.target.href){var c=$(b.target).index();switch(c){case 1:d.editor.focus(),d.selection.selectNode(a,!0),d.commands.link.widget.trigger("click");break;case 2:try{d.editor.focus(),d.selection.selectNode(a),d.execute("unlink"),d.commands.underline.toggled=!1,d.selection.collapse(!1),d._refreshTools()}catch(e){}break;default:window.open(b.target.href,"_blank")}}return b.preventDefault&&b.preventDefault(),b.stopPropagation&&b.stopPropagation(),!1})}}"bold"==f.command?(d.style.fontWeight&&(d.style.fontWeight>=600||"bold"==d.style.fontWeight)&&(r=!0),d.selection.isCollapsed()?f.toggled=s:f.toggled=s||r,s=f.toggled):"italic"==f.command?(d.style.fontStyle&&"italic"==d.style.fontStyle&&(r=!0),b?f.toggled=s:s=f.toggled):"underline"==f.command?(d.style.u&&(r=!0),b?f.toggled=s:s=f.toggled):"justifyleft"==f.command?"left"==d.style.textAlign&&(r=!0):"justifyright"==f.command?"right"==d.style.textAlign&&(r=!0):"justifycenter"==f.command?"center"==d.style.textAlign&&(r=!0):"justifyfull"==f.command?"justify"==d.style.textAlign&&(r=!0):$.each(d.style,function(a,b){f.command==a.toLowerCase()&&(r=!0)});var w=s;r&&f.command.indexOf("justify")!=-1?f.widget.jqxToggleButton("check"):w?f.widget.jqxToggleButton("check"):r&&d.range.collapsed===!1?f.widget.jqxToggleButton("check"):$.jqx.browser.msie&&$.jqx.browser.version<9&&r&&!d.selection.isCollapsed()&&f.widget.jqxToggleButton("check");break;case"button":default:f.refresh&&f.refresh(f.widget,d.style)}})};if(0==g.length)k(f);else for(var i=0;i<g.length;i++){var j=g[i],f=j.split(" ");k(f)}}}this.readOnly=e}}},_rgbToHex:function(a){if(a){if("#"===a.substr(0,1)){if(4==a.length){var b=a.substr(1,1),c=a.substr(2,1),d=a.substr(3,1);return"#"+b+b+c+c+d+d}return a}var e=/(.*?)rgb\((\d+),\s*(\d+),\s*(\d+)\)/i.exec(a);if(!e)return null;var b=parseInt(e[2],10).toString(16),c=parseInt(e[3],10).toString(16),d=parseInt(e[4],10).toString(16);return"#"+((1==b.length?"0"+b:b)+(1==c.length?"0"+c:c)+(1==d.length?"0"+d:d))}return null},_preventDefault:function(a,b){b!==!1&&($(".jqx-editor-dropdownpicker").length>0&&$(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),$(".jqx-editor-dropdownlist").length>0&&$(".jqx-editor-dropdownlist").jqxDropDownList("close")),a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0,a.returnValue=!1},_addCommandHandler:function(a,b,c,d,e){var f=this;switch(!c&&e.init&&(c="custom"),c){case"custom":switch(e.type){case"list":action=function(a){"source"!=f._documentMode&&"none"!=a.args.type&&(e.value=$(this).val(),f.execute("custom",e),f.readOnly||f._refreshTools()),f._preventDefault(a,!1)};break;case"colorPicker":action=function(a){if("source"!=f._documentMode){$(e.colorPicker).find("td").removeClass("jqx-editor-color-picker-selected-cell");if("div"==a.target.nodeName.toLowerCase()){var b=$(a.target).css("background-color");$(a.target).parent().addClass("jqx-editor-color-picker-selected-cell")}else{var b=$(a.target).find("div").css("background-color");$(a.target).addClass("jqx-editor-color-picker-selected-cell")}$("#bar-"+c).css("background",b),e.widget.val=function(){var a=function(a){return"number"!=typeof a?a:"rgb("+(255&a)+", "+((65280&a)>>8)+", "+((16711680&a)>>16)+")"},c=a(b),d=f._rgbToHex(c);return d},e.widget.jqxDropDownButton("close"),f.execute("custom",e)}return f._preventDefault(a),!1};break;case"button":case"toggleButton":default:action=function(a){$(".jqx-editor-dropdownpicker").length>0&&$(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),$(".jqx-editor-dropdownlist").length>0&&$(".jqx-editor-dropdownlist").jqxDropDownList("close"),f._preventDefault(a);$(this).attr("data-command");return"source"!=f._documentMode&&(e.toggle&&e.toggle(),f.execute("custom",e),f._refreshTools()),!1}}break;case"formatblock":action=function(a){"source"!=f._documentMode&&"none"!=a.args.type&&(f.execute($(this).attr("data-command"),"<"+$(this).val()+">",e),f.readOnly||(f.commands.bold.toggled=!1,f._refreshTools())),f._preventDefault(a,!1)};break;case"fontsize":action=function(a){if("source"!=f._documentMode&&"none"!=a.args.type){var b=$(this).val(),c="xx-small,x-small,small,medium,large,x-large,xx-large".split(","),d=$(this).jqxDropDownList("getSelectedIndex")+1,d=1+c.indexOf(b);f.execute($(this).attr("data-command"),d,e)}f._preventDefault(a,!1)};break;case"fontname":action=function(a){if("source"!=f._documentMode&&"none"!=a.args.type){var b=$(this).val();f.execute($(this).attr("data-command"),b,e)}f._preventDefault(a,!1)};break;case"forecolor":case"backcolor":action=function(a){if("source"!=f._documentMode){$(e.colorPicker).find("td").removeClass("jqx-editor-color-picker-selected-cell");if("div"==a.target.nodeName.toLowerCase()){var b=$(a.target).css("background-color");$(a.target).parent().addClass("jqx-editor-color-picker-selected-cell")}else{var b=$(a.target).find("div").css("background-color");$(a.target).addClass("jqx-editor-color-picker-selected-cell")}$("#bar-"+c).css("background",b),e.widget.jqxDropDownButton("close"),f.execute(c,b,e)}return f._preventDefault(a),!1};break;case"viewsource":action=function(a){return f.linkPopup&&f.linkPopup.remove(),e.toggle(),f.setMode(e.toggled),$(".jqx-editor-dropdownpicker").length>0&&$(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),$(".jqx-editor-dropdownlist").length>0&&$(".jqx-editor-dropdownlist").jqxDropDownList("close"),f._preventDefault(a),!1};break;case"insertimage":action=function(a){f._insertImageAction(a,f,e)};break;case"createlink":action=function(a){f._createLinkAction(a,f,e)};break;default:action=function(a){$(".jqx-editor-dropdownpicker").length>0&&$(".jqx-editor-dropdownpicker").jqxDropDownButton("close"),$(".jqx-editor-dropdownlist").length>0&&$(".jqx-editor-dropdownlist").jqxDropDownList("close"),f._preventDefault(a);var b=$(this).attr("data-command");if("source"!=f._documentMode){if("underline"==b&&f.getSelectedElement()){var c=f.getSelectedElement();if(c&&"a"==c.nodeName.toLowerCase())return e.toggled?$(c).css("text-decoration","none"):$(c).css("text-decoration","underline"),e.toggle(),f._refreshTools(),!1}e.toggle&&e.toggle(),f.execute(b,$(this).val(),e),f._refreshTools()}return!1}}return f.addHandler(a,b,action),!1},_createLinkAction:function(a,b,c){var b=this;if("source"==b._documentMode)return void b._preventDefault(a);b.focused||b.editor.focus(),b.range=b.getRange();var d=b.getSelectedElement();if("a"==d.nodeName.toLowerCase()?b.editLink=d:b.editLink=null,$(".jqx-editor-link-window").length>0)return b.editLink&&b.selection.selectNode(d,!0),b._updateLinkWindow(),b._preventDefault(a),!1;var e=$("<div class='jqx-editor-window jqx-editor-link-window'><div>"+b.localization["Insert Link"]+"</div><div><table style='border-collapse: separate; border-spacing: 2px;'><tr><td align='right'>"+b.localization.URL+":</td><td><input style='width: 200px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+b.localization.Title+":</td><td><input style='width: 200px; height: 23px;' value=''/></td><tr/><tr><td align='right'></td><td><div class='jqx-editor-link-checkbox'>"+b.localization["Open in a new window/tab"]+"</div></td><tr/><tr><td align='right'></td><td align='right'><button>Ok</button><button style='margin-left: 5px;'>Remove</button><button style='margin-left: 5px;'>Cancel</button></td><tr/></table></div></div>"),f=e.find("input");f.addClass(b.toThemeProperty("jqx-widget")),f.addClass(b.toThemeProperty("jqx-widget-content")),f.addClass(b.toThemeProperty("jqx-input"));var g=e.find(".jqx-editor-link-checkbox").jqxCheckBox({theme:b.theme,height:23,width:180}),h=e.find("button:first").jqxButton({theme:b.theme,disabled:!0}),i=$(e.find("button")[1]).jqxButton({theme:b.theme}),j=e.find("button:last").jqxButton({theme:b.theme});h.val(this.localization.Ok),j.val(this.localization.Cancel),i.val(this.localization.Remove),this.addHandler(j,$.jqx.mobile.isTouchDevice()?$.jqx.mobile.getTouchEventName("touchstart"):"click",function(a){b.editor.focus(),b.selectRange(b.range),b._refreshTools(),b._preventDefault(a)}),(!b.editLink||b.editLink&&!b.editLink.href)&&i.hide();var k=!1;if(this.addHandler($(f[0]),"focus",function(){k=""==f[1].value||f[1].value==f[0].value}),this.addHandler($(f[1]),"keyup",function(a){a.keyCode&&(13==a.keyCode&&h.trigger("click"),27==a.keyCode&&j.trigger("click"))}),this.addHandler($(f[0]),"keyup change",function(a){f[0].value.length>0?h.jqxButton({disabled:!1}):h.jqxButton({disabled:!0}),k&&(f[1].value=f[0].value),a.keyCode&&(13==a.keyCode&&h.trigger("click"),27==a.keyCode&&j.trigger("click"))}),this.addHandler(i,$.jqx.mobile.isTouchDevice()?$.jqx.mobile.getTouchEventName("touchstart"):"click",function(a){e.jqxWindow("close");try{b.editor.focus(),b.selection.selectNode(b.editLink),b.execute("unlink"),b.selection.collapse(!1),b.commands.underline.toggled=!1,b._refreshTools()}catch(c){}b._preventDefault(a)}),this.addHandler(h,$.jqx.mobile.isTouchDevice()?$.jqx.mobile.getTouchEventName("touchstart"):"click",function(a){var d=e.find("input"),f=$("<a>"+(d[1].value||d[0].value)+"</a>");g.val()&&f.attr("target","_blank"),f[0].href=$.trim(d[0].value),d[0].value.indexOf("http")==-1&&d[0].value.indexOf("mailto")==-1&&(f[0].href="http://"+$.trim(d[0].value)),b.focused||b.editor.focus(),b.range&&b.selectRange(b.range),b.execute("insertHTML",""+f[0].outerHTML+"<span id='INSERTION_MARKER'>&nbsp;</span>",c),b.editor.focus();var h=$(b.editorDocument).find("#INSERTION_MARKER");b.selection.selectNode(h[0],!0),b.getRange().setStartAfter&&b.getRange().setStartAfter(h[0]),h.remove(),b.selection.collapse(!1),b._refreshTools(),b._preventDefault(a)}),b.updating=!0,e.appendTo(document.body),b.addHandler(e,"open",function(){b.updating=!0,setTimeout(function(){b.range=b.getRange(),$(f[0]).focus()},25)}),e.jqxWindow({resizable:!1,width:280,okButton:h,cancelButton:j,theme:b.theme,isModal:!0,position:{center:b.widget}}),b.addHandler(e,"close",function(){b.updating=!1}),b.focused||(b.editor.focus(),b.selectRange(b.range)),b.editLink)f[0].value=b.editLink.href||"",f[1].value=$(b.editLink).text(),g.val("_blank"==$(b.editLink).attr("target"));else if(!b.selection.isCollapsed()){var l=b.selection.getText();l.match(/^(?!:\/\/)([a-zA-Z0-9]+\.)?[a-zA-Z0-9][a-zA-Z0-9-]+\.[a-zA-Z]{2,6}?$/i)?f[0].value=l:f[1].value=l}return f[0].value.length>0?h.jqxButton({disabled:!1}):h.jqxButton({disabled:!0}),b._preventDefault(a),!1},_insertImageAction:function(a,b,c){if("source"==b._documentMode)return void b._preventDefault(a);if($(".jqx-editor-image-window").length>0)return b._updateImageWindow(),b._preventDefault(a),!1;var d=$("<div class='jqx-editor-window jqx-editor-image-window'><div>"+b.localization["Insert Image"]+"</div><div><table style='border-collapse: separate; border-spacing: 2px;'><tr><td align='right'>"+b.localization.URL+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+b.localization["Alt Text"]+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+b.localization.Width+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+b.localization.Height+":</td><td><input style='width: 180px; height: 23px;' value=''/></td><tr/><tr><td align='right'>"+b.localization.HSpace+":</td><td><input style='width: 180px; height: 23px;' class='jqx-editor-hspace'/></td><tr/><tr><td align='right'>"+b.localization.VSpace+":</td><td><input style='width: 180px; height: 23px;' class='jqx-editor-vspace'/></td><tr/><tr><td align='right'>"+b.localization.Align+":</td><td><div class='jqx-editor-align'></div></td><tr/><tr><td align='right'></td><td align='right'><button>Ok</button><button style='margin-left: 5px;'>Remove</button><button style='margin-left: 5px;'>Cancel</button></td><tr/></table></div></div>"),e=d.find("input");e.addClass(b.toThemeProperty("jqx-widget")),e.addClass(b.toThemeProperty("jqx-widget-content")),e.addClass(b.toThemeProperty("jqx-input")),d.find(".jqx-editor-align").jqxDropDownList({autoDropDownHeight:!0,selectedIndex:0,theme:b.theme,height:23,width:180,source:[b.localization["not set"],b.localization.Left,b.localization.Right]});var f=d.find("button:first").jqxButton({theme:b.theme}),g=d.find("button:last").jqxButton({theme:b.theme}),h=$(d.find("button")[1]).jqxButton({theme:b.theme});return f.val(this.localization.Ok),g.val(this.localization.Cancel),h.val(this.localization.Remove),h.hide(),this.addHandler(h,$.jqx.mobile.isTouchDevice()?$.jqx.mobile.getTouchEventName("touchstart"):"click",function(a){$(b.editImage).removeClass("jqx-editor-focus"),$(b.editImage).remove(),b.editImage=null,b._preventDefault(a),d.jqxWindow("close"),b._raiseEvent("change")}),this.addHandler(g,$.jqx.mobile.isTouchDevice()?$.jqx.mobile.getTouchEventName("touchstart"):"click",function(a){$(b.editImage).removeClass("jqx-editor-focus"),b.editImage=null,b._preventDefault(a)}),this.addHandler(f,$.jqx.mobile.isTouchDevice()?$.jqx.mobile.getTouchEventName("touchstart"):"click",function(a){$(b.editImage).removeClass("jqx-editor-focus");var e=d.find("input"),f=b.editImage?$(b.editImage):$('<img style="border: 1px solid transparent;">'),g=f.attr("src",e[0].value).attr("unselectable","on");e[1].value&&g.attr("alt",e[1].value).attr("title",e[1].value),e[2].value&&!isNaN(parseInt(e[2].value))?g.width(e[2].value):g.css("width","auto"),e[3].value&&!isNaN(parseInt(e[3].value))?g.height(e[3].value):g.css("height","auto"),e[4].value?"auto"==e[4].value.toString()?(g.css("margin-left","auto"),g.css("margin-right","auto")):e[4].value.toString().indexOf("%")!=-1?(g.css("margin-left",parseInt(e[4].value)+"%"),g.css("margin-right",parseInt(e[4].value)+"%")):(g.css("margin-left",parseInt(e[4].value)+"px"),g.css("margin-right",parseInt(e[4].value)+"px")):(g.css("margin-left","0px"),g.css("margin-right","0px")),e[5].value?"auto"==e[5].value.toString()?(g.css("margin-top","auto"),g.css("margin-bottom","auto")):e[5].value.toString().indexOf("%")!=-1?(g.css("margin-top",parseInt(e[5].value)+"%"),g.css("margin-bottom",parseInt(e[5].value)+"%")):(g.css("margin-top",parseInt(e[5].value)+"px"),g.css("margin-bottom",parseInt(e[5].value)+"px")):(g.css("margin-top","0px"),g.css("margin-bottom","0px"));var h=d.find(".jqx-editor-align").jqxDropDownList("selectedIndex");if(1==h?g.css("float","left"):2==h?g.css("float","right"):0==h&&g.css("float","none"),g.css("resize",!1),g[0].oncontrolselect=function(){return!1},g[0].selectstart=function(){return!1},!b.editImage){b.focused||b.editor.focus(),b.range&&b.selectRange(b.range),b.execute("insertHTML",g[0].outerHTML+"<span id='INSERTION_MARKER'>&nbsp;</span>",c),b.editor.focus();var i=$(b.editorDocument).find("#INSERTION_MARKER");b.selection.selectNode(i[0],!0),b.getRange().setStartAfter&&b.getRange().setStartAfter(i[0]),i.remove(),b.selection.collapse(!1),b._refreshTools(),b._preventDefault(a)}b.editImage=null,b._preventDefault(a)}),d.appendTo(document.body),
b.updating=!0,b.addHandler(d,"open",function(){b.updating=!0,setTimeout(function(){$(e[0]).focus()},25)}),d.jqxWindow({resizable:!1,width:280,okButton:f,cancelButton:g,theme:b.theme,isModal:!0,position:{center:b.widget}}),b.addHandler(d,"close",function(){b.updating=!1}),b.focused||(b.editor.focus(),b.selectRange(b.range)),b._preventDefault(a),!1},editmode:function(a){if(a||this.readOnly){if(a&&this.readOnly){var b=this.editor.find("#sourceText").text();this.editor.html(b),this.buttons.hasOwnProperty("html")&&this.buttons.html.removeClass("active"),this.editor.attr("contentEditable",!0),this._addHandlers()}}else{this._removeHandlers(),this.editor.attr("contentEditable",!1);var b=document.createTextNode(this.editor.html()),c=$("<pre>");c.html(b).attr({id:"sourceText",contentEditable:!0}).css("height","100%"),this.editor.html(c),this.buttons.hasOwnProperty("html")&&this.buttons.html.addClass("active"),c.focus()}this.readOnly=!a},setMode:function(a){this.range||(this.editor.focus(),this.range=this.getRange());var b,d=this.editor[0];if(a){this._documentMode="source";var e=new c,f=e.HTMLtoXML(d.innerHTML);f=e.FormatHTML(f),b=document.createTextNode(f),d.innerHTML="";var g=document.createElement("pre");d.contentEditable=!1,g.style.height="100%",g.style.margin="0px",g.style.outline="none",g.style.display="block",g.id="sourceText",g.contentEditable=!0,g.appendChild(b),d.appendChild(g),this.readOnly=!0}else this._documentMode="html",document.all?d.innerHTML=d.innerText:d.textContent?d.innerHTML=d.textContent:(b=document.createRange(),b.selectNodeContents(d.firstChild),d.innerHTML=b.toString()),d.contentEditable=!0,this.readOnly=!1,this._refreshTools(),this.editor.focus(),this.selection.selectNode(this.editor[0]),this.editor.scrollTop(0),this.selection.collapse(!0);$.each(this.commands,function(){if(this.widget&&"viewsource"!=this.command)switch(this.type){case"list":this.widget.jqxDropDownList({disabled:a});break;case"colorPicker":this.widget.jqxDropDownButton({disabled:a});break;case"button":this.widget.jqxButton({disabled:a});break;case"toggleButton":this.widget.jqxToggleButton({toggled:!1,disabled:a})}}),this.editor.focus(),this.commands.html.widget.jqxToggleButton({toggled:"source"==a||1==a}),this.commands.html.toggled="source"==a||1==a},execute:function(a,b,c){if(!this.readOnly){var d=this,e=this.editorDocument;if("source"==d._documentMode)return;d.linkPopup&&d.linkPopup.remove(),this.editor.focus(),$.jqx.browser.mozilla&&this.focus();var f=function(a){try{if(a.command&&"inserthtml"==a.command.toLowerCase()){var b=d.getRange(),c=a.value;c.toString().indexOf("<")==-1&&(c="<span>"+a.value+"</span>"),d.selection.insertContent(""+c+"<span id='INSERTION_MARKER'>&nbsp;</span>"),d.selectRange(b),setTimeout(function(){var a=$(d.editorDocument).find("#INSERTION_MARKER");d.selection.selectNode($(a).prev()[0],!0),a.remove(),d.selection.collapse(!1)},10)}else if(a.command){if(!e.queryCommandEnabled(a.command))return!1;e.execCommand(a.command,!1,a.value)}else{if(!e.queryCommandEnabled(a))return!1;e.execCommand(a,!1,a)}}catch(f){}};if("custom"==a){var g=b.action(b.widget,this.editor);g&&f(g)}else try{if(c&&c.action){var g=c.action(c.widget,this.editor);f(g)}else if(e.queryCommandEnabled(a))e.execCommand(a,!1,b);else{if("insertHTML"!=a)return!1;this.selection.insertContent(b)}}catch(h){if("insertHTML"!=a)return!1;this.selection.insertContent(b)}d._raiseEvent("change",{command:a,args:b}),this.changed=!0,this.range=this.getRange()}},destroy:function(){this._removeHandlers();var a=this.tools.split(" "),b=this.tools.split(" | "),c=this,d=function(a){$.each(a,function(a,b){var d=c.commands[this];if(!d)return!0;switch(d.type){case"list":d.widget.jqxDropDownList("destroy");break;case"colorPicker":d.colorPicker.remove(),d.widget.jqxDropDownButton("destroy");break;case"toggleButton":d.widget.jqxToggleButton("destroy");break;case"custom":this.destroyTool&&this.destroyTool(this);break;case"button":default:d.widget.jqxToggleButton("destroy")}})};if(0==b.length)d(a);else for(var e=0;e<b.length;e++){var f=b[e],a=f.split(" ");d(a)}this.inline?this.toolbar.remove():this.widget.remove()},val:function(a){return void 0!=a&&"object"!=typeof a&&this.editor.html(a),this.editor.html()},_raiseEvent:function(a,b){if(void 0==b&&(b={owner:null}),"source"==this._documentMode)return!0;var c=a;args=b,args.owner=this;var d=new jQuery.Event(c);d.owner=this,d.args=args;var e=this.widget.trigger(d);return b=d.args,e}});var b=function(a){var b={initialize:function(a){this.document=a},getSelection:function(){return this.document.getSelection?this.document.getSelection():this.document.selection},getRange:function(){var a=this.getSelection();if(!a)return null;try{return a.rangeCount>0?a.getRangeAt(0):this.document.createRange?this.document.createRange():this.document.selection.createRange()}catch(b){return this.document.body.createTextRange()}},selectRange:function(a){if(a.select)a.select();else{var b=this.getSelection();b.addRange&&(b.removeAllRanges(),b.addRange(a))}},selectNode:function(a,b){var c=this.getRange(),d=this.getSelection();return c.moveToElementText?(c.moveToElementText(a),c.select()):d.addRange?(b?c.selectNodeContents(a):c.selectNode(a),d.removeAllRanges(),d.addRange(c)):d.setBaseAndExtent(a,0,a,1),a},isCollapsed:function(){var a=this.getRange();return!a.item&&(0==a.boundingWidth||this.getSelection().isCollapsed)},collapse:function(a){var b=this.getRange(),c=this.getSelection();b.select?(b.collapse(a),b.select()):a?c.collapseToStart():c.collapseToEnd()},getContent:function(){var a=this.getRange(),b=$("<div>")[0];if(this.isCollapsed())return"";a.cloneContents?b.appendChild(a.cloneContents()):void 0!=a.item||void 0!=a.htmlText?$(b).html(a.item?a.item(0).outerHTML:a.htmlText):$(b).html(a.toString());var c=$(b).html();return c},getText:function(){var a=this.getRange(),b=this.getSelection();return this.isCollapsed()?"":a.text||(b.toString?b.toString():"")},getNode:function(){var b=this.getRange();if(!$.jqx.browser.msie||$.jqx.browser.version>=9){var c=null;if(b)for(c=b.commonAncestorContainer,b.collapsed||b.startContainer==b.endContainer&&b.startOffset-b.endOffset<2&&b.startContainer.hasChildNodes()&&(c=b.startContainer.childNodes[b.startOffset]);"element"!=typeof c;)c=c.parentNode;return a.id(c)}return a.id(b.item?b.item(0):b.parentElement())},insertContent:function(a){var b=this.getRange();if(b.pasteHTML)b.pasteHTML(a),b.collapse(!1),b.select();else if(b.insertNode)if(b.deleteContents(),b.createContextualFragment)b.insertNode(b.createContextualFragment(a));else{var c=this.document,d=c.createDocumentFragment(),e=c.createElement("div");d.appendChild(e),e.outerHTML=a,b.insertNode(d)}}};return b.initialize(a),b},c=function(){function a(a){for(var b={},c=a.split(","),d=0;d<c.length;d++)b[c[d]]=!0;return b}var b=/^<([-A-Za-z0-9_]+)((?:\s+\w+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,c=/^<\/([-A-Za-z0-9_]+)[^>]*>/,d=/([-A-Za-z0-9_]+)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,e=a("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),f=a("address,applet,blockquote,button,center,dd,del,dir,div,dl,dt,fieldset,form,frameset,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,p,pre,script,table,tbody,td,tfoot,th,thead,tr,ul"),g=a("a,abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),h=a("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),i=a("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),j=a("script,style"),k=this.HTMLParser=function(a,k){function l(a,b,c,j){if(b=b.toLowerCase(),f[b])for(;q.last()&&g[q.last()];)m("",q.last());if(h[b]&&q.last()==b&&m("",b),j=e[b]||!!j,j||q.push(b),k.start){var l=[];c.replace(d,function(a,b){var c=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:i[b]?b:"";l.push({name:b,value:c,escaped:c.replace(/(^|[^\\])"/g,'$1\\"')})}),k.start&&k.start(b,l,j)}}function m(a,b){if(b)for(var c=q.length-1;c>=0&&q[c].toLowerCase()!=b.toLowerCase();c--);else var c=0;if(c>=0){for(var d=q.length-1;d>=c;d--)k.end&&k.end(q[d]);q.length=c}}var n,o,p,q=[],r=a;for(q.last=function(){return this[this.length-1]};a;){if(o=!0,q.last()&&j[q.last()])a=a.replace(new RegExp("(.*)</"+q.last()+"[^>]*>"),function(a,b){return b=b.replace(/<!--(.*?)-->/g,"$1").replace(/<!\[CDATA\[(.*?)]]>/g,"$1"),k.chars&&k.chars(b),""}),m("",q.last());else if(0==a.indexOf("<!--")?(n=a.indexOf("-->"),n>=0&&(k.comment&&k.comment(a.substring(4,n)),a=a.substring(n+3),o=!1)):0==a.indexOf("</")?(p=a.match(c),p&&(a=a.substring(p[0].length),p[0].replace(c,m),o=!1)):0==a.indexOf("<")&&(p=a.match(b),p&&(a=a.substring(p[0].length),p[0].replace(b,l),o=!1)),o){n=a.indexOf("<");var s=n<0?a:a.substring(0,n);a=n<0?"":a.substring(n),k.chars&&k.chars(s)}r=a}m()};this.HTMLtoXML=function(a){var b="";return a=a.replace(/\r/gi,""),a=a.replace(/\n/gi,""),k(a,{start:function(a,c,d){b+="<"+a;for(var e=0;e<c.length;e++)b+=" "+c[e].name+'="'+c[e].escaped+'"';b+=(d?"/":"")+">"},end:function(a){b+="</"+a+">\r\n"},chars:function(a){b+=a},comment:function(a){b+="<!--"+a+"-->"}}),b},this.FormatHTML=function(a,b){function c(){return this.pos=0,this.token="",this.current_mode="CONTENT",this.tags={parent:"parent1",parentcount:1,parent1:""},this.tag_type="",this.token_text=this.last_token=this.last_text=this.token_type="",this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed,?php,?,?=".split(","),extra_liners:"head,body,/html".split(","),in_array:function(a,b){for(var c=0;c<b.length;c++)if(a===b[c])return!0;return!1}},this.get_content=function(){for(var a="",b=[],c=!1;"<"!==this.input.charAt(this.pos);){if(this.pos>=this.input.length)return b.length?b.join(""):["","TK_EOF"];if(a=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(a,this.Utils.whitespace))b.length&&(c=!0),this.line_char_count--;else{if(c){if(this.line_char_count>=this.max_char){b.push("\n");for(var d=0;d<this.indent_level;d++)b.push(this.indent_string);this.line_char_count=0}else b.push(" "),this.line_char_count++;c=!1}b.push(a)}}return b.length?b.join(""):""},this.get_contents_to=function(a){if(this.pos==this.input.length)return["","TK_EOF"];var b="",c=new RegExp("</"+a+"\\s*>","igm");c.lastIndex=this.pos;var d=c.exec(this.input),e=d?d.index:this.input.length;return this.pos<e&&(b=this.input.substring(this.pos,e),this.pos=e),b},this.record_tag=function(a){this.tags[a+"count"]?(this.tags[a+"count"]++,this.tags[a+this.tags[a+"count"]]=this.indent_level):(this.tags[a+"count"]=1,this.tags[a+this.tags[a+"count"]]=this.indent_level),this.tags[a+this.tags[a+"count"]+"parent"]=this.tags.parent,this.tags.parent=a+this.tags[a+"count"]},this.retrieve_tag=function(a){if(this.tags[a+"count"]){for(var b=this.tags.parent;b&&a+this.tags[a+"count"]!==b;)b=this.tags[b+"parent"];b&&(this.indent_level=this.tags[a+this.tags[a+"count"]],this.tags.parent=this.tags[b+"parent"]),delete this.tags[a+this.tags[a+"count"]+"parent"],delete this.tags[a+this.tags[a+"count"]],1==this.tags[a+"count"]?delete this.tags[a+"count"]:this.tags[a+"count"]--}},this.get_tag=function(){var a,b,c="",d=[],e=!1;do{if(this.pos>=this.input.length)return d.length?d.join(""):["","TK_EOF"];c=this.input.charAt(this.pos),this.pos++,this.line_char_count++,this.Utils.in_array(c,this.Utils.whitespace)?(e=!0,this.line_char_count--):("'"!==c&&'"'!==c||d[1]&&"!"===d[1]||(c+=this.get_unformatted(c),e=!0),"="===c&&(e=!1),d.length&&"="!==d[d.length-1]&&">"!==c&&e&&(this.line_char_count>=this.max_char?(this.print_newline(!1,d),this.line_char_count=0):(d.push(" "),this.line_char_count++),e=!1),"<"===c&&(a=this.pos-1),d.push(c))}while(">"!==c);var f,g=d.join("");f=g.indexOf(" ")!=-1?g.indexOf(" "):g.indexOf(">");var h=g.substring(1,f).toLowerCase();if("/"===g.charAt(g.length-2)||this.Utils.in_array(h,this.Utils.single_token))this.tag_type="SINGLE";else if("script"===h)this.record_tag(h),this.tag_type="SCRIPT";else if("style"===h)this.record_tag(h),this.tag_type="STYLE";else if(this.Utils.in_array(h,i)){var j=this.get_unformatted("</"+h+">",g);d.push(j),a>0&&this.Utils.in_array(this.input.charAt(a-1),this.Utils.whitespace)&&d.splice(0,0,this.input.charAt(a-1)),b=this.pos-1,this.Utils.in_array(this.input.charAt(b+1),this.Utils.whitespace)&&d.push(this.input.charAt(b+1)),this.tag_type="SINGLE"}else if("!"===h.charAt(0))if(h.indexOf("[if")!=-1){if(g.indexOf("!IE")!=-1){var j=this.get_unformatted("-->",g);d.push(j)}this.tag_type="START"}else if(h.indexOf("[endif")!=-1)this.tag_type="END",this.unindent();else if(h.indexOf("[cdata[")!=-1){var j=this.get_unformatted("]]>",g);d.push(j),this.tag_type="SINGLE"}else{var j=this.get_unformatted("-->",g);d.push(j),this.tag_type="SINGLE"}else"/"===h.charAt(0)?(this.retrieve_tag(h.substring(1)),this.tag_type="END"):(this.record_tag(h),this.tag_type="START"),this.Utils.in_array(h,this.Utils.extra_liners)&&this.print_newline(!0,this.output);return d.join("")},this.get_unformatted=function(a,b){if(b&&b.indexOf(a)!=-1)return"";var c="",d="",e=!0;do{if(this.pos>=this.input.length)return d;if(c=this.input.charAt(this.pos),this.pos++,this.Utils.in_array(c,this.Utils.whitespace)){if(!e){this.line_char_count--;continue}if("\n"===c||"\r"===c){d+="\n",this.line_char_count=0;continue}}d+=c,this.line_char_count++,e=!0}while(d.indexOf(a)==-1);return d},this.get_token=function(){var a;if("TK_TAG_SCRIPT"===this.last_token||"TK_TAG_STYLE"===this.last_token){var b=this.last_token.substr(7);return a=this.get_contents_to(b),"string"!=typeof a?a:[a,"TK_"+b]}if("CONTENT"===this.current_mode)return a=this.get_content(),"string"!=typeof a?a:[a,"TK_CONTENT"];if("TAG"===this.current_mode){if(a=this.get_tag(),"string"!=typeof a)return a;var c="TK_TAG_"+this.tag_type;return[a,c]}},this.get_full_indent=function(a){return a=this.indent_level+a||0,a<1?"":Array(a+1).join(this.indent_string)},this.printer=function(a,b,c,d,e){this.input=a||"",this.output=[],this.indent_character=b,this.indent_string="",this.indent_size=c,this.brace_style=e,this.indent_level=0,this.max_char=d,this.line_char_count=0;for(var f=0;f<this.indent_size;f++)this.indent_string+=this.indent_character;this.print_newline=function(a,b){if(this.line_char_count=0,b&&b.length){if(!a)for(;this.Utils.in_array(b[b.length-1],this.Utils.whitespace);)b.pop();b.push("\n");for(var c=0;c<this.indent_level;c++)b.push(this.indent_string)}},this.print_token=function(a){this.output.push(a)},this.indent=function(){this.indent_level++},this.unindent=function(){this.indent_level>0&&this.indent_level--}},this}var d,e,f,g,h,i;for(b=b||{},e=b.indent_size||4,f=b.indent_char||" ",h=b.brace_style||"collapse",g=1/0,i=b.unformatted||["a","span","bdo","em","strong","dfn","code","samp","kbd","var","cite","abbr","acronym","q","sub","sup","tt","i","b","big","small","u","s","strike","font","ins","del","pre","address","dt","h1","h2","h3","h4","h5","h6"],d=new c,d.printer(a,f,e,g,h);;){var j=d.get_token();if(d.token_text=j[0],d.token_type=j[1],"TK_EOF"===d.token_type)break;switch(d.token_type){case"TK_TAG_START":d.print_newline(!1,d.output),d.print_token(d.token_text),d.indent(),d.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":d.print_newline(!1,d.output),d.print_token(d.token_text),d.current_mode="CONTENT";break;case"TK_TAG_END":if("TK_CONTENT"===d.last_token&&""===d.last_text){var k=d.token_text.match(/\w+/)[0],l=d.output[d.output.length-1].match(/<\s*(\w+)/);null!==l&&l[1]===k||d.print_newline(!0,d.output)}d.print_token(d.token_text),d.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var m=d.token_text.match(/^\s*<([a-z]+)/i);m&&d.Utils.in_array(m[1],i)||d.print_newline(!1,d.output),d.print_token(d.token_text),d.current_mode="CONTENT";break;case"TK_CONTENT":""!==d.token_text&&d.print_token(d.token_text),d.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(""!==d.token_text){d.output.push("\n");var n=d.token_text;if("keep"==b.indent_scripts)var o=0;else if("separate"==b.indent_scripts)var o=-d.indent_level;else var o=1;var p=d.get_full_indent(o),q=n.match(/^\s*/)[0],r=q.match(/[^\n\r]*$/)[0].split(d.indent_string).length-1,s=d.get_full_indent(o-r);n=n.replace(/^\s*/,p).replace(/\r\n|\r|\n/g,"\n"+s).replace(/\s*$/,""),n&&(d.print_token(n),d.print_newline(!0,d.output))}d.current_mode="TAG"}d.last_token=d.token_type,d.last_text=d.token_text}return d.output.join("")}}}(jQuery);
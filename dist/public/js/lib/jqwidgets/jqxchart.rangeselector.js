!function(a){a.extend(a.jqx._jqxChart.prototype,{_renderCategoryAxisRangeSelector:function(b,c){var d=this;d._isTouchDevice=a.jqx.mobile.isTouchDevice();var e=d._getCategoryAxis(b),f=d.seriesGroups[b];if(e&&0!=e.visible&&"spider"!=f.type&&d._isGroupVisible(b)){var g=e.rangeSelector;if(g){this._isSelectorRefresh||this.host.find(".rangeSelector").remove();var h="horizontal"==f.orientation;g.renderTo&&(h=!1),d.rtl&&(e.flip=!0);var i=h?this.host.height():this.host.width();i-=3;var j=this._getCategoryAxisStats(b,e,i),k=e.position;if(g.renderTo&&g.position&&(k=g.position),!this._isSelectorRefresh){var l=g.renderTo,m="<div class='rangeSelector jqx-disableselect' style='position: absolute; background-color: transparent;' onselectstart='return false;'></div>",n=a(m).appendTo(l?l:this.host.find(".chartContainer"));if(l)n.css({width:l.width(),height:l.height()}),c.width=l.width(),c.height=l.height();else{var o=this.host.coord();selectorSize=this._selectorGetSize(e),h?(n.css("left",o.left+1+c.x+("right"!=k?-selectorSize:c.width)),n.css("top",o.top),n.css("height",i),n.css("width",selectorSize),c.height=selectorSize):(n.css("left",o.left+1),n.css("top",o.top+c.y+("top"!=k?c.height:-selectorSize)),n.css("height",selectorSize),n.css("width",i),c.width=selectorSize)}this._refreshSelector(b,e,j,n,c,h)}}}},_refreshSelector:function(b,c,d,e,f,g){var h={},i=c.rangeSelector;this.seriesGroups[b];for(var j in i)h[j]=i[j];var k=h.minValue,l=h.maxValue;void 0==k&&(k=Math.min(d.min.valueOf(),d.dsRange.min.valueOf())),void 0==l&&(l=Math.max(d.max.valueOf(),d.dsRange.max.valueOf())),this._isDate(d.min)&&(k=new Date(k)),this._isDate(d.max)&&(l=new Date(l));var m=c.position;i.renderTo&&i.position&&(m=i.position),h.dataField=c.dataField,h.rangeSelector=void 0,h.type=c.type,h.baseUnit=i.baseUnit||c.baseUnit,h.minValue=k,h.maxValue=l,h.flip=c.flip,h.position=m;var n=5,o=g?0:f.x,p=g?0:this.padding.right,q=g?f.y:n,r=g?this._paddedRect.height-this._plotRect.height:n,s=i.padding;s=void 0!=s||i.renderTo?{left:s&&s.left?s.left:o,top:s&&s.top?s.top:q,right:s&&s.right?s.right:p,bottom:s&&s.bottom?s.bottom:r}:{left:o,top:q,right:p,bottom:r};for(var t=c.rangeSelector.dataField,j=0;void 0==t&&j<this.seriesGroups.length;j++)for(var u=0;void 0==t&&u<this.seriesGroups[j].series.length;u++)t=this.seriesGroups[j].series[u].dataField;var v={padding:s,title:i.title||"",description:i.description||"",titlePadding:i.titlePadding,colorScheme:i.colorScheme||this.colorScheme,backgroundColor:i.backgroundColor||this.backgroundColor||"transparent",backgroundImage:i.backgroundImage||"",showBorderLine:i.showBorderLine||!!i.renderTo,borderLineWidth:i.borderLineWidth||this.borderLineWidth,borderLineColor:i.borderLineColor||this.borderLineColor,rtl:i.rtl||this.rtl,greyScale:i.greyScale||this.greyScale,showLegend:!1,enableAnimations:!1,enableEvents:!1,showToolTips:!1,source:this.source,xAxis:h,seriesGroups:[{orientation:g?"horizontal":"vertical",valueAxis:{visible:!1},type:c.rangeSelector.serieType||"area",series:[{dataField:t,opacity:.8,lineWidth:1}]}]};e.empty(),e.jqxChart(v);var w=this;e.on(w._getEvent("mousemove"),function(){w._unselect(),w._hideToolTip()});var x=e.jqxChart("getInstance");if(x._plotRect){var y=x._paddedRect;if(y.height=x._plotRect.height,g||"top"!=m){if(g){var z=x._renderData[0].xAxis.rect.width;y.width-=z,"right"!=m&&(y.x+=z)}}else y.y+=x._renderData[0].xAxis.rect.height;w._createSliderElements(b,e,y,i),w.addHandler(a(document),w._getEvent("mousemove"),w._onSliderMouseMove,{self:this,groupIndex:b,renderTo:e,swapXY:g}),w.addHandler(a(document),w._getEvent("mousedown"),w._onSliderMouseDown,{self:this,groupIndex:b,renderTo:e,swapXY:g}),w.addHandler(a(document),w._getEvent("mouseup"),w._onSliderMouseUp,{self:this,groupIndex:b,renderTo:e,swapXY:g})}},_createSliderElements:function(b,c,d,e){c.find(".slider").remove();var f=e.colorSelectedRange||"blue",g=e.colorUnselectedRange||"white",h=a("<div class='slider' style='position: absolute;'></div>");for(h.css({background:f,opacity:.1,left:d.x,top:d.y,width:d.width,height:d.height}),h.appendTo(c),this._sliders||(this._sliders=[]);this._sliders.length<b+1;)this._sliders.push({});var i="<div class='slider' style='position: absolute;  background: "+g+"; opacity: 0.5;'></div>",j="<div class='slider' style='position: absolute; background: grey; opacity: 0.5;'></div>";this._sliders[b]={element:h,host:c,fullRect:{x:h.coord().left,y:h.coord().top,width:d.width,height:d.height},rect:d,left:a(i),right:a(i),leftTop:a(j),rightTop:a(j),leftBorder:a(j),rightBorder:a(j)},this._sliders[b].left.appendTo(c),this._sliders[b].right.appendTo(c),this._sliders[b].leftTop.appendTo(c),this._sliders[b].rightTop.appendTo(c),this._sliders[b].leftBorder.appendTo(c),this._sliders[b].rightBorder.appendTo(c);var k=this._renderData[b].xAxis,l=k.data.axisStats,m=l.min.valueOf(),n=l.max.valueOf(),o=this._valueToOffset(b,m),p=this._valueToOffset(b,n);if(o>p){var q=p;p=o,o=q}"horizontal"!=this.seriesGroups[b].orientation?h.css({left:Math.round(d.x+o),top:d.y,width:Math.round(p-o),height:d.height}):h.css({top:Math.round(d.y+o),left:d.x,height:Math.round(p-o),width:d.width}),this._setSliderPositions(b,o,p)},_setSliderPositions:function(a,b,c){var d=this.seriesGroups[a],e=this._getCategoryAxis(a),f=e.rangeSelector,g="horizontal"==d.orientation;e.rangeSelector.renderTo&&(g=!1);var h=e.position;f.renderTo&&f.position&&(h=f.position);var i=this._sliders[a],j=g?"top":"left",k=g?"left":"top",l=g?"height":"width",m=g?"width":"height",n=g?"y":"x",o=g?"x":"y",p=i.rect;i.left.css(j,p[n]),i.left.css(k,p[o]),i.left.css(l,b),i.left.css(m,p[m]),i.right.css(j,p[n]+c),i.right.css(k,p[o]),i.right.css(l,p[l]-c+1),i.right.css(m,p[m]),i.leftTop.css(j,p[n]),i.leftTop.css(k,p[o]+(g&&"right"==h||!g&&"top"!=h?0:p[m])),i.leftTop.css(l,b),i.leftTop.css(m,1),i.rightTop.css(j,p[n]+c),i.rightTop.css(k,p[o]+(g&&"right"==h||!g&&"top"!=h?0:p[m])),i.rightTop.css(l,p[l]-c+1),i.rightTop.css(m,1),i.leftBorder.css(j,p[n]+b),i.leftBorder.css(k,p[o]),i.leftBorder.css(l,1),i.leftBorder.css(m,p[m]),i.rightBorder.css(j,p[n]+c),i.rightBorder.css(k,p[o]),i.rightBorder.css(l,1),i.rightBorder.css(m,p[m])},_resizeState:{},_onSliderMouseDown:function(a){var b=a.data.self,c=b._sliders[a.data.groupIndex];c&&(void 0==b._resizeState.state&&b._testAndSetReadyResize(a),"ready"==b._resizeState.state&&(b._resizeState.state="resizing"))},_valueToOffset:function(a,b){var c=this.seriesGroups[a],d=this._sliders[a],e=d.host.jqxChart("getInstance"),f=e._renderData[0].xAxis,g=f.data.axisStats,h=Math.min(g.min.valueOf(),g.dsRange.min.valueOf()),i=Math.max(g.max.valueOf(),g.dsRange.max.valueOf()),j=i-h;0==j&&(j=1);var k=this._getCategoryAxis(a),l="horizontal"==c.orientation?"height":"width",m=(b.valueOf()-h)/j;return d.fullRect[l]*(k.flip?1-m:m)},_offsetToValue:function(a,b){var c=this._sliders[a],d=this.seriesGroups[a],e=this._getCategoryAxis(a),f="horizontal"==d.orientation?"height":"width",g=c.fullRect[f];0==g&&(g=1);var h=c.host.jqxChart("getInstance"),i=h._renderData[0].xAxis,j=i.data.axisStats,k=Math.min(j.min.valueOf(),j.dsRange.min.valueOf()),l=Math.max(j.max.valueOf(),j.dsRange.max.valueOf()),m=b/g*(l-k)+k;return 1==e.flip&&(m=l-b/g*(l-k)),this._isDate(j.min)||this._isDate(j.max)?m=new Date(m):(void 0==e.dataField&&(m=Math.round(m)),m<j.min&&(m=j.min),m>j.max&&(m=j.max)),m},_onSliderMouseUp:function(a){var b=a.data.self,c=a.data.groupIndex,d=a.data.swapXY,e=b._sliders[c];if(e&&"resizing"==b._resizeState.state){b._resizeState={},b.host.css("cursor","default");var f=d?"top":"left",g=d?"y":"x",h=e.element.coord()[f],i=h+(d?e.element.height():e.element.width()),j=b._offsetToValue(c,h-e.fullRect[g]),k=b._offsetToValue(c,i-e.fullRect[g]),l=e.host.jqxChart("getInstance"),m=l._renderData[0].xAxis,n=m.data.axisStats;!n.isTimeUnit&&k.valueOf()-j.valueOf()>864e5&&(j.setHours(0,0,0,0),k.setDate(k.getDate()+1),k.setHours(0,0,0,0));var o=b._getCategoryAxis(c);if(o.flip){var p=j;j=k,k=p}o.minValue=j,o.maxValue=k,b._isSelectorRefresh=!0;var q=b.enableAnimations;b.enableAnimations=!1,b.update(),b.enableAnimations=q}},_onSliderMouseMove:function(b){var c=b.data.self,d=(b.data.renderTo,b.data.groupIndex),e=c._sliders[d],f=b.data.swapXY;if(e){var g=e.fullRect,h=e.element,i=a.jqx.position(b),j=h.coord(),k=f?"top":"left",l=f?"height":"width",m=f?"y":"x";if("resizing"==c._resizeState.state){if("left"==c._resizeState.side){var n=Math.round(i[k]-j[k]),o=g[m];if(j[k]+n>=o&&j[k]+n<=o+g[l]){var p=parseInt(h.css(k)),q=Math.max(2,(f?h.height():h.width())-n);h.css(l,q),h.css(k,p+n)}}else if("right"==c._resizeState.side){var r=f?h.height():h.width(),n=Math.round(i[k]-j[k]-r),o=g[m];if(j[k]+r+n>=o&&j[k]+n+r<=o+g[l]){var q=Math.max(2,r+n);h.css(l,q)}}var s=parseInt(h.css(k))-e.rect[m],t=s+(f?h.height():h.width());c._setSliderPositions(d,s,t)}else c._testAndSetReadyResize(b)}},_testAndSetReadyResize:function(b){var c=b.data.self,d=b.data.renderTo,e=b.data.groupIndex,f=c._sliders[e],g=b.data.swapXY,h=f.fullRect,i=f.element,j=a.jqx.position(b),k=i.coord(),l=g?"left":"top",m=g?"top":"left",n=g?"width":"height",o=c._isTouchDevice?15:5;j[l]>=k[l]&&j[l]<=k[l]+h[n]?Math.abs(j[m]-k[m])<=o?(d.css("cursor",g?"row-resize":"col-resize"),c._resizeState={state:"ready",side:"left"}):Math.abs(j[m]-k[m]-(g?i.height():i.width()))<=o?(d.css("cursor",g?"row-resize":"col-resize"),c._resizeState={state:"ready",side:"right"}):(d.css("cursor","default"),c._resizeState={}):(d.css("cursor","default"),c._resizeState={})},_selectorGetSize:function(a){return a.rangeSelector.renderTo?0:a.rangeSelector.size||this._paddedRect.height/3}})}(jQuery);
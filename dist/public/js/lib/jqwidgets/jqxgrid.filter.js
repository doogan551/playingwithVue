!function(a){a.extend(a.jqx._jqxGrid.prototype,{_updatefilterrowui:function(b){for(var c=this.columns.records.length,d=0,e=this,f=0;f<c;f++){var g=this.columns.records[f],h=g.width;h<g.minwidth&&(h=g.minwidth),h>g.maxwidth&&(h=g.maxwidth);var i=a(this.filterrow[0].cells[f]);i.css("left",d);var j=!0;if(i.width()==h&&(j=!1),b&&(j=!0),i.width(h),i[0].left=d,g.hidden&&g.hideable?i.css("display","none"):d+=h,j)if(g.createfilterwidget&&"custom"==g.filtertype)g.createfilterwidget(g,i);else if(g.filterable){var k=function(b,c){var d=a(c.children()[0]);d.width(h-10),d.attr("disabled",b.disabled)};switch(g.filtertype){case"number":a(i.children()[0]).width(h),i.find("input").width(h-30),i.find("input").attr("disabled",e.disabled),a(i.find(".jqx-dropdownlist-state-normal")).jqxDropDownList({disabled:e.disabled});break;case"date":this.host.jqxDateTimeInput?a(i.children()[0]).jqxDateTimeInput({disabled:e.disabled,width:h-10}):k(this,i);break;case"textbox":case"default":k(this,i);break;case"list":case"checkedlist":this.host.jqxDropDownList?a(i.children()[0]).jqxDropDownList({disabled:e.disabled,width:h-10}):k(this,i);break;case"bool":case"boolean":this.host.jqxCheckBox?a(i.children()[0]).jqxCheckBox({disabled:e.disabled}):k(this,i)}}}var l=a(this.filterrow.children()[0]);l.width(parseInt(d)+2),l.height(this.filterrowheight)},clearfilterrow:function(b){if(this._disablefilterrow=!0,this.columns.records){for(var c=this.columns.records.length,d=0;d<c;d++){var e=this.columns.records[d],f=a(this.filterrow[0].cells[d]);if(("string"!=typeof b||e.displayfield==b)&&e.filterable){var g=function(b,c){var d=a(c.children()[0]);d.val(""),d[0]&&(b["_oldWriteText"+d[0].id]="")};switch(e.filtertype){case"number":f.find("input").val("");break;case"date":this.host.jqxDateTimeInput?a(f.children()[0]).jqxDateTimeInput("setDate",null):g(this,f);break;case"textbox":case"default":g(this,f);break;case"list":this.host.jqxDropDownList?a(f.children()[0]).jqxDropDownList("clearSelection"):g(this,f);break;case"checkedlist":this.host.jqxDropDownList?a(f.children()[0]).jqxDropDownList("checkAll",!1):g(this,f);break;case"bool":case"boolean":this.host.jqxCheckBox?a(f.children()[0]).jqxCheckBox({checked:null}):g(this,f)}}}this._disablefilterrow=!1}},_applyfilterfromfilterrow:function(){if(1!=this._disablefilterrow&&!this.disabled){for(var b=this.columns.records.length,c=this.that,d=0;d<b;d++){var e=new a.jqx.filter,f=this.columns.records[d];if(f.filterable&&null!==f.datafield){var g=c._getcolumntypebydatafield(f),h=c._getfiltertype(g),i=1,j=!0,k=(f.filtertype,function(a,b,d){var e=!0;if(a._filterwidget){var f=a._filterwidget.val();if(""!=f){var g="equal";if("stringfilter"==b)var g="contains";if("numericfilter"==b&&","==c.gridlocalization.decimalseparator&&f.indexOf(c.gridlocalization.decimalseparator)>=0&&(f=f.replace(c.gridlocalization.decimalseparator,".")),"stringfilter"!=b){var h=0;if(f.indexOf(">")!=-1&&(g="greater_than",h=1),f.indexOf("<")!=-1&&(g="less_than",h=1),f.indexOf("=")!=-1&&("greater_than"==g?(g="greater_than_or_equal",h=2):"less_than"==g?(g="less_than_or_equal",h=2):(g="equal",h=1)),0!=h&&(f=f.substring(h),f.length<1))return!1}if(void 0!=a.filtercondition&&(g=a.filtercondition),"datefilter"==b)var j=d.createfilter(b,f,g,null,a.cellsformat,c.gridlocalization);else var j=d.createfilter(b,f,g);d.addfilter(i,j)}else e=!1}return e});switch(f.filtertype){case"date":if(f._filterwidget.jqxDateTimeInput){var l=f._filterwidget.jqxDateTimeInput("getRange");if(null!=l&&null!=l.from&&null!=l.to){var m="GREATER_THAN_OR_EQUAL",n=new Date(0);n.setHours(0),n.setFullYear(l.from.getFullYear(),l.from.getMonth(),l.from.getDate());var o=new Date(0);o.setHours(0),o.setFullYear(l.to.getFullYear(),l.to.getMonth(),l.to.getDate()),o.setHours(l.to.getHours()),o.setMinutes(l.to.getMinutes()),o.setSeconds(l.to.getSeconds());var p=e.createfilter(h,n,m);e.addfilter(0,p);var q="LESS_THAN_OR_EQUAL",r=e.createfilter(h,o,q);e.addfilter(0,r)}else j=!1}else j=k(f,h,e);break;case"number":if(f._filterwidget){var l=f._filterwidget.find("input").val();","==c.gridlocalization.decimalseparator&&l.indexOf(c.gridlocalization.decimalseparator)>=0&&(l=l.replace(c.gridlocalization.decimalseparator,"."));var s=f._filterwidget.find(".filter").jqxDropDownList("selectedIndex"),t=e.getoperatorsbyfiltertype(h)[s];if(c.updatefilterconditions){var u=c.updatefilterconditions(h,e.getoperatorsbyfiltertype(h));void 0!=u&&e.setoperatorsbyfiltertype(h,u);var t=e.getoperatorsbyfiltertype(h)[s]}var v="NULL"==t||"NOT_NULL"==t,w="EMPTY"==t||"NOT_EMPTY"==t;void 0!=l&&l.length>0||v||w?(p=e.createfilter(h,new Number(l),t,null,f.cellsformat,c.gridlocalization),e.addfilter(0,p)):j=!1}else j=!1;break;case"textbox":case"default":j=k(f,h,e);break;case"bool":case"boolean":if(f._filterwidget.jqxCheckBox){var l=f._filterwidget.jqxCheckBox("checked");if(null!=l){var m="equal",x=e.createfilter(h,l,m);e.addfilter(i,x)}else j=!1}else j=k(f,h,e);break;case"list":var y=f._filterwidget.jqxDropDownList("listBox");if(y.selectedIndex>0){var z=y.getItem(y.selectedIndex),l=z.label,m="equal";""===l&&(m="NULL");var x=e.createfilter(h,l,m);e.addfilter(i,x)}else j=!1;break;case"checkedlist":if(f._filterwidget.jqxDropDownList){var y=f._filterwidget.jqxDropDownList("listBox"),A=y.getCheckedItems();if(0==A.length){for(var B=1;B<y.items.length;B++){var l=y.items[B].label,m="not_equal";""===l&&(m="NULL");var x=e.createfilter(h,l,m);e.addfilter(0,x)}j=!0}else if(A.length!=y.items.length)for(var B=0;B<A.length;B++){var l=A[B].label,m="equal";""===l&&(m="NULL");var x=e.createfilter(h,l,m);e.addfilter(i,x)}else j=!1}else j=k(f,h,e)}this._loading||(j?this.addfilter(f.displayfield,e,!1):this.removefilter(f.displayfield,!1))}}this._loading||this.applyfilters("filterrow")}},_updatefilterrow:function(){var b=a('<div style="position: relative;" id="row00'+this.element.id+'"></div>'),c=0,d=this.columns.records.length,e=this.toThemeProperty("jqx-grid-cell");e+=" "+this.toThemeProperty("jqx-grid-cell-pinned"),e+=" "+this.toThemeProperty("jqx-grid-cell-filter-row");var f=d+10,g=new Array,h=this.that;this.filterrow[0].cells=g,b.height(this.filterrowheight),this.filterrow.children().detach(),this.filterrow.append(b),this._filterrowcache||(this._filterrowcache=new Array),this._initcolumntypes();for(var i=!1,j=new Array,k=0;k<d;k++){var l=this.columns.records[k],m=l.width;m<l.minwidth&&(m=l.minwidth),m>l.maxwidth&&(m=l.maxwidth);var n=a('<div style="overflow: hidden; position: absolute; height: 100%;" class="'+e+'"></div>');b.append(n),n.css("left",c),this.rtl?(n.css("z-index",f++),n.css("border-left-width","1px")):n.css("z-index",f--),n[0].style.width=parseFloat(m)+"px",n[0].left=c,l.hidden&&l.hideable?n.css("display","none"):c+=m,g[g.length]=n[0];var o=!0;if(this.rtl){if(this.groupable){var p=this.showrowdetailscolumn&&this.rowdetails?1:0;this.groups.length+p+k>d-1&&(o=!1)}this.showrowdetailscolumn&&this.rowdetails&&k==d-1&&(o=!1)}else{if(this.groupable){var p=this.showrowdetailscolumn&&this.rowdetails?1:0;this.groups.length+p>k&&(o=!1)}this.showrowdetailscolumn&&this.rowdetails&&0==k&&(o=!1)}if(o)if("custom"==l.filtertype&&l.createfilterwidget){var q=function(){h._applyfilterfromfilterrow()};l.createfilterwidget(l,n,q)}else l.filterable&&(this._filterrowcache[l.datafield]?(i=!0,n.append(this._filterrowcache[l.datafield]),l._filterwidget=this._filterrowcache[l.datafield]):(this._addfilterwidget(l,n,m),j[l.datafield]=l._filterwidget))}this._filterrowcache=j,a.jqx.browser.msie&&a.jqx.browser.version<8&&b.css("z-index",f--),b.width(parseFloat(c)+2),this.filterrow.addClass(e),this.filterrow.css("border-top-width","1px"),this.filterrow.css("border-right-width","0px"),i&&this._updatefilterrowui(!0)},_addfilterwidget:function(b,c,d){for(var e=this.that,f="",g=0;g<e.dataview.filters.length;g++){var h=e.dataview.filters[g];if(h.datafield&&h.datafield==b.datafield){f=h.filter.getfilters()[0].value;break}}var i=function(c,e){var g=a('<input autocomplete="off" type="textarea"/>');g[0].id=a.jqx.utilities.createId(),g.addClass(c.toThemeProperty("jqx-widget")),g.addClass(c.toThemeProperty("jqx-input")),g.addClass(c.toThemeProperty("jqx-rc-all")),g.addClass(c.toThemeProperty("jqx-widget-content")),c.rtl&&g.css("direction","rtl"),c.disabled&&g.attr("disabled",!0),g.attr("disabled",!1),g.appendTo(e),g.width(d-10),g.height(c.filterrowheight-10),g.css("margin","4px"),b.createfilterwidget&&b.createfilterwidget(b,e,g),b._filterwidget=g,g.focus(function(){return c.content[0].scrollLeft=0,setTimeout(function(){c.content[0].scrollLeft=0},10),c.focusedfilter=g,g.addClass(c.toThemeProperty("jqx-fill-state-focus")),!1}),g.blur(function(){g.removeClass(c.toThemeProperty("jqx-fill-state-focus"))}),g.keydown(function(a){"13"==a.keyCode&&c._applyfilterfromfilterrow(),g[0]._writeTimer&&clearTimeout(g[0]._writeTimer),g[0]._writeTimer=setTimeout(function(){c._loading||c["_oldWriteText"+g[0].id]!=g.val()&&(c._applyfilterfromfilterrow(),c["_oldWriteText"+g[0].id]=g.val())},800),c.focusedfilter=g}),c.host.removeClass("jqx-disableselect"),c.content.removeClass("jqx-disableselect"),g.val(f)};switch(null!=b.datatype&&("number"==b.filtertype&&("string"!=b.datatype&&"date"!=b.datatype&&"bool"!=b.datatype||(b.filtertype="textbox")),"date"==b.filtertype&&("string"!=b.datatype&&"number"!=b.datatype&&"bool"!=b.datatype||(b.filtertype="textbox")),"bool"==b.filtertype&&("string"!=b.datatype&&"number"!=b.datatype&&"date"!=b.datatype||(b.filtertype="textbox"))),b.filtertype){case"number":var j=a("<div></div>");j.width(c.width()),j.height(this.filterrowheight),c.append(j);var d=c.width()-20,k=function(b,c,d){var g=a('<input style="float: left;" autocomplete="off" type="textarea"/>');return e.rtl&&(g.css("float","right"),g.css("direction","rtl")),g[0].id=a.jqx.utilities.createId(),g.addClass(e.toThemeProperty("jqx-widget")),g.addClass(e.toThemeProperty("jqx-input")),g.addClass(e.toThemeProperty("jqx-rc-all")),g.addClass(e.toThemeProperty("jqx-widget-content")),g.appendTo(b),g.width(c-10),e.disabled&&g.attr("disabled",!0),g.attr("disabled",!1),g.height(e.filterrowheight-10),g.css("margin","4px"),g.css("margin-right","2px"),g.focus(function(){e.focusedfilter=g,g.addClass(e.toThemeProperty("jqx-fill-state-focus"))}),g.blur(function(){g.removeClass(e.toThemeProperty("jqx-fill-state-focus"))}),g.keydown(function(a){"13"==a.keyCode&&e._applyfilterfromfilterrow(),g[0]._writeTimer&&clearTimeout(g[0]._writeTimer),g[0]._writeTimer=setTimeout(function(){e._loading||e["_oldWriteText"+g[0].id]!=g.val()&&(e._applyfilterfromfilterrow(),e["_oldWriteText"+g[0].id]=g.val())},800),e.focusedfilter=g}),g.val(f),g};k(j,d);var l=e._getfiltersbytype("number"),m=a("<div class='filter' style='float: left;'></div>");m.css("margin-top","4px"),m.appendTo(j),e.rtl&&m.css("float","right");var n=0;if(null!=b.filtercondition){var o=l.indexOf(b.filtercondition);o!=-1&&(n=o)}m.jqxDropDownList({disabled:e.disabled,touchMode:e.touchmode,rtl:e.rtl,dropDownHorizontalAlignment:"right",enableBrowserBoundsDetection:!0,selectedIndex:n,width:18,height:21,dropDownHeight:150,dropDownWidth:170,source:l,theme:e.theme}),m.jqxDropDownList({selectionRenderer:function(a){return""}}),m.jqxDropDownList("setContent",""),m.find(".jqx-dropdownlist-content").hide(),b.createfilterwidget&&b.createfilterwidget(b,c,j),b._filterwidget=j;var p=null;this.addHandler(m,"select",function(){var a=m.jqxDropDownList("getSelectedItem").label;b._filterwidget.find("input").val().length>0&&!e.refreshingfilter?e._applyfilterfromfilterrow():0!=b._filterwidget.find("input").val().length||e.refreshingfilter||"null"!=p&&"not null"!=p&&"null"!=a&&"not null"!=a||e._applyfilterfromfilterrow(),p=a});break;case"textbox":case"default":default:i(this,c);break;case"none":break;case"date":if(this.host.jqxDateTimeInput){var q=a("<div></div>");q.css("margin","4px"),q.appendTo(c);var r={calendar:this.gridlocalization,todayString:this.gridlocalization.todaystring,clearString:this.gridlocalization.clearstring};q.jqxDateTimeInput({disabled:e.disabled,localization:r,rtl:e.rtl,showFooter:!0,formatString:b.cellsformat,selectionMode:"range",value:null,theme:this.theme,width:d-10,height:this.filterrowheight-10}),b.createfilterwidget&&b.createfilterwidget(b,c,q),b._filterwidget=q,this.addHandler(q,"valuechanged",function(a){e.refreshingfilter||(e._applyfilterfromfilterrow(),e.focusedfilter=null)})}else i(this,c);break;case"list":case"checkedlist":if(this.host.jqxDropDownList){var s=this._getfilterdataadapter(b),t=!1,m=a("<div></div>");m.css("margin","4px");var u=b.datafield,v="checkedlist"==b.filtertype,w=d<150?220:"auto";s.dataBind();var x=s.records,y=x.length<8;t=y,m.appendTo(c),m.jqxDropDownList({disabled:e.disabled,touchMode:e.touchmode,rtl:e.rtl,checkboxes:v,dropDownWidth:w,source:s.records,autoDropDownHeight:y,theme:this.theme,width:d-10,height:this.filterrowheight-10,displayMember:b.displayfield,valueMember:u});var z=m.jqxDropDownList("listBox");if(v){m.jqxDropDownList({selectionRenderer:function(){var a='<span class="'+e.toThemeProperty("jqx-item")+'" style="top: 2px; position: relative; color: inherit; border: none; background-color: transparent;">'+e.gridlocalization.filterselectstring+"</span>";return a}});var A=a('<span style="top: 2px; position: relative; color: inherit; border: none; background-color: transparent;">'+e.gridlocalization.filterselectstring+"</span>");if(A.addClass(this.toThemeProperty("jqx-item")),void 0!=z){t||z.host.height(200),z.insertAt(e.gridlocalization.filterselectallstring,0),m.jqxDropDownList("setContent",A);var B=!0;new Array;z.checkAll(!1),e.addHandler(z.host,"checkChange",function(a){if(m[0]._selectionChanged=!0,B)if(a.args.label!=e.gridlocalization.filterselectallstring){B=!1,z.host.jqxListBox("checkIndex",0,!0,!1);var b=z.host.jqxListBox("getCheckedItems"),c=z.host.jqxListBox("getItems");1==b.length?z.host.jqxListBox("uncheckIndex",0,!0,!1):c.length!=b.length&&z.host.jqxListBox("indeterminateIndex",0,!0,!1),B=!0}else B=!1,a.args.checked?z.host.jqxListBox("checkAll",!1):z.host.jqxListBox("uncheckAll",!1),B=!0})}}else z.insertAt({label:this.gridlocalization.filterchoosestring,value:""},0),m.jqxDropDownList({selectedIndex:0});b.createfilterwidget&&b.createfilterwidget(b,c,m),b._filterwidget=m;m.jqxDropDownList("dropdownlistWrapper");"list"==b.filtertype?this.addHandler(m,"select",function(a){e.refreshingfilter||a.args&&"none"!=a.args.type&&(e._applyfilterfromfilterrow(),e.focusedfilter=null)}):this.addHandler(m,"close",function(a){m[0]._selectionChanged&&(e._applyfilterfromfilterrow(),e.focusedfilter=null,m[0]._selectionChanged=!1)})}else i(this,c);break;case"bool":case"boolean":if(this.host.jqxCheckBox){var C=a('<div tabIndex=0 style="opacity: 0.99; position: absolute; top: 50%; left: 50%; margin-top: -7px; margin-left: -10px;"></div>');C.appendTo(c),C.jqxCheckBox({disabled:e.disabled,enableContainerClick:!1,animationShowDelay:0,animationHideDelay:0,hasThreeStates:!0,theme:this.theme,checked:null}),b.createfilterwidget&&b.createfilterwidget(b,c,C),f===!0||"true"==f?C.jqxCheckBox({checked:!0}):f!==!1&&"false"!=f||C.jqxCheckBox({checked:!1}),b._filterwidget=C,this.addHandler(C,"change",function(a){e.refreshingfilter||a.args&&(e.focusedfilter=null,e._applyfilterfromfilterrow())})}else i(this,c)}},_getfilterdataadapter:function(b){var c=!!this.source._source;if(c){var d={localdata:this.source.records,datatype:this.source.datatype,async:!1},e=this;dataadapter=new a.jqx.dataAdapter(d,{autoBind:!1,autoSort:!0,autoSortField:b.displayfield,async:!1,uniqueDataFields:[b.displayfield],beforeLoadComplete:function(a){var c=new Array;if(b.cellsformat){for(var d=e._getcolumntypebydatafield(b),f=0;f<a.length;f++){c.push(a[f]);var g=a[f][b.displayfield];a[f][b.displayfield+"JQValue"]=g,"date"===d?a[f][b.displayfield]=dataadapter.formatDate(g,b.cellsformat,e.gridlocalization):"number"!==d&&"float"!==d&&"int"!==d||(a[f][b.displayfield]=dataadapter.formatNumber(g,b.cellsformat,e.gridlocalization))}return c}return a}})}else dataadapter=new a.jqx.dataAdapter(this.source,{autoBind:!1,uniqueDataFields:[b.displayfield],autoSort:!0,autoSortField:b.displayfield,async:!1});if(b.filteritems&&b.filteritems.length>0){var d={localdata:b.filteritems,datatype:this.source.datatype,async:!1};dataadapter=new a.jqx.dataAdapter(d,{autoBind:!1,async:!1})}else if(b.filteritems){if(b.filteritems._source)return b.filteritems._options.autoBind=!1,b.filteritems._options.async=!1,b.filteritems;if(a.isFunction(b.filteritems))return b.filteritems()}return dataadapter},refreshfilterrow:function(){if(this.showfilterrow){this.refreshingfilter=!0,this._updatefilterrowui(),this._updatelistfilters(!0,!0);for(var b=this.that,c=this.columns.records.length,d=0;d<c;d++){var e=this.columns.records[d];if(e.filterable&&e.filter){var f=e.filter.getfilters();if(f.length>0){var g=f[0].value,h=e._filterwidget,i=e._filterwidget.parent();if(null!=h)switch(e.filtertype){case"number":if(i.find("input").val(g),this.host.jqxDropDownList){var j=e.filter.getoperatorsbyfiltertype("numericfilter");h.find(".filter").jqxDropDownList("selectIndex",j.indexOf(f[0].condition))}break;case"date":if(this.host.jqxDateTimeInput){var g=e.filter.getfilterat(0).filtervalue;if(void 0!=g){if(e.filter.getfilterat(1))var k=e.filter.getfilterat(1).filtervalue;else k=g;a(i.children()[0]).jqxDateTimeInput("setRange",new Date(g),new Date(k))}}else h.val(g);break;case"textbox":case"default":h.val(g),b["_oldWriteText"+h[0].id]=g;break;case"bool":case"boolean":this.host.jqxCheckBox?a(i.children()[0]).jqxCheckBox({checked:g}):h.val(g)}}}}this.refreshingfilter=!1}},_destroyedfilters:function(){for(var b=(this.that,this.columns.records.length),c=0;c<b;c++){var d=this.columns.records[c];if(d.filterable){var e=d._filterwidget;if("list"==d.filtertype||"checkedlist"==d.filtertype)this.removeHandler(e,"select"),this.removeHandler(e,"close"),e.jqxDropDownList("destroy");else if("date"==d.filtertype)this.removeHandler(e,"valuechanged"),e.jqxDateTimeInput("destroy");else if("bool"==d.filtertype)this.removeHandler(e,"change"),e.jqxCheckBox("destroy");else if("number"==d.filtertype){var f=e.find(".jqx-input");this.removeHandler(f,"keydown");var g=a(e.children()[1]);g.jqxDropDownList("destroy")}else this.removeHandler(e,"keydown");e.remove()}}},_updatelistfilters:function(b,c){for(var d=this.that,e=this.columns.records.length,f=0;f<e;f++){var g=this.columns.records[f];if(g.filterable&&("list"==g.filtertype||"checkedlist"==g.filtertype)){var h=g._filterwidget;if(b){var i=this._getfilterdataadapter(g);h.jqxDropDownList({source:i});var j=h.jqxDropDownList("getItems"),k=!0;if(j.length!=i.records.length+1&&(k=!1),k)for(var l=1;l<j.length;l++)if(j[l].label!=i.records[l-1][g.displayfield]){k=!1;break}if(k&&!c)continue}else if(void 0==g.filter){h.jqxDropDownList("renderSelection");continue}var m="checkedlist"==g.filtertype,j=h.jqxDropDownList("getItems"),n=h.jqxDropDownList("listBox");if(h.jqxDropDownList("dataBind"),m){if(h.jqxDropDownList({selectionRenderer:function(){return d.gridlocalization.filterselectstring}}),n.insertAt(this.gridlocalization.filterselectallstring,0),h.jqxDropDownList("setContent",this.gridlocalization.filterselectstring),n.checkAll(!1),g.filter){for(var o=g.filter.getfilters(),l=0;l<n.items.length;l++){var p=n.items[l].label,q=void 0;a.each(o,function(){var a;"NOT_EQUAL"==this.condition?a=p!=this.value:"EQUAL"==this.condition&&(a=p==this.value),q=void 0==q&&void 0!==a?a:"EQUAL"==this.condition?q||a:q&&a}),q?n.checkIndex(l,!1,!1):n.uncheckIndex(l,!1,!1)}n._updateCheckedItems();var r=n.getCheckedItems().length;n.items.length!=r&&r>0&&n.host.jqxListBox("indeterminateIndex",0,!0,!1)}}else if(n.insertAt({label:this.gridlocalization.filterchoosestring,value:""},0),h.jqxDropDownList({selectedIndex:0}),g.filter){for(var o=g.filter.getfilters(),s=-1,l=0;l<n.items.length;l++){var p=n.items[l].label;a.each(o,function(){return"NOT_EQUAL"==this.condition||(p==this.value?(s=l,!1):void 0)})}s!=-1&&n.selectIndex(s)}j.length<8?h.jqxDropDownList("autoDropDownHeight",!0):h.jqxDropDownList("autoDropDownHeight",!1)}}},_renderfiltercolumn:function(){var b=this.that;if(this.filterable){if(!this.columns.records)return;a.each(this.columns.records,function(c,d){var e=!1;b.autoshowfiltericon?this.filter?(a(this.filtericon).show(),e=!0):a(this.filtericon).hide():this.filterable&&(a(this.filtericon).show(),e=!0),"right"!=this.align||this.renderer||this.element&&(e?this.element.firstChild.firstChild.style.marginRight="18px":this.element.firstChild.firstChild.style.marginRight="2px")})}},_initcolumntypes:function(){if(this.columns&&this.columns.records){var b=this.source._source.datafields;if(b)for(var c=0;c<this.columns.records.length;c++){var d=this.columns.records[c];if(!d.datatype){var e="";a.each(b,function(){if(this.name==d.displayfield)return this.type&&(e=this.type),!1}),""!=e?d.datatype=e:d.datatype=""}}}},_getcolumntypebydatafield:function(b){var c=this.that,d="string",e=c.source.datafields||(c.source._source?c.source._source.datafields:null);if(e){var f="";if(a.each(e,function(){if(this.name==b.displayfield)return this.type&&(f=this.type),!1}),f)return f}if(null!=b){if(void 0==this.dataview.cachedrecords)return d;var g=null;if(this.virtualmode)a.each(this.dataview.cachedrecords,function(){return g=this[b.displayfield],!1});else{if(0==this.dataview.cachedrecords.length)return d;if(g=this.dataview.cachedrecords[0][b.displayfield],null!=g&&""==g.toString())return"string"}if(null!=g)if("boolean"==typeof g)d="boolean";else if(a.jqx.dataFormat.isNumber(g))d="number";else{var h=new Date(g);if("NaN"==h.toString()||"Invalid Date"==h.toString())if(a.jqx.dataFormat){if(h=a.jqx.dataFormat.tryparsedate(g),null!=h){if(h&&h.getFullYear()&&1970==h.getFullYear()&&0==h.getMonth()&&1==h.getDate()){var i=new Number(g);return isNaN(i)?"string":"number"}return"date"}d="string"}else d="string";else d="date"}}return d},_getfiltersbytype:function(a){var b=this.that,c="";switch(a){case"number":case"float":case"int":c=b.gridlocalization.filternumericcomparisonoperators;break;case"date":c=b.gridlocalization.filterdatecomparisonoperators;break;case"boolean":case"bool":c=b.gridlocalization.filterbooleancomparisonoperators;break;case"string":default:c=b.gridlocalization.filterstringcomparisonoperators}return c},_getfiltertype:function(a){var b="stringfilter";switch(a){case"number":case"int":case"float":case"decimal":b="numericfilter";break;case"boolean":case"bool":b="booleanfilter";break;case"date":case"time":b="datefilter";break;case"string":b="stringfilter"}return b},_buildfilter:function(b,c,d){var e=a(c).find("#filter1"+b.element.id),f=a(c).find("#filter2"+b.element.id),g=a(c).find("#filter3"+b.element.id),h=a(c).find(".filtertext1"+b.element.id),i=a(c).find(".filtertext2"+b.element.id),j=h.val(),k=i.val(),l=b._getcolumntypebydatafield(d),m=(b._getfiltersbytype(l),new a.jqx.filter),n=b._getfiltertype(l);if("default"===b.filtermode){var o=e.jqxDropDownList("selectedIndex"),p=f.jqxDropDownList("selectedIndex"),q=g.jqxDropDownList("selectedIndex"),r=null,s=null;if(b.updatefilterconditions){var t=b.updatefilterconditions(n,m.getoperatorsbyfiltertype(n));void 0!=t&&m.setoperatorsbyfiltertype(n,t)}var u=!1,v=m.getoperatorsbyfiltertype(n)[o],g=m.getoperatorsbyfiltertype(n)[q],w="NULL"==v||"NOT_NULL"==v,x="EMPTY"==v||"NOT_EMPTY"==v;void 0==v&&(v=m.getoperatorsbyfiltertype(n)[0]),void 0==g&&(g=m.getoperatorsbyfiltertype(n)[0]),(j.length>0||w||x)&&(r=m.createfilter(n,j,v,null,d.cellsformat,b.gridlocalization),m.addfilter(p,r),u=!0);var y="NULL"==g||"NOT_NULL"==g,z="EMPTY"==g||"NOT_EMPTY"==g;if((k.length>0||y||z)&&(s=m.createfilter(n,k,g,null,d.cellsformat,b.gridlocalization),m.addfilter(p,s),u=!0),u){var A=d.displayfield;this.addfilter(A,m,!0)}else this._clearfilter(b,c,d)}else{var B=!1,C=e.data().jqxListBox.instance,D=C.getCheckedItems();if(0==D.length){for(var E=1;E<C.items.length;E++){var F=C.items[E].value,G="not_equal",H=m.createfilter(n,F,G,null);m.addfilter(0,H)}B=!0}else if(D.length!=C.items.length){B=!0;for(var E=0;E<D.length;E++)if(b.gridlocalization.filterselectallstring!==D[E].value){var F=D[E].value,G="equal",H=m.createfilter(n,F,G,null),I=1;m.addfilter(I,H)}}else B=!1;if(B){var A=d.displayfield;this.addfilter(A,m,!0)}else{var A=d.displayfield;this.removefilter(A,!0)}}},_clearfilter:function(a,b,c){var d=c.displayfield;this.removefilter(d,!0)},addfilter:function(a,b,c){if(this._loading)throw new Error("jqxGrid: "+this.loadingerrormessage);var d=this.getcolumn(a),e=this._getcolumn(a);void 0!=d&&null!=d&&(d.filter=b,e.filter=b,this.dataview.addfilter(a,b),1==c&&void 0!=c&&this.applyfilters("add"))},removefilter:function(a,b){if(this._loading)throw new Error("jqxGrid: "+this.loadingerrormessage);var c=this.getcolumn(a),d=this._getcolumn(a);void 0!=c&&null!=c&&null!=c.filter&&(this.dataview.removefilter(a,c.filter),c.filter=null,d.filter=null,this.showfilterrow&&this.clearfilterrow(a),1!=b&&b===!1||this.applyfilters("remove"))},applyfilters:function(b){if(this.dataview.filters.length>=0&&(this.virtualmode||!this.source.localdata)&&null!=this.source&&this.source.filter){var c=-1;this.pageable?(c=this.dataview.pagenum,this.dataview.pagenum=0):(this.vScrollInstance.setPosition(0),this.loadondemand=!0,this._renderrows(this.virtualsizeinfo)),this.pageable&&this.virtualmode&&(this.dataview.pagenum=0),this.source.filter(this.dataview.filters,this.dataview.records,this.dataview.records.length),this.pageable&&!this.virtualmode&&(this.dataview.pagenum=c)}if(this.dataview.clearsortdata&&this.dataview.clearsortdata(),this.virtualmode)return this.pageable&&(this.dataview.updateview(),this.gotopage&&this.gotopage(0)),this.rendergridcontent(!1,!1),this.showfilterrow&&"string"!=typeof b&&a.isEmptyObject(b)&&this.refreshfilterrow(),void this._raiseEvent(13,{filters:this.dataview.filters});this.selectedrowindexes,this.that;if(this.dataview.refresh(),this.dataview.clearsortdata&&this.sortcolumn&&this.sortdirection){var d=this.sortdirection.ascending?"asc":"desc";this._loading?this.sortby(this.sortcolumn,d,null,!1,!1):this.sortby(this.sortcolumn,d,null,!1)}this.pageable&&(this.dataview.updateview(),this.gotopage&&(this.gotopage(0),this.updatepagerdetails())),this._updaterowsproperties(),!this.groupable||this.groupable&&0==this.groups.length?(this._rowdetailscache=new Array,this.virtualsizeinfo=null,this._pagescache=new Array,this.columns&&this.columns.records&&this.columns.records.length>0&&!this.columns.records[0].filtericon&&(this.prerenderrequired=!0),this.rendergridcontent(!0,!1),this._updatecolumnwidths(),this._updatecellwidths(),this._renderrows(this.virtualsizeinfo),this.showaggregates&&this._updatecolumnsaggregates&&this._updatecolumnsaggregates()):(this._rowdetailscache=new Array,this._render(!0,!0,!1,!1,!1),this.showfilterrow&&this._updatefocusedfilter(),this._updatecolumnwidths(),this._updatecellwidths(),this._renderrows(this.virtualsizeinfo)),this.showfilterrow&&"string"!=typeof b&&a.isEmptyObject(b)&&this.refreshfilterrow(),this._raiseEvent(13,{filters:this.dataview.filters})},getfilterinformation:function(){for(var a=new Array,b=0;b<this.dataview.filters.length;b++){var c=this.getcolumn(this.dataview.filters[b].datafield);a[b]={filter:this.dataview.filters[b].filter,filtercolumn:c.datafield,filtercolumntext:c.text}}return a},clearfilters:function(b){var c=this.that;if(this.showfilterrow&&this.clearfilterrow(),this.columns.records){var d=1==b||b!==!1;a.each(this.columns.records,function(){c.removefilter(this.displayfield,!d)})}b!==!1&&(1!=b&&b===!1||this.applyfilters("clear"))},_destroyfilterpanel:function(){var b=a(a.find("#filterclearbutton"+this.element.id)),c=a(a.find("#filterbutton"+this.element.id)),d=a(a.find("#filter1"+this.element.id)),e=a(a.find("#filter2"+this.element.id)),f=a(a.find("#filter3"+this.element.id)),g=a(a.find(".filtertext1"+this.element.id)),h=a(a.find(".filtertext2"+this.element.id));g.length>0&&h.length>0&&(g.removeClass(),h.removeClass(),g.remove(),h.remove()),b.length>0&&(b.jqxButton("destroy"),c.jqxButton("destroy"),this.removeHandler(b,"click"),this.removeHandler(c,"click")),d.length>0&&d.jqxDropDownList("destroy"),e.length>0&&e.jqxDropDownList("destroy"),f.length>0&&f.jqxDropDownList("destroy")},_updatefilterpanel:function(b,c,d){null!=b&&void 0!=b||(b=this);var e=b._getcolumntypebydatafield(d),f=b._getfiltersbytype(e);if(!b.host.jqxDropDownList)throw new Error("jqxGrid: Missing reference to jqxdropdownlist.js.");var g=a(c),h=g.find("#filterclearbutton"+b.element.id),i=g.find("#filterbutton"+b.element.id),j=g.find("#filter1"+b.element.id),k=g.find("#filter2"+b.element.id),l=g.find("#filter3"+b.element.id),m=g.find(".filtertext1"+b.element.id),n=g.find(".filtertext2"+b.element.id);if(this._hasdatefilter){var o=m.parent(),p=n.parent();if(o.children().remove(),p.children().remove(),"date"==d.filtertype){b._showwhere.text(b.gridlocalization.filtershowrowdatestring);var q=a("<div class='filtertext1"+b.element.id+"' style='margin-top: 3px; margin-bottom: 3px;'></div>");o.append(q);var r=function(a){var c={calendar:b.gridlocalization,todayString:b.gridlocalization.todaystring,clearString:b.gridlocalization.clearstring};a.jqxDateTimeInput({disabled:b.disabled,localization:c,rtl:b.rtl,width:b._filterpanelwidth-15,height:20,value:null,formatString:d.cellsformat,theme:b.theme})};r(q);var q=a("<div class='filtertext2"+b.element.id+"' style='margin-top: 3px; margin-bottom: 3px;'></div>");p.append(q),r(q)}else{b._showwhere.text(b.gridlocalization.filtershowrowstring);var q=a("<input class='filtertext1"+b.element.id+"' style='height: 20px; margin-top: 3px; margin-bottom: 3px;' type='text'></input>");o.append(q);var r=function(a){a.addClass(b.toThemeProperty("jqx-input")),a.addClass(b.toThemeProperty("jqx-widget-content")),a.addClass(b.toThemeProperty("jqx-rc-all")),a.width(b._filterpanelwidth-15)};r(q);var q=a("<input class='filtertext2"+b.element.id+"' style='height: 20px; margin-top: 3px; margin-bottom: 3px;' type='text'></input>");p.append(q),r(q)}var m=g.find(".filtertext1"+b.element.id),n=g.find(".filtertext2"+b.element.id)}if(m.val(""),n.val(""),this.removeHandler(i,"click"),this.addHandler(i,"click",function(){b._buildfilter(b,c,d),b._closemenu()}),this.removeHandler(h,"click"),this.addHandler(h,"click",function(){b._clearfilter(b,c,d),b._closemenu()}),"default"===this.filtermode){if(j.jqxDropDownList("source")!=f&&(j.jqxDropDownList({enableBrowserBoundsDetection:!1,source:f}),l.jqxDropDownList({enableBrowserBoundsDetection:!1,source:f})),"boolean"==e||"bool"==e)j.jqxDropDownList({autoDropDownHeight:!0,selectedIndex:0}),l.jqxDropDownList({autoDropDownHeight:!0,selectedIndex:0});else{var s=!1;f&&f.length&&f.length<5&&(s=!0),j.jqxDropDownList({autoDropDownHeight:s,selectedIndex:2}),l.jqxDropDownList({autoDropDownHeight:s,selectedIndex:2})}k.jqxDropDownList({selectedIndex:0});var t=d.filter,u=new a.jqx.filter,v="";switch(e){case"number":case"int":case"float":case"decimal":v="numericfilter",w=u.getoperatorsbyfiltertype("numericfilter");break;case"boolean":case"bool":v="booleanfilter",w=u.getoperatorsbyfiltertype("booleanfilter");break;case"date":case"time":v="datefilter",w=u.getoperatorsbyfiltertype("datefilter");break;case"string":v="stringfilter",w=u.getoperatorsbyfiltertype("stringfilter")}if(null!=t){var o=t.getfilterat(0),p=t.getfilterat(1);t.getoperatorat(0);if(b.updatefilterconditions){var w=[],x=b.updatefilterconditions(v,w);if(void 0!=x){for(var y=0;y<x.length;y++)x[y]=x[y].toUpperCase();t.setoperatorsbyfiltertype(v,x),w=x}}var z="default";if(null!=o){var A=w.indexOf(o.comparisonoperator),B=o.filtervalue;m.val(B),j.jqxDropDownList({selectedIndex:A,animationType:z})}if(null!=p){var C=w.indexOf(p.comparisonoperator),D=p.filtervalue;n.val(D),l.jqxDropDownList({selectedIndex:C,animationType:z})}void 0==t.getoperatorat(0)?k.jqxDropDownList({selectedIndex:0,animationType:z}):"and"==t.getoperatorat(0)||0==t.getoperatorat(0)?k.jqxDropDownList({selectedIndex:0}):k.jqxDropDownList({selectedIndex:1})}b.updatefilterpanel&&b.updatefilterpanel(j,l,k,m,n,i,h,t,v,w),(!this._hasdatefilter||this._hasdatefilter&&"date"!=d.filtertype)&&(m.focus(),
setTimeout(function(){m.focus()},10))}else{var E=b._getfilterdataadapter(d),v=b._getfiltertype(e);d.cellsformat?j.jqxListBox({displayMember:d.displayfield,valueMember:d.displayfield+"JQValue",source:E}):j.jqxListBox({displayMember:d.displayfield,valueMember:d.displayfield,source:E}),j.jqxListBox("insertAt",b.gridlocalization.filterselectallstring,0);var F=j.data().jqxListBox.instance;F.checkAll(!1);if(d.filter){F.uncheckAll(!1);for(var G=d.filter.getfilters(),H=0;H<F.items.length;H++){var I=F.items[H].value;a.each(G,function(){if("NOT_EQUAL"==this.condition){if(I!=this.value)return F.uncheckIndex(H,!1,!1),!1}else if("EQUAL"==this.condition&&I==this.value)return F.checkIndex(H,!1,!1),!1})}F._updateCheckedItems();var J=F.getCheckedItems().length;F.items.length!=J&&J>0&&F.host.jqxListBox("indeterminateIndex",0,!0,!1),J===F.items.length-1&&F.host.jqxListBox("checkIndex",0,!0,!1)}}},_initfilterpanel:function(b,c,d,e){null!=b&&void 0!=b||(b=this),c[0].innerHTML="";var f=a("<div class='filter' style='margin-left: 7px;'></div>");c.append(f);var g=a("<div class='filter' style='margin-top: 3px; margin-bottom: 3px;'></div>");g.text(b.gridlocalization.filtershowrowstring),this._showwhere=g;var h=a("<div class='filter' id='filter1"+b.element.id+"'></div>"),i=a("<div class='filter' id='filter2"+b.element.id+"' style='margin-bottom: 3px;'></div>"),j=a("<div class='filter' id='filter3"+b.element.id+"'></div>"),k=b._getcolumntypebydatafield(d);if(!h.jqxDropDownList)throw new Error("jqxGrid: jqxdropdownlist.js is not loaded.");var l=b._getfiltersbytype(k);if(this._hasdatefilter=!1,this._filterpanelwidth=e,this.columns&&this.columns.records)for(var m=0;m<this.columns.records.length;m++)if("date"==this.columns.records[m].filtertype){this._hasdatefilter=!0;break}var n=a("<div class='filter'><input class='filtertext1"+b.element.id+"' style='height: 20px; margin-top: 3px; margin-bottom: 3px;' type='text'></input></div>"),o=n.find("input");o.addClass(this.toThemeProperty("jqx-input")),o.addClass(this.toThemeProperty("jqx-widget-content")),o.addClass(this.toThemeProperty("jqx-rc-all")),o.width(e-15);var p=a("<div class='filter'><input class='filtertext2"+b.element.id+"' style='height: 20px; margin-top: 3px;' type='text'></input></div>"),q=p.find("input");q.addClass(this.toThemeProperty("jqx-input")),q.addClass(this.toThemeProperty("jqx-widget-content")),q.addClass(this.toThemeProperty("jqx-rc-all")),q.width(e-15),b.rtl&&(o.css("direction","rtl"),q.css("direction","rtl"));var r=a("<div class='filter' style='height: 25px; margin-left: 20px; margin-top: 7px;'></div>"),s=a('<span tabIndex=0 id="filterbutton'+b.element.id+'" class="filterbutton" style="padding: 4px 12px; margin-left: 2px;">'+b.gridlocalization.filterstring+"</span>");r.append(s);var t=a('<span tabIndex=0 id="filterclearbutton'+b.element.id+'" class="filterclearbutton" style="padding: 4px 12px; margin-left: 5px;">'+b.gridlocalization.filterclearstring+"</span>");r.append(t),s.jqxButton({height:20,theme:b.theme}),t.jqxButton({height:20,theme:b.theme});var u=function(a){if(a){if(a.text().indexOf("case sensitive")!=-1){var c=a.text();c=c.replace("case sensitive","match case"),a.text(c)}return a.css("font-family",b.host.css("font-family")),a.css("font-size",b.host.css("font-size")),a.css("top","1px"),a.css("position","relative"),a}return""};if("default"===this.filtermode){f.append(g),f.append(h),h.jqxDropDownList({_checkForHiddenParent:!1,rtl:b.rtl,enableBrowserBoundsDetection:!1,selectedIndex:2,width:e-15,height:20,dropDownHeight:150,dropDownWidth:e-15,selectionRenderer:u,source:l,theme:b.theme}),f.append(n);var v=new Array;v[0]=b.gridlocalization.filterandconditionstring,v[1]=b.gridlocalization.filterorconditionstring,i.jqxDropDownList({_checkForHiddenParent:!1,rtl:b.rtl,enableBrowserBoundsDetection:!1,autoDropDownHeight:!0,selectedIndex:0,width:60,height:20,source:v,selectionRenderer:u,theme:b.theme}),f.append(i),j.jqxDropDownList({_checkForHiddenParent:!1,rtl:b.rtl,enableBrowserBoundsDetection:!1,selectedIndex:2,width:e-15,height:20,dropDownHeight:150,dropDownWidth:e-15,selectionRenderer:u,source:l,theme:b.theme}),f.append(j),f.append(p)}else{f.append(g),f.append(h),h.jqxListBox({rtl:b.rtl,_checkForHiddenParent:!1,checkboxes:!0,selectedIndex:2,width:e-15,height:120,theme:b.theme});var w=!0;b.addHandler(h,"checkChange",function(a){if(w)if(a.args.label!=b.gridlocalization.filterselectallstring){w=!1,h.jqxListBox("checkIndex",0,!0,!1);var c=h.jqxListBox("getCheckedItems"),d=h.jqxListBox("getItems");1==c.length?h.jqxListBox("uncheckIndex",0,!0,!1):d.length!=c.length&&h.jqxListBox("indeterminateIndex",0,!0,!1),w=!0}else w=!1,a.args.checked?h.jqxListBox("checkAll",!1):h.jqxListBox("uncheckAll",!1),w=!0})}f.append(r),b.updatefilterpanel&&b.updatefilterpanel(h,j,i,n,p,s,t,null,null,l)}})}(jQuery);
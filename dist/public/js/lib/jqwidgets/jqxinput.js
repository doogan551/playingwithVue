!function(a){a.jqx.jqxWidget("jqxInput","",{}),a.extend(a.jqx._jqxInput.prototype,{defineInstance:function(){this.disabled=!1,this.filter=this.filter||this._filter,this.sort=this.sort||this._sort,this.highlight=this.highlight||this._highlight,this.renderer=this.renderer||this._renderer,this.opened=!1,this.$popup=a("<ul></ul>"),this.source=[],this.roundedCorners=!0,this.searchMode="default",this.placeHolder="",this.width=null,this.height=null,this.value="",this.rtl=!1,this.displayMember="",this.valueMember="",this.events=["select","open","close"],this.popupZIndex=2e4,this.items=8,this.item='<li><a href="#"></a></li>',this.minLength=1,this.maxLength=null},createInstance:function(a){this.render()},render:function(){if("textarea"==this.element.nodeName.toLowerCase())this.element.style.overflow="auto";else if("div"==this.element.nodeName.toLowerCase()){this.baseHost=this.element;var b=this.host.find("input"),c=!1;if(a.each(b,function(){var d=this.type;if(null==d||"text"==d||"textarea"==d)return b=a(this),c=!0,!1}),!c)throw new Error("jqxInput: Missing Text Input in the Input Group");if(b.length>0){this.baseHost=a(this.element),this.host=b,this.element=b[0],this.baseHost.addClass(this.toThemeProperty("jqx-widget")),this.baseHost.addClass(this.toThemeProperty("jqx-rc-all")),this.baseHost.addClass(this.toThemeProperty("jqx-input-group"));var d=this.baseHost.children(),e=this;a.each(d,function(b){a(this).addClass(e.toThemeProperty("jqx-input-group-addon")),a(this).removeClass(e.toThemeProperty("jqx-rc-all")),0==b&&a(this).addClass(e.toThemeProperty("jqx-rc-l")),b==d.length-1&&a(this).addClass(e.toThemeProperty("jqx-rc-r")),this!=e.element&&a(this).addClass(e.toThemeProperty("jqx-fill-state-normal"))})}}this.addHandlers(),this.rtl&&this.host.addClass(this.toThemeProperty("jqx-rtl")),this.host.attr("role","textbox"),a.jqx.aria(this,"aria-autocomplete","both"),a.jqx.aria(this,"aria-disabled",this.disabled),a.jqx.aria(this,"aria-readonly",!1),a.jqx.aria(this,"aria-multiline",!1),this.source&&this.source.length&&a.jqx.aria(this,"aria-haspopup",!0),""!=this.value&&(this.element.value=this.value),this._oldsource=this.source,this._updateSource()},_updateSource:function(){var b=this,c=function(c){var d=new Array;return d=a.map(c,function(a){if(void 0==a)return null;if("string"==typeof a)return{label:a,value:a};if("string"!=typeof a){var c="",d="";return""!=b.displayMember&&void 0!=b.displayMember&&a[b.displayMember]&&(c=a[b.displayMember]),""!=b.valueMember&&void 0!=b.valueMember&&(d=a[b.valueMember]),""==c&&(c=a.label),""==d&&(d=a.value),{label:c,value:d}}return a})};if(this.source&&this.source._source){if(this.adapter=this.source,null!=this.adapter._source.localdata)this.adapter.unbindBindingUpdate(this.element.id),this.adapter.bindBindingUpdate(this.element.id,function(a){b.source=c(b.adapter.records)});else{var d={};this.adapter._options.data?a.extend(b.adapter._options.data,d):(this.source._source.data&&a.extend(d,this.source._source.data),this.adapter._options.data=d),this.adapter.unbindDownloadComplete(this.element.id),this.adapter.bindDownloadComplete(this.element.id,function(a){b.source=c(b.adapter.records)})}return void this.source.dataBind()}a.isFunction(this.source)||(this.source=c(this.source))},_refreshClasses:function(b){var c=b?"addClass":"removeClass";this.host[c](this.toThemeProperty("jqx-widget-content")),this.host[c](this.toThemeProperty("jqx-input")),this.host[c](this.toThemeProperty("jqx-widget")),this.$popup[c](this.toThemeProperty("jqx-popup")),a.jqx.browser.msie&&this.$popup[c](this.toThemeProperty("jqx-noshadow")),this.$popup[c](this.toThemeProperty("jqx-input-popup")),this.$popup[c](this.toThemeProperty("jqx-menu")),this.$popup[c](this.toThemeProperty("jqx-menu-vertical")),this.$popup[c](this.toThemeProperty("jqx-menu-dropdown")),this.$popup[c](this.toThemeProperty("jqx-widget")),this.$popup[c](this.toThemeProperty("jqx-widget-content")),this.roundedCorners&&(this.host[c](this.toThemeProperty("jqx-rc-all")),this.$popup[c](this.toThemeProperty("jqx-rc-all"))),this.disabled?this.host[c](this.toThemeProperty("jqx-fill-state-disabled")):this.host.removeClass(this.toThemeProperty("jqx-fill-state-disabled"))},selectAll:function(){var a=this.host;setTimeout(function(){if("selectionStart"in a[0])a[0].focus(),a[0].setSelectionRange(0,a[0].value.length);else{var b=a[0].createTextRange();b.collapse(!0),b.moveEnd("character",a[0].value.length),b.moveStart("character",0),b.select()}},10)},selectLast:function(){var a=this.host;this.selectStart(a[0].value.length)},selectFirst:function(){this.host;this.selectStart(0)},selectStart:function(a){var b=this.host;setTimeout(function(){if("selectionStart"in b[0])b[0].focus(),b[0].setSelectionRange(a,a);else{var c=b[0].createTextRange();c.collapse(!0),c.moveEnd("character",a),c.moveStart("character",a),c.select()}},10)},focus:function(){try{this.host.focus();var a=this;setTimeout(function(){a.host.focus()},25)}catch(b){}},resize:function(a,b){this.width=a,this.height=b,this.refresh()},refresh:function(){if(this._refreshClasses(!1),this._refreshClasses(!0),this.baseHost){if(this.width&&this.baseHost.width(this.width),this.height){this.baseHost.height(this.height);var b=this,c=0,d=this.baseHost.height()-2;a.jqx.browser.msie&&a.jqx.browser.version<8&&this.baseHost.css("display","inline-block"),a.each(this.baseHost.children(),function(){a(this).css("height","100%"),a.jqx.browser.msie&&a.jqx.browser.version<8&&a(this).css("height",d+"px"),this!==b.element&&(c+=a(this).outerWidth()+2)}),this.host.css("width",this.baseHost.width()-c-4+"px"),a.jqx.browser.msie&&a.jqx.browser.version<9&&(this.host.css("min-height",d+"px"),this.host.css("line-height",d+"px"))}}else this.width&&this.host.width(this.width),this.height&&this.host.height(this.height);this.host.attr("disabled",this.disabled),this.maxLength&&this.host.attr("maxlength",this.maxLength),this.host.attr("placeholder")||this._refreshPlaceHolder()},_refreshPlaceHolder:function(){if("placeholder"in this.element)this.host.attr("placeHolder",this.placeHolder);else{var a=this;""==this.element.value&&(this.element.value=this.placeHolder,this.host.focus(function(){a.element.value==a.placeHolder&&(a.element.value="")}),this.host.blur(function(){""!=a.element.value&&a.element.value!=a.placeHolder||(a.element.value=a.placeHolder)}))}},destroy:function(){this.removeHandlers(),this.host.remove(),this.$popup&&this.$popup.remove()},propertyChangedHandler:function(b,c,d,e){return"placeHolder"==c?void b._refreshPlaceHolder():"opened"==c?void(e?b.open():b.close()):("source"==c&&(b._oldsource=e,b._updateSource()),"displayMember"!=c&&"valueMember"!=c||(b.source=b._oldsource,b._updateSource()),"disabled"==c&&a.jqx.aria(b,"aria-disabled",b.disabled),"value"==c&&(b.element.value=e),void b.refresh())},select:function(a,b){var c=this.$popup.find(".jqx-fill-state-pressed").attr("data-value"),d=this.$popup.find(".jqx-fill-state-pressed").attr("data-name");return this.element.value=this.renderer(d,this.element.value),this.selectedItem={label:d,value:c},this.host.attr("data-value",c),this.host.attr("data-label",d),this._raiseEvent("0",{item:{label:d,value:c},label:d,value:c}),this.close()},val:function(a){return 0==arguments.length||null!=a&&"object"==typeof a&&!a.label&&!a.value?""!=this.displayMember&&""!=this.valueMember&&this.selectedItem?this.selectedItem:this.element.value:a&&a.label?(this.selectedItem={label:a.label,value:a.value},this.host.attr("data-value",a.value),this.host.attr("data-label",a.label),this.value=a,this.element.value=a.label,this.element.value):(this.value=a,this.element.value=a,this.host.attr("data-value",a),this.host.attr("data-label",a),this.element.value)},_raiseEvent:function(a,b){void 0==b&&(b={owner:null});var c=this.events[a];b.owner=this;var d=new jQuery.Event(c);d.owner=this,d.args=b,d.preventDefault&&d.preventDefault();var e=this.host.trigger(d);return e},_renderer:function(a){return a},open:function(){if(!a.jqx.isHidden(this.host)){var b=a.extend({},this.host.coord(!0),{height:this.host[0].offsetHeight});if(0==this.$popup.parent().length){var c=this.element.id+"_popup";this.$popup[0].id=c,a.jqx.aria(this,"aria-owns",c)}this.$popup.appendTo(a(document.body)).css({position:"absolute",zIndex:this.popupZIndex,top:b.top+b.height,left:b.left}).show();var d=0,e=this.$popup.children();return a.each(e,function(){d+=a(this).outerHeight(!0)-1}),this.$popup.height(d),this.opened=!0,this._raiseEvent("1",{popup:this.$popup}),a.jqx.aria(this,"aria-expanded",!0),this}},close:function(){return this.$popup.hide(),this.opened=!1,this._raiseEvent("2",{popup:this.$popup}),a.jqx.aria(this,"aria-expanded",!1),this},suggest:function(b){var c;return this.query=this.element.value,!this.query||this.query.length<this.minLength?this.opened?this.close():this:(c=a.isFunction(this.source)?this.source(this.query,a.proxy(this.load,this)):this.source,c?this.load(c):this)},load:function(b){var c=this;return b=a.grep(b,function(a){return c.filter(a)}),b=this.sort(b),b.length?this._render(b.slice(0,this.items)).open():this.opened?this.close():this},_filter:function(b){var c=this.query,d=b;switch(null!=b.label?d=b.label:this.displayMember&&(d=b[this.displayMember]),this.searchMode){case"containsignorecase":default:return a.jqx.string.containsIgnoreCase(d,c);case"contains":return a.jqx.string.contains(d,c);case"equals":return a.jqx.string.equals(d,c);case"equalsignorecase":return a.jqx.string.equalsIgnoreCase(d,c);case"startswith":return a.jqx.string.startsWith(d,c);case"startswithignorecase":return a.jqx.string.startsWithIgnoreCase(d,c);case"endswith":return a.jqx.string.endsWith(d,c);case"endswithignorecase":return a.jqx.string.endsWithIgnoreCase(d,c)}},_sort:function(a){for(var b,c=[],d=[],e=[],f=0;f<a.length;f++){var b=a[f],g=b;b.label?g=b.label:this.displayMember&&(g=b[this.displayMember]),0===g.toLowerCase().indexOf(this.query.toLowerCase())?c.push(b):g.indexOf(this.query)>=0?d.push(b):g.toLowerCase().indexOf(this.query.toLowerCase())>=0&&e.push(b)}return c.concat(d,e)},_highlight:function(a){var b=this.query;b=b.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var c=new RegExp("("+b+")","ig");return a.replace(c,function(a,b){return"<b>"+b+"</b>"})},_render:function(b){var c=this;return b=a(b).map(function(b,d){var e=d;b=void 0!=d.value?void 0!=d.label?a(c.item).attr({"data-name":d.label,"data-value":d.value}):a(c.item).attr({"data-name":d.value,"data-value":d.value}):void 0!=d.label?a(c.item).attr({"data-value":d.label,"data-name":d.label}):void 0!=c.displayMember&&""!=c.displayMember?a(c.item).attr({"data-name":d[c.displayMember],"data-value":d[c.valueMember]}):a(c.item).attr({"data-value":d,"data-name":d}),d.label?e=d.label:c.displayMember&&(e=d[c.displayMember]),b.find("a").html(c.highlight(e));var f="";return c.rtl&&(f=" "+c.toThemeProperty("jqx-rtl")),b[0].className=c.toThemeProperty("jqx-item")+" "+c.toThemeProperty("jqx-menu-item")+" "+c.toThemeProperty("jqx-rc-all")+f,b[0]}),b.first().addClass(this.toThemeProperty("jqx-fill-state-pressed")),this.$popup.html(b),this.$popup.width(this.host.outerWidth()-6),this},next:function(b){var c=this.$popup.find(".jqx-fill-state-pressed").removeClass(this.toThemeProperty("jqx-fill-state-pressed")),d=c.next();d.length||(d=a(this.$popup.find("li")[0])),d.addClass(this.toThemeProperty("jqx-fill-state-pressed"))},prev:function(a){var b=this.$popup.find(".jqx-fill-state-pressed").removeClass(this.toThemeProperty("jqx-fill-state-pressed")),c=b.prev();c.length||(c=this.$popup.find("li").last()),c.addClass(this.toThemeProperty("jqx-fill-state-pressed"))},addHandlers:function(){this.addHandler(this.host,"focus",a.proxy(this.onFocus,this)),this.addHandler(this.host,"blur",a.proxy(this.onBlur,this)),this.addHandler(this.host,"keypress",a.proxy(this.keypress,this)),this.addHandler(this.host,"keyup",a.proxy(this.keyup,this)),this.addHandler(this.host,"keydown",a.proxy(this.keydown,this)),this.addHandler(this.$popup,"mousedown",a.proxy(this.click,this)),this.host.on?this.$popup.on("mouseenter","li",a.proxy(this.mouseenter,this)):this.$popup.bind("mouseenter","li",a.proxy(this.mouseenter,this))},removeHandlers:function(){this.removeHandler(this.host,"focus",a.proxy(this.onFocus,this)),this.removeHandler(this.host,"blur",a.proxy(this.onBlur,this)),this.removeHandler(this.host,"keypress",a.proxy(this.keypress,this)),this.removeHandler(this.host,"keyup",a.proxy(this.keyup,this)),this.removeHandler(this.host,"keydown",a.proxy(this.keydown,this)),this.removeHandler(this.$popup,"mousedown",a.proxy(this.click,this)),this.host.off?this.$popup.off("mouseenter","li",a.proxy(this.mouseenter,this)):this.$popup.unbind("mouseenter","li",a.proxy(this.mouseenter,this))},move:function(a){if(this.opened){switch(a.keyCode){case 9:case 13:case 27:a.preventDefault();break;case 38:a.preventDefault(),this.prev();break;case 40:a.preventDefault(),this.next()}a.stopPropagation()}},keydown:function(b){this.suppressKeyPressRepeat=~a.inArray(b.keyCode,[40,38,9,13,27]),this.move(b)},keypress:function(a){this.suppressKeyPressRepeat||this.move(a)},keyup:function(a){switch(a.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.opened)return;this.select(a,this);break;case 27:if(!this.opened)return;this.close();break;default:var b=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){b.suggest()},300)}a.stopPropagation(),a.preventDefault()},clear:function(){this.host.val("")},onBlur:function(a){var b=this;setTimeout(function(){b.close()},150),b.host.removeClass(b.toThemeProperty("jqx-fill-state-focus")),this.value=this.host.val()},onFocus:function(a){var b=this;b.host.addClass(b.toThemeProperty("jqx-fill-state-focus"))},click:function(a){a.stopPropagation(),a.preventDefault(),this.select(a,this)},mouseenter:function(b){this.$popup.find(".jqx-fill-state-pressed").removeClass(this.toThemeProperty("jqx-fill-state-pressed")),a(b.currentTarget).addClass(this.toThemeProperty("jqx-fill-state-pressed"))}})}(jQuery);
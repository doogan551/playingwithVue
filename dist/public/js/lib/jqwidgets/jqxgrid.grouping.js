!function(a){a.jqx.dataview.grouping=function(){this.loadgrouprecords=function(b,c,d,e,f,g,h,i,j){for(var k=b,l=this,m=new Array,n=0;n<l.groups.length;n++)m[n]=l.generatekey();var o=new Array,p=0,m=m,q=new Array,r=c,s=c,t=l.groups.length;this.loadedrecords=new Array,this.bounditems=new Array,this.loadedrecords=new Array,this.loadedrootgroups=new Array,this.loadedgroups=new Array,this.loadedgroupsByKey=new Array,this.sortedgroups=new Array;var u=null!=this.sortdata,v=u?this.sortdata:this.records;if(this.pageable){var w=Object.prototype.toString,x=this.groups[0];if(Object.prototype.toString="function"==typeof x?x:function(){return this[x]},u){var y=this.sortfield;Object.prototype.toString="function"==typeof x?x:function(){return this[x]+" "+this[y]}}var z=new Array,A=0;a.each(v,function(){z[c+A++]=this}),v=z,u?v.sort(function(b,c){var b=b.value,c=c.value;if(void 0===b&&(b=null),void 0===c&&(c=null),null===b&&null===c)return 0;if(null===b&&null!==c)return 1;if(null!==b&&null===c)return-1;if(a.jqx.dataFormat.isNumber(b)&&a.jqx.dataFormat.isNumber(c))return b<c?-1:b>c?1:0;if(a.jqx.dataFormat.isDate(b)&&a.jqx.dataFormat.isDate(c))return b<c?-1:b>c?1:0;a.jqx.dataFormat.isNumber(b)||a.jqx.dataFormat.isNumber(c)||(b=String(b).toLowerCase(),c=String(c).toLowerCase());try{if(b<c)return-1;if(b>c)return 1}catch(d){}return 0}):v.sort(function(b,c){if(void 0===b&&(b=null),void 0===c&&(c=null),null===b&&null===c)return 0;if(null===b&&null!==c)return 1;if(null!==b&&null===c)return-1;if(b=b.toString(),c=c.toString(),a.jqx.dataFormat.isNumber(b)&&a.jqx.dataFormat.isNumber(c))return b<c?-1:b>c?1:0;if(a.jqx.dataFormat.isDate(b)&&a.jqx.dataFormat.isDate(c))return b<c?-1:b>c?1:0;a.jqx.dataFormat.isNumber(b)||a.jqx.dataFormat.isNumber(c)||(b=String(b).toLowerCase(),c=String(c).toLowerCase());try{if(b<c)return-1;if(b>c)return 1}catch(d){}return 0}),Object.prototype.toString=w}if(this.virtualmode){for(var z=new Array,A=0,r=0;r<d-c;r++)z[c+A++]=v[r];r=0,v=z}for(var B=c;B<d;B++){var C={};C=u?a.extend({},v[B].value):a.extend({},v[B]),id=C[l.uniqueId],(f>=i||id!=h[f][l.uniqueId]||g&&g[id])&&(j[j.length]=f);for(var D=new Array,E=0,n=0;n<t;n++){var F=l.groups[n],G=C[F];null==G&&(G=""),D[E++]={value:G,hash:m[n]}}if(D.length!=t)break;for(var H=null,I="",J=-1,K=0;K<D.length;K++){J++;var L=D[K].value,M=D[K].hash;if(I=I+"_"+M+"_"+L,void 0==q[I]||null==q[I]){if(null==H)H={group:L,subItems:new Array,subGroups:new Array,level:0},o[p++]=H,H.uniqueid=l.generatekey(),l.loadedgroupsByKey[L]=H;else{var N={group:L,subItems:new Array,subGroups:new Array,parentItem:H,level:H.level+1};l.loadedgroupsByKey[H.uniqueid+"_"+L]=N,N.uniqueid=l.generatekey(),H.subGroups[H.subGroups.length++]=N,H=N}q[I]=H}else H=q[I]}null!=H?(C.uid||(C.uid=this.getid(this.source.id,C,r)),u?(C.boundindex=v[B].index,this.recordsbyid["id"+C.uid]=v[B].value):(C.boundindex=r,this.recordsbyid["id"+C.uid]=v[B]),this.bounditems[C.boundindex]=C,this.sortedgroups[r]=C,C.uniqueid=l.generatekey(),C.parentItem=H,C.level=H.level+1,H.subItems[H.subItems.length++]=C):(C.uid||(C.uid=this.getid(this.source.id,C,r)),u?(C.boundindex=v[B].index,this.recordsbyid["id"+C.uid]=v[B].value):(C.boundindex=r,this.recordsbyid["id"+C.uid]=v[B]),this.sortedgroups[r]=C,this.bounditems[C.boundindex]=C,C.uniqueid=l.generatekey()),f++,r++,s++}var O=function(a,c,d){for(var e=0;e<c.subItems.length;e++)c.subItems[e].visibleindex=b+d,a.rows[d]=c.subItems[e],a.loadedrecords[d]=c.subItems[e],d++;return d},P=function(a,c,d){var e=function(c){if(1==a.aggregates){var e=c,f={};null!=e&&(f.level=e.level,f.visibleindex=b+d,f.uniqueid=a.generatekey(),a.rows[d]=f,a.loadedrecords[d++]=f,f.totalsrow=!0,c.subItems.length>0?(e=c.subItems[c.subItems.length-1],f.parentItem=e.parentItem,f.parentItem.subItems&&(f.parentItem.subItems[f.parentItem.subItems.length]=f)):c.subGroups.length>0&&(e=c.subGroups[c.subGroups.length-1],f.level=e.level,f.parentItem=c,c.subGroups[c.subGroups.length]=f))}};for(subGroup in c.subGroups){var f=c.subGroups[subGroup];f.subGroups&&(a.loadedgroups[a.loadedgroups.length]=f,f.visibleindex=b+d,a.rows[d]=f,a.loadedrecords[d]=f,d++,f.subGroups.length>0?d=P(a,f,d):f.subItems.length>0&&(d=O(a,f,d)),e(f))}return c.subItems.length>0&&(d=O(a,c,d)),e(c),d},Q=o.length;this.loadedgroups=new Array,this.rows=new Array;for(var k=0,r=0;r<Q;r++){var F=o[r];this.loadedrootgroups[r]=F,this.loadedgroups[this.loadedgroups.length]=F,F.visibleindex=b+k,this.rows[k]=F,this.loadedrecords[k]=F,k++,k=P(this,F,k)}return k},this._updategroupsinpage=function(b,c,d,e,f,g,h){var i=new Array,j=[];if(this.groupable&&this.groups.length>0){for(var k=0,l=new Array,m=new Array,n=0;n<b.groups.length;n++)m[n]=b.generatekey();var o=0,p=new Array,q=0;h>this.totalrecords&&(h=this.totalrecords);for(var r=g;r<h;r++){var s=a.extend({},b.sortedgroups[r]);if(id=s[b.uniqueId],!b.pagesize||d>=b.pagesize*b.pagenum&&d<b.pagesize*(b.pagenum+1)){(e>=f||id!=i[e][b.uniqueId]||updated&&updated[id])&&(j[j.length]=e);for(var t=new Array,u=0,n=0;n<b.groups.length;n++){var v=b.groups[n],w=s[v];null==w&&(w=""),t[u++]={value:w,hash:m[n]}}if(t.length!=b.groups.length)break;for(var x=null,y="",z=-1,A=0;A<t.length;A++){z++;var B=t[A].value,C=t[A].hash;if(y=y+"_"+C+"_"+B,void 0==l[y]||null==l[y]){if(null==x){x={group:B,subItems:new Array,subGroups:new Array,level:0},p[q++]=x;var D=b.loadedgroupsByKey[B];void 0!=D&&(x.visibleindex=D.visibleindex,x.uniqueid=D.uniqueid)}else{var E={group:B,subItems:new Array,subGroups:new Array,parentItem:x,level:x.level+1},D=b.loadedgroupsByKey[x.uniqueid+"_"+B];E.visibleindex=D.visibleindex,E.uniqueid=D.uniqueid,x.subGroups[x.subGroups.length++]=E,x=E}l[y]=x}else x=l[y]}null!=x&&(s.parentItem=x,s.level=x.level+1,x.subItems[x.subItems.length++]=s),e++}o++,d++}for(var F=function(b,c,d){for(var e=0;e<c.subItems.length;e++)i[d]=a.extend({},c.subItems[e]),d++;return d},G=function(a){var b=!1;for(subGroup in a.subGroups){var c=a.subGroups[subGroup];if(c.subGroups){if(c.subGroups.length>0){var d=G(c);if(d)return b=!0,!0}if(c.subItems.length>0)return b=!0,!0}}return a.subItems.length>0?(b=!0,!0):b},H=function(a,b,c){for(subGroup in b.subGroups){var d=b.subGroups[subGroup];d.subGroups&&G(d)&&(i[c]=d,c++,d.subGroups.length>0?c=H(a,d,c):d.subItems.length>0&&(c=F(a,d,c)))}return b.subItems.length>0&&(c=F(a,b,c)),c},o=0;o<p.length;o++){var v=p[o];G(v)&&(i[k]=v,k++,k=H(this,v,k))}}return i}},a.extend(a.jqx._jqxGrid.prototype,{_initgroupsheader:function(){if(this.groupsheader.css("visibility","hidden"),this._groupsheader()){this.groupsheader.css("visibility","inherit");var b=this,c=this.gridlocalization.groupsheaderstring;this.groupsheaderdiv=this.groupsheaderdiv||a('<div style="width: 100%; position: relative;"></div>'),this.groupsheaderdiv.height(this.groupsheaderheight),this.groupsheaderdiv.css("top",0),this.groupsheader.append(this.groupsheaderdiv),this.groupheadersbounds=new Array;var d=this.groups.length;this.groupsheaderdiv.children().remove(),this.groupsheaderdiv[0].innerHTML="";var e=new Array;if(d>0)a.each(this.groups,function(c){var f=this,g=b._getColumnText(this),h=g.label,i=b._rendergroupcolumn(h,f);if(i.addClass(b.toThemeProperty("jqx-grid-group-column")),b.groupsheaderdiv.append(i),b.closeablegroups){var j=a(i.find(".jqx-icon-close"));b.isTouchDevice()&&b.touchmode!==!0?b.addHandler(j,"touchstart",function(){return b.removegroupat(c),!1}):b.addHandler(j,"click",function(){return b.removegroupat(c),!1})}if(b.sortable&&b.addHandler(i,"click",function(){var a=b.getcolumn(f);return null!=a&&b._togglesort(a),!1}),e[e.length]=i,b._handlegroupstocolumnsdragdrop(this,i),c<d-1){var k=i.height(),l=a('<div style="float: left; position: relative;"></div>');b.rtl&&l.css("float","right"),l.width(b.groupindentwidth/3),l.height(1),l.css("top",k/2),l.addClass(b.toThemeProperty("jqx-grid-group-column-line")),b.groupsheaderdiv.append(l)}});else{var f=a('<div style="position: relative;">'+c+"</div>");this.groupsheaderdiv.append(f),this.rtl&&f.addClass(this.toThemeProperty("jqx-rtl"))}this._groupheaders=e,this._updategroupheadersbounds()}},_updategroupheadersbounds:function(){var b=this,c=this.groupsheaderdiv.children().outerHeight(),d=(this.groupsheader.height()-c)/2;this.groupsheaderdiv.css("top",d),this.rtl?this.groupsheaderdiv.css("right",d):this.groupsheaderdiv.css("left",d),this.rtl&&this._groupheaders.reverse(),a.each(this._groupheaders,function(a){var c=this.coord();b.groupheadersbounds[a]={left:c.left,top:c.top,width:this.outerWidth(),height:this.outerHeight(),index:a}})},addgroup:function(a){if(a){var b=this;b.groups!==b.dataview.groups&&(b.dataview.groups=b.groups),b.groups[b.groups.length]=a,b.refreshgroups(),this._raiseEvent(12,{type:"Add",index:b.groups[b.groups.length],groups:b.groups})}},insertgroup:function(a,b){if(void 0!=a&&null!=a&&a>=0&&a<=this.groups.length&&b){var c=this;c.groups!==c.dataview.groups&&(c.dataview.groups=c.groups),c.groups.splice(a,0,b.toString()),c.refreshgroups(),this._raiseEvent(12,{type:"Insert",index:a,groups:c.groups})}},refreshgroups:function(){this._refreshdataview(),this._render(!0,!0,!0,!1)},_insertaftergroup:function(a,b){var c=this._getGroupIndexByDataField(a);this.insertgroup(c+1,b)},_insertbeforegroup:function(a,b){var c=this._getGroupIndexByDataField(a);this.insertgroup(c,b)},removegroupat:function(a){if(a>=0&&null!=a&&void 0!=a){var b=this;return b.groups!==b.dataview.groups&&(b.dataview.groups=b.groups),b.groups.splice(a,1),b.refreshgroups(),b.virtualmode&&b.updatebounddata(),this._raiseEvent(12,{type:"Remove",index:a,groups:b.groups}),!0}return!1},cleargroups:function(){var a=this;return a.groups=[],a.dataview.groups=a.groups,a.refreshgroups(),this._raiseEvent(12,{type:"Clear",groups:a.groups}),!0},removegroup:function(a){if(null==a)return!1;var b=this.groups.indexOf(a.toString());return this.removegroupat(b)},getrootgroupscount:function(){var a=this.dataview.loadedrootgroups.length;return a},collapsegroup:function(a){return this._setrootgroupstate(a,!1)},expandgroup:function(a){return this._setrootgroupstate(a,!0)},collapseallgroups:function(a){this._setbatchgroupstate(!1,a)},expandallgroups:function(a){this._setbatchgroupstate(!0,a)},getgroup:function(b){var c=this.dataview.loadedrootgroups[b];if(null==c)return null;var d=this.expandedgroups[c.uniqueid].expanded,e=c.group,f=c.level,g=new Array;this._getsubgroups(g,c);var h=this,i={group:e,level:f,expanded:d,subgroups:g};if(c.subItems){var j=new Array;a.each(c.subItems,function(){var a=this.boundindex;j[j.length]=h.getrowdata(a)}),j.length>0&&(i.subrows=j)}return i},getrootgroups:function(){for(var a=this.dataview.loadedrootgroups.length,b=new Array,c=0;c<a;c++)b[c]=this.getgroup(c);return b},_getsubgroups:function(b,c){var d=this;for(obj in c.subGroups){var e=c.subGroups[obj],f=d.expandedgroups[e.uniqueid].expanded,g=e.group,h=e.level;if(b[b.length]={group:g,level:h,expanded:f},e.subItems){var i=new Array;a.each(e.subItems,function(){var a=this.boundindex;i[i.length]=d.getrowdata(a)}),b[b.length-1].subrows=i}if(e.subGroups){var j=new Array;d._getsubgroups(j,e)}}return b},_setbatchgroupstate:function(a,b){var c=this;for(obj in this.dataview.loadedrootgroups)c._setrootgroupstate(obj,a,!1,!0);if(0==b)return c._requiresupdate=!0,c._renderrows(c.virtualsizeinfo),!0;var d=this.vScrollBar[0].style.visibility;return this.rendergridcontent(!0,!1),(d!=this.vScrollBar[0].style.visibility||this._hiddencolumns)&&(this._updatecolumnwidths(),this._updatecellwidths(),this._renderrows(this.virtualsizeinfo)),!0},_setrootgroupstate:function(a,b,c,d){if(void 0==a||null==a||a<0)return!1;if(!this.groupable||0==this.groups.length)return!1;var e=void 0==c||c;if(a>=0&&a<this.dataview.loadedrootgroups.length){var f=this.dataview.loadedrootgroups[a];if(this.pageable){for(var g=new Array,h=0;h<this.dataview.rows.length;h++)null!=this.dataview.rows[h].group&&0===this.dataview.rows[h].level&&g.push(this.dataview.rows[h]);if(f=g[a],!f)return}return this._setgroupstate(f,b,e,d)}return!1},_togglegroupstate:function(a,b){if(null==a||void 0==a)return!1;var c=this.vScrollInstance.value,d=this.expandedgroups[a.uniqueid];d=void 0!=d&&d.expanded,d=!d;var e=this._setgroupstate(a,d,b);return 0!==c&&"hidden"!==this.vScrollBar.css("visibility")&&(c<=this.vScrollInstance.max?this.vScrollInstance.setPosition(c):this.vScrollInstance.setPosition(this.vScrollInstance.max)),e},_setgroupstate:function(a,b,c,d){if(null==a||void 0==a)return!1;var e=!1;this.editable&&this.editcell&&this.endcelledit(this.editcell.row,this.editcell.column,!1,!1);var f=this.expandedgroups[a.uniqueid];if(void 0==f&&(f={expanded:!1},e=!0),f.expanded!=b&&(e=!0),e){if(this.expandedgroups[a.uniqueid]={expanded:b,group:a},this._setsubgroupsvisibility(this,a,!b,d),c){var g=this.vScrollBar[0].style.visibility;this.rendergridcontent(!0,!1),(g!=this.vScrollBar[0].style.visibility||this._hiddencolumns)&&(this._updatecolumnwidths(),this._updatecellwidths(),this._renderrows(this.virtualsizeinfo))}return void 0!=this.suspendgroupevents&&0!=this.suspendgroupevents||(b?this._raiseEvent(4,{group:a.group,parentgroup:a.parentItem?a.parentItem.group:null,level:a.level,visibleindex:a.visibleindex}):this._raiseEvent(5,{group:a.group,parentgroup:a.parentItem?a.parentItem.group:null,level:a.level,visibleindex:a.visibleindex})),!0}return!1},_setgroupitemsvisibility:function(a,b,c){for(var d=0;d<b.subItems.length;d++)a._setrowvisibility(b.subItems[d].visibleindex,c,!1)},_setsubgroupsvisibility:function(a,b,c,d){if(null!=b.parentItem){if(this.hiddens[b.parentItem.visibleindex])return}else if(null==b.parentItem&&this.hiddens[b.visibleindex])return;for(subGroup in b.subGroups){var e=b.subGroups[subGroup];c||a._setrowvisibility(e.visibleindex,c,!1);var f=!c;d?this.expandedgroups[e.uniqueid]={expanded:f,group:e}:f=void 0!=a.expandedgroups[e.uniqueid]&&a.expandedgroups[e.uniqueid].expanded,e.subGroups&&(e.subGroups.length>0?a._setsubgroupsvisibility(a,e,!f||c,d):e.subItems.length>0&&a._setgroupitemsvisibility(a,e,!f||c)),c&&a._setrowvisibility(e.visibleindex,c,!1)}b.subItems&&b.subItems.length>0&&a._setgroupitemsvisibility(a,b,c)},_handlecolumnsdragdrop:function(){var b=this,c=-1,d=!1;if(b.groupable){var e="mousemove.grouping"+this.element.id,f="mousedown.grouping"+this.element.id,g="mouseup.grouping"+this.element.id,h=!1;this.isTouchDevice()&&this.touchmode!==!0&&(h=!0,e=a.jqx.mobile.getTouchEventName("touchmove")+".grouping"+this.element.id,f=a.jqx.mobile.getTouchEventName("touchstart")+".grouping"+this.element.id,g=a.jqx.mobile.getTouchEventName("touchend")+".grouping"+this.element.id),this.removeHandler(a(document),e),this.addHandler(a(document),e,function(e){if(!b.showgroupsheader)return!0;if(null!=b.dragcolumn){var f=parseInt(e.pageX),g=parseInt(e.pageY);if(h){var i=b.getTouches(e),j=i[0];f=parseInt(j.pageX),g=parseInt(j.pageY)}var k=b.host.coord(),l=parseInt(k.left),m=parseInt(k.top);void 0!=b.dragmousedownoffset&&null!=b.dragmousedownoffset||(b.dragmousedownoffset={left:0,top:0});var n=parseInt(f)-parseInt(b.dragmousedownoffset.left),o=parseInt(g)-parseInt(b.dragmousedownoffset.top);if(b.dragcolumn.css({left:n+"px",top:o+"px"}),d=!1,f>=l&&f<=l+b.host.width()&&g>=m&&g<=m+b.host.height()&&(d=!0),c=-1,d){b.dragcolumnicon.removeClass(b.toThemeProperty("jqx-grid-dragcancel-icon")),b.dragcolumnicon.addClass(b.toThemeProperty("jqx-grid-drag-icon"));var p=b.groupsheader.coord(),q=p.top+b.groupsheader.height(),r=a.data(b.dragcolumn[0],"datarecord");if(r)var s=b.groups.indexOf(r.toString());else var s=-1;var t=s==-1||b.groups.length>1&&s>-1;null!=b.dropline&&(g>=p.top&&g<=q?t&&(c=b._handlegroupdroplines(f)):b.dropline.fadeOut("slow"))}else null!=b.dropline&&b.dropline.fadeOut("slow"),b.dragcolumnicon.removeClass(b.toThemeProperty("jqx-grid-drag-icon")),b.dragcolumnicon.addClass(b.toThemeProperty("jqx-grid-dragcancel-icon"));if(h)return e.preventDefault(),e.stopPropagation(),!1}}),this.removeHandler(a(document),g),this.addHandler(a(document),g,function(e){if(!b.showgroupsheader)return!0;b.__drag=!1,a(document.body).removeClass("jqx-disableselect");var f=parseInt(e.pageX),g=parseInt(e.pageY);if(h){var i=b.getTouches(e),j=i[0];f=parseInt(j.pageX),g=parseInt(j.pageY)}var k=b.host.coord(),l=(parseInt(k.left),parseInt(k.top)),m=b.groupsheader.height();if(b.showtoolbar&&(l+=b.toolbarheight),b.dragstarted=!1,b.dragmousedown=null,null!=b.dragcolumn){var n=a.data(b.dragcolumn[0],"datarecord");if(b.dragcolumn.remove(),b.dragcolumn=null,null!=n){if(!b.getcolumn(n).groupable)return void(null!=b.dropline&&(b.dropline.remove(),b.dropline=null));if(d)if(c!=-1){var o=c.index,p=b.groups[o],q=b._getGroupIndexByDataField(n);q!=o&&(void 0!=q&&q>=0&&b.groups.splice(q,1),"before"==c.position?b.rtl?b._insertaftergroup(p,n):b._insertbeforegroup(p,n):b.rtl?b._insertbeforegroup(p,n):b._insertaftergroup(p,n))}else if(0==b.groups.length)g>l&&g<=l+m&&b.addgroup(n);else if(g>l+m){var q=b._getGroupIndexByDataField(n);b.removegroupat(q)}null!=b.dropline&&(b.dropline.remove(),b.dropline=null)}}})}},_getGroupIndexByDataField:function(a){for(var b=0;b<this.groups.length;b++)if(this.groups[b]==a)return b;return-1},_isColumnInGroups:function(a){for(var b=0;b<this.groups.length;b++)if(this.groups[b]==a)return!0;return!1},_handlegroupdroplines:function(b){var c=this,d=-1;return a.each(c.groupheadersbounds,function(a){if(b<=this.left+this.width/2){var e=this.left-3;return a>0&&(e=this.left-1-c.groupindentwidth/6),c.dropline.css("left",e),c.dropline.css("top",this.top),c.dropline.height(this.height),c.dropline.fadeIn("slow"),d={index:a,position:"before"},c.rtl&&(d={index:c.groupheadersbounds.length-1-a,position:"before"}),!1}b>=this.left+this.width/2&&(c.dropline.css("left",1+this.left+this.width),c.dropline.css("top",this.top),c.dropline.height(this.height),c.dropline.fadeIn("slow"),d={index:a,position:"after"},c.rtl&&(d={index:c.groupheadersbounds.length-1-a,position:"after"}))}),d},_handlegroupstocolumnsdragdrop:function(b,c){this.dragmousedown=null,this.dragmousedownoffset=null,this.dragstarted=!1,this.dragcolumn=null;var d,e=this,f="mousedown",g="mousemove",h=!1;this.isTouchDevice()&&this.touchmode!==!0&&(h=!0,f=a.jqx.mobile.getTouchEventName("touchstart"),g=a.jqx.mobile.getTouchEventName("touchmove")),this.addHandler(c,"dragstart",function(a){return!1}),this.addHandler(c,f,function(b){if(!e.showgroupsheader)return!0;var c=b.pageX,d=b.pageY;if(e.__drag=!0,e.dragmousedown={left:c,top:d},h){var f=e.getTouches(b),g=f[0];c=g.pageX,d=g.pageY,e.dragmousedown={left:c,top:d},b.preventDefault&&b.preventDefault()}var i=a(b.target).coord();e.dragmousedownoffset={left:parseInt(c)-parseInt(i.left),top:parseInt(d-i.top)}}),this.addHandler(c,g,function(f){if(!e.showgroupsheader)return!0;if(e.dragmousedown){if(d={left:f.pageX,top:f.pageY},h){var g=e.getTouches(f),i=g[0];d={left:i.pageX,top:i.pageY}}if(!e.dragstarted&&null==e.dragcolumn){var j=Math.abs(d.left-e.dragmousedown.left),k=Math.abs(d.top-e.dragmousedown.top);(j>3||k>3)&&(e._createdragcolumn(c,d,!0),a(document.body).addClass("jqx-disableselect"),a.data(e.dragcolumn[0],"datarecord",b),f.preventDefault&&f.preventDefault())}}})},_createdragcolumn:function(b,c,d){var e=this,f=c;e.dragcolumn=a("<div></div>");var g=b.clone();e.dragcolumn.css("z-index",999999),g.css("border-width","1px"),g.css("opacity","0.4");var h=a(g.find("."+e.toThemeProperty("jqx-grid-column-menubutton")));h.length>0&&h.css("display","none");var i=a(g.find(".jqx-icon-close"));i.length>0&&i.css("display","none"),e.dragcolumnicon=a('<div style="z-index: 9999; position: absolute; left: 100%; top: 50%; margin-left: -18px; margin-top: -7px;"></div>'),e.dragcolumnicon.addClass(e.toThemeProperty("jqx-grid-drag-icon")),e.dragcolumn.css("float","left"),e.dragcolumn.css("position","absolute");e.host.coord();g.width(b.width()+16),e.dragcolumn.append(g),e.dragcolumn.height(b.height()),e.dragcolumn.width(g.width()),e.dragcolumn.append(e.dragcolumnicon),a(document.body).append(e.dragcolumn),g.css("margin-left",0),g.css("left",0),g.css("top",0),e.dragcolumn.css("left",f.left+e.dragmousedown.left),e.dragcolumn.css("top",f.top+e.dragmousedown.top),void 0!=d&&d&&(e.dropline=a('<div style="display: none; position: absolute;"></div>'),e.dropline.width(2),e.dropline.addClass(e.toThemeProperty("jqx-grid-group-drag-line")),a(document.body).append(e.dropline))},iscolumngroupable:function(a){return this._getcolumnproperty(a,"groupable")},_handlecolumnstogroupsdragdrop:function(b,c){this.dragmousedown=null,this.dragmousedownoffset=null,this.dragstarted=!1,this.dragcolumn=null;var d,e=this,f=!1;this.isTouchDevice()&&this.touchmode!==!0&&(f=!0);var g="mousedown.drag",d="mousemove.drag";f?(g=a.jqx.mobile.getTouchEventName("touchstart")+".drag",d=a.jqx.mobile.getTouchEventName("touchmove")+".drag"):this.addHandler(c,"dragstart",function(a){return!1}),this.addHandler(c,g,function(d){if(!e.showgroupsheader)return!0;if(e.__drag=!0,e._isColumnInGroups(b.displayfield))return"col-resize"!=c.css("cursor"),!0;if(0==b.groupable)return!0;var g=d.pageX,h=d.pageY;if(f){var i=e.getTouches(d),j=i[0];g=j.pageX,h=j.pageY}e.dragmousedown={left:g,top:h},f&&d.preventDefault&&d.preventDefault();var k=a(d.target).coord();e.dragmousedownoffset={left:parseInt(g)-parseInt(k.left),top:parseInt(h-k.top)}}),this.addHandler(c,d,function(g){if(!e.showgroupsheader)return!0;if(e._isColumnInGroups(b.displayfield))return"col-resize"!=c.css("cursor"),!0;if(e.dragmousedown){var h=g.pageX,i=g.pageY;if(f){var j=e.getTouches(g),k=j[0];h=k.pageX,i=k.pageY}if(d={left:h,top:i},!e.dragstarted&&null==e.dragcolumn){var l=Math.abs(d.left-e.dragmousedown.left),m=Math.abs(d.top-e.dragmousedown.top);(l>3||m>3)&&(e._createdragcolumn(c,d,!0),a.data(e.dragcolumn[0],"datarecord",b.displayfield),g.preventDefault&&g.preventDefault())}}})},_rendergroupcolumn:function(b,c){var d=a('<div style="float: left; position: relative;"></div>');if(this.rtl&&d.css("float","right"),null!=this.groupcolumnrenderer&&(d[0].innerHTML=this.groupcolumnrenderer(b),d.addClass(this.toThemeProperty("jqx-grid-group-column")),d.addClass(this.toThemeProperty("jqx-fill-state-normal"))),this.closeablegroups){""==d[0].innerHTML&&(d[0].innerHTML='<a style="float: left;" href="#">'+b+"</a>"),this.rtl&&(d[0].innerHTML='<a style="float: right;" href="#">'+b+"</a>");var e=this.rtl?"left":"right",f='<div style="float: '+e+'; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -18px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"></div></div>';if(a.jqx.browser.msie&&a.jqx.browser.version<8&&(f='<div style="float: left; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -18px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"></div></div>'),this.rtl){var f='<div style="float: '+e+'; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"></div></div>';a.jqx.browser.msie&&a.jqx.browser.version<8&&(f='<div style="float: left; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-icon-close")+'"></div></div>')}d[0].innerHTML+=f}else""==d[0].innerHTML&&(d[0].innerHTML='<a href="#">'+b+"</a>");if(this.sortable){var g=a('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"></div></div>'),h=a('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"></div></div>');if(this.closeablegroups)var g=a('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -32px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"></div></div>'),h=a('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 100%; top: 50%; margin-left: -32px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"></div></div>');if(this.rtl){var g=a('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 0px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"></div></div>'),h=a('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 0px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"></div></div>');if(this.closeablegroups)var g=a('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortascbutton")+'"></div></div>'),h=a('<div style="float: right; min-height: 16px; min-width: 18px;"><div style="position: absolute; left: 0px; top: 50%; margin-left: 16px; margin-top: -8px; float: none; width: 16px; height: 16px;" class="'+this.toThemeProperty("jqx-grid-column-sortdescbutton")+'"></div></div>')}g.css("display","none"),h.css("display","none"),a.jqx.browser.msie&&a.jqx.browser.version<8&&(g.css("float","left"),h.css("float","left")),d.append(g),d.append(h),a.data(document.body,"groupsortelements"+c,{sortasc:g,sortdesc:h})}return d.addClass(this.toThemeProperty("jqx-fill-state-normal")),d.addClass(this.toThemeProperty("jqx-grid-group-column")),d},_rendergroup:function(b,c,d,e,f,g,h){var i=c,j=c.cells[d.level];this.rtl&&(j=c.cells[c.cells.length-1-d.level]);var k=this._findgroupstate(d.uniqueid);if(d.bounddata.subGroups.length>0||d.bounddata.subItems.length>0){var l=this.rtl?"-rtl":"",m=this.toThemeProperty("jqx-icon-arrow-right");l&&(m=this.toThemeProperty("jqx-icon-arrow-left")),k?j.className+=" "+this.toThemeProperty("jqx-grid-group-expand"+l)+" "+this.toThemeProperty("jqx-icon-arrow-down"):j.className+=" "+this.toThemeProperty("jqx-grid-group-collapse"+l)+" "+m}var n=this._getColumnText(this.groups[d.level]).label,o=this.groupindentwidth,p=this.rowdetails&&this.showrowdetailscolumn?(1+b)*o:b*o,q=h-p,r=d.level+1;this.rtl&&(r=0);for(var s=i.cells[r],t=2;void 0!=s&&"none"==s.style.display&&t<i.cells.length-1;)s=i.cells[r+t-1],t++;var u=a(s);if(s){if(s.style.width=parseInt(q)+"px",s.className.indexOf("jqx-grid-cell-filter")!=-1&&u.removeClass(this.toThemeProperty("jqx-grid-cell-filter")),s.className.indexOf("jqx-grid-cell-sort")!=-1&&u.removeClass(this.toThemeProperty("jqx-grid-cell-sort")),s.className.indexOf("jqx-grid-cell-pinned")!=-1&&u.removeClass(this.toThemeProperty("jqx-grid-cell-pinned")),null!=this.groupsrenderer){var v={group:d.group,level:d.level,parent:d.bounddata.parentItem,subGroups:d.bounddata.subGroups,subItems:d.bounddata.subItems,groupcolumn:this._getColumnText(this.groups[d.level]).column},w=this.groupsrenderer(n+": "+d.group,d.group,k,v);if(w)s.innerHTML=w;else{var x=d.bounddata.subItems.length>0?d.bounddata.subItems.length:d.bounddata.subGroups.length;s.innerHTML='<div class="'+this.toThemeProperty("jqx-grid-groups-row")+'" style="position: absolute;"><span>'+n+': </span><span class="'+this.toThemeProperty("jqx-grid-groups-row-details")+'">'+d.group+" ("+x+")</span></div>"}}else{var y=this._getcolumnbydatafield(this.groups[d.level]),z=d.group;if(null==y)throw new Error("jqxGrid: Unable to find '"+this.groups[d.level]+"' group in the Grid's columns collection.");y.cellsformat&&a.jqx.dataFormat&&(a.jqx.dataFormat.isDate(z)?z=a.jqx.dataFormat.formatdate(z,y.cellsformat,this.gridlocalization):a.jqx.dataFormat.isNumber(z)&&(z=a.jqx.dataFormat.formatnumber(z,y.cellsformat,this.gridlocalization)));var x=d.bounddata.subItems.length>0?d.bounddata.subItems.length:d.bounddata.subGroups.length;s.innerHTML='<div class="'+this.toThemeProperty("jqx-grid-groups-row")+'" style="position: absolute;"><span>'+n+': </span><span class="'+this.toThemeProperty("jqx-grid-groups-row-details")+'">'+z+" ("+x+")</span></div>"}if(this.rtl){y||(y=this._getcolumnbydatafield(this.groups[d.level]));var A="hidden"==this.hScrollBar.css("visibility")?0:this.hScrollInstance.max-this.hScrollInstance.value,B="hidden"==this.vScrollBar.css("visibility")?0:this.scrollbarsize+6,p=this.rowdetails&&this.showrowdetailscolumn?(2+d.level)*o:(1+d.level)*o;s.style.width=h+parseInt(A)-p-B+"px",u.addClass(this.toThemeProperty("jqx-rtl"));var C=a(c.cells[c.cells.length-1]).css("z-index");u.css("z-index",C);var D=u.find("div"),q=D.width();D.css("left","100%");var E=null!=this.columns.records[c.cells.length-2-d.level]&&this.columns.records[c.cells.length-2-d.level].pinned;if(this.table.width()<h&&(h=this.table.width(),"hidden"!=this.vScrollBar.css("visibility")&&(h+=this.vScrollBar.outerWidth())),y.pinned||E)this.rowdetails&&this.showrowdetailscolumn&&(h+=30),D.css("margin-left",-q),s.style.width=h+A-p-B+"px";else{var A="hidden"==this.hScrollBar.css("visibility")?0:this.hScrollInstance.max;s.style.width=h+A-p-B+"px";var q=D.width();D.css("margin-left",-q)}}}}})}(jQuery);
!function(){function a(a,b){var c=a?a[b.full]||a[b.parent]||a[b.name]||{}:{};return i&&i(b,c,a),c}function b(a){var b,c,d,e,f,g,h,i,j={},k=a?a.shared||{}:{};for(g in a)if(b=a[g]||{},"shared"!==g)if(b instanceof Array)for(d=0,f=b.length;d<f;d++)e=b[d],j[e]=j[e]||{},j[e][g]=!0,j[e].settingType=j[e].settingType?"multiple":g;else if(b.constructor===Object)for(e in b){if(j[e]=j[e]||{},c=b[e],c="arrayChildId"!==g&&c&&c.constructor===String&&k[c]?k[c]:c,c&&c.constructor===Object)for(h in c)(i=c[h])&&i.constructor==String&&k[i]&&(c[h]=k[i]);j[e][g]=c,j[e].settingType=j[e].settingType?"multiple":g}return j}function c(a){return null===a||void 0===a}function d(a){return null===a||void 0===a||a.constructor===String||a.constructor===Number||a.constructor===Boolean||a instanceof Date}function e(b,g,h,i){var k,l,m,p,r,s,t,u,v,w,x;if(i=i||a(g,h),t=i.custom)v=!0,"function"==typeof t?(l=t(b),c(l)||(l.___$mapCustom=t)):(l=t.map(b),c(l)||(l.___$mapCustom=t.map,t.unmap&&(l.___$unmapCustom=t.unmap)));else if(i.append)v=!0,l=b;else{if(i.exclude)return v=!0,q;if(d(b))l=h.parentIsArray?b:n(b);else if(b instanceof Array){for(l=[],m=0,p=b.length;m<p;m++)l[m]=e(b[m],g,{name:"[i]",parent:h.name+"[i]",full:h.full+"[i]",parentIsArray:!0});h.parentIsArray&&!j||(s={name:"[i]",parent:h.name+"[i]",full:h.full+"[i]",parentIsArray:!0},l=o(l),(r=i.arrayChildId)&&(l.___$childIdName=r),l.pushFromModel=function(a){a=e(a,g,s),l.push(a)},l.unshiftFromModel=function(a){a=e(a,g,s),l.unshift(a)},l.popToModel=function(a){return a=l.pop(),f(a,s)},l.shiftToModel=function(a){return a=l.shift(),f(a,s)})}else if(b.constructor===Object){l={};for(m in b)s={name:m,parent:("[i]"===h.name?h.parent:h.name)+"."+m,full:h.full+"."+m},x=b[m],w=d(x)?a(g,s):void 0,w&&w.custom?(l.___$customChildren=l.___$customChildren||{},l.___$customChildren[m]=w.custom,"function"==typeof w.custom?l[m]=w.custom(b[m]):l[m]=w.custom.map(b[m])):(k=e(x,g,s,w),k!==q&&(l[m]=k))}}return!v&&(u=i.extend)&&("function"==typeof u?l=u(l)||l:u.constructor===Object&&("function"==typeof u.map&&(l=u.map(l)||l),"function"==typeof u.unmap&&(l.___$unmapExtend=u.unmap))),l}function f(a,b){var e,g,h,j,k,m,n=l(a),o=a!==n;if(i&&i(b),!o&&a&&a.constructor===Function)return q;if(a&&a.___$unmapCustom)e=a.___$unmapCustom(a);else if(o&&d(n)||c(n))e=n;else if(n instanceof Array)for(e=[],g=0,h=n.length;g<h;g++)e[g]=f(n[g],{name:"[i]",parent:b.name+"[i]",full:b.full+"[i]"});else if(n.constructor===Object){e={};for(g in n)"___$"!==g.substr(0,4)&&(a.___$customChildren&&a.___$customChildren[g]&&a.___$customChildren[g].unmap?e[g]=a.___$customChildren[g].unmap(n[g]):(k=n[g],ko.isComputed(k)||(j=l(k))&&j.constructor===Function||(m=f(k,{name:g,parent:("[i]"===b.name?b.parent:b.name)+"."+g,full:b.full+"."+g}),m!==q&&(e[g]=m))))}else o||"function"==typeof n||(e=n);return a&&a.___$unmapExtend&&(e=a.___$unmapExtend(e,a)),e}function g(a,b,e,f,h){var j,k,n,o,p,q,r,s,t,u,v,w,x,y,z,A=l(b),B=b!==A;if(i&&i(e),B&&c(A)^c(a))b(a);else if(a&&A&&A.constructor==Object&&a.constructor===Object)for(j in a)if(b.___$customChildren&&b.___$customChildren[j])x=b.___$customChildren[j].map||b.___$customChildren[j],A[j]=x(a[j]);else if(t=A[j],!B&&A.hasOwnProperty(j)&&(d(t)||t&&t.constructor===Array))A[j]=a[j];else if(t&&"function"==typeof t.___$mapCustom)m(t)?(w=t.___$mapCustom(a[j],t),w=l(w),t(w)):A[j]=t.___$mapCustom(a[j],t);else if(c(a[j])&&A[j]&&A[j].constructor===Object)A[j]=a[j];else if(h){var C=function(a,b,c){return function(){g(a[c],A[c],{name:c,parent:("[i]"===e.name?e.parent:e.name)+"."+c,full:e.full+"."+c},A,h),h(h()-1)}}(a,b,j);h(h()+1),setTimeout(C,0)}else g(a[j],A[j],{name:j,parent:("[i]"===e.name?e.parent:e.name)+"."+j,full:e.full+"."+j});else if(A&&A instanceof Array)if(r=b.___$childIdName){for(n=[],o=[],j=a.length-1;j>=0;j--)for(p=a[j][r],k=A.length-1;k>=0;k--)if(t=A[k],y=l(t),q=l(y[r]),q===p){if(t.___$mapCustom)ko.isObservable(t)?(z=t.___$mapCustom(a[j],t),m(z)&&z!=t&&t(l(z))):A[k]=t.___$mapCustom(a[j],t);else if(h){var D=function(a,b,c,d){return function(){g(a[c],A[d],{name:"[i]",parent:e.name+"[i]",full:e.full+"[i]"},void 0,h),h(h()-1)}}(a,b,j,k);h(h()+1),setTimeout(D,0)}else g(a[j],A[k],{name:"[i]",parent:e.name+"[i]",full:e.full+"[i]"});o[k]=!0,n[j]=!0;break}for(k=A.length-1;k>=0;k--)o[k]||b.splice(k,1);for(j=a.length-1;j>=0;j--)n[j]||b.pushFromModel(a[j])}else if(v=[],u=b.___$mapCustom,"function"==typeof u){for(j=0,s=a.length;j<s;j++)v[j]=a[j];b(u(v))}else for(b(v),j=0,s=a?a.length:0;j<s;j++)b.pushFromModel(a[j]);else B&&b(a);if("{root}"===e.name&&h)return{onComplete:function(a){a&&"function"==typeof a&&(h?ko.computed(function(){a&&0===h()&&(a(),a=void 0)}).extend({throttle:50}):a())}}}function h(a,b){j=a.makeChildArraysObservable,window.console&&a.logging?(console.log(b),i=function(a,b,c){var d;d=b&&b.settingType?b.settingType+" "+a.full+" (matched: '"+((c[a.full]?a.full:"")||(c[a.parent]?a.parent:"")||a.name)+"')":"default "+a.full,console.log("- "+d)}):i=void 0}var i,j,k,l=ko.utils.unwrapObservable,m=ko.isObservable,n=ko.observable,o=ko.observableArray,p={name:"{root}",parent:"{root}",full:"{root}"},q=function(){};k={options:{makeChildArraysObservable:!0,logging:!1},fromModel:function(a,c){var d=b(c);return h(this.options,"Mapping From Model"),e(a,d,p)},toModel:function(a){return h(this.options,"Mapping To Model"),f(a,p)},updateFromModel:function(a,b,c){var d=c?ko.observable(0):void 0;return h(this.options,"Update From Model"),g(b,a,p,void 0,d)}},ko.viewmodel=k}();
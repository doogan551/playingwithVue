-function(){function a(a,b){var c=a?a[b.full]||a[b.parent]||a[b.name]||{}:{};return h&&h(b,c,a),c}function b(a){return null===a||void 0===a}function c(a){return null===a||void 0===a||a.constructor===String||a.constructor===Number||a.constructor===Boolean||a instanceof Date}function d(f,g,h,j){var k,n,p,q,r,s,t;if(j=j||a(g,h),k=j.custom)s=!0,"function"==typeof k?(n=k(f),b(n)||(n.___$mapCustom=k)):(n=k.map(f),b(n)||(n.___$mapCustom=k.map,k.unmap&&(n.___$unmapCustom=k.unmap)));else if(j.append)s=!0,n=f;else{if(j.exclude)return s=!0,o;if(c(f))n=h.parentIsArray?f:l(f);else if(f instanceof Array){for(n=[],p=0,k=f.length;p<k;p++)n[p]=d(f[p],g,{name:"[i]",parent:h.name+"[i]",full:h.full+"[i]",parentIsArray:!0});h.parentIsArray&&!i||(q={name:"[i]",parent:h.name+"[i]",full:h.full+"[i]",parentIsArray:!0},n=m(n),(f=j.arrayChildId)&&(n.___$childIdName=f),n.pushFromModel=function(a){a=d(a,g,q),n.push(a)},n.unshiftFromModel=function(a){a=d(a,g,q),n.unshift(a)},n.popToModel=function(a){return a=n.pop(),e(a,q)},n.shiftToModel=function(a){return a=n.shift(),e(a,q)})}else if(f.constructor===Object)for(p in n={},f)q={name:p,parent:("[i]"===h.name?h.parent:h.name)+"."+p,full:h.full+"."+p},t=f[p],(k=c(t)?a(g,q):void 0)&&k.custom?(n.___$customChildren=n.___$customChildren||{},n.___$customChildren[p]=k.custom,n[p]="function"==typeof k.custom?k.custom(f[p]):k.custom.map(f[p])):(k=d(t,g,q,k),k!==o&&(n[p]=k))}return!s&&(r=j.extend)&&("function"==typeof r?n=r(n)||n:r.constructor===Object&&("function"==typeof r.map&&(n=r.map(n)||n),"function"==typeof r.unmap&&(n.___$unmapExtend=r.unmap))),n}function e(a,d){var f,g,i,k,l=j(a);if(k=a!==l,h&&h(d),!k&&a&&a.constructor===Function)return o;if(a&&a.___$unmapCustom)f=a.___$unmapCustom(a);else if(k&&c(l)||b(l))f=l;else if(l instanceof Array)for(f=[],g=0,i=l.length;g<i;g++)f[g]=e(l[g],{name:"[i]",parent:d.name+"[i]",full:d.full+"[i]"});else if(l.constructor===Object)for(g in f={},l)"___$"!==g.substr(0,4)&&(a.___$customChildren&&a.___$customChildren[g]&&a.___$customChildren[g].unmap?f[g]=a.___$customChildren[g].unmap(l[g]):(k=l[g],ko.isComputed(k)||(i=j(k))&&i.constructor===Function||(k=e(k,{name:g,parent:("[i]"===d.name?d.parent:d.name)+"."+g,full:d.full+"."+g}),k!==o&&(f[g]=k))));else!k&&"function"!=typeof l&&(f=l);return a&&a.___$unmapExtend&&(f=a.___$unmapExtend(f,a)),f}function f(a,d,e,g,i){var l,m,n,o,p,q,r,s=j(d);if(m=d!==s,h&&h(e),m&&b(s)^b(a))d(a);else if(a&&s&&s.constructor==Object&&a.constructor===Object)for(l in a)d.___$customChildren&&d.___$customChildren[l]?(g=d.___$customChildren[l].map||d.___$customChildren[l],s[l]=g(a[l])):(g=s[l],!m&&s.hasOwnProperty(l)&&(c(g)||g&&g.constructor===Array)?s[l]=a[l]:g&&"function"==typeof g.___$mapCustom?k(g)?(n=g.___$mapCustom(a[l],g),n=j(n),g(n)):s[l]=g.___$mapCustom(a[l],g):b(a[l])&&s[l]&&s[l].constructor===Object?s[l]=a[l]:i?(g=function(a,b,c){return function(){f(a[c],s[c],{name:c,parent:("[i]"===e.name?e.parent:e.name)+"."+c,full:e.full+"."+c},s,i),i(i()-1)}}(a,d,l),i(i()+1),setTimeout(g,0)):f(a[l],s[l],{name:l,parent:("[i]"===e.name?e.parent:e.name)+"."+l,full:e.full+"."+l}));else if(s&&s instanceof Array)if(r=d.___$childIdName){for(n=[],o=[],l=a.length-1;0<=l;l--)for(p=a[l][r],m=s.length-1;0<=m;m--)if(g=s[m],q=j(g),q=j(q[r]),q===p){g.___$mapCustom?ko.isObservable(g)?(p=g.___$mapCustom(a[l],g),k(p)&&p!=g&&g(j(p))):s[m]=g.___$mapCustom(a[l],g):i?(g=function(a,b,c,d){return function(){f(a[c],s[d],{name:"[i]",parent:e.name+"[i]",full:e.full+"[i]"},void 0,i),i(i()-1)}}(a,d,l,m),i(i()+1),setTimeout(g,0)):f(a[l],s[m],{name:"[i]",parent:e.name+"[i]",full:e.full+"[i]"}),o[m]=!0,n[l]=!0;break}for(m=s.length-1;0<=m;m--)o[m]||d.splice(m,1);for(l=a.length-1;0<=l;l--)n[l]||d.pushFromModel(a[l])}else if(n=[],m=d.___$mapCustom,"function"==typeof m){for(l=0,g=a.length;l<g;l++)n[l]=a[l];d(m(n))}else for(d(n),l=0,g=a?a.length:0;l<g;l++)d.pushFromModel(a[l]);else m&&d(a);if("{root}"===e.name&&i)return{onComplete:function(a){a&&"function"==typeof a&&(i?ko.computed(function(){a&&0===i()&&(a(),a=void 0)}).extend({throttle:50}):a())}}}function g(a,b){i=a.makeChildArraysObservable,window.console&&a.logging?(console.log(b),h=function(a,b,c){console.log("- "+(b&&b.settingType?b.settingType+" "+a.full+" (matched: '"+((c[a.full]?a.full:"")||(c[a.parent]?a.parent:"")||a.name)+"')":"default "+a.full))}):h=void 0}var h,i,j=ko.utils.unwrapObservable,k=ko.isObservable,l=ko.observable,m=ko.observableArray,n={name:"{root}",parent:"{root}",full:"{root}"},o=function(){};ko.viewmodel={options:{makeChildArraysObservable:!0,logging:!1},fromModel:function(a,b){var c,e,f,h,i,j,k,l={},m=b?b.shared||{}:{};for(i in b)if(c=b[i]||{},"shared"!==i)if(c instanceof Array)for(e=0,h=c.length;e<h;e++)f=c[e],l[f]=l[f]||{},l[f][i]=!0,l[f].settingType=l[f].settingType?"multiple":i;else if(c.constructor===Object)for(f in c){if(l[f]=l[f]||{},e=c[f],(e="arrayChildId"!==i&&e&&e.constructor===String&&m[e]?m[e]:e)&&e.constructor===Object)for(j in e)(k=e[j])&&k.constructor==String&&m[k]&&(e[j]=m[k]);l[f][i]=e,l[f].settingType=l[f].settingType?"multiple":i}return g(this.options,"Mapping From Model"),d(a,l,n)},toModel:function(a){return g(this.options,"Mapping To Model"),e(a,n)},updateFromModel:function(a,b,c){return c=c?ko.observable(0):void 0,g(this.options,"Update From Model"),f(b,a,n,void 0,c)}}}();
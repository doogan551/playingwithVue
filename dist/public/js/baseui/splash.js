window.splash=function(a,b,c){function d(){var a=this,d=function(){for(var b=0;b<a.alarms().length;b++)e(a.alarms()[b])},e=function(a){c.ajax({type:"GET",url:"/api/system/getCounts/"+a.name}).done(function(b){b.err||a.count(b),c(".searchBar").focus()})};a.alarms=b.observableArray([{name:"Recent",count:b.observable(0)},{name:"Urgent",count:b.observable(0)},{name:"Emergency",count:b.observable(0)},{name:"Critical",count:b.observable(0)}]),a.results=b.observableArray([]),a.selectedObject=b.observable(),d()}var e=window.opener&&window.opener.workspaceManager;e.socket;return a.init=function(a){viewModel=new d,c(".searchSpinner").hide();var e=new Bloodhound({datumTokenizer:Bloodhound.tokenizers.obj.whitespace("value"),queryTokenizer:Bloodhound.tokenizers.whitespace,remote:{url:"/api/points/globalSearch/%QUERY",wildcard:"%QUERY"}});c(".searchBar").typeahead({hint:c(".searchHint"),menu:c(".searchMenu"),minLength:3,highlight:!0},{name:"results",display:"Name",async:!0,limit:20,source:e,templates:{empty:template=Handlebars.compile(c("#noResults").html()),suggestion:template=Handlebars.compile(c("#template").html())}}).on("typeahead:asyncrequest",function(){c(".searchSpinner").show()}).on("typeahead:asynccancel typeahead:asyncreceive",function(){c(".searchSpinner").hide()}),c(".searchBar").bind("typeahead:select",function(a,b){viewModel.openPoint(b)}),b.applyBindings(viewModel)},d.prototype.search=function(){var a=this,b=c(".searchBar").val(),d=b.split(" ");c.ajax({type:"post",url:"/api/points/globalSearch",data:{tags:d}}).done(function(b){b.err||a.results(b),b.length>0?c(".searchResults").show():c(".searchResults").hide()})},d.prototype.clearSearch=function(){c(".searchBar").focus(),c(".searchBar").typeahead("val","")},d.prototype.openPoint=function(a){var b,d,f,g,h;"Schedule Entry"!==a.pointType&&"Schedule"!==a.pointType?(h=a.pointType,f=820,g=542):(h="Schedule",f=1250,g=750),b=e.config.Utility.pointTypes.getUIEndpoint(h,a._id),d=e.openWindowPositioned(b.review.url,a.Name,h,"",a._id,{width:f,height:g}),c(".searchBar").typeahead("val","")},a}(window.splash||{},ko,jQuery),$(window.splash.init);
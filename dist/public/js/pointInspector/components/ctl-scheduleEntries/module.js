define(["knockout","text!./view.html","lodash"],function(a,b,c){function d(b){var d=this;window.se=this,this.id=b.id,this.point=b.point,this.root=b.rootContext,this.isInEditMode=this.root.isInEditMode,this.utility=this.root.utility,this.pointType=b.pointType,o=this.root.apiEndpoint,i=this.root.socket,l=this.utility.config,m=this.utility.enumToArray,saveBtn=null,j=function(a,b,c){var d="";switch(a){case 0:d="Any";break;case 1:d="January";break;case 2:d="Febuary";break;case 3:d="March";break;case 4:d="April";break;case 5:d="May";break;case 6:d="June";break;case 7:d="July";break;case 8:d="August";break;case 9:d="September";break;case 10:d="October";break;case 11:d="November";break;case 12:d="December"}return b=0===b?"Any":b,c=0===c?"Any":c,d+"/"+b+"/"+c},k=function(a,b){var c=[];c.push({name:"Any",value:0});for(var d=a;d<=b;d++)c.push({name:d,value:d});return c},this.searchTerm=a.observable(""),this.gettingData=a.observable(!0),this.newRow=a.observable("  New Entry"),this.networkError=a.observable(!1),d.entries=a.observableArray([]),this.filteredEntries=a.observableArray(this.entries()),this.sortProperty="Schedule"===this.pointType?"refPoint":"scheduleName",this.sortDirection=p,this.executeNow="Schedule"===this.pointType?a.observable(this.point["Execute Now"].Value()):a.observable(!1),this.hostSchedule="Schedule"===this.pointType?a.observable(this.point["Host Schedule"].Value()):a.observable(!1),this.enableAll="Schedule"===this.pointType?a.observable(this.point["Enable Schedule"].Value()):a.observable(!1),this.heating=a.observable(!1),this.cooling=a.observable(!1),this.origControls={executeNow:this.executeNow(),hostSchedule:this.hostSchedule(),enableAll:this.enableAll(),heating:this.heating(),cooling:this.cooling()},this.lowestControlTime=a.observable(),this.months=a.observableArray(k(1,12)),this.days=a.observableArray(k(1,31)),this.years=a.observableArray(k(2014,2050)),this.Sunday=a.observable("S"),this.Monday=a.observable("M"),this.Tuesday=a.observable("T"),this.Wednesday=a.observable("W"),this.Thursday=a.observable("T"),this.Friday=a.observable("F"),this.Saturday=a.observable("S"),this.Holiday=a.observable("H"),this.SundayActive=a.observable(""),this.MondayActive=a.observable(""),this.TuesdayActive=a.observable(""),this.WednesdayActive=a.observable(""),this.ThursdayActive=a.observable(""),this.FridayActive=a.observable(""),this.SaturdayActive=a.observable(""),this.HolidayActive=a.observable(""),this.activeday=a.observable("activeday"),this.priorities=a.observableArray(d.utility.workspace.systemEnums.controlpriorities),this.controllers=a.observableArray(d.utility.workspace.systemEnums.controllers),d.oldPoints=[],d.updateScheds=[],d.hardScheds=[],this.render(),this.isInEditMode.subscribe(function(b){if(b)saveBtn=$(".actions .btn-success"),d.updateSaveButton();else{for(var c=[],e=0;e<d.entries().length;e++)1===d.entries()[e].point._pStatus()&&c.push(a.viewmodel.toModel(d.entries()[e].point));i.emit("updateSchedules",{hardScheds:c}),d.render(),d.executeNow(d.origControls.executeNow),d.hostSchedule(d.origControls.hostSchedule),d.enableAll(d.origControls.enableAll),d.heating(d.origControls.heating),d.cooling(d.origControls.cooling),d.emptyEntry["Control Time"].Value(0),d.emptyEntry["Days Active"].Value(0),d.emptyEntry["Begin Month"].Value(0),d.emptyEntry["Begin Day"].Value(0),d.emptyEntry["Begin Year"].Value(0),d.emptyEntry["End Month"].Value(0),d.emptyEntry["End Day"].Value(0),d.emptyEntry["End Year"].Value(0)}}),this.root.point.status.subscribe(function(b){var c=[];if("saving"===b){for(var e=0;e<d.entries().length;e++)if(d.entries()[e].isDeleted())d.hardScheds.push(a.viewmodel.toModel(d.entries()[e].point));else if(1===d.entries()[e].point._pStatus())c.push(a.viewmodel.toModel(d.entries()[e].point));else{var f=a.viewmodel.toModel(d.entries()[e].point);5!==f["Control Value"].ValueType&&delete f["Control Value"].eValue,d.updateScheds.push(f)}i.emit("updateSchedules",{oldPoints:d.oldPoints,updateScheds:d.updateScheds,newScheds:c,hardScheds:d.hardScheds,schedule:a.viewmodel.toModel(d.point)}),i.once("scheduleUpdated",function(a){d.render()})}}),this.search=a.computed(function(){var b,c=this.searchTerm().toLowerCase(),f=function(b){return a.utils.arrayFilter(b,function(a){return"Schedule"!==d.pointType&&a.scheduleName().toLowerCase().indexOf(c)!==-1||(null===a.refPoint||a.refPoint.Name.toLowerCase().indexOf(c)!==-1)})},g=this.filteredEntries();for(this.filteredEntries(e.call(f(d.entries()),this.sortProperty,this.sortDirection)),b=0;b<this.filteredEntries().length;b++)for(var i=0;i<g.length&&g[i].point._id()!==this.filteredEntries()[b].point._id();i++)i===g.length-1&&d.scrollIntoView(this.filteredEntries()[b].point._id());h&&(c.length?h.show():h.hide())},this).extend({rateLimit:200}),this.enableBtn=a.computed(function(){var a=d.isInEditMode();return a?"enabled":"disabled"}),this.updateSaveButton=function(){if(null!==saveBtn){saveBtn.attr("disabled",!1);for(var a=0;a<d.entries().length;a++)if(null===d.entries()[a].refPoint&&!d.entries()[a].isDeleted()){saveBtn.attr("disabled",!0);break}}},this.adjustInterval=function(){var a,b=!1,c=0;for(this.lowestControlTime(q),a=0;a<d.entries().length;a++)d.entries()[a].point["Control Time"].Value()<this.lowestControlTime()&&this.lowestControlTime(d.entries()[a].point["Control Time"].Value()),d.entries()[a].point["Control Time"].Value()>c&&(c=d.entries()[a].point["Control Time"].Value());for(a=0;a<d.entries().length;a++)c-this.lowestControlTime()+d.emptyEntry["Control Time"].Value()>q&&(b=!0);if(b&&!window.confirm("Base Time will max out at least one control time. Proceed?"));else for(a=0;a<d.entries().length;a++){var e=d.entries()[a].intervalAdjust();d.entries()[a].intervalAdjust(d.emptyEntry["Control Time"].Value()),e===d.entries()[a].intervalAdjust()&&d.entries()[a].intervalAdjust.valueHasMutated()}return!0},this.applyDays=function(a){var b=a.emptyEntry["Days Active"].Value();return d.entries().forEach(function(a){a.point["Days Active"].Value(b)}),!0},this.applyBegin=function(a){var b=a.emptyEntry["Begin Month"].Value(),c=a.emptyEntry["Begin Day"].Value(),e=a.emptyEntry["Begin Year"].Value();return d.entries().forEach(function(a){a.point["Begin Month"].Value(b),a.point["Begin Day"].Value(c),a.point["Begin Year"].Value(e)}),!0},this.applyEnd=function(a){var b=a.emptyEntry["End Month"].Value(),c=a.emptyEntry["End Day"].Value(),e=a.emptyEntry["End Year"].Value();return d.entries().forEach(function(a){0!==a.point["Begin Month"].Value()&&a.point["End Month"].Value(b),0!==a.point["Begin Day"].Value()&&a.point["End Day"].Value(c),0!==a.point["Begin Year"].Value()&&a.point["End Year"].Value(e)}),!0},this.addRow=function(){var b=this,c={name1:"Schedule Entry",pointType:"Schedule Entry",parentUpi:b.point._id()};$.ajax({url:"/api/points/initpoint",dataType:"json",type:"post",data:c}).done(function(c){if(c["Enable Schedule"].Value=b.hostSchedule(),c["Host Schedule"].Value=b.enableAll(),c["Heating Season"].Value=b.heating(),c["Cooling Season"].Value=b.cooling(),c["Control Time"].Value=b.emptyEntry["Control Time"].Value(),"Schedule"!==b.pointType){var d=l.Utility.getPropertyObject("Control Point",c),e=a.viewmodel.toModel(b.point);d.Value=e._id,c=l.EditChanges.applyUniquePIDLogic({point:c,refPoint:e,propertyObject:d}),c._parentUpi=0}var f=c,g=a.viewmodel.fromModel(c);b.oldPoints.push(f),item=b.buildObservable({point:g,oldPoint:f}),item.isNew(!0),b.entries.push(item),b.updateSaveButton()})},this.cloneRow=function(b,e){var f=b.point._id(),g={targetUpi:f,name1:"Schedule Entry",pointType:"Schedule Entry"};$.ajax({url:"/api/points/initpoint",dataType:"json",type:"post",data:g}).done(function(e){var f=c.cloneDeep(a.viewmodel.toModel(b.point));f._id=e._id,f.Name=e.Name,f.name1=e.name1,f.name2=e.name2,f.name3=e.name3,f.name4=e.name4,f._Name=e.Name,f._name1=e._name1,f._name2=e._name2,f._name3=e._name3,f._name4=e._name4,f._pStatus=e._pStatus,item=d.buildObservable({oldPoint:e,point:a.viewmodel.fromModel(f)},b),item.isNew(!0),d.entries.push(item),d.searchTerm.valueHasMutated(),d.oldPoints.push(e),d.updateSaveButton()})},d.scrollIntoView=function(a){$("html, body").animate({scrollTop:$("#"+a).offset().top},2e3)},d.toggleExecuteNow=function(){return d.point["Execute Now"].Value(d.executeNow()),!0},d.allHost=function(){d.point["Host Schedule"]&&d.point["Host Schedule"].Value(d.hostSchedule());for(var a=0;a<d.entries().length;a++)d.entries()[a].point["Host Schedule"].Value(d.hostSchedule());return!0},d.allEnable=function(){d.point["Enable Schedule"]&&d.point["Enable Schedule"].Value(d.enableAll());for(var a=0;a<d.entries().length;a++)d.entries()[a].point["Enable Schedule"].Value(d.enableAll());return!0},d.allHeating=function(){for(var a=0;a<d.entries().length;a++)d.entries()[a].point["Heating Season"].Value(d.heating());return!0},d.allCooling=function(){for(var a=0;a<d.entries().length;a++)d.entries()[a].point["Cooling Season"].Value(d.cooling());return!0},d.properties=a.observableArray([]),d.emptyEntry={"Control Time":{isDisplayable:!0,isReadOnly:!1,ValueType:17,Value:0},"Days Active":{isDisplayable:!0,isReadOnly:!1,ValueType:18,Value:0},"Begin Day":{isDisplayable:!0,isReadOnly:!1,ValueType:4,Value:0},"Begin Month":{isDisplayable:!0,isReadOnly:!1,ValueType:4,Value:0},"Begin Year":{isDisplayable:!0,isReadOnly:!1,ValueType:4,Value:0},"End Day":{isDisplayable:!0,isReadOnly:!1,ValueType:4,Value:0},"End Month":{isDisplayable:!0,isReadOnly:!1,ValueType:4,Value:0},"End Year":{isDisplayable:!0,isReadOnly:!1,ValueType:4,Value:0}},d.emptyEntry=a.viewmodel.fromModel(d.emptyEntry),d.emptyEntry["Days Active"].Value.subscribe(function(a){for(var b in l.Enums["Day of Week Flags"])0!==(l.Enums["Day of Week Flags"][b]["enum"]&a)?"Sunday"===b?d.SundayActive("activeday"):"Monday"===b?d.MondayActive("activeday"):"Tuesday"===b?d.TuesdayActive("activeday"):"Wednesday"===b?d.WednesdayActive("activeday"):"Thursday"===b?d.ThursdayActive("activeday"):"Friday"===b?d.FridayActive("activeday"):"Saturday"===b?d.SaturdayActive("activeday"):"Holiday"===b&&d.HolidayActive("activeday"):"Sunday"===b?d.SundayActive(""):"Monday"===b?d.MondayActive(""):"Tuesday"===b?d.TuesdayActive(""):"Wednesday"===b?d.WednesdayActive(""):"Thursday"===b?d.ThursdayActive(""):"Friday"===b?d.FridayActive(""):"Saturday"===b?d.SaturdayActive(""):"Holiday"===b&&d.HolidayActive("")}),d.emptyEntry["Begin Month"].Value.subscribe(function(a){0===a?(d.emptyEntry["End Month"].Value(0),d.emptyEntry["End Month"].isReadOnly(!0)):d.emptyEntry["End Month"].isReadOnly(!1)}),d.emptyEntry["Begin Day"].Value.subscribe(function(a){0===a?(d.emptyEntry["End Day"].Value(0),d.emptyEntry["End Day"].isReadOnly(!0)):d.emptyEntry["End Day"].isReadOnly(!1)}),d.emptyEntry["Begin Year"].Value.subscribe(function(a){0===a?(d.emptyEntry["End Year"].Value(0),d.emptyEntry["End Year"].isReadOnly(!0)):d.emptyEntry["End Year"].isReadOnly(!1)}),this.beginDate=a.computed(function(){var a=d.emptyEntry["Begin Month"].Value(),b=d.emptyEntry["Begin Day"].Value(),c=d.emptyEntry["Begin Year"].Value();return j(a,b,c)}),this.endDate=a.computed(function(){var a=d.emptyEntry["End Month"].Value(),b=d.emptyEntry["End Day"].Value(),c=d.emptyEntry["End Year"].Value();return j(a,b,c)}),d.emptyEntry["Begin Month"].Value.valueHasMutated(),d.emptyEntry["Begin Day"].Value.valueHasMutated(),d.emptyEntry["Begin Year"].Value.valueHasMutated(),d.emptyEntry["Days Active"].Value.valueHasMutated(),i.on("returnEntries",function(b){if(!b.err){var c=b.entries,e=[];d.oldPoints=[],d.updateScheds=[],d.cancelScheds=[],d.hardScheds=[],c.forEach(function(b){var c=b,f=a.viewmodel.fromModel(b);0!==b._pStatus?d.hardScheds.push(b):(d.oldPoints.push(c),e.push({point:f,oldPoint:c}))}),e.map(function(a){return a=d.buildObservable(a)}),d.entries=a.observableArray(e),e=[],d.searchTerm.valueHasMutated(),d.gettingData(!1)}})}function e(a,b){var c=~b+1;return this.sort(function(d,e){return"scheduleName"===a?d[a]()===e[a]()?0:d[a]()<e[a]()?c:b:"refPoint"===a?null===d[a]||null===e[a]?null===d[a]?c:b:d[a].Name===e[a].Name?0:d[a].Name<e[a].Name?c:b:d.point[a].hasOwnProperty("Value")?d.point[a].Value()===e.point[a].Value()?0:d.point[a].Value()<e.point[a].Value()?c:b:d.point[a]()===e.point[a]()?0:d.point[a]()<e.point[a]()?c:b})}function f(a){return $.ajax({url:o+"points/getpointref/small/"+a,contentType:"application/json",dataType:"json",type:"get"})}var g,h,i,j,k,l,m,n,o="",p=1,q=86340;d.prototype.buildObservable=function(b,c){var d=this,e=b.point,g=l.Utility.getPropertyObject("Control Point",a.viewmodel.toModel(e));return b.isDeleted=a.observable(c&&c.isDeleted()||!1),b.isNew=a.observable(c&&c.isNew()||!1),b.properties=a.observableArray([]),b.valueTypeSelector=a.observable(c&&c.valueTypeSelector()||0),b.ValueOptions=a.observableArray([]),b.months=a.observableArray(k(1,12)),b.days=a.observableArray(k(1,31)),b.years=a.observableArray(k(2015,2050)),b.Sunday=a.observable(c&&c.Sunday()||"S"),b.Monday=a.observable(c&&c.Monday()||"M"),b.Tuesday=a.observable(c&&c.Tuesday()||"T"),b.Wednesday=a.observable(c&&c.Wednesday()||"W"),b.Thursday=a.observable(c&&c.Thursday()||"T"),b.Friday=a.observable(c&&c.Friday()||"F"),b.Saturday=a.observable(c&&c.Saturday()||"S"),b.Holiday=a.observable(c&&c.Holiday()||"H"),b.SundayActive=a.observable(c&&c.SundayActive()||""),b.MondayActive=a.observable(c&&c.MondayActive()||""),b.TuesdayActive=a.observable(c&&c.TuesdayActive()||""),b.WednesdayActive=a.observable(c&&c.WednesdayActive()||""),b.ThursdayActive=a.observable(c&&c.ThursdayActive()||""),b.FridayActive=a.observable(c&&c.FridayActive()||""),b.SaturdayActive=a.observable(c&&c.SaturdayActive()||""),b.HolidayActive=a.observable(c&&c.HolidayActive()||""),b.activeday=a.observable(c&&c.activeday()||"activeday"),b.intervalAdjust=a.observable(c&&c.intervalAdjust()||0),b.url=a.observable(null),b.scheduleName=a.observable(""),b.lastValueType=a.observable(e["Control Value"].ValueType()),"Schedule"!==d.pointType&&0!==e._parentUpi()&&f(e._parentUpi()).done(function(a){if(a.hasOwnProperty("message"));else{var c=l.Utility.pointTypes.getUIEndpoint(d.pointType,e._parentUpi());b.scheduleName(a.Name),b.url(c.review.url)}}),b.openPointReview=function(){var a=window.opener.workspaceManager;a.openWindowPositioned(b.url(),b.scheduleName(),d.pointType,"",e._parentUpi(),{width:1250,height:750})},b.refPoint=null,b.hasRef=a.computed(function(){return currentRef=e["Point Refs"]()[0].Value(),0!==currentRef}),b.intervalAdjust.subscribe(function(a){var b=e["Control Time"].Value(),c=b-d.lowestControlTime()+a;c>q&&(c=q),e["Control Time"].Value(c)}),b.allowHostEdit=a.computed(function(){}),b.visibleController=a.computed(function(){var a=g.PointType,b=e["Control Property"].Value();return[1,2,4,5].indexOf(a)>-1&&"Value"===b}),b.beginDate=a.computed(function(){var a=e["Begin Month"].Value(),b=e["Begin Day"].Value(),c=e["Begin Year"].Value();return j(a,b,c)}),b.endDate=a.computed(function(){var a=e["End Month"].Value(),b=e["End Day"].Value(),c=e["End Year"].Value();return j(a,b,c)}),e["Point Refs"]()[0].Value.subscribe(function(c){f(c).done(function(c){b.refPoint=c.hasOwnProperty("message")?null:c,d.updateSaveButton(),b.ValueOptions=c.hasOwnProperty("Value")&&c.Value.hasOwnProperty("ValueOptions")?m(c.Value.ValueOptions):[];var f=l.EditChanges.applyUniquePIDLogic({point:a.viewmodel.toModel(e),refPoint:c},"Control Point");for(var h in f["Point Refs"][0])"Value"!==h&&e["Point Refs"]()[0][h](f["Point Refs"][0][h]);g=l.Utility.getPropertyObject("Control Point",a.viewmodel.toModel(e));var i=[],j=g.PointType;for(var k in l.Enums["Point Types"])l.Enums["Point Types"][k]["enum"]===j&&(i=l.Enums["Point Types"][k].schedProps);b.properties(i),e["Control Property"].Value.valueHasMutated()})}),e["Control Property"].Value.subscribe(function(a){if(null!==b.refPoint){var c=l.Templates.getTemplate(b.refPoint["Point Type"].Value)[a],d=c.ValueType;b.valueTypeSelector(d),e["Control Value"].ValueType(d),e["Control Value"].ValueType.valueHasMutated(),e["Control Property"].eValue(l.Enums.Properties[a]["enum"])}}),e["Control Value"].ValueType.subscribe(function(c){var d=e["Control Value"].ValueType(),f=e["Control Property"].Value();if(5===d){"Program Change Request"===f?b.ValueOptions=l.Utility.pointTypes.getEnums(f,f):b.ValueOptions=m(b.refPoint.Value.ValueOptions),b.ValueOptions=a.viewmodel.toModel(b.ValueOptions);for(var g=0;g<b.ValueOptions.length;g++)e["Control Value"].Value()===b.ValueOptions[g].name&&e["Control Value"].eValue(b.ValueOptions[g].value)}else 1===d?1!==b.lastValueType()&&(b.lastValueType(d),e["Control Value"].Value(0)):7===d&&7!==b.lastValueType()&&(b.lastValueType(d),e["Control Value"].Value(!1))}),e["Control Value"].eValue=a.observable(),e["Control Value"].eValue.subscribe(function(a){for(var c=0;c<b.ValueOptions.length;c++)a===b.ValueOptions[c].value&&e["Control Value"].Value(b.ValueOptions[c].name)}),e["Days Active"].Value.subscribe(function(a){for(var c in l.Enums["Day of Week Flags"])0!==(l.Enums["Day of Week Flags"][c]["enum"]&a)?"Sunday"===c?b.SundayActive("activeday"):"Monday"===c?b.MondayActive("activeday"):"Tuesday"===c?b.TuesdayActive("activeday"):"Wednesday"===c?b.WednesdayActive("activeday"):"Thursday"===c?b.ThursdayActive("activeday"):"Friday"===c?b.FridayActive("activeday"):"Saturday"===c?b.SaturdayActive("activeday"):"Holiday"===c&&b.HolidayActive("activeday"):"Sunday"===c?b.SundayActive(""):"Monday"===c?b.MondayActive(""):"Tuesday"===c?b.TuesdayActive(""):"Wednesday"===c?b.WednesdayActive(""):"Thursday"===c?b.ThursdayActive(""):"Friday"===c?b.FridayActive(""):"Saturday"===c?b.SaturdayActive(""):"Holiday"===c&&b.HolidayActive("")}),e["Begin Month"].Value.subscribe(function(a){0===a?(e["End Month"].Value(0),e["End Month"].isReadOnly(!0)):e["End Month"].isReadOnly(!1)}),e["Begin Day"].Value.subscribe(function(a){0===a?(e["End Day"].Value(0),e["End Day"].isReadOnly(!0)):e["End Day"].isReadOnly(!1)}),e["Begin Year"].Value.subscribe(function(a){0===a?(e["End Year"].Value(0),e["End Year"].isReadOnly(!0)):e["End Year"].isReadOnly(!1)}),b.removeEntry=function(a,b){a.point._id();a.isDeleted(!0),d.updateSaveButton()},b.returnEntry=function(a,b){a.point._id();a.isDeleted(!1),d.updateSaveButton()},b.isDeleted.subscribe(function(a){e["Control Time"].isReadOnly(a)}),b.isEditable=a.computed(function(){return d.isInEditMode()&&!b.isDeleted()}),b.isRoCtrl=a.computed(function(){return b.isEditable()?"":"roControls"}),b.notNew=function(){b.isNew()&&window.setTimeout(function(){b.isNew(!1)},2e3)},b.altBgColor=function(a){return b.isDeleted()?"deleted":b.isNew()?"new":a()%2===0?"even":"odd"},e["Begin Month"].Value.valueHasMutated(),e["Begin Day"].Value.valueHasMutated(),e["Begin Year"].Value.valueHasMutated(),e["Point Refs"]()[0].Value.valueHasMutated(),e["Days Active"].Value.valueHasMutated(),b},d.prototype.render=function(){var a,b=this,c=function(){g=$("div.search input"),h=$(".clearSearchIcon"),a="175px",g.css("width",a)};b.gettingData(!0),i.emit("getScheduleEntries",{isSchedule:"Schedule"===this.pointType,upi:this.id}),c()},d.prototype.openPointReview=function(a){var b=window.opener.workspaceManager,c=b.config.Utility.pointTypes.getUIEndpoint(a.ref.PointType,a.ref.Value);b.openWindowPositioned(c.review.url,a.ref.PointName,a.ref.PointType,"",a.ref.Value,{width:820,height:542})},d.prototype.sortTable=function(a,b,c){var d=$(c.currentTarget);this.sortProperty==a?this.sortDirection=-this.sortDirection:(this.sortProperty=a,this.sortDirection=p),e.call(this.filteredEntries,a,this.sortDirection),$("table.entryTable thead div i.fa").removeClass("fa-chevron-down fa-chevron-up"),d.find("i.fa").addClass(this.sortDirection==p?"fa-chevron-up":"fa-chevron-down")},d.prototype.clearSearch=function(){this.searchTerm(""),g.focus()},d.prototype.toggleDay=function(a,b){var c=$(b.currentTarget),d=c.data("enum");days=a.point["Days Active"].Value(),a.point["Days Active"].Value(days^d)},d.prototype.toggleDayGlobal=function(a,b){var c=$(b.currentTarget),d=c.data("enum");days=a.emptyEntry["Days Active"].Value(),a.emptyEntry["Days Active"].Value(days^d)},d.prototype.dispose=function(){this.isTabLoaded.dispose()},a.bindingHandlers.setEnumTextValue={init:function(b,c,d){var e=($(b),a.contextFor(b),d()),f=a.utils.unwrapObservable(e.options),g=(e.value,c());n=e.value.subscribe(function(b){var c=a.utils.arrayFirst(f,function(c,d){return c.badProperty?(f.splice(d,1),!1):a.unwrap(c.value)==b});!!c&&g(a.unwrap(c.name))})}};return{viewModel:d,template:b}});
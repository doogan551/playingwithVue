define(["knockout","text!./view.html"],function(a,b){function c(b){var c=this;this.id=b.id,this.Enums=b.rootContext.utility.config.Enums,e=b.rootContext.apiEndpoint,this.gettingData=a.observable(!0),this.alarmMessages=a.observableArray([]),this.isInEditMode=b.rootContext.isInEditMode,this.render(),this.alarmData=a.observableArray([]),this.returnData=a.observableArray([]),this.data=b.data,this.alarmDefinitions={},this.ackAll=a.observable(!1),this.notifyAll=a.observable(!1),this.ackAll.subscribe(function(a){c.returnData().forEach(function(b){b.ack(a)})}),this.notifyAll.subscribe(function(a){c.returnData().forEach(function(b){b.notify(a)})}),this.isInEditMode.subscribe(function(a){a||c.buildAlarmArrays()}),c.checkNotify=function(a){return c.isInEditMode()&&!a.notify()}}function d(a){return $.ajax({url:"/api/system/getAlarmTemplates",contentType:"application/json",dataType:"json",type:"get"})}var e="";return c.prototype.render=function(){var a=this;d().done(function(b){a.gettingData(!1),a.alarmMessages(b),a.buildAlarmArrays()})},c.prototype.getAlarmMessagesByType=function(a){var b=this;return b.alarmMessages.filter(function(b){return b.msgType==a})},c.prototype.getMessageById=function(a){for(var b=this,c=b.alarmMessages(),d={msgName:"",msgTypeName:""},e=c.length;e--;)if(c[e]._id==a){d=c[e];break}return d},c.prototype.buildAlarmArrays=function(){var a=this;a.returnData([]),a.alarmData([]),a.alarmMessages().forEach(function(b){a.data().forEach(function(c){c.msgId()===b._id&&(b.msgCat===a.Enums["Alarm Categories"].Return["enum"]?(a.returnData().length||(a.notifyAll(c.notify()),a.ackAll(c.ack())),c.notify(a.notifyAll()),c.ack(a.ackAll()),a.returnData.push(c)):(c.notify.subscribe(function(a){a&&c.ack(!0)}),a.alarmData.push(c)))})})},c.prototype.dispose=function(){},{viewModel:c,template:b}});
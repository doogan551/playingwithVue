define(["knockout","text!./view.html"],function(a,b){function c(b){var c=this;c.root=b.rootContext,c.config=c.root.utility.config,c.enums=c.config.Enums,c.point=c.root.point,c.data=c.point.data,c.utility=c.root.utility,c.isEnumValueType=c.data.Value.ValueType()===c.enums["Value Types"].Enum["enum"],c.gettingData=!1,c.readOnOpen=!0,c.showModal=a.observable(!1),c.errorText=a.observable(""),c.presentValue=a.observable(""),c.alarmState=a.observable(""),c.reliability=a.observable(""),c.authorizedValue=a.observable(""),c.statusFlags={"Out of Service":a.observable(!1),Override:a.observable(!1),"In Fault":a.observable(!1),"In Alarm":a.observable(!1),All:a.observable(!1)}}return c.prototype.toggleModal=function(){this.showModal(!0),this.readOnOpen&&this.readValue()},c.prototype.readValue=function(){if(!this.gettingData){var b=this,c=$(".btnReadValue"),d=c.find("i.fa"),e=$(".modal.readValue"),f=e.find(".modalScene"),g=e.find(".modalError"),h=e.find(".modalWait"),i=e.find(".modalValue"),j=e.find(".btnSubmit"),k=function(c,d){var e=a.toJS(b.data.Value.ValueOptions),f=a.utils.arrayFilter(e,function(a){return a[c]===d});return f[0]},l=function(a){b.showModal()?d.addClass("fa-crosshairs"):(b.readOnOpen=!1,a?(c.addClass("btn-danger"),d.addClass("fa-warning")):(c.addClass("btn-success"),d.addClass("fa-check")))},m=function(a){var e,h,m,n,o=b.enums["Status Flags Bits"];if(f.hide(),j.prop("disabled",!1),c.removeClass("btn-warning"),d.removeClass("fa-refresh fa-spin"),b.gettingData=!1,a.error())return l(!0),b.errorText(a.error()),void g.show();l(!1),e=a.value(),h=e.Value,m=e["Authorized Value"],b.isEnumValueType&&(n=k("value",h),h=n&&n.name||h,n=k("value",m),m=n&&n.name||m),b.presentValue(h),b.authorizedValue(m),b.reliability(b.config.Utility.getNameFromEnum("Reliabilities",e.Reliability)||e.Reliability),b.alarmState(b.config.Utility.getNameFromEnum("Alarm States",e["Alarm State"])||e["Alarm State"]);for(var p in o)b.statusFlags[p](!!(e["Status Flags"]&o[p]["enum"]));i.show()};f.hide(),h.show(),j.prop("disabled",!0),c.removeClass("btn-danger btn-success").addClass("btn-warning"),d.removeClass("fa-crosshairs fa-check fa-warning").addClass("fa-refresh fa-spin"),b.readOnOpen=!0,b.gettingData=!0,b.point.issueCommand("Present Value",{upi:b.data._id()},m)}},c.prototype.dispose=function(){},{viewModel:c,template:b}});
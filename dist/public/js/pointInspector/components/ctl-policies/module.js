define(["knockout","text!./view.html"],function(a,b){function c(b){var c=this;c.params=b,apiEndpoint=b.rootContext.apiEndpoint,this.isInEditMode=b.rootContext.isInEditMode,this.isSystemAdmin=b.rootContext.isSystemAdmin(),this.data=b.data,this.policies=a.observableArray([]),this.getPolicies(function(b){if(b.err);else{for(var d=0;d<b.length;d++){b[d].policyOnPoint=a.observable(!1);for(var e=0;e<c.data().length;e++)c.data()[e].toString()===b[d]._id.toString()&&b[d].policyOnPoint(!0)}c.policies(b)}})}return c.prototype.getPolicies=function(a){$.ajax({url:self.apiEndpoint+"policies/get",contentType:"application/json",dataType:"json",type:"get"}).done(a)},c.prototype.togglePolicy=function(a){if(a.policyOnPoint())this.data().push(a._id);else for(var b=0;b<this.data().length;b++)this.data()[b]==a._id&&(this.data().splice(b,1),b--);return!0},c.prototype.dispose=function(){},{viewModel:c,template:b}});
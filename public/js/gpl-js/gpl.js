function RGBColor(e){this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e=e.replace(/ /g,""),e=e.toLowerCase();var t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var n in t)e==n&&(e=t[n]);for(var i=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],o=0;o<i.length;o++){var s=i[o].re,a=i[o].process,r=s.exec(e);r&&(channels=a(r),this.r=channels[0],this.g=channels[1],this.b=channels[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),n=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==n.length&&(n="0"+n),"#"+e+t+n},this.getHelpXML=function(){for(var e=new Array,n=0;n<i.length;n++)for(var o=i[n].example,s=0;s<o.length;s++)e[e.length]=o[s];for(var a in t)e[e.length]=a;var r=document.createElement("ul");r.setAttribute("id","rgbcolor-examples");for(var n=0;n<e.length;n++)try{var l=document.createElement("li"),u=new RGBColor(e[n]),d=document.createElement("div");d.style.cssText="margin: 3px; border: 1px solid black; background:"+u.toHex()+"; color:"+u.toHex(),d.appendChild(document.createTextNode("test"));var c=document.createTextNode(" "+e[n]+" -> "+u.toRGB()+" -> "+u.toHex());l.appendChild(d),l.appendChild(c),r.appendChild(l)}catch(p){}return r}}function getProperFigureClass(e){var t=null;switch(e.type){case"draw2d.shape.node.InputObj":t=new draw2d.shape.node.InputObj(e.id);break;case"draw2d.shape.node.OutputObj":t=new draw2d.shape.node.OutputObj(e.id);break;case"draw2d.shape.node.ConstantValueObj":t=new draw2d.shape.node.ConstantValueObj("/img/icons/Constant.svg",e.id);break;case"draw2d.shape.node.InputObjExternalPoint":t=new draw2d.shape.node.InputObjExternalPoint(e.id);break;case"draw2d.shape.node.InputObjExternalGPL":t=new draw2d.shape.node.InputObjExternalGPL(e.id);break;case"draw2d.shape.node.InputObjInternalReference":t=new draw2d.shape.node.InputObjInternalReference(e.id);break;case"draw2d.shape.node.OutputObjExternalPoint":t=new draw2d.shape.node.OutputObjExternalPoint(e.id);break;case"draw2d.shape.node.OutputObjExternalGPL":t=new draw2d.shape.node.OutputObjExternalGPL(e.id);break;case"draw2d.shape.node.OutputObjInternalReference":t=new draw2d.shape.node.OutputObjInternalReference(e.id);break;case"draw2d.shape.node.ConstantInternalReference":t=new draw2d.shape.node.ConstantInternalReference(e.id);break;case"draw2d.shape.node.SingleSetPointBinarySelectorObject":t=new draw2d.shape.node.SingleSetPointBinarySelectorObject("/img/icons/SingleSetPointBinary.svg",e.id);break;case"draw2d.shape.node.DualSetPointBinarySelectorObject":t=new draw2d.shape.node.DualSetPointBinarySelectorObject("/img/icons/DualSetPointBinary.svg",e.id);break;case"draw2d.shape.node.DualSetPointAnalogSelectorObject":t=new draw2d.shape.node.DualSetPointAnalogSelectorObject("/img/icons/DualSetPointAnalog.svg",e.id);break;case"draw2d.shape.node.SingleSetPointAnalogSelectorObject":t=new draw2d.shape.node.SingleSetPointAnalogSelectorObject("/img/icons/SingleSetPointAnalog.svg",e.id);break;case"draw2d.shape.node.DelayPointObject":t=new draw2d.shape.node.DelayPointObject("/img/icons/DelayPoint.svg",e.id);break;case"draw2d.shape.node.PulsedDelayPointObject":t=new draw2d.shape.node.PulsedDelayPointObject("/img/icons/PulsedDelayPoint.svg",e.id);break;case"draw2d.shape.node.LogicalPointObject":t=new draw2d.shape.node.LogicalPointObject("/img/icons/Logical.svg",e.id);break;case"draw2d.shape.node.MultiplexerPointObject":t=new draw2d.shape.node.MultiplexerPointObject("/img/icons/Multiplexer.svg",e.id);break;case"draw2d.shape.node.RampPointObject":t=new draw2d.shape.node.RampPointObject("/img/icons/Ramp.svg",e.id);break;case"draw2d.shape.node.TotalizerPointObject":t=new draw2d.shape.node.TotalizerPointObject("/img/icons/Totalizer.svg",e.id);break;case"draw2d.shape.node.AveragePointObject":t=new draw2d.shape.node.AveragePointObject("/img/icons/Average.svg",e.id);break;case"draw2d.shape.node.SummationPointObject":t=new draw2d.shape.node.SummationPointObject("/img/icons/Summation.svg",e.id);break;case"draw2d.shape.node.SelectValueLargestPointObject":t=new draw2d.shape.node.SelectValueLargestPointObject("/img/icons/SelectValueHigh Value.svg",e.id);break;case"draw2d.shape.node.SelectValueSmallestPointObject":t=new draw2d.shape.node.SelectValueSmallestPointObject("/img/icons/SelectValueLow Value.svg",e.id);break;case"draw2d.shape.node.AdditionPointSRObject":t=new draw2d.shape.node.AdditionPointSRObject("/img/icons/AddTrue.svg",e.id);break;case"draw2d.shape.node.AdditionPointObject":t=new draw2d.shape.node.AdditionPointObject("/img/icons/AddFalse.svg",e.id);break;case"draw2d.shape.node.SubtractionPointObject":t=new draw2d.shape.node.SubtractionPointObject("/img/icons/SubtractFalse.svg",e.id);break;case"draw2d.shape.node.SubtractionPointSRObject":t=new draw2d.shape.node.SubtractionPointSRObject("/img/icons/SubtractTrue.svg",e.id);break;case"draw2d.shape.node.MultiplicationPointObject":t=new draw2d.shape.node.MultiplicationPointObject("/img/icons/MultiplyFalse.svg",e.id);break;case"draw2d.shape.node.MultiplicationPointSRObject":t=new draw2d.shape.node.MultiplicationPointSRObject("/img/icons/MultiplyTrue.svg",e.id);break;case"draw2d.shape.node.DivisionPointObject":t=new draw2d.shape.node.DivisionPointObject("/img/icons/DivideFalse.svg",e.id);break;case"draw2d.shape.node.DivisionPointSRObject":t=new draw2d.shape.node.DivisionPointSRObject("/img/icons/DivideTrue.svg",e.id);break;case"draw2d.shape.node.ProportionalPointObject":t=new draw2d.shape.node.ProportionalPointObject("/img/icons/P OnlyFalse.svg",e.id);break;case"draw2d.shape.node.ProportionalReversePointObject":t=new draw2d.shape.node.ProportionalReversePointObject("/img/icons/P OnlyTrue.svg",e.id);break;case"draw2d.shape.node.SetPointAdjustNormalPointObject":t=new draw2d.shape.node.SetPointAdjustNormalPointObject("/img/icons/SetPointAdjustNormal.svg",e.id);break;case"draw2d.shape.node.SetPointAdjustReversedPointObject":t=new draw2d.shape.node.SetPointAdjustReversedPointObject("/img/icons/SetPointAdjustReversed.svg",e.id);break;case"draw2d.shape.node.EconomizerPointObject":t=new draw2d.shape.node.EconomizerPointObject("/img/icons/Economizer.svg",e.id);break;case"draw2d.shape.node.EnthalpyPointObject":t=new draw2d.shape.node.EnthalpyPointObject("/img/icons/Enthalpy.svg",e.id);break;case"draw2d.shape.node.EnthalpyDewPointObject":t=new draw2d.shape.node.EnthalpyDewPointObject("/img/icons/EnthalpyDewPoint.svg",e.id);break;case"draw2d.shape.node.EnthalpyWetBulbObject":t=new draw2d.shape.node.EnthalpyWetBulbObject("/img/icons/EnthalpyWetBulb.svg",e.id);break;case"draw2d.shape.node.GreaterComparatorPointObject":t=new draw2d.shape.node.GreaterComparatorPointObject("/img/icons/Greater.svg",e.id);break;case"draw2d.shape.node.LessComparatorPointObject":t=new draw2d.shape.node.LessComparatorPointObject("/img/icons/Less.svg",e.id);break;case"draw2d.shape.node.GreaterOrEqualComparatorPointObject":t=new draw2d.shape.node.GreaterOrEqualComparatorPointObject("/img/icons/GreaterOrEqual.svg",e.id);break;case"draw2d.shape.node.LessOrEqualComparatorPointObject":t=new draw2d.shape.node.LessOrEqualComparatorPointObject("/img/icons/LessOrEqual.svg",e.id);break;case"draw2d.shape.node.EqualComparatorPointObject":t=new draw2d.shape.node.EqualComparatorPointObject("/img/icons/Equal.svg",e.id);break;case"draw2d.shape.node.NotEqualComparatorPointObject":t=new draw2d.shape.node.NotEqualComparatorPointObject("/img/icons/NotEqual.svg",e.id);break;case"draw2d.shape.node.AndDigitalLogicPointObject":t=new draw2d.shape.node.AndDigitalLogicPointObject("/img/icons/And.svg",e.id);break;case"draw2d.shape.node.OrDigitalLogicPointObject":t=new draw2d.shape.node.OrDigitalLogicPointObject("/img/icons/Or.svg",e.id);break;case"draw2d.shape.node.XorDigitalLogicPointObject":t=new draw2d.shape.node.XorDigitalLogicPointObject("/img/icons/X-or.svg",e.id);break;case"draw2d.shape.note.ExtLabel":t=new draw2d.shape.note.ExtLabel(e.id);break;case"draw2d.shape.note.ExtDynamicPoint":t=new draw2d.shape.note.ExtDynamicPoint(e.id);break;case"draw2d.Connection":t=new draw2d.Connection(e.id);break;case"draw2d.shape.node.AlarmStatusPointObject":t=new draw2d.shape.node.AlarmStatusPointObject("/img/icons/AlarmStatusfalsefalsefalsefalse.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInAlarmObject":t=new draw2d.shape.node.AlarmStatusInAlarmObject("/img/icons/AlarmStatusInAlarm.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInFaultObject":t=new draw2d.shape.node.AlarmStatusInFaultObject("/img/icons/AlarmStatusInAlarmInFault.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInOutofServiceObject":t=new draw2d.shape.node.AlarmStatusInOutofServiceObject("/img/icons/AlarmStatusOutofService.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInOverrideObject":t=new draw2d.shape.node.AlarmStatusInOverrideObject("/img/icons/AlarmStatusOverriden.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInAlarmInFaultObject":t=new draw2d.shape.node.AlarmStatusInAlarmInFaultObject("/img/icons/AlarmStatusInAlarmInFault.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInAlarmInFaultInOutofServiceObject":t=new draw2d.shape.node.AlarmStatusInAlarmInFaultInOutofServiceObject("/img/icons/AlarmStatusInAlarmInFaultOutOfService.svg",e.id);break;case"draw2d.shape.node.AlarmStatusAllTrueObject":t=new draw2d.shape.node.AlarmStatusAllTrueObject("/img/icons/AlarmStatustruetruetruetrue.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInFaultInOverrideObject":t=new draw2d.shape.node.AlarmStatusInFaultInOverrideObject("/img/icons/AlarmStatusInFaultOverriden.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInOutofServiceInOverrideObject":t=new draw2d.shape.node.AlarmStatusInOutofServiceInOverrideObject("/img/icons/AlarmStatusOutofServiceOverriden.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInFaultInOutofServiceObject":t=new draw2d.shape.node.AlarmStatusInFaultInOutofServiceObject("/img/icons/AlarmStatusInFaultOutofService.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInAlarmInOverrideObject":t=new draw2d.shape.node.AlarmStatusInAlarmInOverrideObject("/img/icons/AlarmStatusInAlarmOverriden.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInAlarmInOutofServiceObject":t=new draw2d.shape.node.AlarmStatusInAlarmInOutofServiceObject("/img/icons/AlarmStatusInAlarmOutofService.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInFaultInOutofServiceInOverrideObject":t=new draw2d.shape.node.AlarmStatusInFaultInOutofServiceInOverrideObject("/img/icons/AlarmStatusPointAllFalse.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInAlarmInOutofServiceInOverrideObject":t=new draw2d.shape.node.AlarmStatusInFaultInOverrideObject("/img/icons/AlarmStatusInAlarmOutofServiceOverriden.svg",e.id);break;case"draw2d.shape.node.AlarmStatusInAlarmInFaultInOverrideObject":t=new draw2d.shape.node.AlarmStatusInAlarmInFaultInOverrideObject("/img/icons/AlarmStatusInAlarmInFaultOverriden.svg",e.id)}return t}function Properties(uniqueId,shape){this.shape=shape,this.shapeCategory="",this.isNewlyAdded=!1,this.delete=!1,this.justDeleted=!1,this.id=ko.observable(uniqueId),this.upi=ko.observable(0),this.iconChange=ko.observable({}),this.givenName=ko.observable(),this.isAccessed=ko.observable(!1),this.updated=ko.observable(!1),this.previousVersion=ko.observable({}),this.isEnum=ko.observable(!0),this.internalReferenceType={},this.isConstantEnumAllowed=ko.observable(!1),this.constantReference=ko.observable(!1),this.showLabel=ko.observable(!0),this.showValue=ko.observable(!0),this.lbl=ko.observable(),this.valueOptions=ko.observableArray([]),this.precision=ko.observable(),this.numOfDecimals=ko.observable("3"),this.numOfCharacters=ko.observable("3"),this.maxOutputChange=ko.observable("100.000"),this.propertiesArray=ko.observableArray([]),this.referencePoint=ko.observable(),this.referenceType=ko.observable(),this.referenceList=ko.observableArray([]),this.segment=ko.observable(""),this.valueType=ko.observable(""),this.valu=ko.observable(),this.constantEnum=ko.observable(""),this.constantFloat=ko.observable(0),this.referenceTypes=ko.observableArray(),this.calculationTypes=ko.observableArray(),this.internalRef=ko.observable(),this.internalRefs=ko.observableArray([]),this.iconChangeFn=function(e){var t=null,n=window.app.view.getFigure(this.id());$(n.children.data).each(function(e,n){n&&n.figure.path&&n.figure.path.indexOf(".svg")>0&&(t=n.figure)}),window.app.view.removeFigure(t);var i=new draw2d.shape.basic.Image;i.init("/img/icons/"+e+".svg",60,60),n.addFigure(i,new draw2d.layout.locator.CenterLocator(n))},this.showLabel.subscribe(function(e){var t=window.app.view.getFigure(this.id());t.label.visible=e,t.label.repaint()},this),this.showValue.subscribe(function(e){var t=window.app.view.getFigure(this.id());t.displayText.visible=e,t.displayText.repaint()},this),this.valueType.subscribe(function(e){if(!GPLViewModel.isViewer()&&void 0!=e){var t=window.app.view.getFigure(this.id());"Enum"==e?t.displayText.setText("StText QC"):t.displayText.setText("512.6 QC"),t.displayText.setFontColor("#bf070a"),t.displayText.setFontSize(8),t.displayText.setFontFamily("Trebuchet"),t.displayText.setBold(!0),t.displayText.repaint()}},this),this.valu.subscribe(function(e){if(void 0!=e&&null!=e&&("Monitor"==this.shapeCategory||"Control"==this.shapeCategory||"Constant"==this.shapeCategory))for(var t=window.app.view.getFigure(this.id()),n=this.id()+"_0",i=t.getPort(n).getConnections(),o=0;o<i.getSize();o++){var s=i.get(o);if("draw2d.shape.node.ConstantValueObj"==t.NAME)this.constantWorks(s.targetPort);else if("draw2d.shape.node.ConstantInternalReference"==t.NAME){var a=t.props()["Internal Reference"].Value;this.constantWorks(s.targetPort,a)}else"Control"==GPLViewModel.getProp(s.targetPort.parent.id).shapeCategory?(this.setSourceTargetProperty(s.sourcePort.parent.id,e,s.sourcePort.propertyRepresented,e._id),GPLViewModel.getDProp(s.targetPort.parent.id,"UPI").Value().Value=e._id):(this.setSourceTargetProperty(s.targetPort.parent.id,e,s.targetPort.propertyRepresented,e._id),GPLViewModel.getDProp(s.sourcePort.parent.id,"UPI").Value().Value=e._id)}},this),this.setSourceTargetProperty=function(e,t,n,i){GPLViewModel.ensureAllUnderlyingProperties(e);var o=window.app.view.getFigure(e),s=o.props();GPLViewModel.getProp(e).previousVersion(JSON.stringify(s)),s[n].Value=i;var a={point:s,oldPoint:s,refPoint:t,property:n},r=Config.Update.formatPoint(a);GPLViewModel.getProp(e).setProps(r),GPLViewModel.getProp(e).updated(!0)},this.constantFloat.subscribe(function(e){this.isEnum(!1),this.valu(parseInt(e))},this),this.constantEnum.subscribe(function(e){this.isEnum(!0),this.valu(parseInt(e))},this),this.lbl.subscribe(function(e){var t=window.app.view.getFigure(this.id());this.internalRefChangeTrack=e,t.label.setText(e),t.repaint(),t.label.repaint()},this),this.setProps=function(e){var t=this;for(var n in e)t.propertiesArray.push(new PropValue(n,e[n]))},this.setPersistentAttributes=function(e){var t=this;if(void 0!==e)if(t.id(e.id),t.valueType(e.valueType),t.propertiesArray([]),e.props){for(var n in e.props)t.propertiesArray.push(new PropValue(n,e.props[n]));if(e.props._id)t.upi(e.props._id);else if(e.props.UPI&&(t.upi(e.props.UPI.Value),e.props["Reference Type"])){if(e.props["Reference Type"].Value.indexOf("InternalRef")>-1){var i="";e.props["Internal Reference"]?i=e.props["Internal Reference"].Value:GPLViewModel.getPropByUPI(this.upi(),this.id())?i=GPLViewModel.getPropByUPI(this.upi(),this.id()).id():iToast.showError("Error","This sequence has an some points UPI missing."),t.internalRef(i)}t.referenceType(e.props["Reference Type"].Value)}e.props["Value Type"]&&("draw2d.shape.node.ConstantValueObj"==e.type&&"Float"==e.props["Value Type"].Value?t.constantFloat(e.props["Constant Value"].Value):"draw2d.shape.node.ConstantValueObj"==e.type&&"Enum"==e.props["Value Type"].Value&&t.constantEnum(e.props["Constant Value"].Value),t.valueType(e.props["Value Type"].Value)),t.lbl(e.label),t.showLabel(e.showLabel),t.showValue(e.showValue),t.precision(e.precision),e.props["Reference Type"]&&(t.internalReferenceType=e.props["Reference Type"].Value)}else{var o=Config.Templates.Points[e.typ];for(var n in o)t.propertiesArray.push(new PropValue(n,o[n]))}},this.getPersistentAttributes=function(){var e=window.app.view.getFigure(this.id());return{type:e.NAME,id:e.id,x:e.x,y:e.y,color:e.getColor().hash(),stroke:e.getStroke(),label:e.label.getText(),showValue:this.showValue(),showLabel:this.showLabel(),precision:this.precision(),props:e.props()}},this.getProperty=function(e){return ko.utils.arrayFirst(this.propertiesArray(),function(t){return t.Name==e})},this.getPointDetails=function(e){var t=this;null!=e&&0!=e&&$.ajax({url:"/api/points/"+e,type:"get",async:!1,cache:!1,success:function(e){t.segment(e.Name)}})},this.isVisible=function(e,t){return null==e.getProperty(t)?!1:0==e.getProperty(t).Value().Value?!1:!0},this.getName=function(e,t){if(null==e.getProperty(t)||void 0==e.getProperty(t))return"";if(0==e.getProperty(t).Value().Value)return"";var n=GPLViewModel.getPropByUPI(e.getProperty(t).Value().Value);return n.lbl()},this.getPropByUPI=function(e){$.ajax({url:"/api/points/"+e,type:"get",async:!1,cache:!1,success:function(e){return e}})},this.changeSelect=function(e,t){0!=this.selectedIndex&&null!=e.getProperty(t)&&(e.getProperty(t).Value().Value=this.selectedOptions[0].text,e.getProperty(t).Value().eValue=this.selectedOptions[0].value)},this.changeVal=function(e,t,n){this.getProperty(e).Value().Value=n.target.value},this.staticVal=function(data,prop,changeIcon){return eval("data."+prop+"(this.value);"),changeIcon&&this.iconChangeFn(this.value,data),!0},this.staticCheck=function(data,prop){return eval("data."+prop+"(this.checked);"),!0},this.changeChecked=function(e,t){return e.getProperty(t).Value().Value=this.checked,!0},this.updateInterval=function(e,t){if(t)e.getProperty("Update Interval").Value().Value+=60*Number(this.value);else{var n=e.getProperty("Update Interval").Value().Value;e.getProperty("Update Interval").Value().Value=n>60?n-n%60+Number(this.value):Number(this.value)}},this.setValueText=function(e,t){var n=window.app.view.getFigure(this.id()),i=Number(e).toFixed(this.precision());"NaN"==i&&(i=e),t?(n.displayText.setText(i+" "+t["Quality Code"]),n.displayText.setFontColor("#"+t["Quality Code Font HTML Color"])):n.displayText.setText(i)},this.constantWorks=function(e,t){var n=t?GPLViewModel.getProp(t):this,i={isDisplayable:!0,isReadOnly:!1,ValueType:n.isEnum()?5:1,Value:n.isEnum()?n.constantEnum():n.constantFloat()},o=e.alternateProperty||e.propertyRepresented;GPLViewModel.getProp(e.parent.id).previousVersion(JSON.stringify(e.parent.getPersistentAttributes().props));var s={point:e.parent.props(),oldPoint:e.parent.props(),refPoint:i,property:o};console.log(s);var a=Config.Utility.createActivityLog(s);a[o].Value=i.Value,a[o].ValueType=i.ValueType,GPLViewModel.getProp(e.parent.id).setProps(a),GPLViewModel.getProp(e.parent.id).updated(!0)}}var fs,enumsTemplatesFile,enumsTemplatesJson,Config;try{fs=require("fs"),enumsTemplatesFile=__dirname+"/enumsTemplates.json",enumsTemplatesJson=JSON.parse(fs.readFileSync(enumsTemplatesFile));var _=require("underscore")}catch(e){console.log("e",e)}Config=function(){var e={},t=[];return e.apiURL="http://www.infoscanweb.com",e.apiLink="www.infoscanweb.com",e.apiIp="65.41.39.24",e.deadbandFactor=.1,e.Test={test:function(){return console.log("inside test"),!0}},e.Utility={createActivityLog:function(e){return e.point[e.property]["Activity Log"]={log:"Created"},e},clone:function(e){if(null===e||"object"!=typeof e)return e;var t=e.constructor();for(var n in e)t[n]=clone(e[n]);return t},isNumber:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},e.Update={formatPoint:function(e){var t=Math.pow(10,36),n=-1*Math.pow(10,36),i=e.point[e.property].ValueType,o=e.point[e.property].Value;return e.hasOwnProperty("refPoint")===!1&&(e.refPoint=null),e.ok=!0,(i===enumsTemplatesJson.Enums["Value Types"].Float["enum"]||i===enumsTemplatesJson.Enums["Value Types"].Integer["enum"]||i===enumsTemplatesJson.Enums["Value Types"].Unsigned["enum"])&&(Config.Utility.isNumber(o)===!1?(e.ok=!1,e.result="The value entered contains invalid characters. It must be a number."):i===enumsTemplatesJson.Enums["Value Types"].Float["enum"]&&(o>t?(e.ok=!1,e.result=e.property+" must be less than "+t+" (that's a 1 with 36 zeroes!)."):n>o&&(e.ok=!1,e.result=e.property+" must be greater than "+n+" (that's a -1 with 36 zeroes!)."))),e.ok===!0&&(Config.EditValidation.hasOwnProperty(e.property)?e=Config.EditValidation[e.property](e):(e.ok=!1,e.result="Internal validation error. No handler for property '"+e.property+"'.")),e.ok===!0?(e=Config.Utility.createActivityLog(e),e.point):{err:e.result}}},e.Get={formatPoint:function(e){var n=e.point;return pointType=n["Point Type"].Value,refPoint=e.refPoint?e.refPoint:null,property=e.property?e.property:null,t=[],n._cfgRequired=!1,n._updPoint=!1,n._updTOD=!1,"Configure Device"==property?n=Config.EditChanges.applyConfigureDevice(e):"Reliability"==property?n=Config.EditChanges.applyReliability(e):"Alarm State"==property?n=Config.EditChanges.applyAlarmState(e):"Device Status"==property?n=Config.EditChanges.applyDeviceStatus(e):"Value"==property&&n.Value.ValueType===enumsTemplatesJson.Enums["Value Types"].Enum["enum"]?n=Config.EditChanges.applyValue(e):"Authorized Value"==property?n=Config.EditChanges.applyAuthorizedValue(e):"Control Point"==property?n=Config.EditChanges.applyControlPoint(e):"Interlock Point"==property?n=Config.EditChanges.applyInterlockPoint(e):"Select Input"==property?n=Config.EditChanges.applySelectInput(e):"Shutdown Point"==property?n=Config.EditChanges.applyShutdownPoint(e):"Trigger Point"==property?n=Config.EditChanges.applyTriggerPoint(e):("Alarm Adjust Point"==property||"Alarm Display Point"==property)&&(n=Config.EditChanges.applyUniquePIDLogic(e)),"Analog Input"==pointType&&"Sensor Point"==property?n=Config.EditChanges.applyAnalogInputTypeSensorPoint(e):"Analog Output"==pointType&&"Sensor Point"==property?n=Config.EditChanges.applyAnalogOutputTypeSensorPoint(e):"Binary Input"==pointType&&"Feedback Point"==property?n=Config.EditChanges.applyBinaryInputTypeFeedbackPoint(e):"Delay"==pointType&&"Monitor Point"==property?n=Config.EditChanges.applyDelayPointTypeMointorPoint(e):"Comparator"==pointType&&"Input Point 1"==property?n=Config.EditChanges.applyComparatorPointTypeInputPoint1(e):"Comparator"==pointType&&"Input Point 2"==property?n=Config.EditChanges.applyComparatorPointTypeInputPoint2(e):"Logic"==pointType&&"Input Point 1"==property?n=Config.EditChanges.applyLogicPointTypeInputPoint1(e):"Logic"==pointType&&"Input Point 2"==property?n=Config.EditChanges.applyLogicPointTypeInputPoint2(e):"Logic"==pointType&&"Input Point 3"==property?n=Config.EditChanges.applyLogicPointTypeInputPoint3(e):"Logic"==pointType&&"Input Point 4"==property?n=Config.EditChanges.applyLogicPointTypeInputPoint4(e):"Logic"==pointType&&"Input Point 5"==property?n=Config.EditChanges.applyLogicPointTypeInputPoint5(e):"Math"==pointType&&"Input Point 1"==property?n=Config.EditChanges.applyMathPointTypeInputPoint1(e):"Math"==pointType&&"Input Point 2"==property?n=Config.EditChanges.applyMathPointTypeInputPoint2(e):"Multiplexer"==pointType&&"Input Point 1"==property?n=Config.EditChanges.applyMultiplexerPointTypeInputPoint1(e):"Multiplexer"==pointType&&"Input Point 2"==property&&(n=Config.EditChanges.applyMultiplexerPointTypeInputPoint2(e)),n}},e.EditValidation={validateUsingTheseLimits:function(e,t,n){var i=e.point,o=i[e.property].Value;return e.ok=!1,t>o?e.result=e.property+" cannot be less than "+t+".":o>n?e.result=e.property+" cannot be greater than "+n+".":e.ok=!0,e},validateUsingMaxMinKeys:function(e){var t=e.point,n=t[e.property].Max,i=t[e.property].Min;return this.validateUsingTheseLimits(e,i,n)},validateNameSegment:function(e){var t=e.point,n=t[e.property].Value,i=n.length;return e.ok=!1,i>40?e.result=e.property+" cannot be more than 40 characters.":-1!==n.indexOf("_")?e.result="The underscore character, '_', is reserved.":e.ok=!0,e},validatePortNAddress:function(e){var t=e.point,n=(t[e.property].Value,t["Point Type"].Value);return e.ok=!1,"Device"!==n?e.result="Internal validation error. Point type '"+n+"' does not support this property.":e=this.validateUsingTheseLimits(e,0,127),e},validateNetworkNumber:function(e){var t,n,i=e.point,o=e.point[e.property].Value,s=["Port 1 Network","Port 2 Network","Port 3 Network","Port 4 Network","Downlink Network","Ethernet Network"],a=s.length;for(n=0;a>n;n++)if(t=s[n],t!==e.property&&i.hasOwnProperty(t)&&i[t].isReadOnly===!1&&i[t].isDisplayable===!0&&o===i[t].Value){e.ok=!1,e.result="Please enter a network number different from the "+t+" number.";break}return e},validatePortNNetwork:function(e){var t=e.point,n=(t[e.property].Value,t["Point Type"].Value);return e.ok=!1,"Device"!==n?e.result="Internal validation error. Point type '"+n+"' does not support this property.":(e=this.validateUsingMaxMinKeys(e),e.ok===!0&&(e=this.validateNetworkNumber(e))),e},validatePortNProtocol:function(e){var t=e.point,n=(t[e.property].Value,t["Point Type"].Value);return e.ok=!1,"Device"!==n?e.result="Internal validation error. Point type '"+n+"' does not support this property.":(e.ok=!0,e.point=Config.EditChanges.applyDeviceTypePortNProtocol(e)),e},validateIfCRVN:function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Logic"!==n&&(e.ok=!1,e.result="Internal error. Point type '"+n+"' is not supported."),e},validateChannelUniqueness:function(e){var t,n,i=e.point,o=i[e.property].Value,s=["Channel","Feedback Channel","On Channel","Off Channel","Open Channel","Close Channel"],a=s.length;for(e.ok=!0,n=0;a>n;n++)if(t=s[n],t!==e.property&&i.hasOwnProperty(t)&&i[t].isDisplayable===!0&&i[t].isReadOnly===!1&&o===i[t].Value){e.ok=!1,e.result=e.property+" number cannot be the same as the "+t+" number.";break}},"Active Control":function(e){return e.ok=!0,e},"Active Release":function(e){return e.ok=!0,e},"Active Text":function(e){var t=e.point,n=t[e.property].Value,i=n.length;return e.ok=!1,1>i?e.result=e.property+" must have at least one character.":i>40?e.result=e.property+" is limited to 40 characters.":n.toLowerCase()===t["Inactive Text"].Value.toLowerCase()?e.result=e.property+" must be different from the Inactive Text.":(e.ok=!0,e.point=Config.EditChanges.applyActiveText(e)),e},"Alarm Adjust Band":function(e){var t=e.point,n=t[e.property].Value,i=t["High Alarm Limit"].Value-t["Low Alarm Limit"].Value;return e.ok=!1,n<t["Alarm Deadband"].Value?e.result=e.property+" must be greater than or equal to the Alarm Deadband ("+t["Alarm Deadband"].Value+").":t["Alarm Adjust Band"].Value>i?e.result=e.property+" must be less than or equal to the High Alarm Limit - Low Alarm Limit ("+i+").":e.ok=!0,e},"Alarm Adjust Point":function(e){return e.ok=!0,e.point=Config.EditChanges.applyUniquePIDLogic(e),e},"Alarm Class":function(e){return e.ok=!0,e},"Alarm Deadband":function(e){var t=e.point,n=t[e.property].Value,i=Math.abs(t["Maximum Value"].Value-t["Minimum Value"].Value)*Config.deadbandFactor;return e.ok=!1,0>n?e.result=e.property+" must be greater than or equal to 0.":n>i?e.result=e.property+" can be no more than "+100*Config.deadbandFactor+"% of (Maximum Value - Minimum Value), ("+i+").":e.ok=!0,e},"Alarm Delay Time":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!0,60>n&&(e.ok=!1,e.result=e.property+" cannot be less than 1 minute."),e},"Alarm Display Point":function(e){return e.ok=!0,e},"Alarm Inhibit":function(e){return e.ok=!0,e},"Alarm Repeat Enable":function(e){return e.ok=!0,e.point=Config.EditChanges.applyDeviceAlarmRepeatEnable(e),e},"Alarm Repeat Time":function(e){return e.ok=!0,e},"Alarm State":function(e){return e.ok=!0,e.point=Config.EditChanges.applyAlarmState(e),e},"Alarm Value":function(e){return e.ok=!0,e},"Alarms Off":function(e){return e.ok=!0,e},"APDU Retries":function(e){return this.validateUsingTheseLimits(e,0,5)},"APDU Timeout":function(e){return this.validateUsingTheseLimits(e,5,60)},"Authorized Value":function(e){return e.ok=!0,e.point=Config.EditChanges.applyAuthorizedValue(e),e},"Begin Day":function(e){return this.validateUsingMaxMinKeys(e)},"Begin Month":function(e){return this.validateUsingMaxMinKeys(e)},"Begin Year":function(e){return this.validateUsingMaxMinKeys(e)},"Broadcast Enable":function(e){return e.ok=!0,e},Channel:function(e){return e=this.validateUsingMaxMinKeys(e),e.ok===!0&&(e=this.validateChannelUniqueness(e)),e},"Close Channel":function(e){return e=this.validateUsingMaxMinKeys(e),e.ok===!0&&(e=this.validateChannelUniqueness(e)),e},"Close Polarity":function(e){return e.ok=!0,e},"Configure Device":function(e){return e.ok=!0,e},"Control Data Type":function(e){return e.ok=!0,e},"Control Function":function(e){return e.ok=!0,e
},"Control Pending":function(e){return e.ok=!0,e},"Control Register":function(e){return this.validateUsingTheseLimits(e,1,65535)},"Conversion Adjustment":function(e){return e.ok=!0,e},"Conversion Coefficient 1":function(e){return e.ok=!0,e},"Conversion Coefficient 2":function(e){return e.ok=!0,e},"Conversion Coefficient 3":function(e){return e.ok=!0,e},"Conversion Coefficient 4":function(e){return e.ok=!0,e},"Conversion Type":function(e){return e.ok=!0,e.point=Config.EditChanges.applyConversionTypeProperty(e),e},"Cooling Season":function(e){return e.ok=!0,e},"Cooling Setpoint":function(e){var t=e.point,n=t[e.property].Value,i=t["Heating Setpoint"].Value+2*t["Input Deadband"].Value;return e.ok=!1,i>=n?e.result="Cooling Setpoint must be greater than the Heating Setpoint plus 2*Input Deadband ("+i+").":e.ok=!0,e},"COV Enable":function(e){return e.ok=!0,e.point=Config.EditChanges[e.property](e),e},"COV Increment":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!0,0>=n&&(e.ok=!1,e.result=e.property+" must be greater than 0."),e},"COV Period":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!0,10>n&&(e.ok=!1,e.result=e.property+" must be 10 seconds or greater."),e},"Days Active":function(e){return e.ok=!0,e},"Delay Time":function(e){return e.ok=!0,e},"Demand Enable":function(e){return e.ok=!0,e.point=Config.EditChanges[e.property](e),e},"Demand Interval":function(e){return e.ok=!0,e},Description:function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,n.length>80?e.result="Description cannot be more than 80 characters.":e.ok=!0,e},"Device Point":function(e){return e.ok=!0,e},"Device Status":function(e){return e.ok=!0,e.point=Config.EditChanges.applyDeviceStatus(e),e},"Disable Limit Fault":function(e){return e.ok=!0,e},"Dry Bulb Point":function(e){return e.ok=!0,e},"Enable Schedule":function(e){return e.ok=!0,e},"Enable Warning Alarms":function(e){return e.ok=!0,e.point=Config.EditChanges.applyEnableWarningAlarms(e),e},"End Day":function(e){return this.validateUsingMaxMinKeys(e)},"End Month":function(e){return this.validateUsingMaxMinKeys(e)},"End Year":function(e){return this.validateUsingMaxMinKeys(e)},"Engineering Units":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,n.length>20?e.result="Engineering Units must be 20 characters or less.":e.ok=!0,e},"Execute Now":function(e){return e.ok=!0,e},"Fail Action":function(e){return e.ok=!0,e},"Fall Time":function(e){return e.ok=!0,e},"Fast Pulse":function(e){return e.ok=!0,e},"Feedback Channel":function(e){return e=this.validateUsingMaxMinKeys(e),e.ok===!0&&(e=this.validateChannelUniqueness(e)),e},"Feedback Polarity":function(e){return e.ok=!0,e},Filter:function(e){return e.ok=!0,e},"Filter Weight":function(e){return this.validateUsingTheseLimits(e,0,1)},"Firmware Revision":function(e){return e.ok=!0,e},"Heating Season":function(e){return e.ok=!0,e},"Heating Setpoint":function(e){var t=e.point,n=t[e.property].Value,i=t["Cooling Setpoint"].Value-2*t["Input Deadband"].Value;return e.ok=!1,n>=i?e.result=e.property+" must be less than the Cooling Setpoint minus 2*Input Deadband ("+i+").":e.ok=!0,e},"High Alarm Limit":function(e){var t=e.point,n=t[e.property].Value,i=t["Low Alarm Limit"].Value+2*t["Alarm Deadband"].Value;return e.ok=!1,n>t["Maximum Value"].Value?e.result=e.property+" cannot be greater than the Maximum Value ("+t["Maximum Value"].Value+").":t["Enable Warning Alarms"].Value===!0&&n<t["High Warning Limit"].Value?e.result=e.property+" cannot be less than the High Warning Limit ("+t["High Warning Limit"].Value+").":i>n?e.result=e.property+" cannot be less than the Low Alarm Limit plus twice the Alarm Deadband ("+i+").":e.ok=!0,e},"High Deadband":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,0>n?e.result=e.property+" must be 0 or greater.":e.ok=!0,e},"High Setpoint":function(e){var t=e.point,n=t[e.property].Value,i=t["Low Setpoint"].Value+2*t["Input Deadband"].Value;return e.ok=!1,i>=n?e.result=e.property+" must be greater than the Low Setpoint plus twice the Input Deadband ("+i+").":e.ok=!0,e},"High Warning Limit":function(e){var t=e.point,n=t[e.property].Value,i=t["Low Warning Limit"].Value+2*t["Alarm Deadband"].Value;return e.ok=!1,n>t["High Alarm Limit"].Value?e.result=e.property+" cannot be greater than the High Alarm Limit ("+t["High Alarm Limit"].Value+").":i>n?e.result=e.property+" cannot be less than the Low Warning Limit plus twice the Alarm Deadband ("+i+")":e.ok=!0,e},"Host Schedule":function(e){return e.ok=!0,e},"Humidity Point":function(e){return e.ok=!0,e},"In Alarm":function(e){return e.ok=!0,e},"In Fault":function(e){return e.ok=!0,e},"In Out of Service":function(e){return e.ok=!0,e},"In Override":function(e){return e.ok=!0,e},"Inactive Control":function(e){return e.ok=!0,e},"Inactive Text":function(e){var t=e.point,n=t[e.property].Value,i=n.length;return e.ok=!1,1>i?e.result=e.property+" must have at least one character.":i>40?e.result=e.property+" is limited to 40 characters.":n.toLowerCase()===t["Active Text"].Value.toLowerCase()?e.result=e.property+" must be different from the Active Text.":(e.ok=!0,e.point=Config.EditChanges.applyInactiveText(e)),e},"Input Deadband":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,0>n?e.result=e.property+" cannot be less than 0.":e.ok=!0,e},"Input High Limit":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,n<t["Input Low Limit"].Value?e.result=e.property+" cannot be less than the Input Low Limit ("+t["Input Low Limit"].Value+").":e.ok=!0,e},"Input Low Limit":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,n>t["Input High Limit"].Value?e.result=e.property+" cannot be greater than the Input High Limit ("+t["Input High Limit"].Value+").":e.ok=!0,e},"Input Rate":function(e){return e.ok=!0,e},"Input Range":function(e){return e.ok=!0,e},Instance:function(e){return this.validateUsingTheseLimits(e,0,4194303)},"Interlock Point":function(e){return e.ok=!0,e.point=Config.EditChanges.applyInterlockPoint(e),point},"Interlock State":function(e){return e.ok=!0,e},"Last Report Time":function(e){return e.ok=!0,e},"Last Start Reset Time":function(e){return e.ok=!0,e},"Last Start Time":function(e){return e.ok=!0,e},"Low Alarm Limit":function(e){var t=e.point,n=t[e.property].Value,i=t["High Alarm Limit"].Value-2*t["Alarm Deadband"].Value;return e.ok=!1,n<t["Minimum Value"].Value?e.result=e.property+" cannot be less than the Minimum Value ("+t["Minimum Value"].Value+").":t["Enable Warning Alarms"].Value===!0&&n>t["Low Warning Limit"].Value?e.result=e.property+" cannot be greater than the Low Warning Limit ("+t["Low Warning Limit"].Value+").":n>i?e.result=e.property+" cannot be greater than the High Alarm Limit minus twice the Alarm Deadband ("+i+").":e.ok=!0,e},"Low Deadband":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,0>n?e.result=e.property+" cannot be less than 0.":e.ok=!0,e},"Low Setpoint":function(e){var t=e.point,n=t[e.property].Value,i=t["High Setpoint"].Value-2*t["Input Deadband"].Value;return e.ok=!1,n>=i?e.result=e.property+" must be less than the High Setpoint minus twice the Input Deadband ("+i+").":e.ok=!0,e},"Low Warning Limit":function(e){var t=e.point,n=t[e.property].Value,i=t["High Warning Limit"].Value-2*t["Alarm Deadband"].Value;return e.ok=!1,n<t["Low Alarm Limit"].Value?e.result=e.property+" cannot be less than the Low Alarm Limit ("+t["Low Alarm Limit"].Value+").":n>i?e.result=e.property+" cannot be greater than the High Warning Limit minus twice the Alarm Deadband ("+i+").":e.ok=!0,e},"Maximum Change":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,n>=t["Maximum Value"].Value?e.result=e.property+" must be less than the Maximum Value.":e.ok=!0,e},"Minimum Off Time":function(e){return e.ok=!0,e},"Minimum On Time":function(e){return e.ok=!0,e},"Mixed Air Point":function(e){return e.ok=!0,e},"Momentary Delay":function(e){return e.ok=!0,e},Name:function(e){return e.ok=!0,e},Name1:function(e){return this.validateNameSegment(e)},Name2:function(e){return this.validateNameSegment(e)},Name3:function(e){return this.validateNameSegment(e)},Name4:function(e){return this.validateNameSegment(e)},"Number of Starts":function(e){return e.ok=!0,e},"Off Channel":function(e){return e=this.validateUsingMaxMinKeys(e),e.ok===!0&&(e=this.validateChannelUniqueness(e)),e},"Off Control Data Type":function(e){return e.ok=!0,e},"Off Control Function":function(e){return e.ok=!0,e},"Off Control Register":function(e){return this.validateUsingTheseLimits(e,1,65535)},"Off Control Value":function(e){return this.validateUsingTheseLimits(e,0,65535)},"On Channel":function(e){return e=this.validateUsingMaxMinKeys(e),e.ok===!0&&(e=this.validateChannelUniqueness(e)),e},"On Control Data Type":function(e){return e.ok=!0,e},"On Control Function":function(e){return e.ok=!0,e},"On Control Register":function(e){return this.validateUsingTheseLimits(e,1,65535)},"On Control Value":function(e){return this.validateUsingTheseLimits(e,0,65535)},"Open Channel":function(e){return e=this.validateUsingMaxMinKeys(e),e.ok===!0&&(e=this.validateChannelUniqueness(e)),e},"Open Polarity":function(e){return e.ok=!0,e},"Out of Service":function(e){return e.ok=!0,e.point=Config.EditChanges.applyOutOfService(e),e},"Outside Air Point":function(e){return e.ok=!0,e},"Point Instance":function(e){return e.ok=!0,e},"Point Type":function(e){return e.ok=!0,e},Polarity:function(e){return e.ok=!0,e},"Poll Data Type":function(e){return e.ok=!0,e},"Poll Function":function(e){return e.ok=!0,e},"Poll Register":function(e){return this.validateUsingTheseLimits(e,1,65535)},"Quality Code Enable":function(e){return e.ok=!0,e},"Previous Total":function(e){return e.ok=!0,e},"Proportional Band":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,0>=n?e.result=e.property+" must be greater than 0.":e.ok=!0,e},"Reset Gain":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,0>=n?e.result=e.property+" must be greater than 0.":e.ok=!0,e},"Reset Interval":function(e){return e.ok=!0,e.point=Config.EditChanges.applyResetInterval(e),e},"Reset Time":function(e){var t=e.point,n=t[e.property].Value,i=t["Reset Interval"].Value;return e.ok=!1,"Minute"===i?300===n||600===n||900===n||1800===n?e.ok=!0:e.result=e.property+" must be 5, 10, 15, or 30 minutes.":"Hour"===i?(e=this.validateUsingTheseLimits(e,0,3540),e.ok===!1&&(e.result=e.property+" must be between 0 and 59 minutes.")):(e=this.validateUsingTheseLimits(e,0,86340),e.ok===!1&&(e.result=e.property+" must be between 0 and 23 hours, 59 minutes.")),e},"Return Air Point":function(e){return e.ok=!0,e.point=Config.EditChanges.applyUniquePIDLogic(e),e},"Pulse Weight":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,0>=n?e.result=e.property+" must be greater than 0.":e.ok=!0,e},Rate:function(e){return e.ok=!0,e},"Rate Period":function(e){return e.ok=!0,e},Reliability:function(e){return e.ok=!0,e.point=Config.EditChanges.applyReliability(e),e},Remarks:function(e){var t=e.point,n=t[e.property].Value,i=n.length;return e.ok=!1,i>1e3?e.result=e.property+" are limited to 1000 characters.":e.ok=!0,e},"Remote Unit Point":function(e){return e.ok=!0,e},"Reverse Action":function(e){return e.ok=!0,e},"Rise Time":function(e){return e.ok=!0,e},"Run Total":function(e){return e.ok=!0,e},"Run Total Alarm Enable":function(e){return e.ok=!0,e},"Run Total Limit":function(e){return e.ok=!0,e},"Run Total Reset Enable":function(e){return e.ok=!0,e},"Run Total Reset Time":function(e){return e.ok=!0,e},"Same State Test":function(e){return e.ok=!0,e},"Scale Factor":function(e){return e.ok=!0,e},Security:function(e){return e.ok=!0,e},"Select Input":function(e){return e.ok=!0,e.point=Config.EditChanges.applySelectInput(e),e},"Select State":function(e){return e.ok=!0,e},"Sensor Type":function(e){return e.ok=!0,e},"Setpoint Input":function(e){return e.ok=!0,e.point=Config.EditChanges.applySetpointInput(e),e},"Setpoint Value":function(e){return e.ok=!0,e},"Show Label":function(e){return e.ok=!0,e},"Show Value":function(e){return e.ok=!0,e},"Shutdown Control":function(e){return e.ok=!0,e},"Shutdown Enable":function(e){return e.ok=!0,e},"Shutdown Point":function(e){return e.ok=!0,e.point=Config.EditChanges.applyShutdownPoint(e),e},"Shutdown Release":function(e){return e.ok=!0,e},"Shutdown State":function(e){return e.ok=!0,e},"Square Root":function(e){return e.ok=!0,e},"Starts Alarm Limit":function(e){return e.ok=!0,e},States:function(e){return e.ok=!0,e.point=Config.EditChanges.applyStates(e),e},"Startup Delay":function(e){return e.ok=!0,e},"Status Flags":function(e){return e.ok=!0,e},"Stop Scan":function(e){return e.ok=!0,e},"Supervised Input":function(e){return e.ok=!0,e},Total:function(e){return e.ok=!0,e},"Trend COV Increment":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,0>=n?e.result=e.property+" must be greater than 0.":e.ok=!0,e},"Trend Enable":function(e){return e.ok=!0,e},"Trend Interval":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,1>n?e.result=e.property+" cannot be less than 1 second.":n>3659?e.result=e.property+" cannot be more than 60 minutes, 59 seconds.":e.ok=!0,e},"Trend Samples":function(e){return e=this.validateUsingTheseLimits(e,0,255),e.ok===!0&&(e.point=Config.EditChanges[e.property](e)),e},"Trend Last Status":function(e){return e.ok=!0,e},"Trend Last Value":function(e){return e.ok=!0,e},"Trigger Constant":function(e){return e.ok=!0,e},"Trigger Point":function(e){return e.ok=!0,e.point=Config.EditChanges.applyTriggerPoint(e),e},"Update Interval":function(e){return e.ok=!0,e},"Value Deadband":function(e){var t=e.point,n=t[e.property].Value,i=Math.abs(t["Maximum Value"].Value-t["Minimum Value"].Value)*Config.deadbandFactor;return e.ok=!1,0>n?e.result=e.property+" cannot be less than 0.":n>i?e.result=e.property+" cannot be more than "+100*Config.deadbandFactor+"% of (Maximum Value - Minimum Value), ("+i+")":e.ok=!0,e},"VAV Channel":function(e){return e.ok=!0,e},"Verify Delay":function(e){return e.ok=!0,e},"Warning Adjust Band":function(e){var t=e.point,n=t[e.property].Value;return e.ok=!1,0>n?e.result=e.property+" cannot be less than 0.":n>=t["Alarm Adjust Band"].Value?e.result=e.property+" must be less than the Alarm Adjust Band ("+t["Alarm Adjust Band"].Value+").":e.ok=!0,e},"Trend Sample Entry":function(e){return e.ok=!0,e},"Downlink Network":function(e){var t=e.point,n=t["Point Type"].Value,i=t[e.property].Value;return e.ok=!1,"Device"!==n?e.result="Internal validation error. Point type '"+n+"' does not support this property.":0>i?e.result=e.property+" must be 0 or greater.":i>65534?e.result=e.property+" must be 65534 or less.":(e.ok=!0,e=this.validateNetworkNumber(e)),e},"Ethernet Address":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Device"!==n&&(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."),e},"Ethernet Network":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Device"!==n?(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."):(e=this.validateUsingMaxMinKeys(e),e.ok===!0&&(e=this.validateNetworkNumber(e))),e},"Ethernet Protocol":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Device"!==n?(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."):e.point=Config.EditChanges.applyDeviceTypeEthernetProtocol(e),e},"Model Type":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,("Device"!==n||"Remote Unit"!==n)&&(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."),e},"Port 1 Address":function(e){return this.validatePortNAddress(e)},"Port 2 Address":function(e){return this.validatePortNAddress(e)},"Port 3 Address":function(e){return this.validatePortNAddress(e)},"Port 4 Address":function(e){return this.validatePortNAddress(e)},"Port 1 Maximum Address":function(e){return this.validatePortNAddress(e)},"Port 2 Maximum Address":function(e){return this.validatePortNAddress(e)},"Port 3 Maximum Address":function(e){return this.validatePortNAddress(e)},"Port 4 Maximum Address":function(e){return this.validatePortNAddress(e)},"Port 1 Network":function(e){return this.validatePortNNetwork(e)},"Port 2 Network":function(e){return this.validatePortNNetwork(e)},"Port 3 Network":function(e){return this.validatePortNNetwork(e)},"Port 4 Network":function(e){return this.validatePortNNetwork(e)},"Port 1 Protocol":function(e){return this.validatePortNProtocol(e)},"Port 2 Protocol":function(e){return this.validatePortNProtocol(e)},"Port 3 Protocol":function(e){return this.validatePortNProtocol(e)},"Port 4 Protocol":function(e){return this.validatePortNProtocol(e)},"Uplink Port":function(e){var t=e.point,n=(t[e.property].Value,t["Point Type"].Value);return e.ok=!1,"Device"!==n?e.result="Internal validation error. Point type '"+n+"' does not support this property.":(e.ok=!0,e.point=Config.EditChanges.applyDeviceTypeUplinkPort(e)),e},"Device Address":function(e){var t=e.point,n=(t[e.property].Value,t["Point Type"].Value);return e.ok=!1,"Remote Unit"!==n?e.result="Internal validation error. Point type '"+n+"' does not support this property.":e.ok=!0,e},"Device Port":function(e){var t=e.point,n=(t[e.property].Value,t["Point Type"].Value);return e.ok=!1,"Remote Unit"!==n?e.result="Internal validation error. Point type '"+n+"' does not support this property.":e.ok=!0,e},"Network Segment":function(e){var t=e.point,n=(t[e.property].Value,t["Point Type"].Value);return e.ok=!1,"Remote Unit"!==n?e.result="Internal validation error. Point type '"+n+"' does not support this property.":e=this.validateUsingTheseLimits(e,1,65534),e},"Network Type":function(e){var t=e.point,n=(t[e.property].Value,t["Point Type"].Value);return e.ok=!1,"Remote Unit"!==n?e.result="Internal validation error. Point type '"+n+"' does not support this property.":(e.point=Config.EditChanges.applyRemoteUnitTypeNetworkType(e),e.ok=!0),e},"Calculation Type":function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!1,n){case"Average":case"Comparator":case"Delay":case"Digital Logic":case"Enthalpy":case"Math":case"Select Value":e.ok=!0;break;case"Analog Selector":case"Binary Selector":case"Proportional":e.ok=!0,e.point=Config.EditChanges[e.property](e);break;default:e.result="Internal validation error. Point type '"+n+"' does not support this property."}return e},"Control Point":function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!1,n){case"Alarm Status":case"Analog Selector":case"Average":case"Binary Selector":case"Comparator":case"Delay":case"Digital Logic":case"Enthalpy":case"Economizer":case"Logic":case"Math":case"Multiplexer":case"Proportional":case"Ramp":case"Select Value":case"Setpoint Adjust":case"Totalizer":e.ok=!0,e.point=Config.EditChanges.applyControlPoint(e);break;default:e.result="Internal validation error. Point type '"+n+"' does not support this property."}return e},"Control Priority":function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!1,n){case"Alarm Status":case"Analog Output":case"Analog Selector":case"Analog Value":case"Average":case"Binary Value":case"Binary Output":case"Binary Selector":case"Comparator":case"Delay":case"Digital Logic":case"Enthalpy":case"Economizer":case"Logic":case"Math":case"Multiplexer":case"Proportional":case"Ramp":case"Select Value":case"Setpoint Adjust":case"Totalizer":e.ok=!0;break;default:e.result="Internal validation error. Point type '"+n+"' does not support this property."}return e},Controller:function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!1,n){case"Alarm Status":case"Analog Output":case"Analog Selector":case"Analog Value":case"Average":case"Binary Output":case"Binary Selector":case"Binary Value":case"Comparator":case"Delay":case"Digital Logic":case"Enthalpy":case"Economizer":case"Logic":case"Math":case"Multiplexer":case"Proportional":case"Ramp":case"Select Value":case"Setpoint Adjust":case"Totalizer":e.ok=!0;break;default:e.result="Internal validation error. Point type '"+n+"' does not support this property."}return e},"Maximum Value":function(e){var t=e.point,n=t[e.property].Value,i=t["Point Type"].Value;switch(e.ok=!1,i){case"Analog Input":case"Analog Output":case"Analog Value":t["Alarms Off"].Value===!0&&n<t["Minimum Value"].Value?e.result=e.property+" must be greater than the Minimum Value ("+t["Minimum Value"].Value+").":n<t["High Alarm Limit"].Value?e.result=e.property+" must be greater than the High Alarm Limit ("+t["High Alarm Limit"].Value+").":e.ok=!0;break;case"Accumulator":0>=n?e.result=e.property+" must be greater than 0.":e.ok=!0;break;case"Average":case"Economizer":case"Enthalpy":case"Math":case"Multiplexer":case"Proportional":case"Ramp":case"Select Value":case"Setpoint Adjust":case"Totalizer":n<=t["Minimum Value"].Value?e.result=e.property+" must be greater than the Minimum Value ("+t["Minimum Value"].Value+").":e.ok=!0;break;default:e.result="Internal validation error. Point type '"+i+"' does not support this property."}return e},"Minimum Value":function(e){var t=e.point,n=t[e.property].Value,i=t["Point Type"].Value;switch(e.ok=!1,i){case"Analog Input":case"Analog Output":case"Analog Value":t["Alarms Off"].Value===!0&&n>t["Maximum Value"].Value?e.result=e.property+" cannot be greater than the Maximum Value ("+t["Maximum Value"].Value+").":n>t["Low Alarm Limit"].Value?e.result=e.property+" cannot be greater than the Low Alarm Limit ("+t["Low Alarm Limit"].Value+").":e.ok=!0;break;case"Average":case"Economizer":case"Enthalpy":case"Math":case"Multiplexer":case"Proportional":case"Ramp":case"Select Value":case"Setpoint Adjust":case"Totalizer":n>=t["Maximum Value"].Value?e.result=e.property+" must be less than the Maximum Value ("+t["Maximum Value"].Value+").":e.ok=!0;break;default:e.result="Internal validation error. Point type '"+i+"' does not support this property."}return e},"Shutdown Value":function(e){var t=e.point,n=t["Point Type"].Value,i=t[e.property].Value;switch(e.ok=!1,n){case"Average":case"Economizer":case"Enthalpy":case"Math":case"Multiplexer":case"Proportional":case"Ramp":case"Select Value":case"Setpoint Adjust":case"Totalizer":i<t["Minimum Value"].Value?e.result=e.property+" cannot be less than the Minimum Value ("+t["Minimum Value"].Value+").":i>t["Maximum Value"].Value?e.result=e.property+" cannot be greater than the Maximum Value ("+t["Maximum Value"].Value+").":e.ok=!0;break;case"Analog Selector":e.ok=!0;break;case"Alarm Status":case"Binary Selector":case"Comparator":case"Delay":case"Digital Logic":case"Logic":e.ok=!0,e.point=Config.EditChanges.applyShutdownValue(e);break;default:e.result="Internal validation error. Point type '"+n+"' does not support this property."}return e},Value:function(e){var t=e.point,n=t.Value.Value,i=t["Point Type"].Value;switch(e.ok=!1,i){case"Analog Input":case"Analog Output":case"Analog Value":case"Average":case"Economizer":case"Enthalpy":case"Math":case"Multiplexer":case"Proportional":case"Ramp":case"Select Value":case"Setpoint Adjust":case"Totalizer":n<t["Minimum Value"].Value?e.result=e.property+" cannot be less than the Minimum Value ("+t["Minimum Value"].Value+").":n>t["Maximum Value"].Value?e.result=e.property+" cannot be greater than the Maximum Value ("+t["Maximum Value"].Value+").":e.ok=!0;break;case"Alarm Status":case"Binary Input":case"Binary Output":case"Binary Value":case"Binary Selector":case"Comparator":case"Delay":case"Device":case"Digital Logic":case"Logic":case"MultiState Value":case"Remote Unit":e.ok=!0,e.point=Config.EditChanges.applyValue(e);break;case"Accumulator":n>t["Maximum Value"].Value?e.result=e.property+" cannot be greater than the Maximum Value ("+t["Maximum Value"].Value+")":e.ok=!0;break;case"Analog Selector":e.ok=!0;break;default:e.result="Internal validation error. Point type '"+i+"' does not support this property."}return e},"Input Point 1":function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!0,n){case"Average":case"Comparator":case"Digital Logic":case"Logic":case"Math":case"Multiplexer":case"Select Value":t=Config.EditChanges[e.property](e);break;default:e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."}return e},"Input Point 2":function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!0,n){case"Average":case"Comparator":case"Digital Logic":case"Logic":case"Math":case"Multiplexer":case"Select Value":t=Config.EditChanges[e.property](e);break;default:e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."}return e},"Input Point 3":function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!0,n){case"Average":case"Logic":case"Select Value":t=Config.EditChanges[e.property](e);break;default:e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."}return e},"Input Point 4":function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!0,n){case"Average":case"Logic":case"Select Value":t=Config.EditChanges[e.property](e);break;default:e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."}return e},"Input Point 5":function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!0,n){case"Average":case"Logic":case"Select Value":t=Config.EditChanges[e.property](e);break;default:e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."}return e},"Monitor Point":function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!0,n){case"Alarm Status":case"Analog Selector":case"Analog Value":case"Binary Selector":case"Binary Value":case"Proportional":case"Ramp":case"Setpoint Adjust":case"Totalizer":e.point=Config.EditChanges.applyMonitorPoint(e);break;case"Delay":e.point=Config.EditChanges.applyDelaytypeMointorPoint(e);break;default:e.ok=!1,e.result="Internal error. Point type '"+n+"' is not supported."}return e.ok===!0&&(e.point=Config.EditChanges[e.property](e)),e},"Input 1 Constant":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,("Math"!==n||"Multiplexer"!==n)&&(e.ok=!1,e.result="Internal error. Point type '"+n+"' is not supported."),e},"Input 2 Constant":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,("Math"!==n||"Multiplexer"!==n||"Comparator"!==n)&&(e.ok=!1,e.result="Internal error. Point type '"+n+"' is not supported."),e},"Active Value":function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!0,n){case"Alarm Status":case"Analog Selector":case"Binary Selector":case"Comparator":case"Delay":case"Digital Logic":case"Logic":e.point=Config.EditChanges.applyActiveValue(e);break;default:e.ok=!1,e.result="Internal error. Point type '"+n+"' is not supported."}return e},"Inactive Value":function(e){var t=e.point,n=t["Point Type"].Value;switch(e.ok=!0,n){case"Alarm Status":case"Analog Selector":case"Binary Selector":case"Comparator":case"Delay":case"Digital Logic":case"Logic":e.point=Config.EditChanges.applyInactiveValue(e);break;default:e.ok=!1,e.result="Internal error. Point type '"+n+"' is not supported."}return e},"If Compare 1":function(e){return this.validateIfCRVN(e)},"If Compare 2":function(e){return this.validateIfCRVN(e)},"If Compare 3":function(e){return this.validateIfCRVN(e)},"If Compare 4":function(e){return this.validateIfCRVN(e)},"If Compare 5":function(e){return this.validateIfCRVN(e)},"If Result 2":function(e){return this.validateIfCRVN(e)},"If Result 3":function(e){return this.validateIfCRVN(e)},"If Result 4":function(e){return this.validateIfCRVN(e)},"If Result 5":function(e){return this.validateIfCRVN(e)},"If Value 1":function(e){return this.validateIfCRVN(e)},"If Value 2":function(e){return this.validateIfCRVN(e)},"If Value 3":function(e){return this.validateIfCRVN(e)},"If Value 4":function(e){return this.validateIfCRVN(e)},"If Value 5":function(e){return this.validateIfCRVN(e)},"Input Type":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Binary Input"===n?e.point=Config.EditChanges.applyBinaryInputTypeInputType(e):"Analog Input"===n||"MultiState Value"===n||(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."),e},"Sensor Point":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Analog Input"==n?e.point=Config.EditChanges.applyAnalogInputTypeSensorPoint(e):"Analog Output"==n?e.point=Config.EditChanges.applyAnalogOutputTypeSensorPoint(e):(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."),e},"Default Value":function(e){var t=e.point,n=t[e.property].Value;return type=t["Point Type"].Value,e.ok=!1,"Analog Output"===type||"Analog Value"===type?n<t["Minimum Value"].Value?e.result=e.property+" cannot be less than the Minimum Value ("+t["Minimum Value"].Value+").":n>t["Maximum Value"].Value?e.result=e.property+" cannot be greater than the Maximum Value ("+t["Maximum Value"].Value+").":e.ok=!0:"Binary Output"===type||"Binary Value"===type?e.ok=!0:e.result="Internal validation error. Point type '"+type+"' does not support this property.",e},"Output Type":function(e){var t=e.point;return t["Output Type"].Value,type=t["Point Type"].Value,e.ok=!0,"Analog Output"===type?e.point=Config.EditChanges.applyAnalogOutputTypeOutputType(e):"Binary Output"===type?e.point=Config.EditChanges.applyBinaryOutputTypeOutputType(e):(e.ok=!1,e.result="Internal validation error. Point type '"+type+"' does not support this property."),e},"Feedback Point":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Binary Input"===n?e.point=Config.EditChanges.applyBinaryInputTypeFeedbackPoint(e):"Binary Output"===n?e.point=Config.EditChanges.applyBinaryOutputTypeFeedbackPoint(e):"Binary Value"===n?e.point=Config.EditChanges.applyBinaryValueTypeFeedbackPoint(e):(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."),e},"Feedback Type":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Binary Output"===n?e.point=Config.EditChanges.applyBinaryOutputTypeFeedbackType(e):(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."),e},"Close On Complete":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Slide Show"!==n&&(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."),e},"Continuous Show":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Slide Show"!==n?(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."):e.point=Config.EditChanges[e.property](e),e},"Maximize Displays":function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Slide Show"!==n&&(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."),e},"Repeat Count":function(e){var t=e.point,n=t["Point Type"].Value;return val=t[e.property].Value,e.ok=!1,"Slide Show"!==n?e.result="Internal validation error. Point type '"+n+"' does not support this property.":e=validateUsingMaxMinKeys(e),e},Slides:function(e){var t=e.point,n=t["Point Type"].Value;return e.ok=!0,"Slide Show"!==n&&(e.ok=!1,e.result="Internal validation error. Point type '"+n+"' does not support this property."),e}},e.EditChanges={"Calculation Type":function(e){var t,n,i=e.point,o=i[e.property].Value;if("Analog Selector"===i["Point Type"].Value||"Binary Selector"===i["Point Type"].Value)"Single Setpoint"===o?(i["Setpoint Input"].isDisplayable=!0,i["Setpoint Value"].isDisplayable=!0,i["High Deadband"].isDisplayable=!0,i["Low Deadband"].isDisplayable=!0,i["Input Deadband"].isDisplayable=!1,i["High Setpoint"].isDisplayable=!1,i["Low Setpoint"].isDisplayable=!1,i["Cooling Setpoint"].isDisplayable=!1,i["Heating Setpoint"].isDisplayable=!1):"Dual Setpoint"===o?(i["Setpoint Input"].isDisplayable=!1,i["Setpoint Value"].isDisplayable=!1,i["High Deadband"].isDisplayable=!1,i["Low Deadband"].isDisplayable=!1,i["Input Deadband"].isDisplayable=!0,i["High Setpoint"].isDisplayable=!0,i["Low Setpoint"].isDisplayable=!0,i["Cooling Setpoint"].isDisplayable=!1,i["Heating Setpoint"].isDisplayable=!1):(i["Setpoint Input"].isDisplayable=!1,i["Setpoint Value"].isDisplayable=!1,i["High Deadband"].isDisplayable=!1,i["Low Deadband"].isDisplayable=!1,i["Input Deadband"].isDisplayable=!0,i["High Setpoint"].isDisplayable=!1,i["Low Setpoint"].isDisplayable=!1,i["Cooling Setpoint"].isDisplayable=!0,i["Heating Setpoint"].isDisplayable=!0);
else if("PID"===i["Calculation Type"]){for(i["Input Range"].isDisplayable=!0,delete i["Input Range"].ValueOptions,i["Input Range"].ValueOptions={},n=0;8>n;n++)t=25+25*n+" sec",i["Input Range"].ValueOptions[t]=n;i["Rise Time"].isDisplayable=!0,i["Fall Time"].isDisplayable=!0,i["Proportional Band"].isDisplayable=!1,i["Reset Gain"].isDisplayable=!1}else"PI"===i["Calculation Type"]?(i["Input Range"].isDisplayable=!0,delete i["Input Range"].ValueOptions,i["Input Range"].ValueOptions={},i["Input Range"].ValueOptions["1"]=0,i["Input Range"].ValueOptions["10"]=1,i["Input Range"].ValueOptions["100"]=2,i["Input Range"].ValueOptions["1000"]=3,i["Input Range"].ValueOptions["5000"]=4,i["Input Range"].ValueOptions["10000"]=5,i["Input Range"].ValueOptions["25000"]=6,i["Input Range"].ValueOptions.Auto=7,i["Rise Time"].isDisplayable=!1,i["Fall Time"].isDisplayable=!1,i["Proportional Band"].isDisplayable=!0,i["Reset Gain"].isDisplayable=!0):(i["Input Range"].isDisplayable=!1,i["Rise Time"].isDisplayable=!1,i["Fall Time"].isDisplayable=!1,i["Proportional Band"].isDisplayable=!0,i["Reset Gain"].isDisplayable=!1);return i},"Continuous Show":function(e){var t=e.point,n=t[e.property].Value;return t["Repeat Count"].isDisplayable=n===!0?!1:!0,t},"COV Enable":function(e){var t=e.point,n=t[e.property].Value;return t.hasOwnProperty("COV Increment")&&(t["COV Increment"].isReadOnly=n===!0?!1:!0),t},"Demand Enable":function(e){var t=e.point,n=t[e.property].Value;return t["Demand Interval"].isReadOnly=n===!0?!1:!0,t},applyLogicInputPointN:function(e){var t,n=e.point,i=e.refPoint,o=e.property.substring(e.property.length-1),s={ifCompareN:"If Compare "+o,ifResultN:"If Result "+o,ifValueN:"If Value "+o},a=!0;(null===i||0===n[e.property].Value)&&(a=!1);for(t in s)n[s.key].isDisplayable=a;if(a===!0)if(refpoint.Value.ValueType===enumsTemplatesJson.Enums["Value Types"].Enum["enum"])if(n[s.ifValueN].ValueOptions=i.Value.ValueOptions,n[s.ifValueN].ValueType==enumsTemplatesJson.Enums["Value Types"].Float["enum"]){n[s.ifValueN].ValueType=enumsTemplatesJson.Enums["Value Types"].Enum["enum"];for(t in n[s.ifValueN].ValueOptions){n[s.ifValueN].Value=t,n[s.ifValueN].eValue=n[s.ifValueN].ValueOptions[t];break}}else this.applyPropertyValueLogic(n,s.ifValueN);else n[s.ifValueN].ValueType=enumsTemplatesJson.Enums["Value Types"].Float["enum"],n[s.ifValueN].Value=0,delete n[s.ifValueN].eValue,delete n[s.ifValueN].ValueOptions;return this.applyUniquePIDLogic(e)},"Input Point 1":function(e){var t=e.point,n=t["Point Type"].Value;return"Logic"===n?t=this.applyLogicInputPointN(e):"Multiplexer"===n?t=this.applyMultiplexerPointTypeInputPoint1(e):"Math"===n?t=this.applyMathPointTypeInputPoint1(e):"Comparator"===n?t=this.applyComparatorPointTypeInputPoint1(e):"Select Value"===n?t=this.applySelectValuePointTypeInputPoint1(e):"Average"===n?t=this.applyAveragePointTypeInputPoint1(e):"Digital Logic"===n&&(t=this.applyUniquePIDLogic(e)),t},"Input Point 2":function(e){var t=e.point,n=t["Point Type"].Value;return"Logic"===n?t=this.applyLogicInputPointN(e):"Multiplexer"===n?t=this.applyMultiplexerPointTypeInputPoint2(e):"Math"===n?t=this.applyMathPointTypeInputPoint2(e):"Comparator"===n?t=this.applyComparatorPointTypeInputPoint2(e):"Select Value"===n?t=this.applySelectValuePointTypeInputPoint2(e):"Average"===n?t=this.applyAveragePointTypeInputPoint2(e):"Digital Logic"===n&&(t=this.applyUniquePIDLogic(e)),t},"Input Point 3":function(e){var t=e.point,n=t["Point Type"].Value;return"Logic"===n?t=this.applyLogicInputPointN(e):"Select Value"===n?t=this.applySelectValuePointTypeInputPoint3(e):"Average"===n&&(t=this.applyAveragePointTypeInputPoint3(e)),t},"Input Point 4":function(e){var t=e.point,n=t["Point Type"].Value;return"Logic"===n?t=this.applyLogicInputPointN(e):"Select Value"===n?t=this.applySelectValuePointTypeInputPoint4(e):"Average"===n&&(t=this.applyAveragePointTypeInputPoint4(e)),t},"Input Point 5":function(e){var t=e.point,n=t["Point Type"].Value;return"Logic"===n?t=this.applyLogicInputPointN(e):"Select Value"===n?t=this.applySelectValuePointTypeInputPoint5(e):"Average"===n&&(t=this.applyAveragePointTypeInputPoint5(e)),t},"Monitor Point":function(e){var t,n=e.point,i=n[e.property].Value,o=["Fail Action","Demand Interval","Demand Enable"],s=o.length,a=0===i?!0:!1;for(t=0;s>t;t++)n.hasOwnProperty(o[t])&&(n[o[t]].isReadOnly=a);return n},"Trend Samples":function(e){var t,n,i=e.point,o=i[e.property].Value,s=["Trend Enable","Trend Interval","Trend COV Increment"],a=s.length,r=0===o?!0:!1;for(n=0;a>n;n++)t=s[n],i.hasOwnProperty(t)&&(i[t].isReadOnly=r);return i},applyReliability:function(e){var t=e.point;return t.Reliability.eValue=0!==t._relDevice?t._relDevice:0!==t._relRMU?t._relRMU:t._relPoint,t=this.applyPropertyEnumSet(t,"Reliability",enumsTemplatesJson.Enums.Reliabilities)},applyEnableWarningAlarms:function(e){return e.point["Enable Warning Alarms"].Value===!0?(e.point["High Warning Limit"].isReadOnly=!1,e.point["Low Warning Limit"].isReadOnly=!1):(e.point["High Warning Limit"].isReadOnly=!0,e.point["Low Warning Limit"].isReadOnly=!0),e.point},applyConfigureDevice:function(e){return e.point["Configure Device"].Value=!1,e.point},applyAlarmState:function(e){var t=e.point;return t=this.applyPropertyEnumSet(t,"Alarm State",enumsTemplatesJson.Enums["Alarm States"])},applyDeviceStatus:function(e){var t=e.point;return t=this.applyPropertyEnumSet(t,"Device Status",enumsTemplatesJson.Enums["Device Statuses"])},applyUniquePIDLogic:function(e){var n=e.point,i=e.refPoint,o=e.property;return t.push(o),void 0!==i&&null!==i&&void 0!==n[o]&&n[o].ValueType===enumsTemplatesJson.Enums["Value Types"].UniquePID["enum"]&&0!==n[o].Value?(n[o].PointName=i.Name,n[o].PointType=i["Point Type"].eValue,void 0!==i["Point Instance"]?(n[o].PointInst=i["Point Instance"].Value,n[o].DevInst="Device"==i["Point Type"].Value?n[o].PointInst:void 0!==i["Device Point"]?i["Device Point"].DevInst:0):n[o].DevInst=0):(0===n[o].Value&&(n[o].PointName=null),n[o].DevInst=0,n[o].PointType=0,n[o].PointInst=0),n},applyPropertyValueLogic:function(e,t){if(void 0!==e[t]&&e[t].ValueType===enumsTemplatesJson.Enums["Value Types"].Enum["enum"]){e[t].Value="??????";for(var n in e[t].ValueOptions)if(e[t].eValue===e[t].ValueOptions[n]){e[t].Value=n;break}}return e},applyPropertyEnumSet:function(e,t,n){var i,o;if(void 0!==e[t]){e[t].Value="??????";for(o in n)if(i=n[o].hasOwnProperty("enum")===!0?n[o]["enum"]:n[o],e[t].eValue===i){e[t].Value=o;break}}return e},applyValidateDemandEnable:function(e){var t=e.point;return t["Demand Interval"].isReadOnly=t["Demand Enable"].Value===!0?!1:!0,t},applyActiveText:function(e){var t=e.point;if(void 0!==t["Active Text"]){void 0!==t["Alarm Value"]&&1===t["Alarm Value"].eValue&&(t["Alarm Value"].Value=t["Active Text"].Value),1===t.Value.eValue&&(t.Value.Value=t["Active Text"].Value);for(var n in t.Value.ValueOptions)1===t.Value.ValueOptions[n]&&(delete t.Value.ValueOptions[n],t.Value.ValueOptions[t["Active Text"].Value]=1)}return t},applyInactiveText:function(e){var t=e.point;if(void 0!==t["Inactive Text"]){void 0!==t["Alarm Value"]&&0===t["Alarm Value"].eValue&&(t["Alarm Value"].Value=t["Inactive Text"].Value),0===t.Value.eValue&&(t.Value.Value=t["Inactive Text"].Value);for(var n in t.Value.ValueOptions)if(0===t.Value.ValueOptions[n]){delete t.Value.ValueOptions[n],t.Value.ValueOptions[t["Inactive Text"].Value]=0;break}}return t},applyValue:function(e){var t=e.point;return t=this.applyPropertyValueLogic(t,"Value")},applyAuthorizedValue:function(e){var t=e.point;return t=this.applyPropertyEnumSet(t,e.property,t.Value.ValueOptions)},applyActiveValue:function(e){var t=e.point;return t=this.applyPropertyEnumSet(t,e.property,t.Value.ValueOptions)},applyInactiveValue:function(e){var t=e.point;return t=this.applyPropertyEnumSet(t,e.property,t.Value.ValueOptions)},applyShutdownValue:function(e){var t=e.point;return t=this.applyPropertyEnumSet(t,e.property,t.Value.ValueOptions)},applyControlPoint:function(e){var t=e.point,n=e.refPoint;return t.Value.ValueType===enumsTemplatesJson.Enums["Value Types"].Enum["enum"]&&(void 0!==t["Control Point"].Value&&0!==t["Control Point"].Value?n&&n.Value.ValueType===enumsTemplatesJson.Enums["Value Types"].Enum["enum"]?(t.States.isDisplayable=!1,t.Value.ValueOptions=n.Value.ValueOptions,t=this.applyValue(e)):(t.States.isDisplayable=!0,t.Value.ValueOptions=t.States.ValueOptions,t=this.applyValue(e)):(t.States.isDisplayable=!0,t.Value.ValueOptions=t.States.ValueOptions,t=this.applyPropertyValueLogic(t,"Control Point")),t=this.applyActiveValue(e),t=this.applyInactiveValue(e),t=this.applyShutdownValue(e)),t=this.applyUniquePIDLogic(e)},applyMonitorPoint:function(e){return this.applyUniquePIDLogic(e)},applyDelaytypeMointorPoint:function(e){var t=e.point,n=e.refPoint;return n&&0!==t[e.property].Value&&n.Value.ValueType===enumsTemplatesJson.Enums["Value Types"].Enum["enum"]&&(t["Trigger Constant"].ValueOptions=n.Value.ValueOptions,t=this.applyPropertyValueLogic(t,"Trigger Constant")),t=this.applyUniquePIDLogic(e)},applyInterlockPoint:function(e){var t=e.point,n=e.refPoint;return n&&void 0!==t["Interlock Point"]&&0!==t["Interlock Point"].Value&&n.Value.ValueType===enumsTemplatesJson.Enums["Value Types"].Enum["enum"]?(t["Interlock State"].isDisplayable=!0,t["Interlock State"].ValueOptions=n.Value.ValueOptions,t=this.applyPropertyValueLogic(t,"Interlock State")):t["Interlock State"].isDisplayable=!1,t=this.applyUniquePIDLogic(e)},applyOutOfService:function(e){var t=e.point;return"Accumulator"!==t["Point Type"].Value&&"Analog Output"!==t["Point Type"].Value&&"Analog Value"!==t["Point Type"].Value&&"Binary Output"!==t["Point Type"].Value&&"Binary Value"!==t["Point Type"].Value&&"MultiState Value"!==t["Point Type"].Value&&(t["Out of Service"].Value===!0?t.Value.isReadOnly=!1:(t.Value.isReadOnly=!0,t.Value.Value=e.oldPoint.Value.Value)),t},applyResetInterval:function(e){var t=e.point;return t["Reset Time"].isDisplayable="Manual"===t["Reset Interval"].Value?!1:!0,t},applySelectInput:function(e){var t=e.point,n=e.refPoint;return 0!==t["Select Input"].Value&&n.Value.ValueType===enumsTemplatesJson.Enums["Value Types"].Enum["enum"]?(t["Select State"].isDisplayable=!0,t["Select State"].ValueOptions=n.Value.ValueOptions,t=this.applyPropertyValueLogic(t,"Select Input")):t["Select State"].isDisplayable=!1,this.applyUniquePIDLogic(e)},applySetpointInput:function(e){var t=e.point,n=e.refPoint;return t["Setpoint Value"].isDisplayable=void 0!==n?!1:!0,this.applyUniquePIDLogic(e)},applyShutdownPoint:function(e){var t=e.point,n=e.refPoint;return n&&0!==t["Shutdown Point"].Value&&n.Value.ValueType===enumsTemplatesJson.Enums["Value Types"].Enum["enum"]?(t["Shutdown State"].isDisplayable=!0,t["Shutdown State"].ValueOptions=n.Value.ValueOptions,t=this.applyPropertyValueLogic(t,"Shutdown State")):t["Shutdown State"].isDisplayable=!1,this.applyUniquePIDLogic(e)},applyStates:function(e){var t=e.point,n=0,i="";for(var o in t.States.ValueOptions)t.States.ValueOptions[o]>n&&(n=t.States.ValueOptions[o],i=o);t.States.Value=i,t.Value.ValueOptions=t.States.ValueOptions;for(var s in t.Value.ValueOptions){if(t.Value.eValue==t.Value.ValueOptions[s]){t.Value.Value=s;break}t.Value.Value="??????"}return t=this.applyActiveValue(e),t=this.applyInactiveValue(e),t=this.applyShutdownValue(e)},applyTriggerPoint:function(e){var t=e.point;return t["Trigger Constant"].isDisplayable=0!==t["Trigger Point"].Value?!1:!0,this.applyUniquePIDLogic(e)},applyConversionTypeProperty:function(e){var t=e.point;return t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Conversion Coefficient 3"].isDisplayable=!0,t["Conversion Coefficient 4"].isDisplayable=!0,"Quadratic"===t["Conversion Type"].Value||"Flow"===t["Conversion Type"].Value?t["Conversion Coefficient 4"].isDisplayable=!1:(t["Conversion Coefficient 3"].isDisplayable=!1,t["Conversion Coefficient 4"].isDisplayable=!1),t},applySelectValuePointTypeInputPoint1:function(e){return this.applyUniquePIDLogic(e)},applySelectValuePointTypeInputPoint2:function(e){return this.applyUniquePIDLogic(e)},applySelectValuePointTypeInputPoint3:function(e){return this.applyUniquePIDLogic(e)},applySelectValuePointTypeInputPoint4:function(e){return this.applyUniquePIDLogic(e)},applySelectValuePointTypeInputPoint5:function(e){return this.applyUniquePIDLogic(e)},applyAveragePointTypeInputPoint1:function(e){return this.applyUniquePIDLogic(e)},applyAveragePointTypeInputPoint2:function(e){return this.applyUniquePIDLogic(e)},applyAveragePointTypeInputPoint3:function(e){return this.applyUniquePIDLogic(e)},applyAveragePointTypeInputPoint4:function(e){return this.applyUniquePIDLogic(e)},applyAveragePointTypeInputPoint5:function(e){return this.applyUniquePIDLogic(e)},applyDelayPointTypeMointorPoint:function(e){var t=e.point,n=e.refPoint;return void 0!==t["Monitor Point"].Value&&0!==t["Monitor Point"].Value&&n&&n.Value.ValueType==enumsTemplatesJson.Enums["Value Types"].Enum["enum"]&&(t["Trigger Constant"].ValueOptions=n.Value.ValueOptions,t=this.applyPropertyValueLogic(t,"Trigger Constant")),t=this.applyUniquePIDLogic(e)},applyComparatorPointTypeInputPoint1:function(e){var t=e.point;if(void 0!==t["Input Point 1"].Value)if(0!==t["Input Point 1"].Value&&refPoint.Value.ValueType===enumsTemplatesJson.Enums["Value Types"].Enum["enum"]){t["Input 2 Constant"].ValueType=enumsTemplatesJson.Enums["Value Types"].Enum["enum"],t["Input 2 Constant"].ValueOptions=refPoint.Value.ValueOptions;for(var n in t["Input 2 Constant"].ValueOptions)t["Input 2 Constant"].Value=n,t["Input 2 Constant"].eValue=t["Input 2 Constant"].ValueOptions[n]}else t["Input 2 Constant"].ValueType=enumsTemplatesJson.Enums["Value Types"].Float["enum"],delete t["Input 2 Constant"].eValue,delete t["Input 2 Constant"].ValueOptions,t["Input 2 Constant"].Value=0;return t=this.applyUniquePIDLogic(e)},applyComparatorPointTypeInputPoint2:function(e){var t=e.point;return void 0!==t["Input Point 2"].Value&&(t["Input 2 Constant"].isDisplayable=0===t["Input Point 2"].Value?!0:!1),t=this.applyUniquePIDLogic(e)},applyLogicPointTypeInputPoint1:function(e){return applyLogicInputPointN(e)},applyLogicPointTypeInputPoint2:function(e){return applyLogicInputPointN(e)},applyLogicPointTypeInputPoint3:function(e){return applyLogicInputPointN(e)},applyLogicPointTypeInputPoint4:function(e){return applyLogicInputPointN(e)},applyLogicPointTypeInputPoint5:function(e){return applyLogicInputPointN(e)},applyMathPointTypeInputPoint1:function(e){var t=e.point;return e.refPoint,t["Input 1 Constant"].isDisplayable=0===t["Input Point 1"].Value?!0:!1,this.applyUniquePIDLogic(e)},applyMathPointTypeInputPoint2:function(e){var t=e.point;return e.refPoint,t["Input 2 Constant"].isDisplayable=0===t["Input Point 2"].Value?!0:!1,this.applyUniquePIDLogic(e)},applyMultiplexerPointTypeInputPoint1:function(e){var t=e.point;return e.refPoint,t["Input 1 Constant"].isDisplayable=0===t["Input Point 1"].Value?!0:!1,this.applyUniquePIDLogic(e)},applyMultiplexerPointTypeInputPoint2:function(e){var t=e.point;return e.refPoint,t["Input 2 Constant"].isDisplayable=0===t["Input Point 2"].Value?!0:!1,this.applyUniquePIDLogic(e)},applyDeviceTypeModelType:function(e){var t=e.point;return t["Model Type"].isDisplayable===!1?t:(delete t.Protocol,delete t["Ethernet Maximum Address"],delete t["Ethernet Address"].Min,delete t["Ethernet Address"].Max,delete t["Port 1 Protocol"].Min,delete t["Port 1 Protocol"].Max,delete t["Port 2 Protocol"].Min,delete t["Port 2 Protocol"].Max,delete t["Port 3 Protocol"].Min,delete t["Port 3 Protocol"].Max,delete t["Port 4 Protocol"].Min,delete t["Port 4 Protocol"].Max,delete t["Port 1 Address"].Min,delete t["Port 1 Address"].Max,delete t["Port 2 Address"].Min,delete t["Port 2 Address"].Max,delete t["Port 3 Address"].Min,delete t["Port 3 Address"].Max,delete t["Port 4 Address"].Min,delete t["Port 4 Address"].Max,delete t["Port 1 Maximum Address"].Min,delete t["Port 1 Maximum Address"].Max,delete t["Port 2 Maximum Address"].Min,delete t["Port 2 Maximum Address"].Max,delete t["Port 3 Maximum Address"].Min,delete t["Port 3 Maximum Address"].Max,delete t["Port 4 Maximum Address"].Min,delete t["Port 4 Maximum Address"].Max,void 0!==t["Uplink Port"].Value&&("Ethernet"==t["Uplink Port"].Value?t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"].Ethernet["enum"]:"Port 1"==t["Uplink Port"].Value?t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]:"Port 2"==t["Uplink Port"].Value?t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"]:"Port 3"==t["Uplink Port"].Value?t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 3"]["enum"]:"Port 4"==t["Uplink Port"].Value&&(t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 4"]["enum"])),void 0!==t["Ethernet Protocol"].Value&&(t["Ethernet Protocol"].eValue="IP"==t["Ethernet Protocol"].Value?enumsTemplatesJson.Enums["Ethernet Protocols"].IP["enum"]:enumsTemplatesJson.Enums["Ethernet Protocols"].None["enum"]),void 0!==t["Port 1 Protocol"].Value&&("None"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].None["enum"]:"MS/TP"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"]:"N2"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].N2["enum"]:"Modbus RTU"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["Modbus RTU"]["enum"]:"MS/RTU"==t["Port 1 Protocol"].Value&&(t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/RTU"]["enum"])),void 0!==t["Port 2 Protocol"].Value&&("None"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].None["enum"]:"MS/TP"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"]:"N2"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].N2["enum"]:"Modbus RTU"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["Modbus RTU"]["enum"]:"MS/RTU"==t["Port 2 Protocol"].Value&&(t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/RTU"]["enum"])),void 0!==t["Port 3 Protocol"].Value&&("None"==t["Port 3 Protocol"].Value?t["Port 3 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].None["enum"]:"MS/TP"==t["Port 3 Protocol"].Value?t["Port 3 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"]:"N2"==t["Port 3 Protocol"].Value?t["Port 3 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].N2["enum"]:"Modbus RTU"==t["Port 3 Protocol"].Value?t["Port 3 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["Modbus RTU"]["enum"]:"MS/RTU"==t["Port 3 Protocol"].Value&&(t["Port 3 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/RTU"]["enum"])),void 0!==t["Port 4 Protocol"].Value&&("None"==t["Port 4 Protocol"].Value?t["Port 4 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].None["enum"]:"MS/TP"==t["Port 4 Protocol"].Value?t["Port 4 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"]:"N2"==t["Port 4 Protocol"].Value?t["Port 4 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].N2["enum"]:"Modbus RTU"==t["Port 4 Protocol"].Value?t["Port 4 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["Modbus RTU"]["enum"]:"MS/RTU"==t["Port 4 Protocol"].Value&&(t["Port 4 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/RTU"]["enum"])),t._devModel=t["Model Type"].eValue,t._cfgRequired=!0,t._relPoint=enumsTemplatesJson.Enums.Reliabilities["No Fault"]["enum"],"string"!=typeof t["Ethernet Address"].Value&&(t["Ethernet Address"].Value="",t["Ethernet Address"].ValueType=enumsTemplatesJson.Enums["Value Types"].String["enum"]),t["Ethernet Network"].Max=65534,t["Port 1 Network"].Max=65534,t["Port 2 Network"].Max=65534,t["Port 3 Network"].Max=65534,t["Port 4 Network"].Max=65534,"MicroScan 5 UNV"==t["Model Type"].Value||"Unknown"==t["Model Type"].Value||"MicroScan 5 xTalk"==t["Model Type"].Value||"MicroScan 5 UNV"==t["Model Type"].Value||"SCADA Vio"==t["Model Type"].Value?(t["Uplink Port"].isDisplayable=!0,t["Uplink Port"].isReadOnly=!1,t["Uplink Port"].ValueOptions={Ethernet:enumsTemplatesJson.Enums["Device Ports"].Ethernet["enum"],"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],"Port 2":enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"],"Port 3":enumsTemplatesJson.Enums["Device Ports"]["Port 3"]["enum"],"Port 4":enumsTemplatesJson.Enums["Device Ports"]["Port 4"]["enum"]},"Port 1"==t["Uplink Port"].Value?t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]:"Port 2"==t["Uplink Port"].Value?t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"]:"Port 3"==t["Uplink Port"].Value?t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 3"]["enum"]:"Port 4"==t["Uplink Port"].Value?t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 4"]["enum"]:(t["Uplink Port"].Value="Ethernet",t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"].Ethernet["enum"]),t["Downlink Network"].isReadOnly=!1,(t["Downlink Network"].Value<0||t["Downlink Network"].Value>65534)&&(t["Downlink Network"].Value=0),t["Ethernet Protocol"].isDisplayable=!0,"IP"!=t["Ethernet Protocol"].Value?(t["Ethernet Protocol"].Value="None",t["Ethernet Protocol"].eValue=enumsTemplatesJson.Enums["Ethernet Protocols"].None["enum"]):t["Ethernet Protocol"].eValue=enumsTemplatesJson.Enums["Ethernet Protocols"].IP["enum"],t["Ethernet Network"].isReadOnly=!1,(t["Ethernet Network"].Value<0||t["Ethernet Network"].Value>65534)&&(t["Ethernet Network"].Value=0),t["Ethernet Address"].isReadOnly=!1,t["Port 1 Protocol"].isDisplayable=!0,"MS/TP"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"]:"N2"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].N2["enum"]:"Modbus RTU"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["Modbus RTU"]["enum"]:"MS/RTU"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/RTU"]["enum"]:(t["Port 1 Protocol"].Value="None",t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].None["enum"]),t["Port 2 Protocol"].isDisplayable=!0,"MS/TP"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"]:"N2"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].N2["enum"]:"Modbus RTU"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["Modbus RTU"]["enum"]:"MS/RTU"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/RTU"]["enum"]:(t["Port 2 Protocol"].Value="None",t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].None["enum"]),t["Port 3 Protocol"].isDisplayable=!0,"MS/TP"==t["Port 3 Protocol"].Value?t["Port 3 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"]:"N2"==t["Port 3 Protocol"].Value?t["Port 3 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].N2["enum"]:"Modbus RTU"==t["Port 3 Protocol"].Value?t["Port 3 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["Modbus RTU"]["enum"]:"MS/RTU"==t["Port 3 Protocol"].Value?t["Port 3 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/RTU"]["enum"]:(t["Port 3 Protocol"].Value="None",t["Port 3 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].None["enum"]),t["Port 4 Protocol"].isDisplayable=!0,"MS/TP"==t["Port 4 Protocol"].Value?t["Port 4 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"]:"N2"==t["Port 4 Protocol"].Value?t["Port 4 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].N2["enum"]:"Modbus RTU"==t["Port 4 Protocol"].Value?t["Port 4 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["Modbus RTU"]["enum"]:"MS/RTU"==t["Port 4 Protocol"].Value?t["Port 4 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/RTU"]["enum"]:(t["Port 4 Protocol"].Value="None",t["Port 4 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].None["enum"]),t["Port 1 Network"].isReadOnly=!1,(t["Port 1 Network"].Value<0||t["Port 1 Network"].Value>65534)&&(t["Port 1 Network"].Value=0),t["Port 2 Network"].isReadOnly=!1,(t["Port 2 Network"].Value<0||t["Port 2 Network"].Value>65534)&&(t["Port 2 Network"].Value=0),t["Port 3 Network"].isReadOnly=!1,(t["Port 3 Network"].Value<0||t["Port 3 Network"].Value>65534)&&(t["Port 3 Network"].Value=0),t["Port 4 Network"].isReadOnly=!1,(t["Port 4 Network"].Value<0||t["Port 4 Network"].Value>65534)&&(t["Port 4 Network"].Value=0),t["Port 1 Address"].isReadOnly=!1,(t["Port 1 Address"].Value<0||t["Port 1 Address"].Value>127)&&(t["Port 1 Address"].Value=0),t["Port 2 Address"].isReadOnly=!1,(t["Port 2 Address"].Value<0||t["Port 2 Address"].Value>127)&&(t["Port 2 Address"].Value=0),t["Port 3 Address"].isReadOnly=!1,(t["Port 3 Address"].Value<0||t["Port 3 Address"].Value>127)&&(t["Port 3 Address"].Value=0),t["Port 4 Address"].isReadOnly=!1,(t["Port 4 Address"].Value<0||t["Port 4 Address"].Value>127)&&(t["Port 4 Address"].Value=0),t["Port 1 Maximum Address"].isReadOnly=!1,(t["Port 1 Maximum Address"].Value<0||t["Port 1 Maximum Address"].Value>127)&&(t["Port 1 Maximum Address"].Value=0),t["Port 2 Address"].isReadOnly=!1,(t["Port 2 Maximum Address"].Value<0||t["Port 2 Maximum Address"].Value>127)&&(t["Port 2 Maximum Address"].Value=0),t["Port 3 Address"].isReadOnly=!1,(t["Port 3 Maximum Address"].Value<0||t["Port 3 Maximum Address"].Value>127)&&(t["Port 3 Maximum Address"].Value=0),t["Port 4 Maximum Address"].isReadOnly=!1,(t["Port 4 Maximum Address"].Value<0||t["Port 4 Maximum Address"].Value>127)&&(t["Port 4 Maximum Address"].Value=0)):"MicroScan 4 UNV"==t["Model Type"].Value||"MicroScan 4 xTalk"==t["Model Type"].Value||"MicroScan 4 Digital"==t["Model Type"].Value?(t["Uplink Port"].isDisplayable=!0,t["Uplink Port"].isReadOnly=!1,t["Uplink Port"].ValueOptions={Ethernet:enumsTemplatesJson.Enums["Device Ports"].Ethernet["enum"],"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]},"Port 1"!=t["Uplink Port"].Value?(t["Uplink Port"].Value="Ethernet",t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"].Ethernet["enum"]):"Port 1"==t["Uplink Port"].Value&&(t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]),t["Downlink Network"].isDisplayable=!1,t["Ethernet Protocol"].isDisplayable=!0,"IP"!=t["Ethernet Protocol"].Value?(t["Ethernet Protocol"].Value="None",t["Ethernet Protocol"].eValue=enumsTemplatesJson.Enums["Ethernet Protocols"].None["enum"]):t["Ethernet Protocol"].eValue=enumsTemplatesJson.Enums["Ethernet Protocols"].IP["enum"],t["Ethernet Network"].isReadOnly=!1,(t["Ethernet Network"].Value<0||t["Ethernet Network"].Value>65534)&&(t["Ethernet Network"].Value=0),t["Ethernet Address"].isReadOnly=!1,t["Port 1 Protocol"].isDisplayable=!0,"MS/TP"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"]:"N2"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].N2["enum"]:"Modbus RTU"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["Modbus RTU"]["enum"]:"MS/RTU"==t["Port 1 Protocol"].Value?t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/RTU"]["enum"]:(t["Port 1 Protocol"].Value="None",t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].None["enum"]),t["Port 2 Protocol"].isDisplayable=!0,"MS/TP"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"]:"N2"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].N2["enum"]:"Modbus RTU"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["Modbus RTU"]["enum"]:"MS/RTU"==t["Port 2 Protocol"].Value?t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/RTU"]["enum"]:(t["Port 2 Protocol"].Value="None",t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"].None["enum"]),t["Port 3 Protocol"].isDisplayable=!1,t["Port 4 Protocol"].isDisplayable=!1,t["Port 1 Network"].isReadOnly=!1,(t["Port 1 Network"].Value<0||t["Port 1 Network"].Value>65534)&&(t["Port 1 Network"].Value=0),t["Port 2 Network"].isReadOnly=!1,(t["Port 2 Network"].Value<0||t["Port 2 Network"].Value>65534)&&(t["Port 2 Network"].Value=0),t["Port 1 Address"].isReadOnly=!1,(t["Port 1 Address"].Value<0||t["Port 1 Address"].Value>127)&&(t["Port 1 Address"].Value=0),t["Port 2 Address"].isReadOnly=!1,(t["Port 2 Address"].Value<0||t["Port 2 Address"].Value>127)&&(t["Port 2 Address"].Value=0),t["Port 1 Maximum Address"].isReadOnly=!1,(t["Port 1 Maximum Address"].Value<0||t["Port 1 Maximum Address"].Value>127)&&(t["Port 1 Maximum Address"].Value=0),t["Port 2 Address"].isReadOnly=!1,(t["Port 2 Maximum Address"].Value<0||t["Port 2 Maximum Address"].Value>127)&&(t["Port 2 Maximum Address"].Value=0)):"Central Device"==t["Model Type"].Value?(t["Model Type"].isDisplayable=!1,t["Uplink Port"].isDisplayable=!1,t["Uplink Port"].Value="Ethernet",t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"].Ethernet["enum"],t["Uplink Port"].ValueOptions={Ethernet:enumsTemplatesJson.Enums["Device Ports"].Ethernet["enum"]},t["Downlink Network"].isDisplayable=!1,t["Ethernet Protocol"].isDisplayable=!1,(t["Ethernet Network"].Value<0||t["Ethernet Network"].Value>65534)&&(t["Ethernet Network"].Value=0),t["Ethernet Address"].isReadOnly=!0,t["Ethernet Network"].isReadOnly=!0,t["Port 1 Protocol"].isDisplayable=!1,t["Port 2 Protocol"].isDisplayable=!1,t["Port 3 Protocol"].isDisplayable=!1,t["Port 4 Protocol"].isDisplayable=!1):"Field Interface Device"==t["Model Type"].Value||"MicroScan Interface Device"==t["Model Type"].Value||"Staefa Interface Device"==t["Model Type"].Value||"N2 Interface Device"==t["Model Type"].Value||"Sierra Steam Meter Device"==t["Model Type"].Value||"Armstrong SteamEye Device"==t["Model Type"].Value||"Siemens Power Meter Device"==t["Model Type"].Value||"Ingersol Rand Intellysis Device"==t["Model Type"].Value||"BACnet Interface Device"==t["Model Type"].Value?(t["Uplink Port"].isDisplayable=!1,t["Uplink Port"].Value="Port 1",t["Uplink Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],t["Uplink Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]},t["Ethernet Protocol"].isDisplayable=!1,t["Ethernet Protocol"].Value="None",t["Ethernet Protocol"].eValue=enumsTemplatesJson.Enums["Ethernet Protocols"].None["enum"],t["Port 1 Protocol"].isDisplayable=!0,t["Port 2 Protocol"].isDisplayable=!1,t["Port 3 Protocol"].isDisplayable=!1,t["Port 4 Protocol"].isDisplayable=!1,t["Port 1 Network"].isReadOnly=!1,(t["Port 1 Network"].Value<0||t["Port 1 Network"].Value>65534)&&(t["Port 1 Network"].Value=0)):(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"],console.log("Bad Model Type:",t["Model Type"])),e.point=t,e.point=this.applyDeviceTypeUplinkPort(e),e.point)},applyDeviceAlarmRepeatEnable:function(e){return e.point["Alarm Repeat Time"].isDisplayable=e.point["Alarm Repeat Enable"].Value===!1?!1:!0,e.point},applyDeviceTypeUplinkPort:function(e){var t=e.point;return"Ethernet"==t["Uplink Port"].Value?(t["Ethernet Protocol"].isReadOnly=!0,t["Ethernet Protocol"].Value="IP",t["Ethernet Protocol"].eValue=enumsTemplatesJson.Enums["Ethernet Protocols"].IP["enum"],t["Ethernet Network"].Min=1,t["Port 1 Protocol"].isReadOnly=!1,t["Port 2 Protocol"].isReadOnly=!1,t["Port 3 Protocol"].isReadOnly=!1,t["Port 4 Protocol"].isReadOnly=!1,t["Port 1 Network"].Min=0,t["Port 2 Network"].Min=0,t["Port 3 Network"].Min=0,t["Port 4 Network"].Min=0,("MicroScan 5 UNV"==t["Model Type"].Value||"Unknown"==t["Model Type"].Value||"MicroScan 5 xTalk"==t["Model Type"].Value||"MicroScan 5 UNV"==t["Model Type"].Value||"SCADA Vio"==t["Model Type"].Value)&&(t["Downlink Network"].isDisplayable=!0)):(t["Downlink Network"].isDisplayable=!1,t["Ethernet Protocol"].isReadOnly=!1,t["Ethernet Network"].Min=0,"Port 1"==t["Uplink Port"].Value?(t["Port 1 Protocol"].isReadOnly=!0,t["Port 2 Protocol"].isReadOnly=!1,t["Port 3 Protocol"].isReadOnly=!1,t["Port 4 Protocol"].isReadOnly=!1,t["Port 1 Protocol"].Value="MS/TP",t["Port 1 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"],t["Port 1 Network"].Min=1,t["Port 2 Network"].Min=0,t["Port 3 Network"].Min=0,t["Port 4 Network"].Min=0,t["Port 1 Maximum Address"].isReadOnly=!1,t["Port 2 Maximum Address"].isReadOnly=!1,t["Port 3 Maximum Address"].isReadOnly=!1,t["Port 4 Maximum Address"].isReadOnly=!1):"Port 2"==t["Uplink Port"].Value?(t["Port 1 Protocol"].isReadOnly=!1,t["Port 2 Protocol"].isReadOnly=!0,t["Port 3 Protocol"].isReadOnly=!1,t["Port 4 Protocol"].isReadOnly=!1,t["Port 2 Protocol"].Value="MS/TP",t["Port 2 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"],t["Port 1 Network"].Min=0,t["Port 2 Network"].Min=1,t["Port 3 Network"].Min=0,t["Port 4 Network"].Min=0,t["Port 1 Maximum Address"].isReadOnly=!1,t["Port 2 Maximum Address"].isReadOnly=!1,t["Port 3 Maximum Address"].isReadOnly=!1,t["Port 4 Maximum Address"].isReadOnly=!1):"Port 3"==t["Uplink Port"].Value?(t["Port 1 Protocol"].isReadOnly=!1,t["Port 2 Protocol"].isReadOnly=!1,t["Port 3 Protocol"].isReadOnly=!0,t["Port 4 Protocol"].isReadOnly=!1,t["Port 3 Protocol"].Value="MS/TP",t["Port 3 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"],t["Port 1 Network"].Min=0,t["Port 2 Network"].Min=0,t["Port 3 Network"].Min=1,t["Port 4 Network"].Min=0,t["Port 1 Maximum Address"].isReadOnly=!1,t["Port 2 Maximum Address"].isReadOnly=!1,t["Port 3 Maximum Address"].isReadOnly=!1,t["Port 4 Maximum Address"].isReadOnly=!1):"Port 4"==t["Uplink Port"].Value&&(t["Port 1 Protocol"].isReadOnly=!1,t["Port 2 Protocol"].isReadOnly=!1,t["Port 3 Protocol"].isReadOnly=!1,t["Port 4 Protocol"].isReadOnly=!0,t["Port 4 Protocol"].Value="MS/TP",t["Port 4 Protocol"].eValue=enumsTemplatesJson.Enums["Port Protocols"]["MS/TP"]["enum"],t["Port 1 Network"].Min=0,t["Port 2 Network"].Min=0,t["Port 3 Network"].Min=0,t["Port 4 Network"].Min=1,t["Port 1 Maximum Address"].isReadOnly=!1,t["Port 2 Maximum Address"].isReadOnly=!1,t["Port 3 Maximum Address"].isReadOnly=!1,t["Port 4 Maximum Address"].isReadOnly=!1)),e.point=t,e.point=this.applyDeviceTypeEthernetProtocol(e),e.point=this.applyDeviceTypePortNProtocol(e),e.point
},applyDeviceTypeEthernetProtocol:function(e){var t=e.point;return"None"==t["Ethernet Protocol"].Value?(t["Ethernet Address"].isDisplayable=!1,t["Ethernet Network"].isDisplayable=!1):(t["Ethernet Address"].isDisplayable=!0,t["Ethernet Network"].isDisplayable=!0),t},applyDeviceTypePortNProtocol:function(e){var t=e.point;return t["Port 1 Protocol"].isDisplayable===!1?(t["Port 1 Address"].isDisplayable=!1,t["Port 1 Maximum Address"].isDisplayable=!1,t["Port 1 Network"].isDisplayable=!1):"MS/TP"==t["Port 1 Protocol"].Value?(t["Port 1 Network"].isDisplayable=!0,t["Port 1 Address"].isDisplayable=!0,t["Port 1 Maximum Address"].isDisplayable=!0):"MS/RTU"==t["Port 1 Protocol"].Value?(t["Port 1 Network"].isDisplayable=!0,t["Port 1 Address"].isDisplayable=!1,t["Port 1 Maximum Address"].isDisplayable=!0,t["Port 1 Maximum Address"].isReadOnly=!1):(t["Port 1 Address"].isDisplayable=!1,t["Port 1 Maximum Address"].isDisplayable=!1,t["Port 1 Network"].isDisplayable=!1),t["Port 2 Protocol"].isDisplayable===!1?(t["Port 2 Address"].isDisplayable=!1,t["Port 2 Maximum Address"].isDisplayable=!1,t["Port 2 Network"].isDisplayable=!1):"MS/TP"==t["Port 2 Protocol"].Value?(t["Port 2 Network"].isDisplayable=!0,t["Port 2 Address"].isDisplayable=!0,t["Port 2 Maximum Address"].isDisplayable=!0):"MS/RTU"==t["Port 2 Protocol"].Value?(t["Port 2 Network"].isDisplayable=!0,t["Port 2 Address"].isDisplayable=!1,t["Port 2 Maximum Address"].isDisplayable=!0,t["Port 2 Maximum Address"].isReadOnly=!1):(t["Port 2 Address"].isDisplayable=!1,t["Port 2 Maximum Address"].isDisplayable=!1,t["Port 2 Network"].isDisplayable=!1),t["Port 3 Protocol"].isDisplayable===!1?(t["Port 3 Address"].isDisplayable=!1,t["Port 3 Maximum Address"].isDisplayable=!1,t["Port 3 Network"].isDisplayable=!1):"MS/TP"==t["Port 3 Protocol"].Value?(t["Port 3 Network"].isDisplayable=!0,t["Port 3 Address"].isDisplayable=!0,t["Port 3 Maximum Address"].isDisplayable=!0):"MS/RTU"==t["Port 3 Protocol"].Value?(t["Port 3 Network"].isDisplayable=!0,t["Port 3 Address"].isDisplayable=!1,t["Port 3 Maximum Address"].isDisplayable=!0,t["Port 3 Maximum Address"].isReadOnly=!1):(t["Port 3 Address"].isDisplayable=!1,t["Port 3 Maximum Address"].isDisplayable=!1,t["Port 3 Network"].isDisplayable=!1),t["Port 4 Protocol"].isDisplayable===!1?(t["Port 4 Address"].isDisplayable=!1,t["Port 4 Maximum Address"].isDisplayable=!1,t["Port 4 Network"].isDisplayable=!1):"MS/TP"==t["Port 4 Protocol"].Value?(t["Port 4 Network"].isDisplayable=!0,t["Port 4 Address"].isDisplayable=!0,t["Port 4 Maximum Address"].isDisplayable=!0):"MS/RTU"==t["Port 4 Protocol"].Value?(t["Port 4 Network"].isDisplayable=!0,t["Port 4 Address"].isDisplayable=!1,t["Port 4 Maximum Address"].isDisplayable=!0,t["Port 4 Maximum Address"].isReadOnly=!1):(t["Port 4 Address"].isDisplayable=!1,t["Port 4 Maximum Address"].isDisplayable=!1,t["Port 4 Network"].isDisplayable=!1),t},applyRemoteUnitTypeModelType:function(e){var t=e.point;return t._cfgRequired=!0,t._relPoint=enumsTemplatesJson.Enums.Reliabilities["No Fault"]["enum"],t._rmuModel=t["Model Type"].eValue,t["Device Address"].isDisplayable=!0,t["Device Address"].Min=0,t["Device Address"].Max=127,t["Device Port"].isDisplayable=!1,t["Device Port"].ValueOptions={Ethernet:enumsTemplatesJson.Enums["Device Ports"].Ethernet["enum"],"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],"Port 2":enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"],"Port 3":enumsTemplatesJson.Enums["Device Ports"]["Port 3"]["enum"],"Port 4":enumsTemplatesJson.Enums["Device Ports"]["Port 4"]["enum"]},t["Poll Function"].isDisplayable=!1,t["Poll Register"].isDisplayable=!1,t.Instance.isDisplayable=!1,t["Network Type"].isDisplayable=!1,t["Network Type"].ValueOptions={Unknown:enumsTemplatesJson.Enums["Network Types"].Unknown["enum"],"MS/TP":enumsTemplatesJson.Enums["Network Types"]["MS/TP"]["enum"],IP:enumsTemplatesJson.Enums["Network Types"].IP["enum"]},t["Network Segment"].isDisplayable=!1,t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?"BACnet"==t["Model Type"].Value?(t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],t["Network Type"].isDisplayable=!0,t["Network Type"].eValue===enumsTemplatesJson.Enums["Network Types"]["MS/TP"]["enum"]?t["Network Type"].Value="MS/TP":t["Network Type"].eValue===enumsTemplatesJson.Enums["Network Types"].IP["enum"]?t["Network Type"].Value="IP":(t["Network Type"].eValue=enumsTemplatesJson.Enums["Network Types"].Unknown["enum"],t["Network Type"].Value="Unknown"),e.point=t,t=this.applyRemoteUnitTypeNetworkType(e)):"Liebert"==t["Model Type"].Value||"Sierra Steam Meter"==t["Model Type"].Value||"Siemens Power Meter"==t["Model Type"].Value||"Ingersol Rand Intellysis"==t["Model Type"].Value||"PowerLogics 3000 Meter"==t["Model Type"].Value||"Generic Modbus"==t["Model Type"].Value||"PowerTraks 9000"==t["Model Type"].Value||"Programmable Modbus"==t["Model Type"].Value?(t["Device Port"].isDisplayable=!0,t["Device Port"].ValueOptions={Ethernet:enumsTemplatesJson.Enums["Device Ports"].Ethernet["enum"],"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],"Port 2":enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"],"Port 3":enumsTemplatesJson.Enums["Device Ports"]["Port 3"]["enum"],"Port 4":enumsTemplatesJson.Enums["Device Ports"]["Port 4"]["enum"]},"Port 1"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]:"Port 2"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"]:"Port 3"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 3"]["enum"]:"Port 4"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 4"]["enum"]:(t["Device Port"].Value="Ethernet",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"].Ethernet["enum"]),t["Device Address"].isDisplayable=!0,t["Device Address"].Max=254,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0):"MS3 RT"==t["Model Type"].Value||"MS 3 EEPROM"==t["Model Type"].Value||"MS 3 Flash"==t["Model Type"].Value||"MS 4 VAV"==t["Model Type"].Value?(t["Device Port"].isDisplayable=!0,t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],"Port 2":enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"],"Port 3":enumsTemplatesJson.Enums["Device Ports"]["Port 3"]["enum"],"Port 4":enumsTemplatesJson.Enums["Device Ports"]["Port 4"]["enum"]},"Port 2"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"]:"Port 3"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 3"]["enum"]:"Port 4"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 4"]["enum"]:(t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]),t["Device Address"].isDisplayable=!0,t["Device Address"].Max=127,t["Poll Function"].isDisplayable=!1,t["Poll Register"].isDisplayable=!1,t.Instance.isDisplayable=!1,t["Network Type"].isDisplayable=!1,t["Network Segment"].isDisplayable=!1):"N2 Device"==t["Model Type"].Value?(t["Device Port"].isDisplayable=!0,t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],"Port 2":enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"],"Port 3":enumsTemplatesJson.Enums["Device Ports"]["Port 3"]["enum"],"Port 4":enumsTemplatesJson.Enums["Device Ports"]["Port 4"]["enum"]},"Port 2"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"]:"Port 3"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 3"]["enum"]:"Port 4"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 4"]["enum"]:(t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]),t["Device Address"].isDisplayable=!0,t["Device Address"].Max=254):(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"],console.log("Bad RMU Model Type:",t["Model Type"].Value,", _id:",t._id,", _devModel:",t._devModel)):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?"BACnet"==t["Model Type"].Value?(t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],t.Instance.isDisplayable=!0,t["Network Type"].isDisplayable=!0,"MS/TP"==t["Network Type"].Value?t["Network Type"].eValue=enumsTemplatesJson.Enums["Network Types"]["MS/TP"]["enum"]:"IP"==t["Network Type"].Value?t["Network Type"].eValue=enumsTemplatesJson.Enums["Network Types"].IP["enum"]:(t["Network Type"].Value="Unknown",t["Network Type"].eValue=enumsTemplatesJson.Enums["Network Types"].Unknown["enum"]),e.point=t,t=this.applyRemoteUnitTypeNetworkType(e)):"Liebert"==t["Model Type"].Value||"Sierra Steam Meter"==t["Model Type"].Value||"Siemens Power Meter"==t["Model Type"].Value||"Ingersol Rand Intellysis"==t["Model Type"].Value||"PowerLogic 3000 Meter"==t["Model Type"].Value||"Generic Modbus"==t["Model Type"].Value||"PowerTraks 9000"==t["Model Type"].Value||"Programmable Modbus"==t["Model Type"].Value?(t["Device Port"].isDisplayable=!0,t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],"Port 2":enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"]},"Port 2"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"]:(t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]),t["Device Address"].Max=254,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0):"MS3 RT"==t["Model Type"].Value||"MS 3 EEPROM"==t["Model Type"].Value||"MS 3 Flash"==t["Model Type"].Value||"MS 4 VAV"==t["Model Type"].Value?(t["Device Port"].isDisplayable=!0,t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],"Port 2":enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"]},"Port 2"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"]:(t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"])):"N2 Device"==t["Model Type"].Value?(t["Device Port"].isDisplayable=!0,t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],"Port 2":enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"]},"Port 2"==t["Device Port"].Value?t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 2"]["enum"]:(t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]),t["Device Address"].Max=254):(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"],console.log("Bad RMU Model Type:",t["Model Type"].Value,", _id:",t._id,", _devModel:",t._devModel)):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["BACnet Interface Device"]["enum"]?"BACnet"==t["Model Type"].Value?(t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]},t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],t["Device Port"].Value="Port 1",t.Instance.isDisplayable=!0,t["Network Type"].isDisplayable=!0,t["Network Type"].ValueOptions={Unknown:enumsTemplatesJson.Enums["Network Types"].Unknown["enum"],"MS/TP":enumsTemplatesJson.Enums["Network Types"]["MS/TP"]["enum"]},"MS/TP"==t["Network Type"].Value?t["Network Type"].eValue=enumsTemplatesJson.Enums["Network Types"]["MS/TP"]["enum"]:(t["Network Type"].Value="Unknown",t["Network Type"].eValue=enumsTemplatesJson.Enums["Network Types"].Unknown["enum"]),e.point=t,t=this.applyRemoteUnitTypeNetworkType(e)):(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"],console.log("Bad RMU Model Type:",t["Model Type"].Value,", _id:",t._id,", _devModel:",t._devModel)):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Sierra Steam Meter Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Siemens Power Meter Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Ingersol Rand Intellysis Device"]["enum"]?"Sierra Steam Meter"==t["Model Type"].Value||"Siemens Power Meter"==t["Model Type"].Value||"Ingersol Rand Intellysis"==t["Model Type"].Value?(t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]},t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],t["Device Address"].Max=254,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0):(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"],console.log("Bad RMU Model Type:",t["Model Type"].Value,", _id:",t._id,", _devModel:",t._devModel)):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan Interface Device"]["enum"]?"MS3 RT"==t["Model Type"].Value||"MS 3 EEPROM"==t["Model Type"].Value||"MS 3 Flash"==t["Model Type"].Value?(t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]},t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]):(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"],console.log("Bad RMU Model Type:",t["Model Type"].Value,", _id:",t._id,", _devModel:",t._devModel)):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["N2 Interface Device"]["enum"]?"N2 Device"==t["Model Type"].Value?(t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]},t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],t["Device Address"].Max=254):(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"],console.log("Bad RMU Model Type:",t["Model Type"].Value,", _id:",t._id,", _devModel:",t._devModel)):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Field Interface Device"]["enum"]?"IFC Remote Unit"==t["Model Type"].Value?(t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]},t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],t["Device Address"].Max=254):(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"],console.log("Bad RMU Model Type:",t["Model Type"].Value,", _id:",t._id,", _devModel:",t._devModel)):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Armstrong SteamEye Device"]["enum"]?"ASE Remote Unit"==t["Model Type"].Value?(t["COV Period"].ValueType=12,t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]},t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],t["Device Address"].Max=65535):(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"],console.log("Bad RMU Model Type:",t["Model Type"].Value,", _id:",t._id,", _devModel:",t._devModel)):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Staefa Interface Device"]["enum"]?"Smart II Remote Unit"==t["Model Type"].Value?(t["Device Port"].ValueOptions={"Port 1":enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"]},t["Device Port"].Value="Port 1",t["Device Port"].eValue=enumsTemplatesJson.Enums["Device Ports"]["Port 1"]["enum"],t["Device Address"].Max=254):(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"],console.log("Bad RMU Model Type:",t["Model Type"].Value,", _id:",t._id,", _devModel:",t._devModel)):(t.relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"],console.log("Bad Device Model Type:",t["Model Type"].Value,", _id:",t._id,", _devModel:",t._devModel)),t},applyRemoteUnitTypeNetworkType:function(e){var t=e.point;return"Unknown"==t["Network Type"].Value?(t["Device Address"].isDisplayable=!1,t["Network Segment"].isDisplayable=!1):"MS/TP"==t["Network Type"].Value?(t["Device Address"].isDisplayable=!0,t["Device Address"].Max=127,t["Network Segment"].isDisplayable=!0):(t["Device Address"].isDisplayable=!0,t["Device Address"].Max=-1,t["Network Segment"].isDisplayable=!0),t},applyAnalogInputTypeSensorPoint:function(e){var t=e.point,n=e.refPoint;return n&&void 0!==t["Sensor Point"].Value&&0!==t["Sensor Point"].Value?(t["Conversion Type"].isReadOnly=!0,t["Conversion Type"].eValue=n["Conversion Type"].eValue,t["Conversion Type"].Value=n["Conversion Type"].Value,void 0!==t["Conversion Coefficient 1"]&&(t["Conversion Coefficient 1"].isReadOnly=!0,t["Conversion Coefficient 1"].Value=n["Conversion Coefficient 1"].Value),void 0!==t["Conversion Coefficient 2"]&&(t["Conversion Coefficient 2"].isReadOnly=!0,t["Conversion Coefficient 2"].Value=n["Conversion Coefficient 2"].Value),void 0!==t["Conversion Coefficient 3"]&&(t["Conversion Coefficient 3"].isReadOnly=!0,t["Conversion Coefficient 3"].Value=n["Conversion Coefficient 3"].Value),void 0!==t["Conversion Coefficient 4"]&&(t["Conversion Coefficient 4"].isReadOnly=!0,t["Conversion Coefficient 4"].Value=n["Conversion Coefficient 4"].Value),e.point=t,e.point=this.applyConversionTypeProperty(e),e.point=this.applyUniquePIDLogic(e),e.point):(t["Conversion Type"].isReadOnly=!1,void 0!==t["Conversion Coefficient 1"]&&(t["Conversion Coefficient 1"].isReadOnly=!1),void 0!==t["Conversion Coefficient 2"]&&(t["Conversion Coefficient 2"].isReadOnly=!1),void 0!==t["Conversion Coefficient 3"]&&(t["Conversion Coefficient 3"].isReadOnly=!1),void 0!==t["Conversion Coefficient 4"]&&(t["Conversion Coefficient 4"].isReadOnly=!1),e.point=t,e.point=this.applyConversionTypeProperty(e),e.point=this.applyUniquePIDLogic(e),e.point)},applyAnalogInputTypeDevModel:function(e){var t=e.point;if(t._relPoint=t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]?enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"]:enumsTemplatesJson.Enums.Reliabilities["No Fault"]["enum"],t._cfgRequired=!0,t.Instance.isDisplayable=!1,t.Channel.isDisplayable=!1,t["VAV Channel"].isDisplayable=!1,t["VAV Channel"].ValueOptions={"1 - Zone Temperature":1,"2 - Setpoint Adjust":2,"3 - Supply Temperature":3,"4 - Auxiliary":4,"5 - Air Volume":5},t["Input Type"].isDisplayable=!1,t["Poll Data Type"].isDisplayable=!1,t["Poll Function"].isDisplayable=!1,t["Poll Register"].isDisplayable=!1,t["Sensor Point"].isDisplayable=!1,t["Conversion Type"].isDisplayable=!1,t["Conversion Coefficient 1"].isDisplayable=!1,t["Conversion Coefficient 2"].isDisplayable=!1,t["Conversion Coefficient 3"].isDisplayable=!1,t["Conversion Coefficient 4"].isDisplayable=!1,t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"])if(0===t["Remote Unit Point"].Value){if(t._devModel!==enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"])return t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=2,t.Channel.Min=1,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={"20 mA SP":3,"Rate Input":5},t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point):(t.Channel.isDisplayable=!0,t.Channel.Max=16,t.Channel.Min=1,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Resistance:0,"5 Volt":1,"10 Volt":2,"20 mA SP":3,"20 mA LP":4,"Rate Input":5},t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point);t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"])t.Instance.isDisplayable=!0;else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"])return t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point;if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"])return t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Normal:0,Inverted:2,Velocity:3},t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point;if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]["enum"])return t["VAV Channel"].isDisplayable=!0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Normal:0,Inverted:2,Velocity:3},t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"])if(0===t["Remote Unit Point"].Value){if(t._devModel!==enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"])return t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=32,t.Channel.Min=1,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={"Rate Input":1},t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point):(t.Channel.isDisplayable=!0,t.Channel.Max=16,t.Channel.Min=1,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Normal:0,"Rate Input":1},t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point);t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"])t.Instance.isDisplayable=!0;else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"])return t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point;if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"])return t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Normal:0,Inverted:2,Velocity:3},t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point;if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]["enum"])return t["VAV Channel"].isDisplayable=!0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Normal:0,Inverted:2,Velocity:3},t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["BACnet Interface Device"]["enum"])0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]?t.Instance.isDisplayable=!0:t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Sierra Steam Meter Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Siemens Power Meter Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Ingersol Rand Intellysis Device"]["enum"])if(0===t["Remote Unit Point"].Value)t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"])return t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan Interface Device"]["enum"])if(0===t["Remote Unit Point"].Value)t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"])return t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Normal:0,Inverted:2,Velocity:3},t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["N2 Interface Device"]["enum"])0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?t.Instance.isDisplayable=!0:t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Field Interface Device"]["enum"])if(0===t["Remote Unit Point"].Value)t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["IFC Remote Unit"]["enum"])return t.Channel.isDisplayable=!0,t.Channel.Max=15,t.Channel.Min=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={"High Resistance":0,"High Voltage":1,"Low Resistance":2,"Low Voltage":3},t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Armstrong SteamEye Device"]["enum"])if(0===t["Remote Unit Point"].Value)t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["ASE Remote Unit"]["enum"])return t.Channel.isDisplayable=!0,t.Channel.Max=255,t.Channel.Min=0,t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Staefa Interface Device"]["enum"])if(0===t["Remote Unit Point"].Value)t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Smart II Remote Unit"]["enum"])return t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0,t["Sensor Point"].isDisplayable=!0,t["Conversion Type"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogInputTypeSensorPoint(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"];return t},applyAnalogOutputTypeSensorPoint:function(e){var t=e.point,n=e.refPoint;
return null!==n&&void 0!==n&&void 0!==t["Sensor Point"].Value&&0!==t["Sensor Point"].Value?(void 0!==t["Conversion Coefficient 1"]&&(t["Conversion Coefficient 1"].isReadOnly=!0,t["Conversion Coefficient 1"].Value=n["Conversion Coefficient 1"].Value),void 0!==t["Conversion Coefficient 2"]&&(t["Conversion Coefficient 2"].isReadOnly=!0,t["Conversion Coefficient 2"].Value=n["Conversion Coefficient 2"].Value)):(void 0!==t["Conversion Coefficient 1"]&&(t["Conversion Coefficient 1"].isReadOnly=!1),void 0!==t["Conversion Coefficient 2"]&&(t["Conversion Coefficient 2"].isReadOnly=!1)),t=this.applyUniquePIDLogic(e)},applyAnalogOutputTypeOutputType:function(e){var t=e.point;return"Pulsed"==t["Output Type"].Value||"Pulse Width"==t["Output Type"].Value?t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]["enum"]?(t.Channel.isDisplayable=!1,t["Close Channel"].isDisplayable=!1,t["Open Channel"].isDisplayable=!1,t.Polarity.isDisplayable=!1,t["VAV Channel"].isDisplayable=!0):(t.Polarity.isDisplayable=!0,t.Polarity.isReadOnly=!1,t["VAV Channel"].isDisplayable=!1,"Pulse Width"==t["Output Type"].Value?(t.Channel.isDisplayable=!1,t["Close Channel"].isDisplayable=!0,t["Open Channel"].isDisplayable=!0):(t.Channel.isDisplayable=!0,t["Close Channel"].isDisplayable=!1,t["Open Channel"].isDisplayable=!1)):(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]["enum"]?(t.Channel.isDisplayable=!1,t["VAV Channel"].isDisplayable=!0):(t.Channel.isDisplayable=!0,t["VAV Channel"].isDisplayable=!1),t["Close Channel"].isDisplayable=!1,t["Open Channel"].isDisplayable=!1,t.Polarity.isDisplayable=!1),t},applyAnalogOutputTypeDevModel:function(e){var t=e.point;if(t._relPoint=t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]?enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"]:enumsTemplatesJson.Enums.Reliabilities["No Fault"]["enum"],t._cfgRequired=!0,t["Sensor Point"].isDisplayable=!1,t["Conversion Coefficient 1"].isDisplayable=!1,t["Conversion Coefficient 2"].isDisplayable=!1,t.Instance.isDisplayable=!1,t["Poll Data Type"].isDisplayable=!1,t["Poll Function"].isDisplayable=!1,t["Poll Register"].isDisplayable=!1,t["Control Data Type"].isDisplayable=!1,t["Control Function"].isDisplayable=!1,t["Control Register"].isDisplayable=!1,t["Output Type"].isDisplayable=!1,t["Open Channel"].isDisplayable=!1,t["Close Channel"].isDisplayable=!1,t.Channel.isDisplayable=!1,t.Polarity.isDisplayable=!1,t["VAV Channel"].isDisplayable=!1,t["VAV Channel"].ValueOptions={"1 - Damper":1,"2 - Reheat":2},t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"])if(0===t["Remote Unit Point"].Value){if(t._devModel!==enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"])return t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?(t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={"Pulse Width":1,Pulsed:2},t["Open Channel"].Max=5,t["Open Channel"].Min=1,t["Close Channel"].Max=5,t["Close Channel"].Min=1,e.point=t,e.point=this.applyAnalogOutputTypeSensorPoint(e),e.point=this.applyAnalogOutputTypeOutputType(e),e.point):(t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={"0 to 5 Volt":0,"0 to 10 Volt":3,"0 to 20 mA":4,"Pulse Width":1,Pulsed:2},t["Open Channel"].Max=8,t["Open Channel"].Min=1,t["Close Channel"].Max=8,t["Close Channel"].Min=1,e.point=t,e.point=this.applyAnalogOutputTypeSensorPoint(e),e.point=this.applyAnalogOutputTypeOutputType(e),e.point);t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"])t.Instance.isDisplayable=!0;else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"])return t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["Control Data Type"].isDisplayable=!0,t["Control Function"].isDisplayable=!0,t["Control Register"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogOutputTypeOutputType(e),e.point;if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"])return t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Analog:0,"Pulse Width":1,Pulsed:2},t.Channel.Max=7,t.Channel.Min=0,t["Open Channel"].Max=7,t["Open Channel"].Min=0,t["Close Channel"].Max=7,t["Close Channel"].Min=0,e.point=t,e.point=this.applyAnalogOutputTypeSensorPoint(e),e.point=this.applyAnalogOutputTypeOutputType(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"])if(0===t["Remote Unit Point"].value){if(t._devModel!==enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"])return t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?(t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={"Pulse Width":1,Pulsed:2},t["Open Channel"].Max=32,t["Open Channel"].Min=1,t["Close Channel"].Max=32,t["Close Channel"].Min=1,e.point=t,e.point=this.applyAnalogOutputTypeSensorPoint(e),e.point=this.applyAnalogOutputTypeOutputType(e),e.point):(t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Analog:0,"Pulse Width":1,Pulsed:2},t.Channel.isDisplayable=!0,t.Channel.Max=8,t.Channel.Min=1,t["Open Channel"].Max=8,t["Open Channel"].Min=1,t["Close Channel"].Max=8,t["Close Channel"].Min=1,e.point=t,e.point=this.applyAnalogOutputTypeSensorPoint(e),e.point=this.applyAnalogOutputTypeOutputType(e),e.point);t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"])t.Instance.isDisplayable=!0;else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"])return t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["Control Data Type"].isDisplayable=!0,t["Control Function"].isDisplayable=!0,t["Control Register"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogOutputTypeOutputType(e),e.point;if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"])return t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Analog:0,"Pulse Width":1,Pulsed:2},t.Channel.Max=7,t.Channel.Min=0,t["Open Channel"].Max=7,t["Open Channel"].Min=0,t["Close Channel"].Max=7,t["Close Channel"].Min=0,e.point=t,e.point=this.applyAnalogOutputTypeSensorPoint(e),e.point=this.applyAnalogOutputTypeOutputType(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["BACnet Interface Device"]["enum"])0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]?t.Instance.isDisplayable=!0:t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Ingersol Rand Intellysis Device"]["enum"])if(0===t["Remote Unit Point"].Value)t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"])return t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["Control Data Type"].isDisplayable=!0,t["Control Function"].isDisplayable=!0,t["Control Register"].isDisplayable=!0,e.point=t,e.point=this.applyAnalogOutputTypeOutputType(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan Interface Device"]["enum"])if(0===t["Remote Unit Point"].Value)t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"])return t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Analog:0,"Pulse Width":1,Pulsed:2},t.Channel.Max=7,t.Channel.Min=0,t["Open Channel"].Max=7,t["Open Channel"].Min=0,t["Close Channel"].Max=7,t["Close Channel"].Min=0,e.point=t,e.point=this.applyAnalogOutputTypeSensorPoint(e),e.point=this.applyAnalogOutputTypeOutputType(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["N2 Interface Device"]["enum"])0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?t.Instance.isDisplayable=!0:t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Field Interface Device"]["enum"])if(0===t["Remote Unit Point"].Value)t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["IFC Remote Unit"]["enum"])return t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Analog:0,"Pulse Width":1,Pulsed:2},t.Channel.Max=3,t.Channel.Min=0,t["Open Channel"].Max=15,t["Open Channel"].Min=0,t["Close Channel"].Max=15,t["Close Channel"].Min=0,e.point=t,e.point=this.applyAnalogOutputTypeSensorPoint(e),e.point=this.applyAnalogOutputTypeOutputType(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else if(t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Staefa Interface Device"]["enum"])if(0===t["Remote Unit Point"].Value)t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"];else{if(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Smart II Remote Unit"]["enum"])return t["Sensor Point"].isDisplayable=!0,t["Conversion Coefficient 1"].isDisplayable=!0,t["Conversion Coefficient 2"].isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Analog:0,"Pulse Width":1,Pulsed:2},t.Channel.Max=7,t.Channel.Min=0,t["Open Channel"].Max=7,t["Open Channel"].Min=0,t["Close Channel"].Max=7,t["Close Channel"].Min=0,e.point=t,e.point=this.applyAnalogOutputTypeSensorPoint(e),e.point=this.applyAnalogOutputTypeOutputType(e),e.point;t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]}else t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"];return t},applyAnalogValueTypeDevModel:function(e){var t=e.point;return t._relPoint=t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]?enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"]:0,t._cfgRequired=!0,t.Instance.isDisplayable=!1,t["Monitor Point"].isDisplayable=!0,t["Demand Interval"].isDisplayable=!0,t["Demand Enable"].isDisplayable=!0,t["Fail Action"].isDisplayable=!0,t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?(t.Instance.isDisplayable=!0,t["Monitor Point"].isDisplayable=!1,t["Demand Interval"].isDisplayable=!1,t["Demand Enable"].isDisplayable=!1,t["Fail Action"].isDisplayable=!1):0!==t["Remote Unit Point"].Value&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?(t.Instance.isDisplayable=!0,t["Monitor Point"].isDisplayable=!1,t["Demand Interval"].isDisplayable=!1,t["Demand Enable"].isDisplayable=!1,t["Fail Action"].isDisplayable=!1):0!==t["Remote Unit Point"].Value&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["BACnet Interface Device"]["enum"]?t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]?(t.Instance.isDisplayable=!0,t["Monitor Point"].isDisplayable=!1,t["Demand Interval"].isDisplayable=!1,t["Demand Enable"].isDisplayable=!1,t["Fail Action"].isDisplayable=!1):0!==t["Remote Unit Point"]&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Sierra Steam Meter Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Siemens Power Meter Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Ingersol Rand Intellysis Device"]["enum"]?0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan Interface Device"]["enum"]?0!==t["Remote Unit Point"].Value&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["N2 Interface Device"]["enum"]?(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]&&(t.Instance.isDisplayable=!0,t["Monitor Point"].isDisplayable=!1,t["Demand Interval"].isDisplayable=!1,t["Demand Enable"].isDisplayable=!1,t["Fail Action"].isDisplayable=!1),0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"])):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Field Interface Device"]["enum"]?0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Armstrong SteamEye Device"]["enum"]?0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Staefa Interface Device"]["enum"]?0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"],t},applyBinaryValueTypeDevModel:function(e){var t=e.point;return t._relPoint=t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]?enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"]:enumsTemplatesJson.Enums.Reliabilities["No Fault"]["enum"],t._cfgRequired=!0,t.Instance.isDisplayable=!1,t["Monitor Point"].isDisplayable=!0,t["Demand Interval"].isDisplayable=!0,t["Demand Enable"].isDisplayable=!0,t["Fail Action"].isDisplayable=!0,t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?(t.Instance.isDisplayable=!0,t["Monitor Point"].isDisplayable=!1,t["Demand Interval"].isDisplayable=!1,t["Demand Enable"].isDisplayable=!1,t["Fail Action"].isDisplayable=!1):0!==t["Remote Unit Point"].Value&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?(t.Instance.isDisplayable=!0,t["Monitor Point"].isDisplayable=!1,t["Demand Interval"].isDisplayable=!1,t["Demand Enable"].isDisplayable=!1,t["Fail Action"].isDisplayable=!1):0!==t["Remote Unit Point"].Value&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["BACnet Interface Device"]["enum"]?(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]&&(t.Instance.isDisplayable=!0,t["Monitor Point"].isDisplayable=!1,t["Demand Interval"].isDisplayable=!1,t["Demand Enable"].isDisplayable=!1,t["Fail Action"].isDisplayable=!1),0!==t["Remote Unit Point"]&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"])):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Sierra Steam Meter Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Siemens Power Meter Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Ingersol Rand Intellysis Device"]["enum"]?0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan Interface Device"]["enum"]?0!==t["Remote Unit Point"].Value&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]&&t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["N2 Interface Device"]["enum"]?t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?(t.Instance.isDisplayable=!0,t["Monitor Point"].isDisplayable=!1,t["Demand Interval"].isDisplayable=!1,t["Demand Enable"].isDisplayable=!1,t["Fail Action"].isDisplayable=!1):0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Field Interface Device"]["enum"]?0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Armstrong SteamEye Device"]["enum"]?0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Staefa Interface Device"]["enum"]?0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"],t},applyBinaryValueTypeFeedbackPoint:function(e){var t=e.point;return 0!==t["Feedback Point"].Value?(t["Feedback Polarity"].isDisplayable=!0,t["Alarm Value"].isReadOnly=!0):(t["Feedback Polarity"].isDisplayable=!1,t["Alarm Value"].isReadOnly=!1),e.point=t,t=Config.EditChanges.applyUniquePIDLogic(e)},applyBinaryInputTypeFeedbackPoint:function(e){var t=e.point;return 0!==t["Feedback Point"].Value?(t["Feedback Polarity"].isDisplayable=!0,t["Alarm Value"].isReadOnly=!0):(t["Feedback Polarity"].isDisplayable=!1,t["Alarm Value"].isReadOnly=!1),e.point=t,t=this.applyUniquePIDLogic(e)},applyBinaryInputTypeInputType:function(e){var t=e.point;return t["Momentary Delay"].isDisplayable=1===t["Input Type"].eValue?!0:!1,t},applyBinaryInputTypeDevModel:function(e){var t=e.point;return t._relPoint=t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]?enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"]:enumsTemplatesJson.Enums.Reliabilities["No Fault"]["enum"],t._cfgRequired=!0,t.Instance.isDisplayable=!1,t.Channel.isDisplayable=!1,t["VAV Channel"].isDisplayable=!1,t["VAV Channel"].ValueOptions={"1 - Occupancy Override":1,"2 - Occupancy Sensor":2},t["Input Type"].isDisplayable=!1,t["Poll Data Type"].isDisplayable=!1,t["Poll Function"].isDisplayable=!1,t["Poll Register"].isDisplayable=!1,t["Supervised Input"].isDisplayable=!1,t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?0===t["Remote Unit Point"].Value?t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=9,t.Channel.Min=1,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0,Momentary:1,Pulse:2},e.point=t,t=this.applyBinaryInputTypeInputType(e)):(t.Channel.isDisplayable=!0,t.Channel.Max=16,t.Channel.Min=1,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0,Momentary:1,Pulse:2},e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?t.Instance.isDisplayable=!0:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"]?(t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0,Momentary:1},t["Supervised Input"].isDisplayable=!0,e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]["enum"]?(t["VAV Channel"].isDisplayable=!0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0,Momentary:1},e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?0===t["Remote Unit Point"].Value?t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=32,t.Channel.Min=1,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0,Momentary:1},e.point=t,t=this.applyBinaryInputTypeInputType(e)):(t.Channel.isDisplayable=!0,t.Channel.Max=16,t.Channel.Min=1,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0,Momentary:1},e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?t.Instance.isDisplayable=!0:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"]?(t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0,Momentary:1},t["Supervised Input"].isDisplayable=!0,e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]["enum"]?(t["VAV Channel"].isDisplayable=!0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0,Momentary:1},e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["BACnet Interface Device"]["enum"]?0===t["Remote Unit Point"].Value?(t.Channel.Value=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0},t["Supervised Input"].isDisplayable=!0,e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]?t.Instance.isDisplayable=!0:t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Sierra Steam Meter Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Ingersol Rand Intellysis Device"]["enum"]?0===t["Remote Unit Point"].Value?(t.Channel.Value=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0},e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]?(t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan Interface Device"]["enum"]?0===t["Remote Unit Point"].Value?(t.Channel.Value=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0},e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0,Momentary:1},t["Supervised Input"].isDisplayable=!0,e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["N2 Interface Device"]["enum"]?0===t["Remote Unit Point"].Value?(t.Channel.Value=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0},e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?t.Instance.isDisplayable=!0:t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Field Interface Device"]["enum"]?0===t["Remote Unit Point"].Value?(t.Channel.Value=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0},e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["IFC Remote Unit"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=15,t.Channel.Min=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0},t["Supervised Input"].isDisplayable=!0,e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Armstrong SteamEye Device"]["enum"]?0===t["Remote Unit Point"].Value?(t.Channel.Value=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0},e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["ASE Remote Unit"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=255,t.Channel.Min=0):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Staefa Interface Device"]["enum"]?0===t["Remote Unit Point"].Value?(t.Channel.Value=0,t["Input Type"].isDisplayable=!0,t["Input Type"].ValueOptions={Latch:0},e.point=t,t=this.applyBinaryInputTypeInputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Smart II Remote Unit"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"],t
},applyBinaryOutputTypeFeedbackType:function(e){var t=e.point;return t["Close Channel"].isDisplayable=!1,t["Open Channel"].isDisplayable=!1,t["Close Polarity"].isDisplayable=!1,t["Open Polarity"].isDisplayable=!1,t["Feedback Channel"].isDisplayable=!1,t["Feedback Polarity"].isDisplayable=!1,t["Feedback Point"].isDisplayable=!1,t["Verify Delay"].isReadOnly=!0,0!==t["Feedback Point"].Value&&(t["Feedback Type"].eValue=3,t["Feedback Type"].Value="Point",t["Verify Delay"].isReadOnly=!1),1===t["Feedback Type"].eValue?(t["Feedback Channel"].isDisplayable=!0,t["Feedback Polarity"].isDisplayable=!0,t["Verify Delay"].isReadOnly=!1):2===t["Feedback Type"].eValue?(t["Close Channel"].isDisplayable=!0,t["Open Channel"].isDisplayable=!0,t["Close Polarity"].isDisplayable=!0,t["Open Polarity"].isDisplayable=!0,t["Verify Delay"].isReadOnly=!1):3===t["Feedback Type"].eValue&&(t["Feedback Point"].isDisplayable=!0,t["Feedback Polarity"].isDisplayable=!0,t["Verify Delay"].isReadOnly=!1),t},applyBinaryOutputTypeOutputType:function(e){var t=e.point;return 0===t["Output Type"].eValue?(t.Channel.isDisplayable=!0,t["On Channel"].isDisplayable=!1,t["Off Channel"].isDisplayable=!1,t["Momentary Delay"].isDisplayable=!1):(t.Channel.isDisplayable=!1,t["On Channel"].isDisplayable=!0,t["Off Channel"].isDisplayable=!0,t["Momentary Delay"].isDisplayable=!0),t},applyBinaryOutputTypeFeedbackPoint:function(e){return this.applyUniquePIDLogic(e)},applyBinaryOutputTypeDevModel:function(e){var t=e.point;return t._relPoint=t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]?enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"]:enumsTemplatesJson.Enums.Reliabilities["No Fault"]["enum"],t._cfgRequired=!0,t["Same State Test"].isDisplayable=!1,t["VAV Channel"].isDisplayable=!1,t["VAV Channel"].ValueOptions={"3 - Lights":3,"5 - Fan":5,"6 - Digital Heat 1":6,"7 - Digital Heat 2":7,"8 - Digital Heat 3":8},t["Supervised Input"].isDisplayable=!1,t.Polarity.isDisplayable=!1,t["Output Type"].isDisplayable=!1,t.Channel.isDisplayable=!1,t["On Channel"].isDisplayable=!1,t["Off Channel"].isDisplayable=!1,t["Momentary Delay"].isDisplayable=!1,t["Feedback Type"].isDisplayable=!0,t["Feedback Type"].ValueOptions={None:0,Single:1,Dual:2,Point:3},t.Instance.isDisplayable=!1,t["Poll Data Type"].isDisplayable=!1,t["Poll Function"].isDisplayable=!1,t["Poll Register"].isDisplayable=!1,t["On Control Data Type"].isDisplayable=!1,t["On Control Function"].isDisplayable=!1,t["On Control Value"].isDisplayable=!1,t["Off Control Data Type"].isDisplayable=!1,t["Off Control Function"].isDisplayable=!1,t["Off Control Register"].isDisplayable=!1,t["Off Control Value"].isDisplayable=!1,t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?0===t["Remote Unit Point"].Value?t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?(t["Same State Test"].isDisplayable=!0,t.Polarity.isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Latch:0,Momentary:1},t.Channel.Max=5,t.Channel.Min=1,t["On Channel"].Max=5,t["On Channel"].Min=1,t["Off Channel"].Max=5,t["Off Channel"].Min=1,t["Feedback Channel"].Max=9,t["Feedback Channel"].Min=1,t["Open Channel"].Max=9,t["Open Channel"].Min=1,t["Close Channel"].Max=9,t["Close Channel"].Min=1,e.point=t,t=this.applyBinaryOutputTypeOutputType(e)):(t["Same State Test"].isDisplayable=!0,t.Polarity.isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Latch:0,Momentary:1},t.Channel.Max=8,t.Channel.Min=1,t["On Channel"].Max=8,t["On Channel"].Min=1,t["Off Channel"].Max=8,t["Off Channel"].Min=1,t["Feedback Channel"].Max=16,t["Feedback Channel"].Min=1,t["Open Channel"].Max=16,t["Open Channel"].Min=1,t["Close Channel"].Max=16,t["Close Channel"].Min=1,e.point=t,t=this.applyBinaryOutputTypeOutputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]?(t["Feedback Type"].ValueOptions={None:0,Point:3,Remote:4},t.Instance.isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?(t["Feedback Type"].ValueOptions={None:0,Single:1,Point:3},t["Feedback Channel"].Max=255,t["Feedback Channel"].Min=0,t.Instance.isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"]?(t["Feedback Type"].ValueOptions={None:0,Point:3},t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["On Control Data Type"].isDisplayable=!0,t["On Control Function"].isDisplayable=!0,t["On Control Register"].isDisplayable=!0,t["On Control Value"].isDisplayable=!0,t["Off Control Data Type"].isDisplayable=!0,t["Off Control Function"].isDisplayable=!0,t["Off Control Register"].isDisplayable=!0,t["Off Control Value"].isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"]?(t["Same State Test"].isDisplayable=!0,t.Polarity.isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Latch:0,Momentary:1},t.Channel.Max=7,t.Channel.Min=0,t["On Channel"].Max=7,t["On Channel"].Min=0,t["Off Channel"].Max=7,t["Off Channel"].Min=0,t["Feedback Type"].ValueOptions={None:0,Single:1,Point:3},t["Feedback Channel"].Max=7,t["Feedback Channel"].Min=0,e.point=t,t=this.applyBinaryOutputTypeOutputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]["enum"]?(t["Feedback Type"].ValueOptions={None:0},t["VAV Channel"].isDisplayable=!0,t.Polarity.isDisplayable=!0):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?0===t["Remote Unit Point"].Value?t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?(t["Same State Test"].isDisplayable=!0,t.Polarity.isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Latch:0,Momentary:1},t.Channel.Max=32,t.Channel.Min=1,t["On Channel"].Max=32,t["On Channel"].Min=1,t["Off Channel"].Max=32,t["Off Channel"].Min=1,t["Feedback Channel"].Max=32,t["Feedback Channel"].Min=1,t["Open Channel"].Max=32,t["Open Channel"].Min=1,t["Close Channel"].Max=32,t["Close Channel"].Min=1,e.point=t,t=this.applyBinaryOutputTypeOutputType(e)):(t["Same State Test"].isDisplayable=!0,t.Polarity.isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Latch:0,Momentary:1},t.Channel.Max=8,t.Channel.Min=1,t["On Channel"].Max=8,t["On Channel"].Min=1,t["Off Channel"].Max=8,t["Off Channel"].Min=1,t["Feedback Channel"].Max=16,t["Feedback Channel"].Min=1,t["Open Channel"].Max=16,t["Open Channel"].Min=1,t["Close Channel"].Max=16,t["Close Channel"].Min=1,e.point=t,t=this.applyBinaryOutputTypeOutputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]?(t["Feedback Type"].ValueOptions={None:0,Point:3,Remote:4},t.Instance.isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?(t["Feedback Type"].ValueOptions={None:0,Single:1,Point:3},t["Feedback Channel"].Max=255,t["Feedback Channel"].Min=0,t.Instance.isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"]?(t["Feedback Type"].ValueOptions={None:0,Point:3},t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["On Control Data Type"].isDisplayable=!0,t["On Control Function"].isDisplayable=!0,t["On Control Register"].isDisplayable=!0,t["On Control Value"].isDisplayable=!0,t["Off Control Data Type"].isDisplayable=!0,t["Off Control Function"].isDisplayable=!0,t["Off Control Register"].isDisplayable=!0,t["Off Control Value"].isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"]?(t["Same State Test"].isDisplayable=!0,t.Polarity.isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Latch:0,Momentary:1},t.Channel.Max=7,t.Channel.Min=0,t["On Channel"].Max=7,t["On Channel"].Min=0,t["Off Channel"].Max=7,t["Off Channel"].Min=0,t["Feedback Type"].ValueOptions={None:0,Single:1,Point:3},t["Feedback Channel"].Max=7,t["Feedback Channel"].Min=0,e.point=t,t=this.applyBinaryOutputTypeOutputType(e)):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 4 VAV"]["enum"]?(t["Feedback Type"].ValueOptions={None:0},t["VAV Channel"].isDisplayable=!0,t.Polarity.isDisplayable=!0):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["BACnet Interface Device"]["enum"]?t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet||0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:(t["Feedback Type"].ValueOptions={None:0,Point:3},t.Instance.isDisplayable=!0):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Ingersol Rand Intellysis Device"]["enum"]?t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]||0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:(t["Feedback Type"].ValueOptions={None:0,Point:3},t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["On Control Data Type"].isDisplayable=!0,t["On Control Function"].isDisplayable=!0,t["On Control Register"].isDisplayable=!0,t["On Control Value"].isDisplayable=!0,t["Off Control Data Type"].isDisplayable=!0,t["Off Control Function"].isDisplayable=!0,t["Off Control Register"].isDisplayable=!0,t["Off Control Value"].isDisplayable=!0):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan Interface Device"]["enum"]?t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]||t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]||t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]||0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:(t["Same State Test"].isDisplayable=!0,t.Polarity.isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Latch:0,Momentary:1},t.Channel.Max=7,t.Channel.Min=0,t["On Channel"].Max=7,t["On Channel"].Min=0,t["Off Channel"].Max=7,t["Off Channel"].Min=0,t["Feedback Type"].ValueOptions={None:0,Single:1,Point:3},t["Feedback Channel"].Max=7,t["Feedback Channel"].Min=0,e.point=t,t=this.applyBinaryOutputTypeOutputType(e)):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["N2 Interface Device"]["enum"]?t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]||0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:(t["Feedback Type"].ValueOptions={None:0,Single:1,Point:3},t["Feedback Channel"].Max=255,t["Feedback Channel"].Min=0,t.Instance.isDisplayable=!0):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Field Interface Device"]["enum"]?t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["IFC Remote Unit"]||0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:(t["Same State Test"].isDisplayable=!0,t["Supervised Input"].isDisplayable=!0,t.Polarity.isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Latch:0,Momentary:1},t.Channel.Max=15,t.Channel.Min=0,t["On Channel"].Max=15,t["On Channel"].Min=0,t["Off Channel"].Max=15,t["Off Channel"].Min=0,t["Feedback Type"].ValueOptions={None:0,Single:1,Point:3},t["Feedback Channel"].Max=15,t["Feedback Channel"].Min=0,e.point=t,t=this.applyBinaryOutputTypeOutputType(e)):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Staefa Interface Device"]["enum"]?t._rmuModel!==enumsTemplatesJson.Enums["Remote Unit Model Types"]["Smart II Remote Unit"]||0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:(t["Same State Test"].isDisplayable=!0,t.Polarity.isDisplayable=!0,t["Output Type"].isDisplayable=!0,t["Output Type"].ValueOptions={Latch:0,Momentary:1},t.Channel.Max=7,t.Channel.Min=0,t["On Channel"].Max=7,t["On Channel"].Min=0,t["Off Channel"].Max=7,t["Off Channel"].Min=0,t["Feedback Type"].ValueOptions={None:0,Single:1,Point:3},t["Feedback Channel"].Max=7,t["Feedback Channel"].Min=0,e.point=t,t=this.applyBinaryOutputTypeOutputType(e)):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"],e.point=t,e.point=this.applyBinaryOutputTypeFeedbackType(e),e.point},applyMultiStateValueTypeDevModel:function(e){var t=e.point;return t._relPoint=t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]?enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"]:enumsTemplatesJson.Enums.Reliabilities["No Fault"]["enum"],t._cfgRequired=!0,t.Instance.isDisplayable=!1,t["Input Type"].isDisplayable=!1,t["Control Data Type"].isDisplayable=!1,t["Control Function"].isDisplayable=!1,t["Control Register"].isDisplayable=!1,t["Poll Function"].isDisplayable=!1,t["Poll Register"].isDisplayable=!1,t["Poll Data Type"].isDisplayable=!1,t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]?(t.Instance.isDisplayable=!0,t["Input Type"].isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"]?(t["Control Data Type"].isDisplayable=!0,t["Control Function"].isDisplayable=!0,t["Control Register"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["Poll Data Type"].isDisplayable=!0):0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]?(t.Instance.isDisplayable=!0,t["Input Type"].isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"]?(t["Control Data Type"].isDisplayable=!0,t["Control Function"].isDisplayable=!0,t["Control Register"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["Poll Data Type"].isDisplayable=!0):0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]):t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Staefa Interface Device"]["enum"]?(t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Smart II Remote Unit"]["enum"]&&(t.Instance.isDisplayable=!0),0!==t["Remote Unit Point"].Value&&(t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"])):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"],t},applyAccumulatorTypeDevModel:function(e){var t=e.point;return t._relPoint=t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]?enumsTemplatesJson.Enums.Reliabilities["Invalid Device Model Type"]["enum"]:enumsTemplatesJson.Enums.Reliabilities["No Fault"]["enum"],t._cfgRequired=!0,t.Instance.isDisplayable=!1,t.Channel.isDisplayable=!1,t["Fast Pulse"].isDisplayable=!1,t["Poll Data Type"].isDisplayable=!1,t["Poll Function"].isDisplayable=!1,t["Poll Register"].isDisplayable=!1,t["Rate Period"].isDisplayable=!1,t["Pulse Weight"].isDisplayable=!1,t._devModel===enumsTemplatesJson.Enums["Device Model Types"].Unknown["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Central Device"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?0===t["Remote Unit Point"].Value?t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 5 xTalk"]["enum"]?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["SCADA Vio"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=9,t.Channel.Min=6,t["Fast Pulse"].isDisplayable=!0,t["Rate Period"].isDisplayable=!0,t["Pulse Weight"].isDisplayable=!0):(t.Channel.isDisplayable=!0,t.Channel.Max=16,t.Channel.Min=1,t["Fast Pulse"].isDisplayable=!0,t["Rate Period"].isDisplayable=!0,t["Pulse Weight"].isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?t.Instance.isDisplayable=!0:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"]?(t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["Pulse Weight"].isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0,t["Pulse Weight"].isDisplayable=!0):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 UNV"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]||t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?0===t["Remote Unit Point"].Value?t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 xTalk"]["enum"]?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan 4 Digital"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=32,t.Channel.Min=1,t["Rate Period"].isDisplayable=!0,t["Pulse Weight"].isDisplayable=!0):(t.Channel.isDisplayable=!0,t.Channel.Max=16,t.Channel.Min=1,t["Rate Period"].isDisplayable=!0,t["Pulse Weight"].isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].BACnet["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?t.Instance.isDisplayable=!0:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"].Liebert["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Siemens Power Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Ingersol Rand Intellysis"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerLogic 3000 Meter"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Generic Modbus"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["PowerTraks 9000"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Programmable Modbus"]["enum"]?(t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["Pulse Weight"].isDisplayable=!0):t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0,t["Pulse Weight"].isDisplayable=!0):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Sierra Steam Meter Device"]["enum"]?0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Sierra Steam Meter"]["enum"]?(t["Poll Data Type"].isDisplayable=!0,t["Poll Function"].isDisplayable=!0,t["Poll Register"].isDisplayable=!0,t["Pulse Weight"].isDisplayable=!0):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["MicroScan Interface Device"]["enum"]?0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS3 RT"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 EEPROM"]["enum"]||t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["MS 3 Flash"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0,t["Pulse Weight"].isDisplayable=!0):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["N2 Interface Device"]["enum"]?0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["N2 Device"]["enum"]?t.Instance.isDisplayable=!0:t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Field Interface Device"]["enum"]?0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["IFC Remote Unit"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=15,t.Channel.Min=0,t["Pulse Weight"].isDisplayable=!0):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._devModel===enumsTemplatesJson.Enums["Device Model Types"]["Staefa Interface Device"]["enum"]&&(0===t["Remote Unit Point"].Value?t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]:t._rmuModel===enumsTemplatesJson.Enums["Remote Unit Model Types"]["Smart II Remote Unit"]["enum"]?(t.Channel.isDisplayable=!0,t.Channel.Max=7,t.Channel.Min=0,t["Pulse Weight"].isDisplayable=!0):t._relPoint=enumsTemplatesJson.Enums.Reliabilities["Invalid Remote Unit Model Type"]["enum"]),e.point}},e.Templates={getTemplate:function(e){var t={},n=enumsTemplatesJson.Templates._common,i=enumsTemplatesJson.Templates.Points[e];return _.extend(t,n,i),t}},e.Applications={Navigator:{"Point Types":[]},GPL:{"Point Types":[]}},e}(Config||{});try{module.exports={logger:function(e,t){return console.log(e),t()},ValueOptionsUpdate:Config.ValueOptionsUpdate,Logger:Config.Logger,Update:Config.Update,Test:Config.Test,Get:Config.Get,Import:Config.Import,EditChanges:Config.EditChanges,EditValidation:Config.EditValidation,Enums:enumsTemplatesJson.Enums,Applications:Config.Applications,Templates:Config.Templates}}catch(e){console.log("ERR",e),$.ajax({url:"/js/lib/enumsTemplates.json",async:!1,success:function(e){enumsTemplatesJson=e,Config.Enums=enumsTemplatesJson.Enums,Config.Templates=enumsTemplatesJson.Templates}})}!function(){function e(e){var t={opts:e};t.FRAMERATE=30,t.MAX_VIRTUAL_PIXELS=3e4,t.log=function(){},1==t.opts.log&&"undefined"!=typeof console&&(t.log=function(e){console.log(e)}),t.init=function(e){var n=0;t.UniqueId=function(){return n++,"canvg"+n},t.Definitions={},t.Styles={},t.Animations=[],t.Images=[],t.ctx=e,t.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(e,t){this.viewPorts.push({width:e,height:t})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(e){return null!=e&&"number"==typeof e?e:"x"==e?this.width():"y"==e?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},t.init(),t.ImagesLoaded=function(){for(var e=0;e<t.Images.length;e++)if(!t.Images[e].loaded)return!1;return!0},t.trim=function(e){return e.replace(/^\s+|\s+$/g,"")},t.compressSpaces=function(e){return e.replace(/[\s\r\t\n]+/gm," ")},t.ajax=function(e){var t;return t=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),t?(t.open("GET",e,!1),t.send(null),t.responseText):null},t.parseXml=function(e){if(window.DOMParser){var t=new DOMParser;return t.parseFromString(e,"text/xml")}e=e.replace(/<!DOCTYPE svg[^>]*>/,"");var n=new ActiveXObject("Microsoft.XMLDOM");return n.async="false",n.loadXML(e),n},t.Property=function(e,t){this.name=e,this.value=t},t.Property.prototype.getValue=function(){return this.value},t.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},t.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var e=parseFloat(this.value);return(this.value+"").match(/%$/)&&(e/=100),e},t.Property.prototype.valueOrDefault=function(e){return this.hasValue()?this.value:e},t.Property.prototype.numValueOrDefault=function(e){return this.hasValue()?this.numValue():e},t.Property.prototype.addOpacity=function(e){var n=this.value;if(null!=e&&""!=e&&"string"==typeof this.value){var i=new RGBColor(this.value);i.ok&&(n="rgba("+i.r+", "+i.g+", "+i.b+", "+e+")")}return new t.Property(this.name,n)},t.Property.prototype.getDefinition=function(){var e=this.value.match(/#([^\)'"]+)/);return e&&(e=e[1]),e||(e=this.value),t.Definitions[e]},t.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},t.Property.prototype.getFillStyleDefinition=function(e,n){var i=this.getDefinition();if(null!=i&&i.createGradient)return i.createGradient(t.ctx,e,n);if(null!=i&&i.createPattern){if(i.getHrefAttribute().hasValue()){var o=i.attribute("patternTransform");i=i.getHrefAttribute().getDefinition(),o.hasValue()&&(i.attribute("patternTransform",!0).value=o.value)}return i.createPattern(t.ctx,e)}return null
},t.Property.prototype.getDPI=function(){return 96},t.Property.prototype.getEM=function(e){var n=12,i=new t.Property("fontSize",t.Font.Parse(t.ctx.font).fontSize);return i.hasValue()&&(n=i.toPixels(e)),n},t.Property.prototype.getUnits=function(){var e=this.value+"";return e.replace(/[0-9\.\-]/g,"")},t.Property.prototype.toPixels=function(e,n){if(!this.hasValue())return 0;var i=this.value+"";if(i.match(/em$/))return this.numValue()*this.getEM(e);if(i.match(/ex$/))return this.numValue()*this.getEM(e)/2;if(i.match(/px$/))return this.numValue();if(i.match(/pt$/))return this.numValue()*this.getDPI(e)*(1/72);if(i.match(/pc$/))return 15*this.numValue();if(i.match(/cm$/))return this.numValue()*this.getDPI(e)/2.54;if(i.match(/mm$/))return this.numValue()*this.getDPI(e)/25.4;if(i.match(/in$/))return this.numValue()*this.getDPI(e);if(i.match(/%$/))return this.numValue()*t.ViewPort.ComputeSize(e);var o=this.numValue();return n&&1>o?o*t.ViewPort.ComputeSize(e):o},t.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/s$/)?1e3*this.numValue():e.match(/ms$/)?this.numValue():this.numValue()},t.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var e=this.value+"";return e.match(/deg$/)?this.numValue()*(Math.PI/180):e.match(/grad$/)?this.numValue()*(Math.PI/200):e.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var n={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return t.Property.prototype.toTextBaseline=function(){return this.hasValue()?n[this.value]:null},t.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(e,n,i,o,s,a){var r=null!=a?this.Parse(a):this.CreateFont("","","","","",t.ctx.font);return{fontFamily:s||r.fontFamily,fontSize:o||r.fontSize,fontStyle:e||r.fontStyle,fontWeight:i||r.fontWeight,fontVariant:n||r.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var e=this;this.Parse=function(n){for(var i={},o=t.trim(t.compressSpaces(n||"")).split(" "),s={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},a="",r=0;r<o.length;r++)s.fontStyle||-1==e.Styles.indexOf(o[r])?s.fontVariant||-1==e.Variants.indexOf(o[r])?s.fontWeight||-1==e.Weights.indexOf(o[r])?s.fontSize?"inherit"!=o[r]&&(a+=o[r]):("inherit"!=o[r]&&(i.fontSize=o[r].split("/")[0]),s.fontStyle=s.fontVariant=s.fontWeight=s.fontSize=!0):("inherit"!=o[r]&&(i.fontWeight=o[r]),s.fontStyle=s.fontVariant=s.fontWeight=!0):("inherit"!=o[r]&&(i.fontVariant=o[r]),s.fontStyle=s.fontVariant=!0):("inherit"!=o[r]&&(i.fontStyle=o[r]),s.fontStyle=!0);return""!=a&&(i.fontFamily=a),i}},t.ToNumberArray=function(e){for(var n=t.trim(t.compressSpaces((e||"").replace(/,/g," "))).split(" "),i=0;i<n.length;i++)n[i]=parseFloat(n[i]);return n},t.Point=function(e,t){this.x=e,this.y=t},t.Point.prototype.angleTo=function(e){return Math.atan2(e.y-this.y,e.x-this.x)},t.Point.prototype.applyTransform=function(e){var t=this.x*e[0]+this.y*e[2]+e[4],n=this.x*e[1]+this.y*e[3]+e[5];this.x=t,this.y=n},t.CreatePoint=function(e){var n=t.ToNumberArray(e);return new t.Point(n[0],n[1])},t.CreatePath=function(e){for(var n=t.ToNumberArray(e),i=[],o=0;o<n.length;o+=2)i.push(new t.Point(n[o],n[o+1]));return i},t.BoundingBox=function(e,t,n,o){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,this.x=function(){return this.x1},this.y=function(){return this.y1},this.width=function(){return this.x2-this.x1},this.height=function(){return this.y2-this.y1},this.addPoint=function(e,t){null!=e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),null!=t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},this.addX=function(e){this.addPoint(e,null)},this.addY=function(e){this.addPoint(null,e)},this.addBoundingBox=function(e){this.addPoint(e.x1,e.y1),this.addPoint(e.x2,e.y2)},this.addQuadraticCurve=function(e,t,n,i,o,s){var a=e+2/3*(n-e),r=t+2/3*(i-t),l=a+1/3*(o-e),u=r+1/3*(s-t);this.addBezierCurve(e,t,a,l,r,u,o,s)},this.addBezierCurve=function(e,t,n,o,s,a,r,l){var u=[e,t],d=[n,o],c=[s,a],p=[r,l];for(this.addPoint(u[0],u[1]),this.addPoint(p[0],p[1]),i=0;1>=i;i++){var h=function(e){return Math.pow(1-e,3)*u[i]+3*Math.pow(1-e,2)*e*d[i]+3*(1-e)*Math.pow(e,2)*c[i]+Math.pow(e,3)*p[i]},m=6*u[i]-12*d[i]+6*c[i],y=-3*u[i]+9*d[i]-9*c[i]+3*p[i],f=3*d[i]-3*u[i];if(0!=y){var g=Math.pow(m,2)-4*f*y;if(!(0>g)){var P=(-m+Math.sqrt(g))/(2*y);P>0&&1>P&&(0==i&&this.addX(h(P)),1==i&&this.addY(h(P)));var v=(-m-Math.sqrt(g))/(2*y);v>0&&1>v&&(0==i&&this.addX(h(v)),1==i&&this.addY(h(v)))}}else{if(0==m)continue;var w=-f/m;w>0&&1>w&&(0==i&&this.addX(h(w)),1==i&&this.addY(h(w)))}}},this.isPointInBox=function(e,t){return this.x1<=e&&e<=this.x2&&this.y1<=t&&t<=this.y2},this.addPoint(e,t),this.addPoint(n,o)},t.Transform=function(e){var n=this;this.Type={},this.Type.translate=function(e){this.p=t.CreatePoint(e),this.apply=function(e){e.translate(this.p.x||0,this.p.y||0)},this.unapply=function(e){e.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(e){e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(e){var n=t.ToNumberArray(e);this.angle=new t.Property("angle",n[0]),this.cx=n[1]||0,this.cy=n[2]||0,this.apply=function(e){e.translate(this.cx,this.cy),e.rotate(this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.unapply=function(e){e.translate(this.cx,this.cy),e.rotate(-1*this.angle.toRadians()),e.translate(-this.cx,-this.cy)},this.applyToPoint=function(e){var t=this.angle.toRadians();e.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),e.applyTransform([Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0]),e.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(e){this.p=t.CreatePoint(e),this.apply=function(e){e.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(e){e.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(e){e.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(e){this.m=t.ToNumberArray(e),this.apply=function(e){e.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.applyToPoint=function(e){e.applyTransform(this.m)}},this.Type.SkewBase=function(e){this.base=n.Type.matrix,this.base(e),this.angle=new t.Property("angle",e)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(e){this.base=n.Type.SkewBase,this.base(e),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(e){this.base=n.Type.SkewBase,this.base(e),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].apply(e)},this.unapply=function(e){for(var t=this.transforms.length-1;t>=0;t--)this.transforms[t].unapply(e)},this.applyToPoint=function(e){for(var t=0;t<this.transforms.length;t++)this.transforms[t].applyToPoint(e)};for(var i=t.trim(t.compressSpaces(e)).replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),o=0;o<i.length;o++){var s=t.trim(i[o].split("(")[0]),a=i[o].split("(")[1].replace(")",""),r=new this.Type[s](a);r.type=s,this.transforms.push(r)}},t.AspectRatio=function(e,n,i,o,s,a,r,l,u,d){n=t.compressSpaces(n),n=n.replace(/^defer\s/,"");var c=n.split(" ")[0]||"xMidYMid",p=n.split(" ")[1]||"meet",h=i/o,m=s/a,y=Math.min(h,m),f=Math.max(h,m);"meet"==p&&(o*=y,a*=y),"slice"==p&&(o*=f,a*=f),u=new t.Property("refX",u),d=new t.Property("refY",d),u.hasValue()&&d.hasValue()?e.translate(-y*u.toPixels("x"),-y*d.toPixels("y")):(c.match(/^xMid/)&&("meet"==p&&y==m||"slice"==p&&f==m)&&e.translate(i/2-o/2,0),c.match(/YMid$/)&&("meet"==p&&y==h||"slice"==p&&f==h)&&e.translate(0,s/2-a/2),c.match(/^xMax/)&&("meet"==p&&y==m||"slice"==p&&f==m)&&e.translate(i-o,0),c.match(/YMax$/)&&("meet"==p&&y==h||"slice"==p&&f==h)&&e.translate(0,s-a)),"none"==c?e.scale(h,m):"meet"==p?e.scale(y,y):"slice"==p&&e.scale(f,f),e.translate(null==r?0:-r,null==l?0:-l)},t.Element={},t.EmptyProperty=new t.Property("EMPTY",""),t.Element.ElementBase=function(e){if(this.attributes={},this.styles={},this.children=[],this.attribute=function(e,n){var i=this.attributes[e];return null!=i?i:(1==n&&(i=new t.Property(e,""),this.attributes[e]=i),i||t.EmptyProperty)},this.getHrefAttribute=function(){for(var e in this.attributes)if(e.match(/:href$/))return this.attributes[e];return t.EmptyProperty},this.style=function(e,n){var i=this.styles[e];if(null!=i)return i;var o=this.attribute(e);if(null!=o&&o.hasValue())return this.styles[e]=o,o;var s=this.parent;if(null!=s){var a=s.style(e);if(null!=a&&a.hasValue())return a}return 1==n&&(i=new t.Property(e,""),this.styles[e]=i),i||t.EmptyProperty},this.render=function(e){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(e.save(),this.attribute("mask").hasValue()){var t=this.attribute("mask").getDefinition();null!=t&&t.apply(e,this)}else if(this.style("filter").hasValue()){var n=this.style("filter").getDefinition();null!=n&&n.apply(e,this)}else this.setContext(e),this.renderChildren(e),this.clearContext(e);e.restore()}},this.setContext=function(){},this.clearContext=function(){},this.renderChildren=function(e){for(var t=0;t<this.children.length;t++)this.children[t].render(e)},this.addChild=function(e,n){var i=e;n&&(i=t.CreateElement(e)),i.parent=this,this.children.push(i)},null!=e&&1==e.nodeType){for(var n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(1==i.nodeType&&this.addChild(i,!0),this.captureTextNodes&&3==i.nodeType){var o=i.nodeValue||i.text||"";""!=t.trim(t.compressSpaces(o))&&this.addChild(new t.Element.tspan(i),!1)}}for(var n=0;n<e.attributes.length;n++){var s=e.attributes[n];this.attributes[s.nodeName]=new t.Property(s.nodeName,s.nodeValue)}var a=t.Styles[e.nodeName];if(null!=a)for(var r in a)this.styles[r]=a[r];if(this.attribute("class").hasValue())for(var l=t.compressSpaces(this.attribute("class").value).split(" "),u=0;u<l.length;u++){if(a=t.Styles["."+l[u]],null!=a)for(var r in a)this.styles[r]=a[r];if(a=t.Styles[e.nodeName+"."+l[u]],null!=a)for(var r in a)this.styles[r]=a[r]}if(this.attribute("id").hasValue()){var a=t.Styles["#"+this.attribute("id").value];if(null!=a)for(var r in a)this.styles[r]=a[r]}if(this.attribute("style").hasValue())for(var a=this.attribute("style").value.split(";"),n=0;n<a.length;n++)if(""!=t.trim(a[n])){var d=a[n].split(":"),r=t.trim(d[0]),c=t.trim(d[1]);this.styles[r]=new t.Property(r,c)}this.attribute("id").hasValue()&&null==t.Definitions[this.attribute("id").value]&&(t.Definitions[this.attribute("id").value]=this)}},t.Element.RenderedElementBase=function(e){this.base=t.Element.ElementBase,this.base(e),this.setContext=function(e){if(this.style("fill").isUrlDefinition()){var n=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=n&&(e.fillStyle=n)}else if(this.style("fill").hasValue()){var i=this.style("fill");"currentColor"==i.value&&(i.value=this.style("color").value),e.fillStyle="none"==i.value?"rgba(0,0,0,0)":i.value}if(this.style("fill-opacity").hasValue()){var i=new t.Property("fill",e.fillStyle);i=i.addOpacity(this.style("fill-opacity").value),e.fillStyle=i.value}if(this.style("stroke").isUrlDefinition()){var n=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=n&&(e.strokeStyle=n)}else if(this.style("stroke").hasValue()){var o=this.style("stroke");"currentColor"==o.value&&(o.value=this.style("color").value),e.strokeStyle="none"==o.value?"rgba(0,0,0,0)":o.value}if(this.style("stroke-opacity").hasValue()){var o=new t.Property("stroke",e.strokeStyle);o=o.addOpacity(this.style("stroke-opacity").value),e.strokeStyle=o.value}if(this.style("stroke-width").hasValue()){var s=this.style("stroke-width").toPixels();e.lineWidth=0==s?.001:s}if(this.style("stroke-linecap").hasValue()&&(e.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(e.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(e.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var a=t.ToNumberArray(this.style("stroke-dasharray").value);"undefined"!=typeof e.setLineDash?e.setLineDash(a):"undefined"!=typeof e.webkitLineDash?e.webkitLineDash=a:"undefined"!=typeof e.mozDash&&(e.mozDash=a);var r=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof e.lineDashOffset?e.lineDashOffset=r:"undefined"!=typeof e.webkitLineDashOffset?e.webkitLineDashOffset=r:"undefined"!=typeof e.mozDashOffset&&(e.mozDashOffset=r)}if("undefined"!=typeof e.font&&(e.font=t.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue()){var l=new t.Transform(this.attribute("transform").value);l.apply(e)}if(this.style("clip-path").hasValue()){var u=this.style("clip-path").getDefinition();null!=u&&u.apply(e)}this.style("opacity").hasValue()&&(e.globalAlpha=this.style("opacity").numValue())}},t.Element.RenderedElementBase.prototype=new t.Element.ElementBase,t.Element.PathElementBase=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.path=function(e){return null!=e&&e.beginPath(),new t.BoundingBox},this.renderChildren=function(e){this.path(e),t.Mouse.checkPath(this,e),""!=e.fillStyle&&("inherit"!=this.attribute("fill-rule").valueOrDefault("inherit")?e.fill(this.attribute("fill-rule").value):e.fill()),""!=e.strokeStyle&&e.stroke();var n=this.getMarkers();if(null!=n){if(this.style("marker-start").isUrlDefinition()){var i=this.style("marker-start").getDefinition();i.render(e,n[0][0],n[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var i=this.style("marker-mid").getDefinition(),o=1;o<n.length-1;o++)i.render(e,n[o][0],n[o][1]);if(this.style("marker-end").isUrlDefinition()){var i=this.style("marker-end").getDefinition();i.render(e,n[n.length-1][0],n[n.length-1][1])}}},this.getBoundingBox=function(){return this.path()},this.getMarkers=function(){return null}},t.Element.PathElementBase.prototype=new t.Element.RenderedElementBase,t.Element.svg=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.baseClearContext=this.clearContext,this.clearContext=function(e){this.baseClearContext(e),t.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(e){e.strokeStyle="rgba(0,0,0,0)",e.lineCap="butt",e.lineJoin="miter",e.miterLimit=4,"undefined"!=typeof e.font&&"undefined"!=typeof window.getComputedStyle&&(e.font=window.getComputedStyle(e.canvas).getPropertyValue("font")),this.baseSetContext(e),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),e.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var n=t.ViewPort.width(),i=t.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){n=this.attribute("width").toPixels("x"),i=this.attribute("height").toPixels("y");var o=0,s=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(o=-this.attribute("refX").toPixels("x"),s=-this.attribute("refY").toPixels("y")),"visible"!=this.attribute("overflow").valueOrDefault("hidden")&&(e.beginPath(),e.moveTo(o,s),e.lineTo(n,s),e.lineTo(n,i),e.lineTo(o,i),e.closePath(),e.clip())}if(t.ViewPort.SetCurrent(n,i),this.attribute("viewBox").hasValue()){var a=t.ToNumberArray(this.attribute("viewBox").value),r=a[0],l=a[1];n=a[2],i=a[3],t.AspectRatio(e,this.attribute("preserveAspectRatio").value,t.ViewPort.width(),n,t.ViewPort.height(),i,r,l,this.attribute("refX").value,this.attribute("refY").value),t.ViewPort.RemoveCurrent(),t.ViewPort.SetCurrent(a[2],a[3])}}},t.Element.svg.prototype=new t.Element.RenderedElementBase,t.Element.rect=function(e){this.base=t.Element.PathElementBase,this.base(e),this.path=function(e){var n=this.attribute("x").toPixels("x"),i=this.attribute("y").toPixels("y"),o=this.attribute("width").toPixels("x"),s=this.attribute("height").toPixels("y"),a=this.attribute("rx").toPixels("x"),r=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(r=a),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(a=r),a=Math.min(a,o/2),r=Math.min(r,s/2),null!=e&&(e.beginPath(),e.moveTo(n+a,i),e.lineTo(n+o-a,i),e.quadraticCurveTo(n+o,i,n+o,i+r),e.lineTo(n+o,i+s-r),e.quadraticCurveTo(n+o,i+s,n+o-a,i+s),e.lineTo(n+a,i+s),e.quadraticCurveTo(n,i+s,n,i+s-r),e.lineTo(n,i+r),e.quadraticCurveTo(n,i,n+a,i),e.closePath()),new t.BoundingBox(n,i,n+o,i+s)}},t.Element.rect.prototype=new t.Element.PathElementBase,t.Element.circle=function(e){this.base=t.Element.PathElementBase,this.base(e),this.path=function(e){var n=this.attribute("cx").toPixels("x"),i=this.attribute("cy").toPixels("y"),o=this.attribute("r").toPixels();return null!=e&&(e.beginPath(),e.arc(n,i,o,0,2*Math.PI,!0),e.closePath()),new t.BoundingBox(n-o,i-o,n+o,i+o)}},t.Element.circle.prototype=new t.Element.PathElementBase,t.Element.ellipse=function(e){this.base=t.Element.PathElementBase,this.base(e),this.path=function(e){var n=4*((Math.sqrt(2)-1)/3),i=this.attribute("rx").toPixels("x"),o=this.attribute("ry").toPixels("y"),s=this.attribute("cx").toPixels("x"),a=this.attribute("cy").toPixels("y");return null!=e&&(e.beginPath(),e.moveTo(s,a-o),e.bezierCurveTo(s+n*i,a-o,s+i,a-n*o,s+i,a),e.bezierCurveTo(s+i,a+n*o,s+n*i,a+o,s,a+o),e.bezierCurveTo(s-n*i,a+o,s-i,a+n*o,s-i,a),e.bezierCurveTo(s-i,a-n*o,s-n*i,a-o,s,a-o),e.closePath()),new t.BoundingBox(s-i,a-o,s+i,a+o)}},t.Element.ellipse.prototype=new t.Element.PathElementBase,t.Element.line=function(e){this.base=t.Element.PathElementBase,this.base(e),this.getPoints=function(){return[new t.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new t.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(e){var n=this.getPoints();return null!=e&&(e.beginPath(),e.moveTo(n[0].x,n[0].y),e.lineTo(n[1].x,n[1].y)),new t.BoundingBox(n[0].x,n[0].y,n[1].x,n[1].y)},this.getMarkers=function(){var e=this.getPoints(),t=e[0].angleTo(e[1]);return[[e[0],t],[e[1],t]]}},t.Element.line.prototype=new t.Element.PathElementBase,t.Element.polyline=function(e){this.base=t.Element.PathElementBase,this.base(e),this.points=t.CreatePath(this.attribute("points").value),this.path=function(e){var n=new t.BoundingBox(this.points[0].x,this.points[0].y);null!=e&&(e.beginPath(),e.moveTo(this.points[0].x,this.points[0].y));for(var i=1;i<this.points.length;i++)n.addPoint(this.points[i].x,this.points[i].y),null!=e&&e.lineTo(this.points[i].x,this.points[i].y);return n},this.getMarkers=function(){for(var e=[],t=0;t<this.points.length-1;t++)e.push([this.points[t],this.points[t].angleTo(this.points[t+1])]);return e.push([this.points[this.points.length-1],e[e.length-1][1]]),e}},t.Element.polyline.prototype=new t.Element.PathElementBase,t.Element.polygon=function(e){this.base=t.Element.polyline,this.base(e),this.basePath=this.path,this.path=function(e){var t=this.basePath(e);return null!=e&&(e.lineTo(this.points[0].x,this.points[0].y),e.closePath()),t}},t.Element.polygon.prototype=new t.Element.polyline,t.Element.path=function(e){this.base=t.Element.PathElementBase,this.base(e);var n=this.attribute("d").value;n=n.replace(/,/gm," "),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2"),n=n.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),n=n.replace(/([0-9])([+\-])/gm,"$1 $2"),n=n.replace(/(\.[0-9]*)(\.)/gm,"$1 $2"),n=n.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),n=t.compressSpaces(n),n=t.trim(n),this.PathParser=new function(e){this.tokens=e.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new t.Point(0,0),this.control=new t.Point(0,0),this.current=new t.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var e=new t.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(e)},this.getAsControlPoint=function(){var e=this.getPoint();return this.control=e,e},this.getAsCurrentPoint=function(){var e=this.getPoint();return this.current=e,e},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var e=new t.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return e},this.makeAbsolute=function(e){return this.isRelativeCommand()&&(e.x+=this.current.x,e.y+=this.current.y),e},this.addMarker=function(e,t,n){null!=n&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(n)),this.addMarkerAngle(e,null==t?null:t.angleTo(e))},this.addMarkerAngle=function(e,t){this.points.push(e),this.angles.push(t)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var e=0;e<this.angles.length;e++)if(null==this.angles[e])for(var t=e+1;t<this.angles.length;t++)if(null!=this.angles[t]){this.angles[e]=this.angles[t];break}return this.angles}}(n),this.path=function(e){var n=this.PathParser;n.reset();var i=new t.BoundingBox;for(null!=e&&e.beginPath();!n.isEnd();)switch(n.nextCommand(),n.command){case"M":case"m":var o=n.getAsCurrentPoint();for(n.addMarker(o),i.addPoint(o.x,o.y),null!=e&&e.moveTo(o.x,o.y),n.start=n.current;!n.isCommandOrEnd();){var o=n.getAsCurrentPoint();n.addMarker(o,n.start),i.addPoint(o.x,o.y),null!=e&&e.lineTo(o.x,o.y)}break;case"L":case"l":for(;!n.isCommandOrEnd();){var s=n.current,o=n.getAsCurrentPoint();n.addMarker(o,s),i.addPoint(o.x,o.y),null!=e&&e.lineTo(o.x,o.y)}break;case"H":case"h":for(;!n.isCommandOrEnd();){var a=new t.Point((n.isRelativeCommand()?n.current.x:0)+n.getScalar(),n.current.y);n.addMarker(a,n.current),n.current=a,i.addPoint(n.current.x,n.current.y),null!=e&&e.lineTo(n.current.x,n.current.y)}break;case"V":case"v":for(;!n.isCommandOrEnd();){var a=new t.Point(n.current.x,(n.isRelativeCommand()?n.current.y:0)+n.getScalar());n.addMarker(a,n.current),n.current=a,i.addPoint(n.current.x,n.current.y),null!=e&&e.lineTo(n.current.x,n.current.y)}break;case"C":case"c":for(;!n.isCommandOrEnd();){var r=n.current,l=n.getPoint(),u=n.getAsControlPoint(),d=n.getAsCurrentPoint();n.addMarker(d,u,l),i.addBezierCurve(r.x,r.y,l.x,l.y,u.x,u.y,d.x,d.y),null!=e&&e.bezierCurveTo(l.x,l.y,u.x,u.y,d.x,d.y)}break;case"S":case"s":for(;!n.isCommandOrEnd();){var r=n.current,l=n.getReflectedControlPoint(),u=n.getAsControlPoint(),d=n.getAsCurrentPoint();n.addMarker(d,u,l),i.addBezierCurve(r.x,r.y,l.x,l.y,u.x,u.y,d.x,d.y),null!=e&&e.bezierCurveTo(l.x,l.y,u.x,u.y,d.x,d.y)}break;case"Q":case"q":for(;!n.isCommandOrEnd();){var r=n.current,u=n.getAsControlPoint(),d=n.getAsCurrentPoint();n.addMarker(d,u,u),i.addQuadraticCurve(r.x,r.y,u.x,u.y,d.x,d.y),null!=e&&e.quadraticCurveTo(u.x,u.y,d.x,d.y)}break;case"T":case"t":for(;!n.isCommandOrEnd();){var r=n.current,u=n.getReflectedControlPoint();n.control=u;var d=n.getAsCurrentPoint();n.addMarker(d,u,u),i.addQuadraticCurve(r.x,r.y,u.x,u.y,d.x,d.y),null!=e&&e.quadraticCurveTo(u.x,u.y,d.x,d.y)}break;case"A":case"a":for(;!n.isCommandOrEnd();){var r=n.current,c=n.getScalar(),p=n.getScalar(),h=n.getScalar()*(Math.PI/180),m=n.getScalar(),y=n.getScalar(),d=n.getAsCurrentPoint(),f=new t.Point(Math.cos(h)*(r.x-d.x)/2+Math.sin(h)*(r.y-d.y)/2,-Math.sin(h)*(r.x-d.x)/2+Math.cos(h)*(r.y-d.y)/2),g=Math.pow(f.x,2)/Math.pow(c,2)+Math.pow(f.y,2)/Math.pow(p,2);g>1&&(c*=Math.sqrt(g),p*=Math.sqrt(g));var P=(m==y?-1:1)*Math.sqrt((Math.pow(c,2)*Math.pow(p,2)-Math.pow(c,2)*Math.pow(f.y,2)-Math.pow(p,2)*Math.pow(f.x,2))/(Math.pow(c,2)*Math.pow(f.y,2)+Math.pow(p,2)*Math.pow(f.x,2)));isNaN(P)&&(P=0);var v=new t.Point(P*c*f.y/p,P*-p*f.x/c),w=new t.Point((r.x+d.x)/2+Math.cos(h)*v.x-Math.sin(h)*v.y,(r.y+d.y)/2+Math.sin(h)*v.x+Math.cos(h)*v.y),b=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2))},T=function(e,t){return(e[0]*t[0]+e[1]*t[1])/(b(e)*b(t))},M=function(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(T(e,t))},C=M([1,0],[(f.x-v.x)/c,(f.y-v.y)/p]),x=[(f.x-v.x)/c,(f.y-v.y)/p],D=[(-f.x-v.x)/c,(-f.y-v.y)/p],E=M(x,D);T(x,D)<=-1&&(E=Math.PI),T(x,D)>=1&&(E=0);var S=1-y?1:-1,V=C+S*(E/2),k=new t.Point(w.x+c*Math.cos(V),w.y+p*Math.sin(V));if(n.addMarkerAngle(k,V-S*Math.PI/2),n.addMarkerAngle(d,V-S*Math.PI),i.addPoint(d.x,d.y),null!=e){var T=c>p?c:p,R=c>p?1:c/p,A=c>p?p/c:1;e.translate(w.x,w.y),e.rotate(h),e.scale(R,A),e.arc(0,0,T,C,C+E,1-y),e.scale(1/R,1/A),e.rotate(-h),e.translate(-w.x,-w.y)}}break;case"Z":case"z":null!=e&&e.closePath(),n.current=n.start}return i},this.getMarkers=function(){for(var e=this.PathParser.getMarkerPoints(),t=this.PathParser.getMarkerAngles(),n=[],i=0;i<e.length;i++)n.push([e[i],t[i]]);return n}},t.Element.path.prototype=new t.Element.PathElementBase,t.Element.pattern=function(e){this.base=t.Element.ElementBase,this.base(e),this.createPattern=function(e){var n=this.attribute("width").toPixels("x",!0),i=this.attribute("height").toPixels("y",!0),o=new t.Element.svg;o.attributes.viewBox=new t.Property("viewBox",this.attribute("viewBox").value),o.attributes.width=new t.Property("width",n+"px"),o.attributes.height=new t.Property("height",i+"px"),o.attributes.transform=new t.Property("transform",this.attribute("patternTransform").value),o.children=this.children;var s=document.createElement("canvas");s.width=n,s.height=i;var a=s.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&a.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var r=-1;1>=r;r++)for(var l=-1;1>=l;l++)a.save(),a.translate(r*s.width,l*s.height),o.render(a),a.restore();var u=e.createPattern(s,"repeat");return u}},t.Element.pattern.prototype=new t.Element.ElementBase,t.Element.marker=function(e){this.base=t.Element.ElementBase,this.base(e),this.baseRender=this.render,this.render=function(e,n,i){e.translate(n.x,n.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&e.rotate(i),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&e.scale(e.lineWidth,e.lineWidth),e.save();var o=new t.Element.svg;o.attributes.viewBox=new t.Property("viewBox",this.attribute("viewBox").value),o.attributes.refX=new t.Property("refX",this.attribute("refX").value),o.attributes.refY=new t.Property("refY",this.attribute("refY").value),o.attributes.width=new t.Property("width",this.attribute("markerWidth").value),o.attributes.height=new t.Property("height",this.attribute("markerHeight").value),o.attributes.fill=new t.Property("fill",this.attribute("fill").valueOrDefault("black")),o.attributes.stroke=new t.Property("stroke",this.attribute("stroke").valueOrDefault("none")),o.children=this.children,o.render(e),e.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&e.scale(1/e.lineWidth,1/e.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&e.rotate(-i),e.translate(-n.x,-n.y)}},t.Element.marker.prototype=new t.Element.ElementBase,t.Element.defs=function(e){this.base=t.Element.ElementBase,this.base(e),this.render=function(){}},t.Element.defs.prototype=new t.Element.ElementBase,t.Element.GradientBase=function(e){this.base=t.Element.ElementBase,this.base(e),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var n=0;n<this.children.length;n++){var i=this.children[n];"stop"==i.type&&this.stops.push(i)}this.getGradient=function(){},this.createGradient=function(e,n,i){var o=this;this.getHrefAttribute().hasValue()&&(o=this.getHrefAttribute().getDefinition());var s=function(e){if(i.hasValue()){var n=new t.Property("color",e);return n.addOpacity(i.value).value}return e},a=this.getGradient(e,n);if(null==a)return s(o.stops[o.stops.length-1].color);for(var r=0;r<o.stops.length;r++)a.addColorStop(o.stops[r].offset,s(o.stops[r].color));if(this.attribute("gradientTransform").hasValue()){var l=t.ViewPort.viewPorts[0],u=new t.Element.rect;u.attributes.x=new t.Property("x",-t.MAX_VIRTUAL_PIXELS/3),u.attributes.y=new t.Property("y",-t.MAX_VIRTUAL_PIXELS/3),u.attributes.width=new t.Property("width",t.MAX_VIRTUAL_PIXELS),u.attributes.height=new t.Property("height",t.MAX_VIRTUAL_PIXELS);var d=new t.Element.g;d.attributes.transform=new t.Property("transform",this.attribute("gradientTransform").value),d.children=[u];var c=new t.Element.svg;c.attributes.x=new t.Property("x",0),c.attributes.y=new t.Property("y",0),c.attributes.width=new t.Property("width",l.width),c.attributes.height=new t.Property("height",l.height),c.children=[d];var p=document.createElement("canvas");p.width=l.width,p.height=l.height;var h=p.getContext("2d");return h.fillStyle=a,c.render(h),h.createPattern(p,"no-repeat")}return a}},t.Element.GradientBase.prototype=new t.Element.ElementBase,t.Element.linearGradient=function(e){this.base=t.Element.GradientBase,this.base(e),this.getGradient=function(e,t){var n="objectBoundingBox"==this.gradientUnits?t.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var i="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),o="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),s="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),a="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return i==s&&o==a?null:e.createLinearGradient(i,o,s,a)}},t.Element.linearGradient.prototype=new t.Element.GradientBase,t.Element.radialGradient=function(e){this.base=t.Element.GradientBase,this.base(e),this.getGradient=function(e,t){var n=t.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var i="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),o="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),s=i,a=o;
this.attribute("fx").hasValue()&&(s="objectBoundingBox"==this.gradientUnits?n.x()+n.width()*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(a="objectBoundingBox"==this.gradientUnits?n.y()+n.height()*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var r="objectBoundingBox"==this.gradientUnits?(n.width()+n.height())/2*this.attribute("r").numValue():this.attribute("r").toPixels();return e.createRadialGradient(s,a,0,i,o,r)}},t.Element.radialGradient.prototype=new t.Element.GradientBase,t.Element.stop=function(e){this.base=t.Element.ElementBase,this.base(e),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var n=this.style("stop-color");this.style("stop-opacity").hasValue()&&(n=n.addOpacity(this.style("stop-opacity").value)),this.color=n.value},t.Element.stop.prototype=new t.Element.ElementBase,t.Element.AnimateBase=function(e){this.base=t.Element.ElementBase,this.base(e),t.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var e=this.attribute("attributeType").value,t=this.attribute("attributeName").value;return"CSS"==e?this.parent.style(t,!0):this.parent.attribute(t,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(e){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"!=this.attribute("repeatCount").value&&"indefinite"!=this.attribute("repeatDur").value)return"remove"!=this.attribute("fill").valueOrDefault("remove")||this.removed?!1:(this.removed=!0,this.getProperty().value=this.initialValue,!0);this.duration=0}this.duration=this.duration+e;var t=!1;if(this.begin<this.duration){var n=this.calcValue();if(this.attribute("type").hasValue()){var i=this.attribute("type").value;n=i+"("+n+")"}this.getProperty().value=n,t=!0}return t},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var e={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var n=e.progress*(this.values.value.length-1),i=Math.floor(n),o=Math.ceil(n);e.from=new t.Property("from",parseFloat(this.values.value[i])),e.to=new t.Property("to",parseFloat(this.values.value[o])),e.progress=(n-i)/(o-i)}else e.from=this.from,e.to=this.to;return e}},t.Element.AnimateBase.prototype=new t.Element.ElementBase,t.Element.animate=function(e){this.base=t.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),t=e.from.numValue()+(e.to.numValue()-e.from.numValue())*e.progress;return t+this.initialUnits}},t.Element.animate.prototype=new t.Element.AnimateBase,t.Element.animateColor=function(e){this.base=t.Element.AnimateBase,this.base(e),this.calcValue=function(){var e=this.progress(),t=new RGBColor(e.from.value),n=new RGBColor(e.to.value);if(t.ok&&n.ok){var i=t.r+(n.r-t.r)*e.progress,o=t.g+(n.g-t.g)*e.progress,s=t.b+(n.b-t.b)*e.progress;return"rgb("+parseInt(i,10)+","+parseInt(o,10)+","+parseInt(s,10)+")"}return this.attribute("from").value}},t.Element.animateColor.prototype=new t.Element.AnimateBase,t.Element.animateTransform=function(e){this.base=t.Element.AnimateBase,this.base(e),this.calcValue=function(){for(var e=this.progress(),n=t.ToNumberArray(e.from.value),i=t.ToNumberArray(e.to.value),o="",s=0;s<n.length;s++)o+=n[s]+(i[s]-n[s])*e.progress+" ";return o}},t.Element.animateTransform.prototype=new t.Element.animate,t.Element.font=function(e){this.base=t.Element.ElementBase,this.base(e),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var n=0;n<this.children.length;n++){var i=this.children[n];"font-face"==i.type?(this.fontFace=i,i.style("font-family").hasValue()&&(t.Definitions[i.style("font-family").value]=this)):"missing-glyph"==i.type?this.missingGlyph=i:"glyph"==i.type&&(""!=i.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[i.unicode]&&(this.glyphs[i.unicode]=[]),this.glyphs[i.unicode][i.arabicForm]=i):this.glyphs[i.unicode]=i)}},t.Element.font.prototype=new t.Element.ElementBase,t.Element.fontface=function(e){this.base=t.Element.ElementBase,this.base(e),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},t.Element.fontface.prototype=new t.Element.ElementBase,t.Element.missingglyph=function(e){this.base=t.Element.path,this.base(e),this.horizAdvX=0},t.Element.missingglyph.prototype=new t.Element.path,t.Element.glyph=function(e){this.base=t.Element.path,this.base(e),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},t.Element.glyph.prototype=new t.Element.path,t.Element.text=function(e){this.captureTextNodes=!0,this.base=t.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e);var t=this.style("dominant-baseline").toTextBaseline();null==t&&(t=this.style("alignment-baseline").toTextBaseline()),null!=t&&(e.textBaseline=t)},this.getBoundingBox=function(){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),i=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize);return new t.BoundingBox(e,n-i,e+Math.floor(2*i/3)*this.children[0].getText().length,n)},this.renderChildren=function(e){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(e,this,0);for(var t=0;t<this.children.length;t++)this.renderChild(e,this,t)},this.getAnchorDelta=function(e,t,n){var i=this.style("text-anchor").valueOrDefault("start");if("start"!=i){for(var o=0,s=n;s<t.children.length;s++){var a=t.children[s];if(s>n&&a.attribute("x").hasValue())break;o+=a.measureTextRecursive(e)}return-1*("end"==i?o:o/2)}return 0},this.renderChild=function(e,t,n){var i=t.children[n];i.attribute("x").hasValue()?i.x=i.attribute("x").toPixels("x")+this.getAnchorDelta(e,t,n):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),i.attribute("dx").hasValue()&&(this.x+=i.attribute("dx").toPixels("x")),i.x=this.x),this.x=i.x+i.measureText(e),i.attribute("y").hasValue()?i.y=i.attribute("y").toPixels("y"):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),i.attribute("dy").hasValue()&&(this.y+=i.attribute("dy").toPixels("y")),i.y=this.y),this.y=i.y,i.render(e);for(var n=0;n<i.children.length;n++)this.renderChild(e,i,n)}},t.Element.text.prototype=new t.Element.RenderedElementBase,t.Element.TextElementBase=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.getGlyph=function(e,t,n){var i=t[n],o=null;if(e.isArabic){var s="isolated";(0==n||" "==t[n-1])&&n<t.length-2&&" "!=t[n+1]&&(s="terminal"),n>0&&" "!=t[n-1]&&n<t.length-2&&" "!=t[n+1]&&(s="medial"),n>0&&" "!=t[n-1]&&(n==t.length-1||" "==t[n+1])&&(s="initial"),"undefined"!=typeof e.glyphs[i]&&(o=e.glyphs[i][s],null==o&&"glyph"==e.glyphs[i].type&&(o=e.glyphs[i]))}else o=e.glyphs[i];return null==o&&(o=e.missingGlyph),o},this.renderChildren=function(e){var n=this.parent.style("font-family").getDefinition();if(null==n)""!=e.fillStyle&&e.fillText(t.compressSpaces(this.getText()),this.x,this.y),""!=e.strokeStyle&&e.strokeText(t.compressSpaces(this.getText()),this.x,this.y);else{var i=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize),o=this.parent.style("font-style").valueOrDefault(t.Font.Parse(t.ctx.font).fontStyle),s=this.getText();n.isRTL&&(s=s.split("").reverse().join(""));for(var a=t.ToNumberArray(this.parent.attribute("dx").value),r=0;r<s.length;r++){var l=this.getGlyph(n,s,r),u=i/n.fontFace.unitsPerEm;e.translate(this.x,this.y),e.scale(u,-u);var d=e.lineWidth;e.lineWidth=e.lineWidth*n.fontFace.unitsPerEm/i,"italic"==o&&e.transform(1,0,.4,1,0,0),l.render(e),"italic"==o&&e.transform(1,0,-.4,1,0,0),e.lineWidth=d,e.scale(1/u,-1/u),e.translate(-this.x,-this.y),this.x+=i*(l.horizAdvX||n.horizAdvX)/n.fontFace.unitsPerEm,"undefined"==typeof a[r]||isNaN(a[r])||(this.x+=a[r])}}},this.getText=function(){},this.measureTextRecursive=function(e){for(var t=this.measureText(e),n=0;n<this.children.length;n++)t+=this.children[n].measureTextRecursive(e);return t},this.measureText=function(e){var n=this.parent.style("font-family").getDefinition();if(null!=n){var i=this.parent.style("font-size").numValueOrDefault(t.Font.Parse(t.ctx.font).fontSize),o=0,s=this.getText();n.isRTL&&(s=s.split("").reverse().join(""));for(var a=t.ToNumberArray(this.parent.attribute("dx").value),r=0;r<s.length;r++){var l=this.getGlyph(n,s,r);o+=(l.horizAdvX||n.horizAdvX)*i/n.fontFace.unitsPerEm,"undefined"==typeof a[r]||isNaN(a[r])||(o+=a[r])}return o}var u=t.compressSpaces(this.getText());if(!e.measureText)return 10*u.length;e.save(),this.setContext(e);var d=e.measureText(u).width;return e.restore(),d}},t.Element.TextElementBase.prototype=new t.Element.RenderedElementBase,t.Element.tspan=function(e){this.captureTextNodes=!0,this.base=t.Element.TextElementBase,this.base(e),this.text=e.nodeValue||e.text||"",this.getText=function(){return this.text}},t.Element.tspan.prototype=new t.Element.TextElementBase,t.Element.tref=function(e){this.base=t.Element.TextElementBase,this.base(e),this.getText=function(){var e=this.getHrefAttribute().getDefinition();return null!=e?e.children[0].getText():void 0}},t.Element.tref.prototype=new t.Element.TextElementBase,t.Element.a=function(e){this.base=t.Element.TextElementBase,this.base(e),this.hasText=!0;for(var n=0;n<e.childNodes.length;n++)3!=e.childNodes[n].nodeType&&(this.hasText=!1);this.text=this.hasText?e.childNodes[0].nodeValue:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(e){if(this.hasText){this.baseRenderChildren(e);var n=new t.Property("fontSize",t.Font.Parse(t.ctx.font).fontSize);t.Mouse.checkBoundingBox(this,new t.BoundingBox(this.x,this.y-n.toPixels("y"),this.x+this.measureText(e),this.y))}else{var i=new t.Element.g;i.children=this.children,i.parent=this,i.render(e)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){t.ctx.canvas.style.cursor="pointer"}},t.Element.a.prototype=new t.Element.TextElementBase,t.Element.image=function(e){this.base=t.Element.RenderedElementBase,this.base(e);var n=this.getHrefAttribute().value,i=n.match(/\.svg$/);if(t.Images.push(this),this.loaded=!1,i)this.img=t.ajax(n),this.loaded=!0;else{this.img=document.createElement("img"),1==t.opts.useCORS&&(this.img.crossOrigin="Anonymous");var o=this;this.img.onload=function(){o.loaded=!0},this.img.onerror=function(){t.log('ERROR: image "'+n+'" not found'),o.loaded=!0},this.img.src=n}this.renderChildren=function(e){var n=this.attribute("x").toPixels("x"),o=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),a=this.attribute("height").toPixels("y");0!=s&&0!=a&&(e.save(),i?e.drawSvg(this.img,n,o,s,a):(e.translate(n,o),t.AspectRatio(e,this.attribute("preserveAspectRatio").value,s,this.img.width,a,this.img.height,0,0),e.drawImage(this.img,0,0)),e.restore())},this.getBoundingBox=function(){var e=this.attribute("x").toPixels("x"),n=this.attribute("y").toPixels("y"),i=this.attribute("width").toPixels("x"),o=this.attribute("height").toPixels("y");return new t.BoundingBox(e,n,e+i,n+o)}},t.Element.image.prototype=new t.Element.RenderedElementBase,t.Element.g=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.getBoundingBox=function(){for(var e=new t.BoundingBox,n=0;n<this.children.length;n++)e.addBoundingBox(this.children[n].getBoundingBox());return e}},t.Element.g.prototype=new t.Element.RenderedElementBase,t.Element.symbol=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.render=function(){}},t.Element.symbol.prototype=new t.Element.RenderedElementBase,t.Element.style=function(e){this.base=t.Element.ElementBase,this.base(e);for(var n="",i=0;i<e.childNodes.length;i++)n+=e.childNodes[i].nodeValue;n=n.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),n=t.compressSpaces(n);for(var o=n.split("}"),i=0;i<o.length;i++)if(""!=t.trim(o[i]))for(var s=o[i].split("{"),a=s[0].split(","),r=s[1].split(";"),l=0;l<a.length;l++){var u=t.trim(a[l]);if(""!=u){for(var d={},c=0;c<r.length;c++){var p=r[c].indexOf(":"),h=r[c].substr(0,p),m=r[c].substr(p+1,r[c].length-p);null!=h&&null!=m&&(d[t.trim(h)]=new t.Property(t.trim(h),t.trim(m)))}if(t.Styles[u]=d,"@font-face"==u)for(var y=d["font-family"].value.replace(/"/g,""),f=d.src.value.split(","),g=0;g<f.length;g++)if(f[g].indexOf('format("svg")')>0)for(var P=f[g].indexOf("url"),v=f[g].indexOf(")",P),w=f[g].substr(P+5,v-P-6),b=t.parseXml(t.ajax(w)),T=b.getElementsByTagName("font"),M=0;M<T.length;M++){var C=t.CreateElement(T[M]);t.Definitions[y]=C}}}},t.Element.style.prototype=new t.Element.ElementBase,t.Element.use=function(e){this.base=t.Element.RenderedElementBase,this.base(e),this.baseSetContext=this.setContext,this.setContext=function(e){this.baseSetContext(e),this.attribute("x").hasValue()&&e.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&e.translate(0,this.attribute("y").toPixels("y"))};var n=this.getHrefAttribute().getDefinition();this.path=function(e){null!=n&&n.path(e)},this.getBoundingBox=function(){return null!=n?n.getBoundingBox():void 0},this.renderChildren=function(e){if(null!=n){var i=n;"symbol"==n.type&&(i=new t.Element.svg,i.type="svg",i.attributes.viewBox=new t.Property("viewBox",n.attribute("viewBox").value),i.attributes.preserveAspectRatio=new t.Property("preserveAspectRatio",n.attribute("preserveAspectRatio").value),i.attributes.overflow=new t.Property("overflow",n.attribute("overflow").value),i.children=n.children),"svg"==i.type&&(this.attribute("width").hasValue()&&(i.attributes.width=new t.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(i.attributes.height=new t.Property("height",this.attribute("height").value)));var o=i.parent;i.parent=null,i.render(e),i.parent=o}}},t.Element.use.prototype=new t.Element.RenderedElementBase,t.Element.mask=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(e,n){var i=this.attribute("x").toPixels("x"),o=this.attribute("y").toPixels("y"),s=this.attribute("width").toPixels("x"),a=this.attribute("height").toPixels("y");if(0==s&&0==a){for(var r=new t.BoundingBox,l=0;l<this.children.length;l++)r.addBoundingBox(this.children[l].getBoundingBox());var i=Math.floor(r.x1),o=Math.floor(r.y1),s=Math.floor(r.width()),a=Math.floor(r.height())}var u=n.attribute("mask").value;n.attribute("mask").value="";var d=document.createElement("canvas");d.width=i+s,d.height=o+a;var c=d.getContext("2d");this.renderChildren(c);var p=document.createElement("canvas");p.width=i+s,p.height=o+a;var h=p.getContext("2d");n.render(h),h.globalCompositeOperation="destination-in",h.fillStyle=c.createPattern(d,"no-repeat"),h.fillRect(0,0,i+s,o+a),e.fillStyle=h.createPattern(p,"no-repeat"),e.fillRect(0,0,i+s,o+a),n.attribute("mask").value=u},this.render=function(){}},t.Element.mask.prototype=new t.Element.ElementBase,t.Element.clipPath=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(e){for(var n=0;n<this.children.length;n++){var i=this.children[n];if("undefined"!=typeof i.path){var o=null;i.attribute("transform").hasValue()&&(o=new t.Transform(i.attribute("transform").value),o.apply(e)),i.path(e),e.clip(),o&&o.unapply(e)}}},this.render=function(){}},t.Element.clipPath.prototype=new t.Element.ElementBase,t.Element.filter=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(e,t){var n=t.getBoundingBox(),i=Math.floor(n.x1),o=Math.floor(n.y1),s=Math.floor(n.width()),a=Math.floor(n.height()),r=t.style("filter").value;t.style("filter").value="";for(var l=0,u=0,d=0;d<this.children.length;d++){var c=this.children[d].extraFilterDistance||0;l=Math.max(l,c),u=Math.max(u,c)}var p=document.createElement("canvas");p.width=s+2*l,p.height=a+2*u;var h=p.getContext("2d");h.translate(-i+l,-o+u),t.render(h);for(var d=0;d<this.children.length;d++)this.children[d].apply(h,0,0,s+2*l,a+2*u);e.drawImage(p,0,0,s+2*l,a+2*u,i-l,o-u,s+2*l,a+2*u),t.style("filter",!0).value=r},this.render=function(){}},t.Element.filter.prototype=new t.Element.ElementBase,t.Element.feMorphology=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(){}},t.Element.feMorphology.prototype=new t.Element.ElementBase,t.Element.feComposite=function(e){this.base=t.Element.ElementBase,this.base(e),this.apply=function(){}},t.Element.feComposite.prototype=new t.Element.ElementBase,t.Element.feColorMatrix=function(e){function n(e,t,n,i,o,s){return e[4*n*i+4*t+s]}function i(e,t,n,i,o,s,a){e[4*n*i+4*t+s]=a}function o(e,t){var n=s[e];return n*(0>n?t-255:t)}this.base=t.Element.ElementBase,this.base(e);var s=t.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var a=s[0];s=[.213+.787*a,.715-.715*a,.072-.072*a,0,0,.213-.213*a,.715+.285*a,.072-.072*a,0,0,.213-.213*a,.715-.715*a,.072+.928*a,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var r=s[0]*Math.PI/180,l=function(e,t,n){return e+Math.cos(r)*t+Math.sin(r)*n};s=[l(.213,.787,-.213),l(.715,-.715,-.715),l(.072,-.072,.928),0,0,l(.213,-.213,.143),l(.715,.285,.14),l(.072,-.072,-.283),0,0,l(.213,-.213,-.787),l(.715,-.715,.715),l(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(e,t,s,a,r){for(var l=e.getImageData(0,0,a,r),s=0;r>s;s++)for(var t=0;a>t;t++){var u=n(l.data,t,s,a,r,0),d=n(l.data,t,s,a,r,1),c=n(l.data,t,s,a,r,2),p=n(l.data,t,s,a,r,3);i(l.data,t,s,a,r,0,o(0,u)+o(1,d)+o(2,c)+o(3,p)+o(4,1)),i(l.data,t,s,a,r,1,o(5,u)+o(6,d)+o(7,c)+o(8,p)+o(9,1)),i(l.data,t,s,a,r,2,o(10,u)+o(11,d)+o(12,c)+o(13,p)+o(14,1)),i(l.data,t,s,a,r,3,o(15,u)+o(16,d)+o(17,c)+o(18,p)+o(19,1))}e.clearRect(0,0,a,r),e.putImageData(l,0,0)}},t.Element.feColorMatrix.prototype=new t.Element.ElementBase,t.Element.feGaussianBlur=function(e){this.base=t.Element.ElementBase,this.base(e),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(e,n,i,o,s){return"undefined"==typeof stackBlurCanvasRGBA?(t.log("ERROR: StackBlur.js must be included for blur to work"),void 0):(e.canvas.id=t.UniqueId(),e.canvas.style.display="none",document.body.appendChild(e.canvas),stackBlurCanvasRGBA(e.canvas.id,n,i,o,s,this.blurRadius),document.body.removeChild(e.canvas),void 0)}},t.Element.feGaussianBlur.prototype=new t.Element.ElementBase,t.Element.title=function(){},t.Element.title.prototype=new t.Element.ElementBase,t.Element.desc=function(){},t.Element.desc.prototype=new t.Element.ElementBase,t.Element.MISSING=function(e){t.log("ERROR: Element '"+e.nodeName+"' not yet implemented.")},t.Element.MISSING.prototype=new t.Element.ElementBase,t.CreateElement=function(e){var n=e.nodeName.replace(/^[^:]+:/,"");n=n.replace(/\-/g,"");var i=null;return i="undefined"!=typeof t.Element[n]?new t.Element[n](e):new t.Element.MISSING(e),i.type=e.nodeName,i},t.load=function(e,n){t.loadXml(e,t.ajax(n))},t.loadXml=function(e,n){t.loadXmlDoc(e,t.parseXml(n))},t.loadXmlDoc=function(e,n){t.init(e);var i=function(t){for(var n=e.canvas;n;)t.x-=n.offsetLeft,t.y-=n.offsetTop,n=n.offsetParent;return window.scrollX&&(t.x+=window.scrollX),window.scrollY&&(t.y+=window.scrollY),t};1!=t.opts.ignoreMouse&&(e.canvas.onclick=function(e){var n=i(new t.Point(null!=e?e.clientX:event.clientX,null!=e?e.clientY:event.clientY));t.Mouse.onclick(n.x,n.y)},e.canvas.onmousemove=function(e){var n=i(new t.Point(null!=e?e.clientX:event.clientX,null!=e?e.clientY:event.clientY));t.Mouse.onmousemove(n.x,n.y)});var o=t.CreateElement(n.documentElement);o.root=!0;var s=!0,a=function(){t.ViewPort.Clear(),e.canvas.parentNode&&t.ViewPort.SetCurrent(e.canvas.parentNode.clientWidth,e.canvas.parentNode.clientHeight),1!=t.opts.ignoreDimensions&&(o.style("width").hasValue()&&(e.canvas.width=o.style("width").toPixels("x"),e.canvas.style.width=e.canvas.width+"px"),o.style("height").hasValue()&&(e.canvas.height=o.style("height").toPixels("y"),e.canvas.style.height=e.canvas.height+"px"));var i=e.canvas.clientWidth||e.canvas.width,a=e.canvas.clientHeight||e.canvas.height;if(1==t.opts.ignoreDimensions&&o.style("width").hasValue()&&o.style("height").hasValue()&&(i=o.style("width").toPixels("x"),a=o.style("height").toPixels("y")),t.ViewPort.SetCurrent(i,a),null!=t.opts.offsetX&&(o.attribute("x",!0).value=t.opts.offsetX),null!=t.opts.offsetY&&(o.attribute("y",!0).value=t.opts.offsetY),null!=t.opts.scaleWidth&&null!=t.opts.scaleHeight){var r=1,l=1,u=t.ToNumberArray(o.attribute("viewBox").value);o.attribute("width").hasValue()?r=o.attribute("width").toPixels("x")/t.opts.scaleWidth:isNaN(u[2])||(r=u[2]/t.opts.scaleWidth),o.attribute("height").hasValue()?l=o.attribute("height").toPixels("y")/t.opts.scaleHeight:isNaN(u[3])||(l=u[3]/t.opts.scaleHeight),o.attribute("width",!0).value=t.opts.scaleWidth,o.attribute("height",!0).value=t.opts.scaleHeight,o.attribute("viewBox",!0).value="0 0 "+i*r+" "+a*l,o.attribute("preserveAspectRatio",!0).value="none"}1!=t.opts.ignoreClear&&e.clearRect(0,0,i,a),o.render(e),s&&(s=!1,"function"==typeof t.opts.renderCallback&&t.opts.renderCallback(n))},r=!0;t.ImagesLoaded()&&(r=!1,a()),t.intervalID=setInterval(function(){var e=!1;if(r&&t.ImagesLoaded()&&(r=!1,e=!0),1!=t.opts.ignoreMouse&&(e|=t.Mouse.hasEvents()),1!=t.opts.ignoreAnimation)for(var n=0;n<t.Animations.length;n++)e|=t.Animations[n].update(1e3/t.FRAMERATE);"function"==typeof t.opts.forceRedraw&&1==t.opts.forceRedraw()&&(e=!0),e&&(a(),t.Mouse.runEvents())},1e3/t.FRAMERATE)},t.stop=function(){t.intervalID&&clearInterval(t.intervalID)},t.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(e,t){this.events.push({type:"onclick",x:e,y:t,run:function(e){e.onclick&&e.onclick()}})},this.onmousemove=function(e,t){this.events.push({type:"onmousemove",x:e,y:t,run:function(e){e.onmousemove&&e.onmousemove()}})},this.eventElements=[],this.checkPath=function(e,t){for(var n=0;n<this.events.length;n++){var i=this.events[n];t.isPointInPath&&t.isPointInPath(i.x,i.y)&&(this.eventElements[n]=e)}},this.checkBoundingBox=function(e,t){for(var n=0;n<this.events.length;n++){var i=this.events[n];t.isPointInBox(i.x,i.y)&&(this.eventElements[n]=e)}},this.runEvents=function(){t.ctx.canvas.style.cursor="";for(var e=0;e<this.events.length;e++)for(var n=this.events[e],i=this.eventElements[e];i;)n.run(i),i=i.parent;this.events=[],this.eventElements=[]}},t}this.canvg=function(t,n,i){if(null!=t||null!=n||null!=i){"string"==typeof t&&(t=document.getElementById(t)),null!=t.svg&&t.svg.stop();var o=e(i||{});(1!=t.childNodes.length||"OBJECT"!=t.childNodes[0].nodeName)&&(t.svg=o);var s=t.getContext("2d");"undefined"!=typeof n.documentElement?o.loadXmlDoc(s,n):"<"==n.substr(0,1)?o.loadXml(s,n):o.load(s,n)}else for(var a=document.querySelectorAll("svg"),r=0;r<a.length;r++){var l=a[r],u=document.createElement("canvas");u.width=l.clientWidth,u.height=l.clientHeight,l.parentNode.insertBefore(u,l),l.parentNode.removeChild(l);var d=document.createElement("div");d.appendChild(l),canvg(u,d.innerHTML)}}}(),"undefined"!=typeof CanvasRenderingContext2D&&(CanvasRenderingContext2D.prototype.drawSvg=function(e,t,n,i,o){canvg(this.canvas,e,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:t,offsetY:n,scaleWidth:i,scaleHeight:o})}),function(){var e=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(t){function n(){!initializing&&this.init&&this.init.apply(this,arguments)}var i=this.prototype;initializing=!0;var o=new this;initializing=!1;for(var s in t)o[s]="function"==typeof t[s]&&"function"==typeof i[s]&&e.test(t[s])?function(e,t){return function(){var n=this._super;this._super=i[e];var o=t.apply(this,arguments);return this._super=n,o}}(s,t[s]):t[s];return n.prototype=o,n.prototype.constructor=n,n.extend=arguments.callee,n}}();var JSON;JSON||(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,o,s,a,r=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(s=l.length,n=0;s>n;n+=1)a[n]=str(n,l)||"null";return o=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+r+"]":"["+a.join(",")+"]",gap=r,o}if(rep&&"object"==typeof rep)for(s=rep.length,n=0;s>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],o=str(i,l),o&&a.push(quote(i)+(gap?": ":":")+o));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(o=str(i,l),o&&a.push(quote(i)+(gap?": ":":")+o));return o=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+r+"}":"{"+a.join(",")+"}",gap=r,o}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,i,o=e[t];if(o&&"object"==typeof o)for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i=walk(o,n),void 0!==i?o[n]=i:delete o[n]);return reviver.call(e,t,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var draw2d={geo:{},io:{json:{},png:{},svg:{}},storage:{google:{}},util:{spline:{}},shape:{basic:{},arrow:{},node:{},note:{},diagram:{},analog:{},icon:{},layout:{},pert:{},state:{},widget:{}},policy:{canvas:{},line:{},port:{},figure:{}},command:{},decoration:{connection:{}},layout:{connection:{},anchor:{},mesh:{},locator:{}},ui:{},isTouchDevice:-1!=navigator.platform.indexOf("iPhone")||-1!=navigator.platform.indexOf("iPod")||-1!=navigator.platform.indexOf("iPad")};document.ontouchmove=function(e){e.preventDefault()},document.oncontextmenu=function(){return!1},function(){Raphael.fn.group=function(e,t){var n=document.getElementsByTagName("svg").length>0;if(!n)return{add:function(){}};var i;for(this.svg="http://www.w3.org/2000/svg",this.defs=document.getElementsByTagName("defs")[e],this.svgcanv=document.getElementsByTagName("svg")[e],this.group=document.createElementNS(this.svg,"g"),i=0;i<t.length;i++)this.group.appendChild(t[i].node);return this.svgcanv.appendChild(this.group),this.group.translate=function(e,t){this.setAttribute("transform","translate("+e+","+t+") scale("+this.getAttr("scale").x+","+this.getAttr("scale").y+")")},this.group.rotate=function(e,t,n){this.setAttribute("transform","translate("+this.getAttr("translate").x+","+this.getAttr("translate").y+") scale("+this.getAttr("scale").x+","+this.getAttr("scale").y+") rotate("+e+","+t+","+n+")")},this.group.scale=function(e,t){this.setAttribute("transform","scale("+e+","+t+") translate("+this.getAttr("translate").x+","+this.getAttr("translate").y+")")},this.group.push=function(e){this.appendChild(e.node)},this.group.getAttr=function(e){this.previous=this.getAttribute("transform")?this.getAttribute("transform"):"";var t,n,o,s=[];for(s=this.previous.split(" "),i=0;i<s.length;i++)if("t"==s[i].substring(0,1)){var a=s[i],r=[];r=a.split("("),a=r[1].substring(0,r[1].length-1),r=[],r=a.split(","),t=0===r.length?{x:0,y:0}:{x:r[0],y:r[1]}}else"r"===s[i].substring(0,1)?(a=s[i],r=a.split("("),a=r[1].substring(0,r[1].length-1),r=a.split(","),n=0===r.length?{x:0,y:0,z:0}:{x:r[0],y:r[1],z:r[2]}):"s"===s[i].substring(0,1)&&(a=s[i],r=a.split("("),a=r[1].substring(0,r[1].length-1),r=a.split(","),o=0===r.length?{x:1,y:1}:{x:r[0],y:r[1]});if("undefined"==typeof t&&(t={x:0,y:0}),"undefined"==typeof n&&(n={x:0,y:0,z:0}),"undefined"==typeof o&&(o={x:1,y:1}),"translate"==e)var l=t;else"rotate"==e?l=n:"scale"==e&&(l=o);return l},this.group.copy=function(e){this.copy=e.node.cloneNode(!0),this.appendChild(this.copy)},this.group}}(),Math.sign=function(){return 0>this?-1:1},window.debug=function(){function e(e){!n||!i&&a&&a.log||n.apply(o,e)}function t(e){return l>0?l>e:u.length+l<=e}for(var n,i,o=this,s=Array.prototype.slice,a=o.console,r={},l=9,u=["error","warn","info","debug","log"],d="assert clear count dir dirxml exception group groupCollapsed groupEnd profile profileEnd table time timeEnd trace".split(" "),c=d.length,p=[];--c>=0;)!function(e){r[e]=function(){0!==l&&a&&a[e]&&a[e].apply(a,arguments)}}(d[c]);for(c=u.length;--c>=0;)!function(n,i){r[i]=function(){var r=s.call(arguments),l=[i].concat(r);p.push(l),e(l),a&&t(n)&&(a.firebug?a[i].apply(o,r):a[i]?a[i](r):a.log(r))}}(c,u[c]);return r.setLevel=function(e){l="number"==typeof e?e:9},r.setCallback=function(){var t=s.call(arguments),o=p.length,a=o;for(n=t.shift()||null,i="boolean"==typeof t[0]?t.shift():!1,a-="number"==typeof t[0]?t.shift():o;o>a;)e(p[a++])},r}(),draw2d.util.Color=Class.extend({init:function(e,t,n){if(this.hashString=null,"undefined"==typeof e||null===e)this.hashString="none";else if(e instanceof draw2d.util.Color)this.red=e.red,this.green=e.green,this.blue=e.blue;else if("undefined"==typeof t){var i=this.hex2rgb(e);this.red=i[0],this.green=i[1],this.blue=i[2]}else this.red=e,this.green=t,this.blue=n},getHTMLStyle:function(){return"rgb("+this.red+","+this.green+","+this.blue+")"},getRed:function(){return this.red},getGreen:function(){return this.green},getBlue:function(){return this.blue},getIdealTextColor:function(){var e=105,t=.299*this.red+.587*this.green+.114*this.blue;return e>255-t?new draw2d.util.Color(0,0,0):new draw2d.util.Color(255,255,255)},hex2rgb:function(e){return e=e.replace("#",""),{0:parseInt(e.substr(0,2),16),1:parseInt(e.substr(2,2),16),2:parseInt(e.substr(4,2),16)}},rgb2hex:function(e){function t(e){return("0"+parseInt(e).toString(16)).slice(-2)}return e=e.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+t(e[1])+t(e[2])+t(e[3])},hex:function(){return this.int2hex(this.red)+this.int2hex(this.green)+this.int2hex(this.blue)
},hash:function(){return null===this.hashString&&(this.hashString="#"+this.hex()),this.hashString},int2hex:function(e){return e=Math.round(Math.min(Math.max(0,e),255)),"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16)},darker:function(e){if("none"===this.hashString)return this;var t=parseInt(Math.round(this.getRed()*(1-e))),n=parseInt(Math.round(this.getGreen()*(1-e))),i=parseInt(Math.round(this.getBlue()*(1-e)));return 0>t?t=0:t>255&&(t=255),0>n?n=0:n>255&&(n=255),0>i?i=0:i>255&&(i=255),new draw2d.util.Color(t,n,i)},lighter:function(e){if("none"===this.hashString)return this;var t=parseInt(Math.round(this.getRed()*(1+e))),n=parseInt(Math.round(this.getGreen()*(1+e))),i=parseInt(Math.round(this.getBlue()*(1+e)));return 0>t?t=0:t>255&&(t=255),0>n?n=0:n>255&&(n=255),0>i?i=0:i>255&&(i=255),new draw2d.util.Color(t,n,i)},fadeTo:function(e,t){var n=Math.floor(this.red+t*(e.red-this.red)+.5),i=Math.floor(this.green+t*(e.green-this.green)+.5),o=Math.floor(this.blue+t*(e.blue-this.blue)+.5);return new draw2d.util.Color(n,i,o)}}),draw2d.util.ArrayList=Class.extend({init:function(e){this.increment=10,this.size=0,this.data=new Array(this.increment),"undefined"!=typeof e&&$.each(e,$.proxy(function(e,t){this.add(t)},this))},reverse:function(){for(var e=new Array(this.size),t=0;t<this.size;t++)e[t]=this.data[this.size-t-1];return this.data=e,this},getCapacity:function(){return this.data.length},getSize:function(){return this.size},isEmpty:function(){return 0===this.getSize()},last:function(){return null!==this.data[this.getSize()-1]?this.data[this.getSize()-1]:null},getLastElement:function(){return this.last()},asArray:function(){return this.trimToSize(),this.data},first:function(){return null!==this.data[0]&&"undefined"!=typeof this.data[0]?this.data[0]:null},getFirstElement:function(){return this.first()},get:function(e){return this.data[e]},add:function(e){return this.getSize()==this.data.length&&this.resize(),this.data[this.size++]=e,this},grep:function(e){return this.trimToSize(),this.data=$.grep(this.data,e),this.data=$.grep(this.data,function(e){return"undefined"!=typeof e}),this.size=this.data.length,this},map:function(e){return this.trimToSize(),this.data=$.map(this.data,e),this.data=$.grep(this.data,function(e){return"undefined"!=typeof e}),this.size=this.data.length,this},unique:function(){return this.trimToSize(),this.data=$.unique(this.data),this.data=$.grep(this.data,function(e){return"undefined"!=typeof e}),this.size=this.data.length,this},addAll:function(e,t){if(!(e instanceof draw2d.util.ArrayList))throw"Unable to handle unknown object type in ArrayList.addAll";var n=this;return"undefined"==typeof t||t===!1?e.each(function(e,t){n.add(t)}):e.each(function(e,t){n.contains(t)||n.add(t)}),this},pop:function(){return this.removeElementAt(this.getSize()-1)},push:function(e){this.add(e)},remove:function(e){var t=this.indexOf(e);return t>=0?this.removeElementAt(t):null},insertElementAt:function(e,t){this.size==this.capacity&&this.resize();for(var n=this.getSize();n>t;n--)this.data[n]=this.data[n-1];return this.data[t]=e,this.size++,this},removeElementAt:function(e){for(var t=this.data[e],n=e;n<this.size-1;n++)this.data[n]=this.data[n+1];return this.data[this.size-1]=null,this.size--,t},removeAll:function(e){return $.each(e,$.proxy(function(e,t){this.remove(t)},this)),this},indexOf:function(e){for(var t=0;t<this.getSize();t++)if(this.data[t]==e)return t;return-1},contains:function(e){for(var t=0;t<this.getSize();t++)if(this.data[t]==e)return!0;return!1},resize:function(){newData=new Array(this.data.length+this.increment);for(var e=0;e<this.data.length;e++)newData[e]=this.data[e];return this.data=newData,this},trimToSize:function(){if(this.data.length==this.size)return this;for(var e=new Array(this.getSize()),t=0;t<this.getSize();t++)e[t]=this.data[t];return this.size=e.length,this.data=e,this},sort:function(e){var t,n,i,o,s,a;for(t=1;t<this.getSize();t++){for(o=this.data[t],i=o[e],n=t-1,s=this.data[n],a=s[e];n>=0&&a>i;)this.data[n+1]=this.data[n],n--,n>=0&&(s=this.data[n],a=s[e]);this.data[n+1]=o}return this},clone:function(e){var t=new draw2d.util.ArrayList;if(e)for(var n=0;n<this.size;n++)t.add(this.data[n].clone());else for(var n=0;n<this.size;n++)t.add(this.data[n]);return t},each:function(e,t){if("undefined"!=typeof t&&t===!0)for(var n=this.size-1;n>=0&&e(n,this.data[n])!==!1;n--);else for(var n=0;n<this.size&&e(n,this.data[n])!==!1;n++);},overwriteElementAt:function(e,t){return this.data[t]=e,this},getPersistentAttributes:function(){return{data:this.data,increment:this.increment,size:this.getSize()}},setPersistentAttributes:function(e){this.data=e.data,this.increment=e.increment,this.size=e.size}}),draw2d.util.ArrayList.EMPTY_LIST=new draw2d.util.ArrayList,Raphael.fn.polygon=function(e){for(var t=["M"],n=e.split(" "),i=0;i<n.length;i++){for(var o=n[i].split(","),s=0;s<o.length;s++){var a=parseFloat(o[s]);a&&t.push(a)}0==i&&t.push("L")}return t.push("Z"),this.path(t)},draw2d.util.UUID=function(){},draw2d.util.UUID.create=function(){var e=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},draw2d.geo.Point=Class.extend({NAME:"draw2d.geo.Point",init:function(e,t){e instanceof draw2d.geo.Point?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t),this.bx=null,this.by=null,this.bw=null,this.bh=null},setBoundary:function(e,t,n,i){return e instanceof draw2d.geo.Rectangle?(this.bx=e.x,this.by=e.y,this.bw=e.w,this.bh=e.h):(this.bx=e,this.by=t,this.bw=n,this.bh=i),this.adjustBoundary(),this},adjustBoundary:function(){return null!==this.bx?(this.x=Math.min(Math.max(this.bx,this.x),this.bw),this.y=Math.min(Math.max(this.by,this.y),this.bh),this):void 0},translate:function(e,t){return this.x+=e,this.y+=t,this.adjustBoundary(),this},getX:function(){return this.x},getY:function(){return this.y},setX:function(e){return this.x=e,this.adjustBoundary(),this},setY:function(e){return this.y=e,this.adjustBoundary(),this},setPosition:function(e,t){return e instanceof draw2d.geo.Point?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t),this.adjustBoundary(),this},getPosition:function(e){var t=e.x-this.x,n=e.y-this.y;return Math.abs(t)>Math.abs(n)?0>t?draw2d.geo.PositionConstants.WEST:draw2d.geo.PositionConstants.EAST:0>n?draw2d.geo.PositionConstants.NORTH:draw2d.geo.PositionConstants.SOUTH},equals:function(e){return this.x===e.x&&this.y===e.y},getDistance:function(e){return Math.sqrt((this.x-e.x)*(this.x-e.x)+(this.y-e.y)*(this.y-e.y))},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},getTranslated:function(e){return new draw2d.geo.Point(this.x+e.x,this.y+e.y)},getScaled:function(e){return new draw2d.geo.Point(this.x*e,this.y*e)},getPersistentAttributes:function(){return{x:this.x,y:this.y}},setPersistentAttributes:function(e){this.x=e.x,this.y=e.y},subtract:function(e){return new draw2d.geo.Point(this.x-e.x,this.y-e.y)},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lerp:function(e,t){return new draw2d.geo.Point(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)},clone:function(){return new draw2d.geo.Point(this.x,this.y)}}),draw2d.geo.Rectangle=draw2d.geo.Point.extend({NAME:"draw2d.geo.Rectangle",init:function(e,t,n,i){this._super(e,t),this.w=n,this.h=i},adjustBoundary:function(){null!==this.bx&&(this.x=Math.min(Math.max(this.bx,this.x),this.bw-this.w),this.y=Math.min(Math.max(this.by,this.y),this.bh-this.h),this.w=Math.min(this.w,this.bw),this.h=Math.min(this.h,this.bh))},resize:function(e,t){return this.w+=e,this.h+=t,this.adjustBoundary(),this},scale:function(e,t){return this.w+=e,this.h+=t,this.x-=e/2,this.y-=t/2,this.adjustBoundary(),this},setBounds:function(e){return this.setPosition(e.x,e.y),this.w=e.w,this.h=e.h,this},isEmpty:function(){return this.w<=0||this.h<=0},getWidth:function(){return this.w},setWidth:function(e){return this.w=e,this.adjustBoundary(),this},getHeight:function(){return this.h},setHeight:function(e){return this.h=e,this.adjustBoundary(),this},getLeft:function(){return this.x},getRight:function(){return this.x+this.w},getTop:function(){return this.y},getBottom:function(){return this.y+this.h},getTopLeft:function(){return new draw2d.geo.Point(this.x,this.y)},getTopCenter:function(){return new draw2d.geo.Point(this.x+this.w/2,this.y)},getTopRight:function(){return new draw2d.geo.Point(this.x+this.w,this.y)},getBottomLeft:function(){return new draw2d.geo.Point(this.x,this.y+this.h)},getBottomCenter:function(){return new draw2d.geo.Point(this.x+this.w/2,this.y+this.h)},getCenter:function(){return new draw2d.geo.Point(this.x+this.w/2,this.y+this.h/2)},getBottomRight:function(){return new draw2d.geo.Point(this.x+this.w,this.y+this.h)},getVertices:function(){var e=new draw2d.util.ArrayList;return e.add(this.getTopLeft()),e.add(this.getTopRight()),e.add(this.getBottomRight()),e.add(this.getBottomLeft()),e},getPoints:function(){return this.getVertices()},moveInside:function(e){var t=new draw2d.geo.Rectangle(e.x,e.y,e.w,e.h);return t.x=Math.max(t.x,this.x),t.y=Math.max(t.y,this.y),t.x=t.w<this.w?Math.min(t.x+t.w,this.x+this.w)-t.w:this.x,t.y=t.h<this.h?Math.min(t.y+t.h,this.y+this.h)-t.h:this.y,t},getDistance:function(e){var t=this.x,n=this.y,i=this.w,o=this.h,s=e.getX(),a=e.getY(),r=1,l=1;e instanceof draw2d.geo.Rectangle&&(r=e.getWidth(),l=e.getHeight());var u=9;if(s>=t+i)u=a>=n+o?0:n>=a+l?6:7;else if(t>=s+r)u=a>=n+o?2:n>=a+l?4:3;else if(a>=n+o)u=1;else{if(!(n>=a+l))return 0;u=5}switch(u){case 0:return t=t+i-s,n=n+o-a,-(t+n);case 1:return-(n+o-a);case 2:return t=s+r-t,n=n+o-a,-(t+n);case 3:return-(s+r-t);case 4:return t=s+r-t,n=a+l-n,-(t+n);case 5:return-(a+l-n);case 6:return t=t+i-s,n=a+l-n,-(t+n);case 7:return-(t+i-s)}throw"Unknown data type of parameter for distance calculation in draw2d.geo.Rectangle.getDistnace(..)"},determineOctant:function(e){var t=3,n=this.x+t,i=this.y+t,o=this.w-2*t,s=this.h-2*t,a=e.x,r=e.y,l=2,u=2;e instanceof draw2d.geo.Rectangle&&(l=e.w,u=e.h);var d=0;return d=n>=a+l?i>=r+u?0:r>=i+s?6:7:a>=n+o?i>=r+u?2:r>=i+s?4:3:i>=r+u?1:r>=i+s?5:8},getDirection:function(e){var t=this.getTopLeft();switch(this.determineOctant(e)){case 0:return t.x-e.x<t.y-e.y?draw2d.geo.Rectangle.DIRECTION_UP:draw2d.geo.Rectangle.DIRECTION_LEFT;case 1:return draw2d.geo.Rectangle.DIRECTION_UP;case 2:return t=this.getTopRight(),e.x-t.x<t.y-e.y?draw2d.geo.Rectangle.DIRECTION_UP:draw2d.geo.Rectangle.DIRECTION_RIGHT;case 3:return draw2d.geo.Rectangle.DIRECTION_RIGHT;case 4:return t=this.getBottomRight(),e.x-t.x<e.y-t.y?draw2d.geo.Rectangle.DIRECTION_DOWN:draw2d.geo.Rectangle.DIRECTION_RIGHT;case 5:return draw2d.geo.Rectangle.DIRECTION_DOWN;case 6:return t=this.getBottomLeft(),t.x-e.x<e.y-t.y?draw2d.geo.Rectangle.DIRECTION_DOWN:draw2d.geo.Rectangle.DIRECTION_LEFT;case 7:return draw2d.geo.Rectangle.DIRECTION_LEFT;case 8:return e.y>this.y?draw2d.geo.Rectangle.DIRECTION_DOWN:draw2d.geo.Rectangle.DIRECTION_UP}return draw2d.geo.Rectangle.DIRECTION_UP},equals:function(e){return this.x==e.x&&this.y==e.y&&this.w==e.w&&this.h==e.h},hitTest:function(e,t){e instanceof draw2d.geo.Point&&(t=e.y,e=e.x);var n=this.x+this.getWidth(),i=this.y+this.getHeight();return e>=this.x&&n>=e&&t>=this.y&&i>=t},isInside:function(e){return e.hitTest(this.getTopLeft())&&e.hitTest(this.getTopRight())&&e.hitTest(this.getBottomLeft())&&e.hitTest(this.getBottomRight())},intersects:function(e){return x11=e.x,y11=e.y,x12=e.x+e.w,y12=e.y+e.h,x21=this.x,y21=this.y,x22=this.x+this.w,y22=this.y+this.h,x_overlap=Math.max(0,Math.min(x12,x22)-Math.max(x11,x21)),y_overlap=Math.max(0,Math.min(y12,y22)-Math.max(y11,y21)),0!==x_overlap*y_overlap},toJSON:function(){return{width:this.w,height:this.h,x:this.x,y:this.y}}}),draw2d.geo.Rectangle.DIRECTION_UP=0,draw2d.geo.Rectangle.DIRECTION_RIGHT=1,draw2d.geo.Rectangle.DIRECTION_DOWN=2,draw2d.geo.Rectangle.DIRECTION_LEFT=3,draw2d.command.CommandType=Class.extend({NAME:"draw2d.command.CommandType",init:function(e){this.policy=e},getPolicy:function(){return this.policy}}),draw2d.command.CommandType.DELETE="DELETE",draw2d.command.CommandType.MOVE="MOVE",draw2d.command.CommandType.CONNECT="CONNECT",draw2d.command.CommandType.MOVE_BASEPOINT="MOVE_BASEPOINT",draw2d.command.CommandType.MOVE_VERTEX="MOVE_VERTEX",draw2d.command.CommandType.MOVE_VERTICES="MOVE_VERTICES",draw2d.command.CommandType.MOVE_GHOST_VERTEX="MOVE_GHOST_VERTEX",draw2d.command.CommandType.RESIZE="RESIZE",draw2d.command.CommandType.RESET="RESET",draw2d.command.Command=Class.extend({NAME:"draw2d.command.Command",init:function(e){this.label=e},getLabel:function(){return this.label},canExecute:function(){return!0},execute:function(){},cancel:function(){},undo:function(){},redo:function(){}}),draw2d.command.CommandCollection=draw2d.command.Command.extend({NAME:"draw2d.command.CommandCollection",init:function(e){this._super("undefined"==typeof e?draw2d.Configuration.i18n.command.collection:e),this.commands=new draw2d.util.ArrayList},getLabel:function(){if(1===this.commands.getSize())return this.commands.first().getLabel();if(this.commands.getSize()>1){var e=this.commands.clone().map(function(e){return e.getLabel()});if(e.unique(),1===e.getSize())return e.first()}return this._super()},add:function(e){this.commands.add(e)},canExecute:function(){var e=!1;return this.commands.each(function(t,n){e=e||n.canExecute()}),e},execute:function(){this.commands.each(function(e,t){t.execute()})},redo:function(){this.commands.each(function(e,t){t.redo()})},undo:function(){this.commands.reverse(),this.commands.each(function(e,t){t.undo()}),this.commands.reverse()}}),draw2d.command.CommandStack=Class.extend({NAME:"draw2d.command.CommandStack",init:function(){this.undostack=[],this.redostack=[],this.maxundo=50,this.transactionCommand=null,this.eventListeners=new draw2d.util.ArrayList,window.onpopstate=$.proxy(function(e){null===e.state},this)},setUndoLimit:function(e){this.maxundo=e},markSaveLocation:function(){this.undostack=[],this.redostack=[],this.notifyListeners(new draw2d.command.Command,draw2d.command.CommandStack.POST_EXECUTE)},execute:function(e){if("undefined"==typeof e)throw"Missing parameter [command] for method call CommandStack.execute";if(null!==e&&e.canExecute()!==!1){if(null!==this.transactionCommand)return this.transactionCommand.add(e),void 0;this.notifyListeners(e,draw2d.command.CommandStack.PRE_EXECUTE),this.undostack.push(e),e.execute(),this.redostack=[],this.undostack.length>this.maxundo&&(this.undostack=this.undostack.slice(this.undostack.length-this.maxundo)),this.notifyListeners(e,draw2d.command.CommandStack.POST_EXECUTE)}},startTransaction:function(e){this.transactionCommand=new draw2d.command.CommandCollection(e)},commitTransaction:function(){if(null!==this.transactionCommand){var e=this.transactionCommand;this.transactionCommand=null,this.execute(e)}},undo:function(){var e=this.undostack.pop();e&&(this.notifyListeners(e,draw2d.command.CommandStack.PRE_UNDO),this.redostack.push(e),e.undo(),this.notifyListeners(e,draw2d.command.CommandStack.POST_UNDO))},redo:function(){var e=this.redostack.pop();e&&(this.notifyListeners(e,draw2d.command.CommandStack.PRE_REDO),this.undostack.push(e),e.redo(),this.notifyListeners(e,draw2d.command.CommandStack.POST_REDO))},getRedoLabel:function(){if(0===this.redostack.length)return"";var e=this.redostack[this.redostack.length-1];return e?e.getLabel():""},getUndoLabel:function(){if(0===this.undostack.length)return"";var e=this.undostack[this.undostack.length-1];return e?e.getLabel():""},canRedo:function(){return this.redostack.length>0},canUndo:function(){return this.undostack.length>0},addEventListener:function(e){if(e instanceof draw2d.command.CommandStackEventListener)this.eventListeners.add(e);else if("function"==typeof e.stackChanged)this.eventListeners.add(e);else{if("function"!=typeof e)throw"Object doesn't implement required callback interface [draw2d.command.CommandStackListener]";this.eventListeners.add({stackChanged:e})}},removeEventListener:function(e){for(var t=0;size>t;t++){var n=this.eventListeners.get(t);if(n===e||n.stackChanged===e)return this.eventListeners.remove(n),void 0}},notifyListeners:function(e,t){for(var n=new draw2d.command.CommandStackEvent(this,e,t),i=this.eventListeners.getSize(),o=0;i>o;o++)this.eventListeners.get(o).stackChanged(n)}}),draw2d.command.CommandStack.PRE_EXECUTE=1,draw2d.command.CommandStack.PRE_REDO=2,draw2d.command.CommandStack.PRE_UNDO=4,draw2d.command.CommandStack.POST_EXECUTE=8,draw2d.command.CommandStack.POST_REDO=16,draw2d.command.CommandStack.POST_UNDO=32,draw2d.command.CommandStack.POST_INIT=64,draw2d.command.CommandStack.POST_MASK=draw2d.command.CommandStack.POST_EXECUTE|draw2d.command.CommandStack.POST_UNDO|draw2d.command.CommandStack.POST_REDO,draw2d.command.CommandStack.PRE_MASK=draw2d.command.CommandStack.PRE_EXECUTE|draw2d.command.CommandStack.PRE_UNDO|draw2d.command.CommandStack.PRE_REDO,draw2d.command.CommandStackEvent=Class.extend({NAME:"draw2d.command.CommandStackEvent",init:function(e,t,n){this.stack=e,this.command=t,this.details=n},getStack:function(){return this.stack},getCommand:function(){return this.command},getDetails:function(){return this.details},isPostChangeEvent:function(){return 0!=(this.getDetails()&draw2d.command.CommandStack.POST_MASK)},isPreChangeEvent:function(){return 0!=(this.getDetails()&draw2d.command.CommandStack.PRE_MASK)}}),draw2d.command.CommandStackEventListener=Class.extend({NAME:"draw2d.command.CommandStackEventListener",init:function(){},stackChanged:function(){}}),draw2d.command.CommandMove=draw2d.command.Command.extend({NAME:"draw2d.command.CommandMove",init:function(e,t,n){this._super(draw2d.Configuration.i18n.command.moveShape),this.figure=e,"undefined"==typeof t?(this.oldX=e.getX(),this.oldY=e.getY()):(this.oldX=t,this.oldY=n)},setStartPosition:function(e,t){this.oldX=e,this.oldY=t},setPosition:function(e,t){this.newX=e,this.newY=t},canExecute:function(){return this.newX!=this.oldX||this.newY!=this.oldY},execute:function(){this.redo()},undo:function(){this.figure.setPosition(this.oldX,this.oldY)},redo:function(){this.figure.setPosition(this.newX,this.newY)}}),draw2d.command.CommandMoveLine=draw2d.command.Command.extend({NAME:"draw2d.command.CommandMoveLine",init:function(e){this._super(draw2d.Configuration.i18n.command.moveLine),this.line=e,this.dx=0,this.dy=0},setTranslation:function(e,t){this.dx=e,this.dy=t},canExecute:function(){return 0!==this.dx&&0!==this.dy},execute:function(){this.redo()},undo:function(){this.line.getVertices().each($.proxy(function(e,t){t.translate(-this.dx,-this.dy)},this)),this.line.svgPathString=null,this.line.repaint()},redo:function(){this.line.getVertices().each($.proxy(function(e,t){t.translate(this.dx,this.dy)},this)),this.line.svgPathString=null,this.line.repaint()}}),draw2d.command.CommandMoveVertex=draw2d.command.Command.extend({NAME:"draw2d.command.CommandMoveVertex",init:function(e){this._super(draw2d.Configuration.i18n.command.moveVertex),this.line=e,this.index=-1,this.newPoint=null},setIndex:function(e){this.index=e,this.origPoint=this.line.getVertices().get(this.index).clone()},updatePosition:function(e,t){this.newPoint=new draw2d.geo.Point(e,t)},canExecute:function(){return-1!==this.index&&null!==this.newPoint},execute:function(){this.redo()},undo:function(){this.line.setVertex(this.index,this.origPoint.x,this.origPoint.y)},redo:function(){this.line.setVertex(this.index,this.newPoint.x,this.newPoint.y)}}),draw2d.command.CommandResize=draw2d.command.Command.extend({NAME:"draw2d.command.CommandResize",init:function(e,t,n){this._super(draw2d.Configuration.i18n.command.resizeShape),this.figure=e,"undefined"==typeof t?(this.oldWidth=e.getWidth(),this.oldHeight=e.getHeight()):(this.oldWidth=t,this.oldHeight=n)},setDimension:function(e,t){this.newWidth=0|e,this.newHeight=0|t},canExecute:function(){return this.newWidth!=this.oldWidth||this.newHeight!=this.oldHeight},execute:function(){this.redo()},undo:function(){this.figure.setDimension(this.oldWidth,this.oldHeight)},redo:function(){this.figure.setDimension(this.newWidth,this.newHeight)}}),draw2d.command.CommandConnect=draw2d.command.Command.extend({NAME:"draw2d.command.CommandConnect",init:function(e,t,n,i){this._super(draw2d.Configuration.i18n.command.connectPorts),this.canvas=e,this.source=t,this.target=n,this.connection=null,this.dropTarget=i},setConnection:function(e){this.connection=e},execute:function(){var e=$.proxy(function(e){this.connection=e,this.connection.setSource(this.source),this.connection.setTarget(this.target),this.canvas.addFigure(this.connection)},this);if(null===this.connection){var t=draw2d.Connection.createConnection(this.source,this.target,e,this.dropTarget);if("undefined"==typeof t)return;this.connection=t}e(this.connection)},redo:function(){this.canvas.addFigure(this.connection),this.connection.reconnect()},undo:function(){this.canvas.removeFigure(this.connection)}}),draw2d.command.CommandReconnect=draw2d.command.Command.extend({NAME:"draw2d.command.CommandReconnect",init:function(e){this._super(draw2d.Configuration.i18n.command.connectPorts),this.con=e,this.oldSourcePort=e.getSource(),this.oldTargetPort=e.getTarget()},canExecute:function(){return!0},setNewPorts:function(e,t){this.newSourcePort=e,this.newTargetPort=t},execute:function(){this.redo()},cancel:function(){this.con.setSource(this.oldSourcePort),this.con.setTarget(this.oldTargetPort),this.con.routingRequired=!0,this.con.repaint()},undo:function(){this.con.setSource(this.oldSourcePort),this.con.setTarget(this.oldTargetPort),this.con.routingRequired=!0,this.con.repaint()},redo:function(){this.con.setSource(this.newSourcePort),this.con.setTarget(this.newTargetPort),this.con.routingRequired=!0,this.con.repaint()}}),draw2d.command.CommandAdd=draw2d.command.Command.extend({init:function(e,t,n,i){this._super("Delete Figure"),this.figure=t,this.canvas=e,this.x=n,this.y=i},execute:function(){this.canvas.addFigure(this.figure,this.x,this.y)},redo:function(){this.execute()},undo:function(){this.canvas.removeFigure(this.figure)}}),draw2d.command.CommandMoveVertices=draw2d.command.Command.extend({NAME:"draw2d.command.CommandMoveVertices",init:function(e){this._super(draw2d.Configuration.i18n.command.moveVertices),this.line=e,this.oldVertices=e.getVertices().clone(),this.newVertices=null},updateVertices:function(e){this.newVertices=e},canExecute:function(){return null!==this.newVertices},execute:function(){this.redo()},undo:function(){this.line.setVertices(this.oldVertices)},redo:function(){this.line.setVertices(this.newVertices)}}),draw2d.command.CommandDelete=draw2d.command.Command.extend({init:function(e){this._super(draw2d.Configuration.i18n.command.deleteShape),this.parent=e.getParent(),this.figure=e,this.canvas=e.getCanvas(),this.connections=null},execute:function(){this.redo()},undo:function(){this.canvas.addFigure(this.figure),this.figure instanceof draw2d.Connection&&this.figure.reconnect(),this.canvas.setCurrentSelection(this.figure),null!==this.parent&&this.parent.addChild(this.figure);for(var e=0;e<this.connections.getSize();++e)this.canvas.addFigure(this.connections.get(e)),this.connections.get(e).reconnect()},redo:function(){if(this.canvas.setCurrentSelection(null),this.figure instanceof draw2d.shape.node.Node&&null===this.connections){this.connections=new draw2d.util.ArrayList;for(var e=this.figure.getPorts(),t=0;t<e.getSize();t++)for(var n=e.get(t),i=0,o=n.getConnections().getSize();o>i;i++)this.connections.contains(n.getConnections().get(i))||this.connections.add(n.getConnections().get(i));for(var t=0;t<e.getSize();t++){var n=e.get(t);n.setCanvas(null)}}this.canvas.removeFigure(this.figure),null===this.connections&&(this.connections=new draw2d.util.ArrayList),null!==this.parent&&this.parent.removeChild(this.figure);for(var t=0;t<this.connections.getSize();++t)this.canvas.removeFigure(this.connections.get(t))}}),draw2d.command.CommandRemoveVertex=draw2d.command.Command.extend({NAME:"draw2d.command.CommandRemoveVertex",init:function(e,t){this._super(draw2d.Configuration.i18n.command.deleteVertex),this.line=e,this.index=t,this.oldPoint=e.getVertices().get(t).clone()},canExecute:function(){return!0},execute:function(){this.redo()},undo:function(){this.line.insertVertexAt(this.index,this.oldPoint.x,this.oldPoint.y)},redo:function(){this.line.removeVertexAt(this.index)}}),draw2d.command.CommandReplaceVertices=draw2d.command.Command.extend({NAME:"draw2d.command.CommandReplaceVertices",init:function(e,t,n){this._super(draw2d.Configuration.i18n.command.addSegment),this.line=e,this.originalVertices=t,this.newVertices=n},canExecute:function(){return!0},execute:function(){this.redo()},undo:function(){this.line.setVertices(this.originalVertices)},redo:function(){this.line.setVertices(this.newVertices)}}),draw2d.layout.connection.ConnectionRouter=Class.extend({NAME:"draw2d.layout.connection.ConnectionRouter",init:function(){},route:function(){throw"subclasses must implement the method [ConnectionRouter.route]"},onInstall:function(){},onUninstall:function(){},getPersistentAttributes:function(e,t){return t},setPersistentAttributes:function(){}}),draw2d.layout.connection.ManhattanConnectionRouter=draw2d.layout.connection.ConnectionRouter.extend({NAME:"draw2d.layout.connection.ManhattanConnectionRouter",MINDIST:0,TOL:.1,TOLxTOL:.01,TOGGLE_DIST:5,init:function(){this._super()},onInstall:function(e){e.installEditPolicy(new draw2d.policy.line.LineSelectionFeedbackPolicy)},route:function(e){var t=e.getStartPoint(),n=e.getSource().getConnectionDirection(e,e.getTarget()),i=e.getEndPoint(),o=e.getTarget().getConnectionDirection(e,e.getSource());this._route(e,i,o,t,n),this._paint(e)},_paint:function(e){for(var t=e.getVertices(),n=t.get(0),i=["M",(0|n.x)+.5," ",(0|n.y)+.5],o=1;o<t.getSize();o++)n=t.get(o),i.push("L",(0|n.x)+.5," ",(0|n.y)+.5);e.svgPathString=i.join("")},_route:function(e,t,n,i,o){var s,a,r=draw2d.geo.Rectangle.DIRECTION_UP,l=draw2d.geo.Rectangle.DIRECTION_RIGHT,u=draw2d.geo.Rectangle.DIRECTION_DOWN,d=draw2d.geo.Rectangle.DIRECTION_LEFT,c=t.x-i.x,p=t.y-i.y;if(c*c<this.TOLxTOL&&p*p<this.TOLxTOL)return e.addPoint(new draw2d.geo.Point(i.x,i.y)),void 0;if(n===d)if(c>0&&p*p<this.TOL&&o===l)s=i,a=o;else{if(0>c)s=new draw2d.geo.Point(t.x-this.MINDIST,t.y);else if(p>0&&o===u||0>p&&o===r)s=new draw2d.geo.Point(i.x,t.y);else if(n==o){var h=Math.min(t.x,i.x)-this.MINDIST;s=new draw2d.geo.Point(h,t.y)}else s=new draw2d.geo.Point(t.x-c/2,t.y);a=p>0?r:u}else if(n===l)if(0>c&&p*p<this.TOL&&o===d)s=i,a=o;else{if(c>0)s=new draw2d.geo.Point(t.x+this.MINDIST,t.y);else if(p>0&&o===u||0>p&&o===r)s=new draw2d.geo.Point(i.x,t.y);else if(n===o){var h=Math.max(t.x,i.x)+this.MINDIST;s=new draw2d.geo.Point(h,t.y)}else s=new draw2d.geo.Point(t.x-c/2,t.y);a=p>0?r:u}else if(n===u)if(c*c<this.TOL&&0>p&&o===r)s=i,a=o;else{if(p>0)s=new draw2d.geo.Point(t.x,t.y+this.MINDIST);else if(c>0&&o===l||0>c&&o===d)s=new draw2d.geo.Point(t.x,i.y);else if(n===o){var h=Math.max(t.y,i.y)+this.MINDIST;s=new draw2d.geo.Point(t.x,h)}else s=new draw2d.geo.Point(t.x,t.y-p/2);a=c>0?d:l}else if(n===r)if(c*c<this.TOL&&p>0&&o===u)s=i,a=o;else{if(0>p)s=new draw2d.geo.Point(t.x,t.y-this.MINDIST);else if(c>0&&o===l||0>c&&o===d)s=new draw2d.geo.Point(t.x,i.y);else if(n===o){var h=Math.min(t.y,i.y)-this.MINDIST;s=new draw2d.geo.Point(t.x,h)}else s=new draw2d.geo.Point(t.x,t.y-p/2);a=c>0?d:l}this._route(e,s,a,i,o),e.addPoint(t)}}),draw2d.layout.connection.ManhattanBridgedConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({NAME:"draw2d.layout.connection.ManhattanBridgedConnectionRouter",BRIDGE_HORIZONTAL_LR:" r 0 0 3 -4 7 -4 10 0 13 0 ",BRIDGE_HORIZONTAL_RL:" r 0 0 -3 -4 -7 -4 -10 0 -13 0 ",init:function(){this._super()},onInstall:function(e){e.installEditPolicy(new draw2d.policy.line.LineSelectionFeedbackPolicy)},route:function(e){var t=e.getStartPoint(),n=e.getSource().getConnectionDirection(e,e.getTarget()),i=e.getEndPoint(),o=e.getTarget().getConnectionDirection(e,e.getSource());this._route(e,i,o,t,n);var s=e.getCanvas().getIntersection(e).sort("x"),a=s.clone().reverse(),r=s,l=0,u=e.getVertices(),d=u.get(0),c=["M",(0|d.x)+.5," ",(0|d.y)+.5],p=d;for(l=1;l<u.getSize();l++){d=u.get(l);var h=5,m=this.BRIDGE_HORIZONTAL_LR;p.x>d.x&&(r=a,m=this.BRIDGE_HORIZONTAL_RL,h=-h),r.each(function(e,t){0==t.justTouching&&draw2d.shape.basic.Line.hit(1,p.x,p.y,d.x,d.y,t.x,t.y)===!0&&d.y===t.y&&(c.push(" L",(0|t.x-h)+.5," ",(0|t.y)+.5),c.push(m))}),c.push(" L",(0|d.x)+.5," ",(0|d.y)+.5),p=d}e.svgPathString=c.join("")}}),draw2d.layout.connection.InteractiveManhattanConnectionRouter=draw2d.layout.connection.ManhattanConnectionRouter.extend({NAME:"draw2d.layout.connection.InteractiveManhattanConnectionRouter",init:function(){this._super()},onInstall:function(e){e.installEditPolicy(new draw2d.policy.line.OrthogonalSelectionFeedbackPolicy),e._routingMetaData||(e._routingMetaData={routedByUserInteraction:!1,fromDir:-1,toDir:-1})},onUninstall:function(e){delete e._routingMetaData},route:function(e,t){0===t.getSize()||e._routingMetaData.routedByUserInteraction===!1?(this._super(e,t),e._routingMetaData.fromDir=e.getSource().getConnectionDirection(e,e.getTarget()),e._routingMetaData.toDir=e.getTarget().getConnectionDirection(e,e.getSource())):(this.halfRoute(e,t),this._paint(e))},halfRoute:function(e,t){var n=t.getSize(),i=e.getStartPoint(),o=e.getSource().getConnectionDirection(e,e.getTarget()),s=e.getEndPoint(),a=e.getTarget().getConnectionDirection(e,e.getSource()),r=Math.max,l=Math.min;if((e._routingMetaData.fromDir!==o||e._routingMetaData.toDir!==a)&&(e._routingMetaData.routedByUserInteraction=!1,this.route(e,t)),1===o&&3===a&&i.x>s.x&&4>=n&&(e._routingMetaData.routedByUserInteraction=!1,this.route(e,t)),t.each(function(t,n){e.addPoint(n)}),!i.equals(t.get(0))){var u=t.get(1),d=t.get(2);switch(e.setVertex(0,i),o){case draw2d.geo.Rectangle.DIRECTION_RIGHT:e.setVertex(1,r(i.x+10,u.x),i.y),e.setVertex(2,r(i.x+10,u.x),d.y);break;case draw2d.geo.Rectangle.DIRECTION_LEFT:e.setVertex(1,l(i.x-10,u.x),i.y),e.setVertex(2,l(i.x-10,u.x),d.y);break;case draw2d.geo.Rectangle.DIRECTION_UP:e.setVertex(1,i.x,l(i.y-10,u.y)),e.setVertex(2,d.x,l(i.y-10,u.y));break;case draw2d.geo.Rectangle.DIRECTION_DOWN:e.setVertex(1,i.x,r(i.y+10,u.y)),e.setVertex(2,d.x,r(i.y+10,u.y))}}if(!s.equals(t.get(n-1))){var u=t.get(n-2),d=t.get(n-3);switch(e.setVertex(n-1,s),a){case draw2d.geo.Rectangle.DIRECTION_RIGHT:e.setVertex(n-2,r(s.x+10,u.x),s.y),e.setVertex(n-3,r(s.x+10,u.x),d.y);break;case draw2d.geo.Rectangle.DIRECTION_LEFT:e.setVertex(n-2,l(s.x-10,u.x),s.y),e.setVertex(n-3,l(s.x-10,u.x),d.y);break;case draw2d.geo.Rectangle.DIRECTION_UP:e.setVertex(n-2,s.x,r(s.y+10,u.y)),e.setVertex(n-3,d.x,r(s.y+10,u.y));break;case draw2d.geo.Rectangle.DIRECTION_DOWN:e.setVertex(n-2,s.x,r(s.y+10,u.y)),e.setVertex(n-3,d.x,r(s.y+10,u.y))}}},canRemoveSegmentAt:function(e,t){var n=e.getVertices().getSize()-1;if(0>=t||t>=n)return!1;if(4>n)return!1;var i=e.getStartPoint(),o=e.getSource().getConnectionDirection(e,e.getTarget()),s=e.getEndPoint(),a=e.getTarget().getConnectionDirection(e,e.getSource());if(5>=n){if(o===draw2d.geo.Rectangle.DIRECTION_RIGHT&&a===draw2d.geo.Rectangle.DIRECTION_LEFT&&i.x>=s.x)return!1;if(o==draw2d.geo.Rectangle.DIRECTION_LEFT&a==draw2d.geo.Rectangle.DIRECTION_RIGHT&&i.x<=s.x)return!1;if(o==draw2d.geo.Rectangle.DIRECTION_UP&a==draw2d.geo.Rectangle.DIRECTION_DOWN&&i.y<=s.y)return!1;if(o==draw2d.geo.Rectangle.DIRECTION_DOWN&a==draw2d.geo.Rectangle.DIRECTION_UP&&i.y>=s.y)return!1;var r=new draw2d.Connection;r.lineSegments=new draw2d.util.ArrayList,r.vertices=new draw2d.util.ArrayList,r.sourcePort=e.sourcePort,r.targetPort=e.targetPort,r._routingMetaData={routedByUserInteraction:!1,fromDir:-1,toDir:-1},this.route(r,new draw2d.util.ArrayList);var l=e.getVertices().getSize()-1,u=r.getVertices().getSize()-1;if(u>=l)return!1}return!0},getPersistentAttributes:function(e,t){return t.vertex=[],e.getVertices().each(function(e,n){t.vertex.push({x:n.x,y:n.y})}),t.routingMetaData=$.extend({},e._routingMetaData),t},setPersistentAttributes:function(e,t){"undefined"!=typeof t.vertex&&(e.oldPoint=null,e.lineSegments=new draw2d.util.ArrayList,e.vertices=new draw2d.util.ArrayList,$.each(t.vertex,$.proxy(function(t,n){e.addPoint(n.x,n.y)
},this))),"undefinied"!=typeof t.routingMetaData&&(e._routingMetaData=$.extend({},t.routingMetaData))}}),draw2d.layout.locator.Locator=Class.extend({NAME:"draw2d.layout.locator.Locator",init:function(e){this.parent=e},getParent:function(){return this.parent},setParent:function(e){this.parent=e},relocate:function(){}}),draw2d.layout.locator.PortLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.PortLocator",init:function(){this._super()},applyConsiderRotation:function(e,t,n){var i=e.getParent(),o=i.getWidth()/2,s=i.getHeight()/2,a=i.getRotationAngle(),r=Raphael.matrix();if(r.rotate(a,o,s),90===a||270===a){var l=i.getHeight()/i.getWidth();r.scale(l,1/l,o,s)}e.setPosition(r.x(t,n),r.y(t,n))}}),draw2d.layout.locator.InputPortLocator=draw2d.layout.locator.PortLocator.extend({NAME:"draw2d.layout.locator.InputPortLocator",init:function(){this._super()},relocate:function(e,t){var n=t.getParent(),i=n.getHeight(),o=i/(n.getInputPorts().getSize()+1);this.applyConsiderRotation(t,0,o*(e+1))}}),draw2d.layout.locator.OutputPortLocator=draw2d.layout.locator.PortLocator.extend({NAME:"draw2d.layout.locator.OutputPortLocator",init:function(){this._super()},relocate:function(e,t){var n=t.getParent(),i=n.getHeight()/(n.getOutputPorts().getSize()+1);this.applyConsiderRotation(t,n.getWidth(),i*(e+1))}}),draw2d.layout.locator.ConnectionLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.ConnectionLocator",init:function(e){this._super(e)}}),draw2d.layout.locator.ManhattanMidpointLocator=draw2d.layout.locator.ConnectionLocator.extend({NAME:"draw2d.layout.locator.ManhattanMidpointLocator",init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getPoints(),o=Math.floor((i.getSize()-2)/2);if(!(i.getSize()<=o+1)){var s=i.get(o),a=i.get(o+1),r=0|(a.x-s.x)/2+s.x-t.getWidth()/2,l=0|(a.y-s.y)/2+s.y-t.getHeight()/2;t.setPosition(r,l)}}}),draw2d.layout.locator.PolylineMidpointLocator=draw2d.layout.locator.ManhattanMidpointLocator.extend({NAME:"draw2d.layout.locator.PolylineMidpointLocator",init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getVertices();if(0===i.getSize()%2)this._super(e,t);else{var e=Math.floor(i.getSize()/2),o=i.get(e);t.setPosition(o.x-t.getWidth()/2,o.y-t.getHeight()/2)}}}),draw2d.layout.locator.TopLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.TopLocator",init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getBoundingBox(),o=t.getBoundingBox();t.setPosition(i.w/2-o.w/2,-(o.h+2)+5)}}),draw2d.layout.locator.LabelLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.TopLocator",init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getBoundingBox(),o=t.getBoundingBox();t.setPosition(i.w/2-o.w/2+25,-(o.h+2)+5)}}),draw2d.layout.locator.CustomTopLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.CustomTopLocator",init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getBoundingBox(),o=t.getBoundingBox();t.setPosition(i.w/2-o.w/2,-(o.h+2)+5)}}),draw2d.layout.locator.BottomLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.BottomLocator",init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getBoundingBox(),o=t.getBoundingBox();t.setPosition(i.w/2-o.w/2,2+i.h)}}),draw2d.layout.locator.LeftLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.LeftLocator",init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getBoundingBox(),o=t.getBoundingBox();t.setPosition(-o.w+10,i.h/2-o.h/2-2),t.setColor("#0d0d0d")}}),draw2d.layout.locator.RightLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.RightLocator",init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getBoundingBox(),o=t.getBoundingBox();t.setPosition(i.w,i.h/2-o.h/2-4)}}),draw2d.layout.locator.RightLocatorFigure=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.RightLocatorFigure",init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getBoundingBox(),o=t.getBoundingBox();t.setPosition(i.w,i.h/2-o.h/2-4)}}),draw2d.layout.locator.CenterLocator=draw2d.layout.locator.Locator.extend({NAME:"draw2d.layout.locator.CenterLocator",init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getBoundingBox();if(t instanceof draw2d.shape.basic.Circle)t.setPosition(i.w/2,i.h/2);else{var o=t.getBoundingBox();t.setPosition(i.w/2-o.w/2,i.h/2-o.h/2)}}}),draw2d.policy.EditPolicy=Class.extend({NAME:"draw2d.policy.EditPolicy",init:function(){},onInstall:function(){},onUninstall:function(){}}),draw2d.policy.canvas.CanvasPolicy=draw2d.policy.EditPolicy.extend({NAME:"draw2d.policy.canvas.CanvasPolicy",init:function(){this._super()},onInstall:function(){},onUninstall:function(){},onClick:function(){},onMouseMove:function(){},onDoubleClick:function(){},snap:function(e,t,n){return n},onMouseDown:function(){},onMouseDrag:function(){},onMouseUp:function(){},onRightMouseDown:function(){},createMonochromGif:function(e,t,n,i){for(var o=String.fromCharCode(e%256)+String.fromCharCode(e/256)+String.fromCharCode(t%256)+String.fromCharCode(t/256),s="GIF89a"+o+"\x00\x00"+String.fromCharCode(i.red)+String.fromCharCode(i.green)+String.fromCharCode(i.blue)+"!\x00\x00\x00\x00,\x00\x00\x00\x00"+o+"\x00",a={bit:1,byte_:0,data:"",writeBit:function(e){e&&(this.byte_|=this.bit),this.bit<<=1,256==this.bit&&(this.bit=1,this.data+=String.fromCharCode(this.byte_),this.byte_=0)},get:function(){var e="",t=this.data;1!=this.bit&&(t+=String.fromCharCode(this.byte_));for(var n=0;n<t.length+1;n+=255)chunklen=t.length-n,0>chunklen&&(chunklen=0),chunklen>255&&(chunklen=255),e+=String.fromCharCode(chunklen)+t.substring(n,n+255);return e+"\x00"}},r=0;t>r;r++)for(var l=0;e>l;l++)a.writeBit(n[l+e*r]),a.writeBit(0),a.writeBit(0),a.writeBit(0),a.writeBit(0),a.writeBit(1);return s+=a.get()+";","data:image/gif;base64,"+draw2d.util.Base64.encode(s)}}),draw2d.policy.canvas.SelectionPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.SelectionPolicy",init:function(){this._super()},unselect:function(e,t){e.getSelection().remove(t),t.unselect(),e.selectionListeners.each(function(e,t){t.onSelectionChanged(null)})}}),draw2d.policy.canvas.SingleSelectionPolicy=draw2d.policy.canvas.SelectionPolicy.extend({NAME:"draw2d.policy.canvas.SingleSelectionPolicy",init:function(){this._super(),this.mouseMovedDuringMouseDown=!1,this.mouseDraggingElement=null,this.mouseDownElement=null},select:function(e,t){e.getSelection().getAll().contains(t)||(null!==e.getSelection().getPrimary()&&this.unselect(e,e.getSelection().getPrimary()),null!==t&&t.select(!0),e.getSelection().setPrimary(t),e.selectionListeners.each(function(e,n){n.onSelectionChanged(t)}))},onMouseDown:function(e,t,n){this.mouseMovedDuringMouseDown=!1;var i=!0;console.log(window.scrollX,window.scrollY);for(var o=e.getBestFigure(t+window.scrollX,n+window.scrollY);null!==o&&null!==o.getParent()&&!(o instanceof draw2d.Port);)o=o.getParent();null!==o&&o.isDraggable()&&(i=o.onDragStart(t-o.getAbsoluteX(),n-o.getAbsoluteY()),i===!1?(this.mouseDraggingElement=null,this.mouseDownElement=o):(this.mouseDraggingElement=o,this.mouseDownElement=o)),o!==e.getSelection().getPrimary()&&null!==o&&o.isSelectable()===!0&&(this.select(e,o),o instanceof draw2d.shape.basic.Line?o instanceof draw2d.Connection||(e.draggingLineCommand=o.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE)),null!==e.draggingLineCommand&&(e.draggingLine=o)):i===!1&&o.unselect())},onMouseDrag:function(e,t,n,i,o){if(this.mouseMovedDuringMouseDown=!0,null!==this.mouseDraggingElement){if(e.linesToRepaintAfterDragDrop.isEmpty()===!0&&this.mouseDraggingElement instanceof draw2d.shape.node.Node){var s=this.mouseDraggingElement.getConnections(),a=e.lineIntersections.clone();e.lineIntersections.each($.proxy(function(t,n){(s.contains(n.line)||s.contains(n.other))&&(a.remove(n),e.linesToRepaintAfterDragDrop.add(n.line),e.linesToRepaintAfterDragDrop.add(n.other))},this)),e.lineIntersections=a,e.linesToRepaintAfterDragDrop.each(function(e,t){t.svgPathString=null,t.repaint()})}var r=e.getSelection().getAll();r.contains(this.mouseDraggingElement)?r.each(function(e,s){s.onDrag(t,n,i,o)}):this.mouseDraggingElement.onDrag(t,n,i,o);var l=e.fromDocumentToCanvasCoordinate(e.mouseDownX+t/e.zoomFactor,e.mouseDownY+n/e.zoomFactor),u=e.getBestFigure(l.x,l.y,this.mouseDraggingElement);u!==e.currentDropTarget&&(null!==e.currentDropTarget&&(e.currentDropTarget.onDragLeave(this.mouseDraggingElement),e.currentDropTarget=null),null!==u&&(e.currentDropTarget=u.onDragEnter(this.mouseDraggingElement)))}else null===this.mouseDownElement||this.mouseDownElement instanceof draw2d.Connection||this.mouseDownElement.onPanning(t,n,i,o)},onMouseUp:function(e){if(null!==this.mouseDraggingElement){var t=e.getSelection().getAll();t.contains(this.mouseDraggingElement)?(e.getCommandStack().startTransaction(),e.getSelection().getAll().each(function(e,t){t.onDragEnd()}),e.getCommandStack().commitTransaction()):this.mouseDraggingElement.onDragEnd(),null!==e.currentDropTarget&&(this.mouseDraggingElement.onDrop(e.currentDropTarget),e.currentDropTarget.onDragLeave(this.mouseDraggingElement),e.currentDropTarget=null),this.mouseDraggingElement=null}null===this.mouseDownElement&&this.mouseMovedDuringMouseDown===!1&&this.select(e,null),this.mouseDownElement=null,this.mouseMovedDuringMouseDown=!1}}),draw2d.policy.canvas.PanningSelectionPolicy=draw2d.policy.canvas.SingleSelectionPolicy.extend({NAME:"draw2d.policy.canvas.PanningSelectionPolicy",init:function(){this._super()},onMouseDrag:function(e,t,n,i,o){if(this._super(e,t,n,i,o),null===this.mouseDraggingElement&&null===this.mouseDownElement){var s=e.getScrollArea();s.scrollTop(s.scrollTop()+o),s.scrollLeft(s.scrollLeft()+i)}}}),draw2d.policy.canvas.BoundingboxSelectionPolicy=draw2d.policy.canvas.SingleSelectionPolicy.extend({NAME:"draw2d.policy.canvas.BoundingboxSelectionPolicy",init:function(){this._super(),this.boundingBoxFigure1=null,this.boundingBoxFigure2=null,this.x=0,this.y=0},select:function(e,t){e.getSelection().getAll().contains(t)||(null!==t&&t.select(!0),e.getSelection().setPrimary(t),e.selectionListeners.each(function(e,n){n.onSelectionChanged(t)}))},onMouseDown:function(e,t,n,i){this.x=t,this.y=n;var o=e.getSelection().getAll();this.mouseMovedDuringMouseDown=!1;for(var s=!0,a=e.getBestFigure(t,n);null!==a&&null!==a.getParent()&&!(a instanceof draw2d.Port);)a=a.getParent();null!==a&&a.isDraggable()&&(s=a.onDragStart(t-a.getAbsoluteX(),n-a.getAbsoluteY()),s===!1?(this.mouseDraggingElement=null,this.mouseDownElement=a):(this.mouseDraggingElement=a,this.mouseDownElement=a)),i===!1&&(null===this.mouseDownElement||this.mouseDownElement.isResizeHandle!==!1||o.contains(this.mouseDownElement)||o.each($.proxy(function(t,n){this.unselect(e,n)},this))),a!==e.getSelection().getPrimary()&&null!==a&&a.isSelectable()===!0&&(this.select(e,a),a instanceof draw2d.shape.basic.Line?a instanceof draw2d.Connection||(e.draggingLineCommand=a.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE)),null!==e.draggingLineCommand&&(e.draggingLine=a)):s===!1&&a.unselect()),o=e.getSelection().getAll(),o.each($.proxy(function(t,n){var i=n.onDragStart(n.getAbsoluteX(),n.getAbsoluteY());n instanceof draw2d.shape.basic.Line||i===!1&&this.unselect(e,n)},this))},onMouseDrag:function(e,t,n,i,o){this._super(e,t,n,i,o),null===this.mouseDraggingElement&&null===this.mouseDownElement&&null===this.boundingBoxFigure1&&(this.boundingBoxFigure1=new draw2d.shape.basic.Rectangle(1,1),this.boundingBoxFigure1.setPosition(this.x,this.y),this.boundingBoxFigure1.setCanvas(e),this.boundingBoxFigure1.setBackgroundColor("#0f0f0f"),this.boundingBoxFigure1.setAlpha(.1),this.boundingBoxFigure2=new draw2d.shape.basic.Rectangle(1,1),this.boundingBoxFigure2.setPosition(this.x,this.y),this.boundingBoxFigure2.setCanvas(e),this.boundingBoxFigure2.setDashArray("- "),this.boundingBoxFigure2.setStroke(1),this.boundingBoxFigure2.setColor(new draw2d.util.Color(84,151,220)),this.boundingBoxFigure2.setBackgroundColor(null)),null!==this.boundingBoxFigure1&&(this.boundingBoxFigure1.setDimension(Math.abs(t),Math.abs(n)),this.boundingBoxFigure1.setPosition(this.x+Math.min(0,t),this.y+Math.min(0,n)),this.boundingBoxFigure2.setDimension(Math.abs(t),Math.abs(n)),this.boundingBoxFigure2.setPosition(this.x+Math.min(0,t),this.y+Math.min(0,n)))},onMouseUp:function(e,t,n){if(null===this.mouseDownElement)e.getSelection().getAll().each($.proxy(function(t,n){this.unselect(e,n)},this));else if(this.mouseDownElement instanceof draw2d.ResizeHandle||this.mouseDownElement instanceof draw2d.shape.basic.LineResizeHandle);else if(null!==this.mouseDownElement&&this.mouseMovedDuringMouseDown===!1){var i=e.getSelection().getAll();i.contains(this.mouseDownElement)||e.getSelection().getAll().each($.proxy(function(t,n){this.unselect(e,n)},this))}if(this._super(e,t,n),null!==this.boundingBoxFigure1){var o=this.boundingBoxFigure1.getBoundingBox();e.getFigures().each($.proxy(function(t,n){if(n.isSelectable()===!0&&n.getBoundingBox().isInside(o)){var i=n.onDragStart(n.getAbsoluteX(),n.getAbsoluteY());i===!0&&this.select(e,n,!1)}},this));var s=e.getSelection();e.getLines().each($.proxy(function(t,n){n instanceof draw2d.Connection&&s.contains(n.getSource().getParent())&&s.contains(n.getTarget().getParent())&&this.select(e,n,!1)},this)),this.boundingBoxFigure1.setCanvas(null),this.boundingBoxFigure1=null,this.boundingBoxFigure2.setCanvas(null),this.boundingBoxFigure2=null}}}),draw2d.policy.canvas.ReadOnlySelectionPolicy=draw2d.policy.canvas.SelectionPolicy.extend({NAME:"draw2d.policy.canvas.ReadOnlySelectionPolicy",init:function(){this._super()},onInstall:function(e){e.getAllPorts().each($.proxy(function(e,t){t.setVisible(!1)},this))},onUninstall:function(e){e.getAllPorts().each($.proxy(function(e,t){t.setVisible(!0)},this))},onMouseDrag:function(e,t,n,i,o){var s=e.getScrollArea();s.scrollTop(s.scrollTop()+o),s.scrollLeft(s.scrollLeft()+i)}}),draw2d.policy.canvas.DecorationPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.DecorationPolicy",init:function(){this._super()}}),draw2d.policy.canvas.FadeoutDecorationPolicy=draw2d.policy.canvas.DecorationPolicy.extend({NAME:"draw2d.policy.canvas.FadeoutDecorationPolicy",DEFAULT_FADEOUT_DURATION:30,TARGET_COLOR:new draw2d.util.Color("#707070"),init:function(){this._super(),this.alpha=1,this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION,this.canvas=null},onInstall:function(e){this.canvas=e,this.timerId=window.setInterval($.proxy(this.onTimer,this),100),this.hidePortsCounter=1,this.alpha=.1},onUninstall:function(){window.clearInterval(this.timerId),this.canvas.getAllPorts().each($.proxy(function(e,t){t.setAlpha(1)},this))},onTimer:function(){this.hidePortsCounter--,this.hidePortsCounter<=0&&this.alpha>0?(this.alpha=Math.max(0,this.alpha-.05),this.canvas.getAllPorts().each($.proxy(function(e,t){t.setAlpha(this.alpha)},this)),this.canvas.getSelection().getAll().each($.proxy(function(e,t){t.selectionHandles.each($.proxy(function(e,t){t.setAlpha(this.alpha)},this))},this))):this.hidePortsCounter>0&&1!==this.alpha&&(this.alpha=1,this.duringHide=!1,this.canvas.getAllPorts().each($.proxy(function(e,t){t.setAlpha(this.alpha)},this)),this.canvas.getSelection().getAll().each($.proxy(function(e,t){t.selectionHandles.each($.proxy(function(e,t){t.setAlpha(this.alpha)},this))},this)))},onMouseDown:function(){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseMove:function(){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseDrag:function(){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION},onMouseUp:function(){this.hidePortsCounter=this.DEFAULT_FADEOUT_DURATION}}),draw2d.policy.canvas.CoronaDecorationPolicy=draw2d.policy.canvas.DecorationPolicy.extend({NAME:"draw2d.policy.canvas.CoronaDecorationPolicy",init:function(){this._super(),this.startDragX=0,this.startDragY=0},onInstall:function(e){var t=e.getFigures();t.each(function(e,t){t.getPorts().each(function(e,t){t.setVisible(!1)})})},onUninstall:function(e){var t=e.getFigures();t.each(function(e,t){t.getPorts().each(function(e,t){t.setVisible(!0)})})},onMouseDown:function(e,t,n){this.startDragX=t,this.startDragY=n},onMouseMove:function(e,t,n){this.updatePorts(e,t,n)},onMouseDrag:function(e,t,n){this.updatePorts(e,this.startDragX+t,this.startDragY+n)},updatePorts:function(e,t,n){var i=e.getFigures();i.each(function(e,i){i.isVisible()===!0&&i.hitTest(t,n,50)===!0&&i instanceof draw2d.shape.node.Node?i.getPorts().each(function(e,t){t.setVisible(!0)}):i.getPorts().each(function(e,t){t.setVisible(!1)})})}}),draw2d.policy.canvas.SnapToEditPolicy=draw2d.policy.canvas.CanvasPolicy.extend({NAME:"draw2d.policy.canvas.SnapToEditPolicy",init:function(e){this._super(),this.grid=e},snap:function(e,t,n){return n}}),draw2d.policy.canvas.SnapToGridEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({NAME:"draw2d.policy.canvas.SnapToEditPolicy",GRID_COLOR:"#e0e0f0",GRID_WIDTH:10,init:function(e){this._super(),this.canvas=null,this.lines=null,this.grid=e?e:this.GRID_WIDTH},onInstall:function(e){this.canvas=e,this.showGrid()},onUninstall:function(){this.canvas=null,this.lines.remove()},snap:function(e,t,n){var i=t.getSnapToGridAnchor();return n.x=n.x+i.x,n.y=n.y+i.y,n.x=this.grid*Math.floor((n.x+this.grid/2)/this.grid),n.y=this.grid*Math.floor((n.y+this.grid/2)/this.grid),n.x=n.x-i.x,n.y=n.y-i.y,n},showGrid:function(){var e=this.canvas.initialWidth,t=this.canvas.initialHeight;this.lines=this.canvas.paper.set();for(var n=this.grid;e>n;n+=this.grid)this.lines.push(this.canvas.paper.path("M "+n+" 0 l 0 "+t));for(var i=this.grid;t>i;i+=this.grid)this.lines.push(this.canvas.paper.path("M 0 "+i+" l "+e+" 0"));this.lines.attr({stroke:this.GRID_COLOR}),this.lines.toBack()}}),draw2d.SnapToHelper={},draw2d.SnapToHelper.NORTH=1,draw2d.SnapToHelper.SOUTH=4,draw2d.SnapToHelper.WEST=8,draw2d.SnapToHelper.EAST=16,draw2d.SnapToHelper.CENTER=32,draw2d.SnapToHelper.NORTH_EAST=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.EAST,draw2d.SnapToHelper.NORTH_WEST=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.WEST,draw2d.SnapToHelper.SOUTH_EAST=draw2d.SnapToHelper.SOUTH|draw2d.SnapToHelper.EAST,draw2d.SnapToHelper.SOUTH_WEST=draw2d.SnapToHelper.SOUTH|draw2d.SnapToHelper.WEST,draw2d.SnapToHelper.NORTH_SOUTH=draw2d.SnapToHelper.NORTH|draw2d.SnapToHelper.SOUTH,draw2d.SnapToHelper.EAST_WEST=draw2d.SnapToHelper.EAST|draw2d.SnapToHelper.WEST,draw2d.SnapToHelper.NSEW=draw2d.SnapToHelper.NORTH_SOUTH|draw2d.SnapToHelper.EAST_WEST,draw2d.policy.canvas.SnapToGeometryEditPolicy=draw2d.policy.canvas.SnapToEditPolicy.extend({NAME:"draw2d.policy.canvas.SnapToGeometryEditPolicy",SNAP_THRESHOLD:3,LINE_COLOR:"#1387E6",FADEOUT_DURATION:300,init:function(){this._super(),this.rows=null,this.cols=null,this.vline=null,this.hline=null,this.canvas=null},onInstall:function(e){this.canvas=e},onUninstall:function(){this.canvas=null},onMouseUp:function(){this.rows=null,this.cols=null,this.hideVerticalLine(),this.hideHorizontalLine()},snap:function(e,t,n){if(t instanceof draw2d.ResizeHandle){var i=t.getSnapToGridAnchor();n.x+=i.x,n.y+=i.y;var o=new draw2d.geo.Point(n.x,n.y),s=t.getSnapToDirection(),a=this.snapPoint(s,n,o);return s&draw2d.SnapToHelper.EAST_WEST&&!(a&draw2d.SnapToHelper.EAST_WEST)?this.showVerticalLine(o.x):this.hideVerticalLine(),s&draw2d.SnapToHelper.NORTH_SOUTH&&!(a&draw2d.SnapToHelper.NORTH_SOUTH)?this.showHorizontalLine(o.y):this.hideHorizontalLine(),o.x-=i.x,o.y-=i.y,o}var r=new draw2d.geo.Rectangle(n.x,n.y,t.getWidth(),t.getHeight()),o=new draw2d.geo.Rectangle(n.x,n.y,t.getWidth(),t.getHeight()),s=draw2d.SnapToHelper.NSEW,a=this.snapRectangle(r,o);return s&draw2d.SnapToHelper.WEST&&!(a&draw2d.SnapToHelper.WEST)?this.showVerticalLine(o.x):s&draw2d.SnapToHelper.EAST&&!(a&draw2d.SnapToHelper.EAST)?this.showVerticalLine(o.getX()+o.getWidth()):this.hideVerticalLine(),s&draw2d.SnapToHelper.NORTH&&!(a&draw2d.SnapToHelper.NORTH)?this.showHorizontalLine(o.y):s&draw2d.SnapToHelper.SOUTH&&!(a&draw2d.SnapToHelper.SOUTH)?this.showHorizontalLine(o.getY()+o.getHeight()):this.hideHorizontalLine(),o.getTopLeft()},snapRectangle:function(e,t){var n=e.getTopLeft(),i=e.getBottomRight(),o=this.snapPoint(draw2d.SnapToHelper.NORTH_WEST,e.getTopLeft(),n);t.x=n.x,t.y=n.y;var s=this.snapPoint(draw2d.SnapToHelper.SOUTH_EAST,e.getBottomRight(),i);return o&draw2d.SnapToHelper.WEST&&(t.x=i.x-e.getWidth()),o&draw2d.SnapToHelper.NORTH&&(t.y=i.y-e.getHeight()),o|s},snapPoint:function(e,t,n){if((null===this.rows||null===this.cols)&&this.populateRowsAndCols(),0!==(e&draw2d.SnapToHelper.EAST)){var i=this.getCorrectionFor(this.cols,t.getX()-1,1);i!==this.SNAP_THRESHOLD&&(e&=~draw2d.SnapToHelper.EAST,n.x+=i)}if(0!==(e&draw2d.SnapToHelper.WEST)){var o=this.getCorrectionFor(this.cols,t.getX(),-1);o!==this.SNAP_THRESHOLD&&(e&=~draw2d.SnapToHelper.WEST,n.x+=o)}if(0!==(e&draw2d.SnapToHelper.SOUTH)){var s=this.getCorrectionFor(this.rows,t.getY()-1,1);s!==this.SNAP_THRESHOLD&&(e&=~draw2d.SnapToHelper.SOUTH,n.y+=s)}if(0!==(e&draw2d.SnapToHelper.NORTH)){var a=this.getCorrectionFor(this.rows,t.getY(),-1);a!==this.SNAP_THRESHOLD&&(e&=~draw2d.SnapToHelper.NORTH,n.y+=a)}return e},populateRowsAndCols:function(){var e=this.canvas.getSelection();this.rows=[],this.cols=[];for(var t=this.canvas.getFigures(),n=0,i=0;i<t.getSize();i++){var o=t.get(i);if(!e.contains(o)){var s=o.getBoundingBox();this.cols[3*n]={type:-1,location:s.getX()},this.rows[3*n]={type:-1,location:s.getY()},this.cols[3*n+1]={type:0,location:s.x+(s.getWidth()-1)/2},this.rows[3*n+1]={type:0,location:s.y+(s.getHeight()-1)/2},this.cols[3*n+2]={type:1,location:s.getRight()-1},this.rows[3*n+2]={type:1,location:s.getBottom()-1},n++}}},getCorrectionFor:function(e,t,n){for(var i=this.SNAP_THRESHOLD,o=this.SNAP_THRESHOLD,s=0;s<e.length;s++){var a,r=e[s];-1===r.type&&0!==n?(a=Math.abs(t-r.location),i>a&&(i=a,o=r.location-t)):0===r.type&&0===n?(a=Math.abs(t-r.location),i>a&&(i=a,o=r.location-t)):1===r.type&&0!==n&&(a=Math.abs(t-r.location),i>a&&(i=a,o=r.location-t))}return o},showVerticalLine:function(e){null==this.vline&&(this.vline=this.canvas.paper.path("M "+e+" 0 l 0 "+this.canvas.getHeight()).attr({stroke:this.LINE_COLOR,"stroke-width":1}))},hideVerticalLine:function(){if(null!=this.vline){var e=this.vline;e.animate({opacity:.1},this.FADEOUT_DURATION,function(){e.remove()}),this.vline=null}},showHorizontalLine:function(e){null==this.hline&&(this.hline=this.canvas.paper.path("M 0 "+e+" l "+this.canvas.getWidth()+" 0").attr({stroke:this.LINE_COLOR,"stroke-width":1}))},hideHorizontalLine:function(){if(null!=this.hline){var e=this.hline;e.animate({opacity:.1},this.FADEOUT_DURATION,function(){e.remove()}),this.hline=null}}}),draw2d.policy.figure.FigureEditPolicy=draw2d.policy.EditPolicy.extend({NAME:"draw2d.policy.figure.FigureEditPolicy",init:function(){this._super()},onRightMouseDown:function(){}}),draw2d.policy.figure.DragDropEditPolicy=draw2d.policy.EditPolicy.extend({NAME:"draw2d.policy.figure.DragDropEditPolicy",init:function(){this._super()},onDragStart:function(e,t){t.shape.attr({cursor:"move"}),t.isMoving=!1,t.originalAlpha=t.getAlpha()},onDrag:function(e,t){t.isMoving===!1&&(t.isMoving=!0,t.setAlpha(.4*t.originalAlpha))},onDragEnd:function(e,t){t.shape.attr({cursor:"default"}),t.isMoving=!1},adjustPosition:function(e,t,n){return t instanceof draw2d.geo.Point?t:new draw2d.geo.Point(t,n)},adjustDimension:function(e,t,n){return new draw2d.geo.Rectangle(0,0,t,n)},moved:function(){}}),draw2d.policy.figure.RegionEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.RegionEditPolicy",init:function(e,t,n,i){if(this._super(),e instanceof draw2d.geo.Rectangle)this.constRect=e;else{if("number"!=typeof i)throw"Invalid parameter. RegionConstraintPolicy need a rectangle as parameter in the constructor";this.constRect=new draw2d.geo.Rectangle(e,t,n,i)}},adjustPosition:function(e,t,n){var i=null;return i=t instanceof draw2d.geo.Point?new draw2d.geo.Rectangle(t.x,t.y,e.getWidth(),e.getHeight()):new draw2d.geo.Rectangle(t,n,e.getWidth(),e.getHeight()),i=this.constRect.moveInside(i),i.getTopLeft()}}),draw2d.policy.figure.VerticalEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.VerticalEditPolicy",init:function(){this._super()},adjustPosition:function(e,t,n){return new draw2d.geo.Point(e.getX(),n)}}),draw2d.policy.figure.HorizontalEditPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.HorizontalEditPolicy",init:function(){this._super()},adjustPosition:function(e,t){return new draw2d.geo.Point(t,e.getY())}}),draw2d.policy.figure.SelectionFeedbackPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.figure.SelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(){},onUnselect:function(e,t){t.selectionHandles.each(function(e,t){t.hide()}),t.selectionHandles=new draw2d.util.ArrayList},onInstall:function(e){this._super(e);var t=e.getCanvas();null!==t&&t.getSelection().contains(e)&&this.onSelect(t,e,!0)},onUninstall:function(e){this._super(e),"undefined"!=typeof e.selectionHandles&&(e.selectionHandles.each(function(e,t){t.hide()}),e.selectionHandles=new draw2d.util.ArrayList)}}),draw2d.policy.figure.ResizeSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.ResizeSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(e,t){if(t.selectionHandles.isEmpty()){var n=new draw2d.ResizeHandle(t,1),i=new draw2d.ResizeHandle(t,2),o=new draw2d.ResizeHandle(t,3),s=new draw2d.ResizeHandle(t,4),a=new draw2d.ResizeHandle(t,5),r=new draw2d.ResizeHandle(t,6),l=new draw2d.ResizeHandle(t,7),u=new draw2d.ResizeHandle(t,8);t.selectionHandles.add(n),t.selectionHandles.add(i),t.selectionHandles.add(o),t.selectionHandles.add(s),t.selectionHandles.add(a),t.selectionHandles.add(r),t.selectionHandles.add(l),t.selectionHandles.add(u),n.show(e),o.show(e),a.show(e),l.show(e),n.setDraggable(t.isResizeable()),o.setDraggable(t.isResizeable()),a.setDraggable(t.isResizeable()),l.setDraggable(t.isResizeable()),t.isResizeable()===!0?(n.setBackgroundColor(n.DEFAULT_COLOR),o.setBackgroundColor(o.DEFAULT_COLOR),a.setBackgroundColor(a.DEFAULT_COLOR),l.setBackgroundColor(l.DEFAULT_COLOR)):(n.setBackgroundColor(null),o.setBackgroundColor(null),a.setBackgroundColor(null),l.setBackgroundColor(null)),t.isStrechable()&&t.isResizeable()&&(i.setDraggable(t.isResizeable()),s.setDraggable(t.isResizeable()),r.setDraggable(t.isResizeable()),u.setDraggable(t.isResizeable()),i.show(e),s.show(e),r.show(e),u.show(e))}this.moved(e,t)},moved:function(e,t){if(!t.selectionHandles.isEmpty()){var n=t.getHeight(),i=t.getWidth(),o=t.getX(),s=t.getY(),a=t.selectionHandles.get(0),r=t.selectionHandles.get(2),l=t.selectionHandles.get(4),u=t.selectionHandles.get(6);if(a.setPosition(o-a.getWidth(),s-a.getHeight()),r.setPosition(o+i,s-r.getHeight()),l.setPosition(o+i,s+n),u.setPosition(o-u.getWidth(),s+n),t.isStrechable()){var d=t.selectionHandles.get(1),c=t.selectionHandles.get(3),p=t.selectionHandles.get(5),h=t.selectionHandles.get(7);d.setPosition(o+i/2-d.getWidth()/2,s-d.getHeight()),c.setPosition(o+i,s+n/2-c.getHeight()/2),p.setPosition(o+i/2-p.getWidth()/2,s+n),h.setPosition(o-h.getWidth(),s+n/2-h.getHeight()/2)}}}}),draw2d.policy.figure.RectangleSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.RectangleSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(e,t){if(t.selectionHandles.isEmpty()){var n=new draw2d.shape.basic.Rectangle;n.setBackgroundColor(null),n.setDashArray("- "),n.setColor("#2096fc"),n.setStroke(.5),n.hide=function(){n.setCanvas(null)},n.show=function(e){n.setCanvas(e),n.shape.toFront()},n.show(e);var i=new draw2d.ResizeHandle(t,1),o=new draw2d.ResizeHandle(t,2),s=new draw2d.ResizeHandle(t,3),a=new draw2d.ResizeHandle(t,4),r=new draw2d.ResizeHandle(t,5),l=new draw2d.ResizeHandle(t,6),u=new draw2d.ResizeHandle(t,7),d=new draw2d.ResizeHandle(t,8);t.selectionHandles.add(i),t.selectionHandles.add(o),t.selectionHandles.add(s),t.selectionHandles.add(a),t.selectionHandles.add(r),t.selectionHandles.add(l),t.selectionHandles.add(u),t.selectionHandles.add(d),i.show(e),s.show(e),r.show(e),u.show(e),i.setDraggable(t.isResizeable()),s.setDraggable(t.isResizeable()),r.setDraggable(t.isResizeable()),u.setDraggable(t.isResizeable()),t.isResizeable()===!0?(i.setBackgroundColor(i.DEFAULT_COLOR),s.setBackgroundColor(s.DEFAULT_COLOR),r.setBackgroundColor(r.DEFAULT_COLOR),u.setBackgroundColor(u.DEFAULT_COLOR)):(i.setBackgroundColor(null),s.setBackgroundColor(null),r.setBackgroundColor(null),u.setBackgroundColor(null)),t.isStrechable()&&t.isResizeable()&&(o.setDraggable(t.isResizeable()),a.setDraggable(t.isResizeable()),l.setDraggable(t.isResizeable()),d.setDraggable(t.isResizeable()),o.show(e),a.show(e),l.show(e),d.show(e)),t.selectionHandles.add(n)}this.moved(e,t)},moved:function(e,t){if(!t.selectionHandles.isEmpty()){var n=t.getHeight(),i=t.getWidth(),o=t.getX(),s=t.getY(),a=t.selectionHandles.get(0),r=t.selectionHandles.get(2),l=t.selectionHandles.get(4),u=t.selectionHandles.get(6);if(a.setPosition(o-a.getWidth(),s-a.getHeight()),r.setPosition(o+i,s-r.getHeight()),l.setPosition(o+i,s+n),u.setPosition(o-u.getWidth(),s+n),t.isStrechable()){var d=t.selectionHandles.get(1),c=t.selectionHandles.get(3),p=t.selectionHandles.get(5),h=t.selectionHandles.get(7);d.setPosition(o+i/2-d.getWidth()/2,s-d.getHeight()),c.setPosition(o+i,s+n/2-c.getHeight()/2),p.setPosition(o+i/2-p.getWidth()/2,s+n),h.setPosition(o-h.getWidth(),s+n/2-h.getHeight()/2)}var m=t.selectionHandles.get(8);m.setPosition(t.getPosition().translate(-2,-2)),m.setDimension(t.getWidth()+4,t.getHeight()+4),m.setRotationAngle(t.getRotationAngle())}}}),draw2d.policy.figure.AntSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.AntSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(e,t){if(t.selectionHandles.isEmpty()){var n=new draw2d.shape.basic.Rectangle;n.setBackgroundColor(null),n.setDashArray("- "),n.setColor("#00bdee"),n.hide=function(){n.setCanvas(null)},n.show=function(e){n.setCanvas(e),n.shape.toFront()},n.show(e),t.selectionHandles.add(n)}this.moved(e,t)},moved:function(e,t){if(!t.selectionHandles.isEmpty()){var n=t.selectionHandles.get(0);n.setPosition(t.getPosition().translate(1,1)),n.setDimension(t.getWidth(),t.getHeight()),n.setRotationAngle(t.getRotationAngle())}}}),draw2d.policy.figure.GlowSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.GlowSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(e,t){t.setGlow(!0),this.moved(e,t)},onUnselect:function(e,t){this._super(e,t),t.setGlow(!1)}}),draw2d.policy.figure.SlimSelectionFeedbackPolicy=draw2d.policy.figure.RectangleSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.SlimSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(e,t,n){if(this._super(e,t,n),!t.selectionHandles.isEmpty()){var i=new draw2d.shape.basic.Rectangle;i.setBackgroundColor(null),i.setColor("#3EB3F8"),i.hide=function(){i.setCanvas(null)},i.show=function(e){i.setCanvas(e),i.shape.toFront()},i.show(e),t.selectionHandles.each(function(e,t){t.setDimension(6,6),t.setRadius(0),t.setColor("#3EB3F8"),t.setBackgroundColor("#ffffff"),t.shape.toFront()}),t.selectionHandles.add(i)}this.moved(e,t)},moved:function(e,t){if(!t.selectionHandles.isEmpty()){this._super(e,t);var n=t.selectionHandles.get(t.selectionHandles.getSize()-1);n.setPosition(t.getPosition().translate(-4,-4)),n.setDimension(t.getWidth()+8,t.getHeight()+8)}}}),draw2d.policy.figure.PropWinFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.figure.PropWinFeedbackPolicy",init:function(){this._super();
var e=new draw2d.shape.icon.Phone(10,10);e.setCanvas(this)},onSelect:function(e,t){if(console.log(t.selectionHandles.isEmpty()),t.selectionHandles.isEmpty()){var n=new draw2d.shape.icon.Phone(10,10);n.show=function(e){n.setCanvas(e),n.shape.toFront()},n.show(e);var i=new draw2d.ResizeHandle(t,1),o=new draw2d.ResizeHandle(t,2),s=new draw2d.ResizeHandle(t,3),a=new draw2d.ResizeHandle(t,4),r=new draw2d.ResizeHandle(t,5),l=new draw2d.ResizeHandle(t,6),u=new draw2d.ResizeHandle(t,7),d=new draw2d.ResizeHandle(t,8);t.selectionHandles.add(i),t.selectionHandles.add(o),t.selectionHandles.add(s),t.selectionHandles.add(a),t.selectionHandles.add(r),t.selectionHandles.add(l),t.selectionHandles.add(u),t.selectionHandles.add(d),s.show(e),i.setDraggable(t.isResizeable()),s.setDraggable(t.isResizeable()),r.setDraggable(t.isResizeable()),u.setDraggable(t.isResizeable()),t.isResizeable()===!0?(i.setBackgroundColor(i.DEFAULT_COLOR),s.setBackgroundColor(s.DEFAULT_COLOR),r.setBackgroundColor(r.DEFAULT_COLOR),u.setBackgroundColor(u.DEFAULT_COLOR)):(i.setBackgroundColor(null),s.setBackgroundColor(null),r.setBackgroundColor(null),u.setBackgroundColor(null)),t.isStrechable()&&t.isResizeable()&&(o.setDraggable(t.isResizeable()),a.setDraggable(t.isResizeable()),l.setDraggable(t.isResizeable()),d.setDraggable(t.isResizeable()),o.show(e),a.show(e),l.show(e),d.show(e)),t.selectionHandles.add(n)}this.moved(e,t)},moved:function(e,t){if(!t.selectionHandles.isEmpty()){var n=t.getHeight(),i=t.getWidth(),o=t.getX(),s=t.getY(),a=t.selectionHandles.get(0),r=t.selectionHandles.get(2),l=t.selectionHandles.get(4),u=t.selectionHandles.get(6);if(a.setPosition(o-a.getWidth(),s-a.getHeight()),r.setPosition(o+i,s-r.getHeight()),l.setPosition(o+i,s+n),u.setPosition(o-u.getWidth(),s+n),t.isStrechable()){var d=t.selectionHandles.get(1),c=t.selectionHandles.get(3),p=t.selectionHandles.get(5),h=t.selectionHandles.get(7);d.setPosition(o+i/2-d.getWidth()/2,s-d.getHeight()),c.setPosition(o+i,s+n/2-c.getHeight()/2),p.setPosition(o+i/2-p.getWidth()/2,s+n),h.setPosition(o-h.getWidth(),s+n/2-h.getHeight()/2)}var m=t.selectionHandles.get(8);m.setPosition(t.getPosition().translate(-2,-2)),m.setDimension(t.getWidth()+4,t.getHeight()+4),m.setRotationAngle(t.getRotationAngle())}}}),draw2d.policy.figure.PropWindowSelectionFeedbackPolicy=draw2d.policy.figure.PropWinFeedbackPolicy.extend({NAME:"draw2d.policy.figure.PropWindowSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(e,t,n){this._super(e,t,n),t.selectionHandles.isEmpty()||t.selectionHandles.each(function(e,t){t.setDimension(20,20),t.setRadius(2)}),this.moved(e,t)}}),draw2d.policy.line.LineSelectionFeedbackPolicy=draw2d.policy.figure.SelectionFeedbackPolicy.extend({NAME:"draw2d.policy.line.LineSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(e,t){t.selectionHandles.isEmpty()&&(t.selectionHandles.add(new draw2d.shape.basic.LineStartResizeHandle(t)),t.selectionHandles.add(new draw2d.shape.basic.LineEndResizeHandle(t)),t.selectionHandles.each(function(n,i){i.setDraggable(t.isResizeable()),i.show(e)})),this.moved(e,t)},moved:function(e,t){t.selectionHandles.each(function(e,t){t.relocate()})}}),draw2d.policy.line.VertexSelectionFeedbackPolicy=draw2d.policy.line.LineSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.line.VertexSelectionFeedbackPolicy",init:function(){this._super()},onSelect:function(e,t,n){if(!GPLViewModel.isViewer()){this._super(e,t,n);for(var i=t.getVertices(),o=1;o<i.getSize()-1;o++){var s=new draw2d.shape.basic.VertexResizeHandle(t,o);t.selectionHandles.add(s),s.setDraggable(t.isResizeable()),s.show(e);var s=new draw2d.shape.basic.GhostVertexResizeHandle(t,o-1);t.selectionHandles.add(s),s.setDraggable(t.isResizeable()),s.show(e)}var s=new draw2d.shape.basic.GhostVertexResizeHandle(t,o-1);t.selectionHandles.add(s),s.setDraggable(t.isResizeable()),s.show(e),this.moved(e,t)}}}),draw2d.policy.line.OrthogonalSelectionFeedbackPolicy=draw2d.policy.line.LineSelectionFeedbackPolicy.extend({NAME:"draw2d.policy.line.OrthogonalSelectionFeedbackPolicy",init:function(){this._super(),this.ResizeHandle=draw2d.ResizeHandle.extend({NAME:"#ResizeHandle",init:function(e,t){this._super(e),this.index=t},onDragStart:function(){this._super(),this.command=this.getCanvas().getCurrentSelection().createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE_VERTICES)),this.vertex=this.owner.getVertices().get(this.index).clone()},onDrag:function(e,t,n,i){if(null==this.command)return!1;var o=this.owner.getSource().getConnectionDirection(this.owner,this.owner.getTarget()),s=this.owner.getTarget().getConnectionDirection(this.owner,this.owner.getSource());this.vertex.translate(n,i);var a=this.owner.getVertices(),r=a.getSize(),l=Math.max,u=Math.min;if(1===this.index){var d=a.get(this.index-1),c=a.get(this.index),p=a.get(this.index+1);if(c.x==p.x&&d.y==c.y)switch(o){case draw2d.geo.Rectangle.DIRECTION_RIGHT:this.owner.setVertex(1,l(d.x+10,this.vertex.x),c.y),this.owner.setVertex(2,l(d.x+10,this.vertex.x),p.y);break;case draw2d.geo.Rectangle.DIRECTION_LEFT:this.owner.setVertex(1,u(d.x-10,this.vertex.x),c.y),this.owner.setVertex(2,u(d.x-10,this.vertex.x),p.y)}else switch(o){case draw2d.geo.Rectangle.DIRECTION_UP:this.owner.setVertex(1,c.x,u(d.y-10,this.vertex.y)),this.owner.setVertex(2,p.x,u(d.y-10,this.vertex.y));break;case draw2d.geo.Rectangle.DIRECTION_DOWN:this.owner.setVertex(1,c.x,l(d.y+10,this.vertex.y)),this.owner.setVertex(2,p.x,l(d.y+10,this.vertex.y))}}else if(this.index===r-2){var p=a.get(this.index-1),c=a.get(this.index),d=a.get(this.index+1);if(d.x===c.x&&p.y===c.y)switch(s){case draw2d.geo.Rectangle.DIRECTION_UP:this.owner.setVertex(r-2,c.x,u(d.y-10,this.vertex.y)),this.owner.setVertex(r-3,p.x,u(d.y-10,this.vertex.y));break;case draw2d.geo.Rectangle.DIRECTION_DOWN:this.owner.setVertex(r-2,c.x,l(d.y+10,this.vertex.y)),this.owner.setVertex(r-3,p.x,l(d.y+10,this.vertex.y))}else switch(s){case draw2d.geo.Rectangle.DIRECTION_RIGHT:this.owner.setVertex(r-2,l(d.x+10,this.vertex.x),c.y),this.owner.setVertex(r-3,l(d.x+10,this.vertex.x),p.y);break;case draw2d.geo.Rectangle.DIRECTION_LEFT:this.owner.setVertex(r-2,u(d.x-10,this.vertex.x),c.y),this.owner.setVertex(r-3,u(d.x-10,this.vertex.x),p.y)}}else{var h=a.get(this.index-2),d=a.get(this.index-1),c=a.get(this.index),p=a.get(this.index+1),m=a.get(this.index+2);if(c.x===p.x&&c.y===d.y)if(0===this.index-2)switch(o){case draw2d.geo.Rectangle.DIRECTION_RIGHT:this.owner.setVertex(this.index-1,d.x,l(this.vertex.y,h.y-10)),this.owner.setVertex(this.index,this.vertex.x,l(this.vertex.y,h.y-10)),this.owner.setVertex(this.index+1,this.vertex.x,p.y);break;case draw2d.geo.Rectangle.DIRECTION_LEFT:this.owner.setVertex(this.index-1,d.x,u(this.vertex.y,h.y+10)),this.owner.setVertex(this.index,this.vertex.x,this.vertex.y),this.owner.setVertex(this.index+1,this.vertex.x,p.y);break;case draw2d.geo.Rectangle.DIRECTION_UP:this.owner.setVertex(this.index-1,d.x,u(this.vertex.y,h.y-10)),this.owner.setVertex(this.index,this.vertex.x,u(this.vertex.y,h.y-10)),this.owner.setVertex(this.index+1,this.vertex.x,p.y);break;case draw2d.geo.Rectangle.DIRECTION_DOWN:this.owner.setVertex(this.index-1,d.x,l(this.vertex.y,h.y+10)),this.owner.setVertex(this.index,this.vertex.x,l(this.vertex.y,h.y+10)),this.owner.setVertex(this.index+1,this.vertex.x,p.y)}else if(0===this.index-r+3)switch(s){case draw2d.geo.Rectangle.DIRECTION_RIGHT:this.owner.setVertex(this.index-1,d.x,this.vertex.y),this.owner.setVertex(this.index,l(this.vertex.x,m.x+10),this.vertex.y),this.owner.setVertex(this.index+1,l(this.vertex.x,m.x+10),p.y);break;case draw2d.geo.Rectangle.DIRECTION_LEFT:this.owner.setVertex(this.index-1,d.x,this.vertex.y),this.owner.setVertex(this.index,u(this.vertex.x,m.x-10),this.vertex.y),this.owner.setVertex(this.index+1,u(this.vertex.x,m.x-10),p.y)}else this.owner.setVertex(this.index-1,d.x,this.vertex.y),this.owner.setVertex(this.index,this.vertex),this.owner.setVertex(this.index+1,this.vertex.x,p.y);else if(d.x===c.x&&c.y===p.y)if(0===this.index-2)switch(o){case draw2d.geo.Rectangle.DIRECTION_RIGHT:this.owner.setVertex(this.index-1,l(this.vertex.x,h.x+10),d.y),this.owner.setVertex(this.index,l(this.vertex.x,h.x+10),this.vertex.y),this.owner.setVertex(this.index+1,p.x,this.vertex.y);break;case draw2d.geo.Rectangle.DIRECTION_LEFT:this.owner.setVertex(this.index-1,u(this.vertex.x,h.x-10),d.y),this.owner.setVertex(this.index,u(this.vertex.x,h.x-10),this.vertex.y),this.owner.setVertex(this.index+1,p.x,this.vertex.y)}else if(0===this.index-r+3)switch(s){case draw2d.geo.Rectangle.DIRECTION_RIGHT:this.owner.setVertex(this.index-1,d.x,u(this.vertex.y,m.y+10)),this.owner.setVertex(this.index,this.vertex.x,u(this.vertex.y,m.y+10)),this.owner.setVertex(this.index+1,this.vertex.x,p.y);break;case draw2d.geo.Rectangle.DIRECTION_LEFT:this.owner.setVertex(this.index-1,d.x,l(this.vertex.y,m.y-10)),this.owner.setVertex(this.index,this.vertex.x,l(this.vertex.y,m.y-10)),this.owner.setVertex(this.index+1,this.vertex.x,p.y)}else this.owner.setVertex(this.index-1,this.vertex.x,d.y),this.owner.setVertex(this.index,this.vertex),this.owner.setVertex(this.index+1,p.x,this.vertex.y)}return this.relocate(),null!==this.command&&this.command.updateVertices(this.owner.getVertices().clone()),this.owner._routingMetaData.routedByUserInteraction=!0,!0},onDragEnd:function(){var e=this.getCanvas().getCommandStack();return e.execute(this.command),this.command=null,!0},relocate:function(){var e=this.getWidth()/2,t=this.getHeight()/2,n=this.owner.getVertices().get(this.index);this.setPosition(n.x-e,n.y-t)}})},onSelect:function(e,t,n){this._super(e,t,n);for(var i=t.getVertices(),o=1;o<i.getSize()-1;o++){var s=new this.ResizeHandle(t,o);t.selectionHandles.add(s),s.setDraggable(t.isResizeable()),s.show(e)}this.moved(e,t)},removeSegment:function(e,t){var n=10,i=e.getVertices().getSize()-1,o=e.getStartPoint(),s=e.getSource().getConnectionDirection(e,e.getTarget()),a=e.getEndPoint(),r=e.getTarget().getConnectionDirection(e,e.getSource()),l=e.getVertex(t-1),u=e.getVertex(t),d=e.getVertex(t+1),c=e.getVertex(t+2);if(u.y===d.y){var p=(u.x+d.x)/2;1===t&&(s===draw2d.geo.Rectangle.DIRECTION_RIGHT?p=Math.max(p,o.x+n):s===draw2d.geo.Rectangle.DIRECTION_LEFT&&(p=Math.min(p,o.x-n))),t===i-2&&(r===draw2d.geo.Rectangle.DIRECTION_RIGHT?p=Math.max(p,a.x+n):r===draw2d.geo.Rectangle.DIRECTION_LEFT&&(p=Math.min(p,a.x-n))),e.setVertex(t-1,new draw2d.geo.Point(p,l.y)),e.setVertex(t+2,new draw2d.geo.Point(p,c.y)),e.removeVertexAt(t),e.removeVertexAt(t),e._routingMetaData.routedByUserInteraction=!0}else if(u.x===d.x){var h=(u.y+d.y)/2;1===t&&(s===draw2d.geo.Rectangle.DIRECTION_RIGHT?h=o.y:s===draw2d.geo.Rectangle.DIRECTION_LEFT&&(h=o.y)),t===i-2&&(r===draw2d.geo.Rectangle.DIRECTION_RIGHT?h=a.y:r===draw2d.geo.Rectangle.DIRECTION_LEFT&&(h=a.y)),e.setVertex(t-1,new draw2d.geo.Point(l.x,h)),e.setVertex(t+2,new draw2d.geo.Point(c.x,h)),e.removeVertexAt(t),e.removeVertexAt(t),e._routingMetaData.routedByUserInteraction=!0}},splitSegment:function(e,t,n,i){var o=e.getVertices().getSize()-1,s=e.getVertex(t),a=e.getVertex(t+1),r=40;if(s.x==a.x)if(e._routingMetaData.routedByUserInteraction=!0,1===o){var l=s.getDistance(a)/4/2,u=new draw2d.geo.Point(s.x,i-l),d=new draw2d.geo.Point(a.x+r,i-l),c=new draw2d.geo.Point(a.x+r,i+l),p=new draw2d.geo.Point(a.x,i+l);e.insertVertexAt(t+1,u),e.insertVertexAt(t+2,d),e.insertVertexAt(t+3,c),e.insertVertexAt(t+4,p)}else{var u=new draw2d.geo.Point(s.x-r/2,i),d=new draw2d.geo.Point(a.x+r/2,i);e.setVertex(t,new draw2d.geo.Point(u.x,s.y)),e.setVertex(t+1,new draw2d.geo.Point(d.x,a.y)),e.insertVertexAt(t+1,u),e.insertVertexAt(t+2,d)}else if(s.y==a.y)if(e._routingMetaData.routedByUserInteraction=!0,1===o){var l=s.getDistance(a)/4/2,u=new draw2d.geo.Point(n-l,s.y),d=new draw2d.geo.Point(n-l,s.y-r),c=new draw2d.geo.Point(n+l,s.y-r),p=new draw2d.geo.Point(n+l,s.y);e.insertVertexAt(t+1,u),e.insertVertexAt(t+2,d),e.insertVertexAt(t+3,c),e.insertVertexAt(t+4,p)}else{var u=new draw2d.geo.Point(0,0),d=new draw2d.geo.Point(0,0);0===t?(u.x=n,u.y=s.y,d.x=n,d.y=a.y+r,e.setVertex(t+1,new draw2d.geo.Point(a.x,d.y))):t===o-1?(u.x=n,u.y=s.y-r,d.x=n,d.y=a.y,e.setVertex(t,new draw2d.geo.Point(s.x,u.y))):(u.x=n,u.y=s.y-r/2,d.x=n,d.y=a.y+r/2,e.setVertex(t,new draw2d.geo.Point(s.x,u.y)),e.setVertex(t+1,new draw2d.geo.Point(a.x,d.y))),e.insertVertexAt(t+1,u),e.insertVertexAt(t+2,d)}},onRightMouseDown:function(e,t,n){var i=e.hitSegment(t,n),o={split:{name:draw2d.Configuration.i18n.menu.addSegment}};null!==i&&(e.getRouter().canRemoveSegmentAt(e,i.index)&&(o.remove={name:draw2d.Configuration.i18n.menu.deleteSegment}),$.contextMenu({selector:"body",events:{hide:function(){$.contextMenu("destroy")}},callback:$.proxy(function(o){switch(o){case"remove":var s=e.getVertices().clone(!0);this.removeSegment(e,i.index);var a=e.getVertices().clone(!0);e.getCanvas().getCommandStack().execute(new draw2d.command.CommandReplaceVertices(e,s,a));break;case"split":var s=e.getVertices().clone(!0);this.splitSegment(e,i.index,t,n);var a=e.getVertices().clone(!0);e.getCanvas().getCommandStack().execute(new draw2d.command.CommandReplaceVertices(e,s,a))}},this),x:t,y:n,items:o}))}}),draw2d.policy.port.PortFeedbackPolicy=draw2d.policy.figure.DragDropEditPolicy.extend({NAME:"draw2d.policy.port.PortFeedbackPolicy",init:function(){this._super()},onHoverEnter:function(){},onHoverLeave:function(){}}),draw2d.policy.port.IntrusivePortsFeedbackPolicy=draw2d.policy.port.PortFeedbackPolicy.extend({NAME:"draw2d.policy.port.IntrusivePortsFeedbackPolicy",init:function(){this._super(),this.connectionLine=null,this.tweenable=null},onDragStart:function(e,t){var n=0;t.getDropTargets().each(function(e,t){t.__beforeInflate=t.getWidth(),n=t.__beforeInflate});var i=t.getDropTargets();i.grep(function(e){return e.NAME!=t.NAME&&e.parent!==t.parent||e instanceof draw2d.HybridPort||t instanceof draw2d.HybridPort}),this.tweenable=new Tweenable,this.tweenable.tween({from:{size:n/2},to:{size:n},duration:200,easing:"easeOutSine",step:function(){i.each(function(){})}}),this.connectionLine=new draw2d.shape.basic.Line,this.connectionLine.setCanvas(e),this.connectionLine.getShapeElement(),this.connectionLine.setDashArray("- "),this.connectionLine.setColor("#30c48a"),this.onDrag(e,t)},onDrag:function(e,t){var n=t.ox+t.getParent().getAbsoluteX(),i=t.oy+t.getParent().getAbsoluteY();this.connectionLine.setStartPoint(n,i),this.connectionLine.setEndPoint(t.getAbsoluteX(),t.getAbsoluteY())},onDragEnd:function(e,t){this.tweenable.stop(!1),this.tweenable=null,t.getDropTargets().each(function(e,t){t.shape.attr({rx:t.__beforeInflate/2,ry:t.__beforeInflate/2}),t.width=t.height=t.__beforeInflate}),this.connectionLine.setCanvas(null),this.connectionLine=null},onHoverEnter:function(e,t,n){this.connectionLine.setGlow(!0),n.setGlow(!0)},onHoverLeave:function(e,t,n){n.setGlow(!1),this.connectionLine.setGlow(!1)}}),draw2d.policy.port.ElasticStrapFeedbackPolicy=draw2d.policy.port.PortFeedbackPolicy.extend({NAME:"draw2d.policy.port.ElasticStrapFeedbackPolicy",init:function(){this._super(),this.connectionLine=null},onDragStart:function(e,t){this.connectionLine=new draw2d.shape.basic.Line,this.connectionLine.setCanvas(e),this.connectionLine.getShapeElement(),this.onDrag(e,t)},onDrag:function(e,t){var n=t.ox+t.getParent().getAbsoluteX(),i=t.oy+t.getParent().getAbsoluteY();this.connectionLine.setStartPoint(n,i),this.connectionLine.setEndPoint(t.getAbsoluteX(),t.getAbsoluteY())},onDragEnd:function(){this.connectionLine.setCanvas(null),this.connectionLine=null},onHoverEnter:function(e,t,n){this.connectionLine.setGlow(!0),n.setGlow(!0)},onHoverLeave:function(e,t,n){n.setGlow(!1),this.connectionLine.setGlow(!1)}}),draw2d.Configuration={version:"4.4.1",i18n:{command:{move:"Move Shape",deleteShape:"Delete Shape",moveShape:"Move Shape",moveLine:"Move Line",addShape:"Add Shape",moveVertex:"Move Vertex",moveVertices:"Move Vertices",deleteVertex:"Delete Vertex",resizeShape:"Resize Shape",collection:"Execute Commands",addVertex:"Add Vertex",connectPorts:"Connect Ports"},menu:{deleteSegment:"Delete Segment",addSegment:"Add Segment"},dialog:{filenamePrompt:"Enter Filename:"}},color:{resizeHandle:"#5bcaff",vertexHandle:"#5bcaff"}},draw2d.Canvas=Class.extend({NAME:"draw2d.Canvas",init:function(e,t,n){this.setScrollArea(document.body),this.canvasId=e,this.html=$("#"+e),this.html.css({cursor:"default"}),"undefined"!=typeof t?(this.initialWidth=t,this.initialHeight=n):(this.initialWidth=this.getWidth(),this.initialHeight=this.getHeight()),this.html.css({"-webkit-tap-highlight-color":"rgba(0,0,0,0)"}),"undefined"!=typeof this.html.droppable&&(this.html.droppable({accept:".draw2d_droppable",over:$.proxy(function(e,t){this.onDragEnter(t.draggable)},this),out:$.proxy(function(e,t){this.onDragLeave(t.draggable)},this),drop:$.proxy(function(e,t){e=this._getEvent(e);var n=this.fromDocumentToCanvasCoordinate(e.clientX,e.clientY);this.onDrop(t.draggable,n.getX(),n.getY())},this)}),$(".draw2d_droppable").draggable({appendTo:"body",stack:"body",zIndex:27e3,helper:"clone",drag:$.proxy(function(e,t){e=this._getEvent(e);var n=this.fromDocumentToCanvasCoordinate(e.clientX,e.clientY);this.onDrag(t.draggable,n.getX(),n.getY())},this),stop:function(){this.isInExternalDragOperation=!1},start:function(e,t){this.isInExternalDragOperation=!0,$(t.helper).addClass("shadow")}})),this.paper="undefined"!=typeof n?Raphael(e,t,n):Raphael(e,this.getWidth(),this.getHeight()),this.paper.canvas.style.position="absolute",this.zoomFactor=1,this.selection=new draw2d.Selection,this.currentDropTarget=null,this.isInExternalDragOperation=!1,this.currentHoverFigure=null,this.editPolicy=new draw2d.util.ArrayList,this.figures=new draw2d.util.ArrayList,this.lines=new draw2d.util.ArrayList,this.commonPorts=new draw2d.util.ArrayList,this.dropTargets=new draw2d.util.ArrayList,this.resizeHandles=new draw2d.util.ArrayList,this.selectionListeners=new draw2d.util.ArrayList,this.commandStack=new draw2d.command.CommandStack,this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList,this.lineIntersections=new draw2d.util.ArrayList,this.commandStack.addEventListener($.proxy(function(e){e.isPostChangeEvent()===!0&&(this.calculateConnectionIntersection(),this.linesToRepaintAfterDragDrop.each(function(e,t){t.svgPathString=null,t.repaint()}),this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList)},this)),this.mouseDown=!1,this.mouseDownX=0,this.mouseDownY=0,this.mouseDragDiffX=0,this.mouseDragDiffY=0,this.html.bind("mouseup touchend",$.proxy(function(e){if(!GPLViewModel.isViewer()&&this.mouseDown!==!1){e=this._getEvent(e),this.calculateConnectionIntersection(),this.mouseDown=!1;var t=this.fromDocumentToCanvasCoordinate(e.clientX,e.clientY);this.editPolicy.each($.proxy(function(e,n){n.onMouseUp(this,t.x,t.y)},this)),this.mouseDragDiffX=0,this.mouseDragDiffY=0}},this)),this.html.bind("mousemove touchmove",$.proxy(function(e){if(!GPLViewModel.isViewer())if(e=this._getEvent(e),this.mouseDown===!1){var t=this.fromDocumentToCanvasCoordinate(e.clientX,e.clientY);try{var n=this.getBestFigure(t.x,t.y);n!==this.currentHoverFigure&&null!==this.currentHoverFigure&&this.currentHoverFigure.onMouseLeave(),n!==this.currentHoverFigure&&null!==n&&n.onMouseEnter(),this.currentHoverFigure=n}catch(i){console.log(i)}this.editPolicy.each($.proxy(function(e,n){n.onMouseMove(this,t.x,t.y)},this))}else{var o=(e.clientX-this.mouseDownX)*this.zoomFactor,s=(e.clientY-this.mouseDownY)*this.zoomFactor;this.editPolicy.each($.proxy(function(e,t){t.onMouseDrag(this,o,s,o-this.mouseDragDiffX,s-this.mouseDragDiffY)},this)),this.mouseDragDiffX=o,this.mouseDragDiffY=s}},this)),this.html.bind("mousedown touchstart",$.proxy(function(e){var t=null;switch(e.which){case 1:case 0:e.preventDefault(),e=this._getEvent(e),this.mouseDownX=e.clientX,this.mouseDownY=e.clientY,this.mouseDragDiffX=0,this.mouseDragDiffY=0,t=this.fromDocumentToCanvasCoordinate(e.clientX,e.clientY),this.mouseDown=!0,this.editPolicy.each($.proxy(function(n,i){i.onMouseDown(this,t.x,t.y,e.shiftKey,e.ctrlKey)},this));break;case 3:e.preventDefault(),e=this._getEvent(e),t=this.fromDocumentToCanvasCoordinate(e.clientX,e.clientY);var n=this.getBestFigure(t.x,t.y);null!==n?(n.select(!0),"function"==typeof n.onDoubleClick&&n.onDoubleClick(),GPLViewModel.isViewer()?"function"==typeof n.openPointReview&&n.openPointReview():(this.selectionListeners.each(function(e,t){t.onSelectionChanged(n)}),console.log(e),this.onRightMouseDown(t.x,t.y,e.shiftKey,e.ctrlKey))):this.onRightMouseDown(t.x,t.y);break;case 2:}},this)),$(document).bind("keydown",$.proxy(function(e){if(!$(e.target).is("input")){var t=e.ctrlKey;this.onKeyDown(e.keyCode,t)}},this))},hideDecoration:function(){},showDecoration:function(){},calculateConnectionIntersection:function(){this.lineIntersections=new draw2d.util.ArrayList;for(var e=this.getLines().clone();e.getSize()>0;){var t=e.removeElementAt(0);e.each($.proxy(function(e,n){var i=t.intersection(n);i.getSize()>0&&(this.lineIntersections.add({line:t,other:n,intersection:i}),this.lineIntersections.add({line:n,other:t,intersection:i}))},this))}},clear:function(){this.lines.clone().each($.proxy(function(e,t){this.removeFigure(t)},this)),this.figures.clone().each($.proxy(function(e,t){this.removeFigure(t)},this)),this.zoomFactor=1,this.selection.clear(),this.currentDropTarget=null,this.isInExternalDragOperation=!1,this.figures=new draw2d.util.ArrayList,this.lines=new draw2d.util.ArrayList,this.commonPorts=new draw2d.util.ArrayList,this.dropTargets=new draw2d.util.ArrayList,this.commandStack.markSaveLocation(),this.linesToRepaintAfterDragDrop=new draw2d.util.ArrayList,this.lineIntersections=new draw2d.util.ArrayList,this.selectionListeners.each(function(e,t){t.onSelectionChanged(null)})},installEditPolicy:function(e){e instanceof draw2d.policy.canvas.SelectionPolicy?(this.getSelection().getAll().each(function(e,t){t.unselect()}),this.editPolicy.grep($.proxy(function(e){var t=!(e instanceof draw2d.policy.canvas.SelectionPolicy);return t===!1&&e.onUninstall(this),t},this))):e instanceof draw2d.policy.canvas.SnapToEditPolicy&&this.editPolicy.grep($.proxy(function(e){var t=!(e instanceof draw2d.policy.canvas.SnapToEditPolicy);return t===!1&&e.onUninstall(this),t},this)),e.onInstall(this),this.editPolicy.add(e)},uninstallEditPolicy:function(e){e instanceof draw2d.policy.EditPolicy&&this.editPolicy.grep($.proxy(function(t){return t===e||t.NAME===e.NAME?(t.onUninstall(this),!1):!0},this))},setZoom:function(e,t){var n=$.proxy(function(e){this.zoomFactor=Math.min(Math.max(.01,e),10);var t=0|this.initialWidth*this.zoomFactor,n=0|this.initialHeight*this.zoomFactor;this.paper.setViewBox(0,0,t,n)},this);if(t){var i=new Tweenable;i.tween({from:{x:this.zoomFactor},to:{x:e},duration:300,easing:"easeOutSine",step:function(e){n(e.x)}})}else n(e)},getZoom:function(){return this.zoomFactor},fromDocumentToCanvasCoordinate:function(e,t){return new draw2d.geo.Point((e-this.getAbsoluteX()+this.getScrollLeft())*this.zoomFactor,(t-this.getAbsoluteY()+this.getScrollTop())*this.zoomFactor)},_fromDocumentToCanvasCoordinate_IE8_HACK:function(e,t){return new draw2d.geo.Point((e-this.getAbsoluteX())*this.zoomFactor,(t-this.getAbsoluteY())*this.zoomFactor)},fromCanvasToDocumentCoordinate:function(e,t){return new draw2d.geo.Point(e*(1/this.zoomFactor)+this.getAbsoluteX()-this.getScrollLeft(),t*(1/this.zoomFactor)+this.getAbsoluteY()-this.getScrollTop())},getHtmlContainer:function(){return this.html},_getEvent:function(e){if("undefined"!=typeof e.originalEvent){if(e.originalEvent.touches&&e.originalEvent.touches.length)return e.originalEvent.touches[0];if(e.originalEvent.changedTouches&&e.originalEvent.changedTouches.length)return e.originalEvent.changedTouches[0]}return e},setScrollArea:function(e){this.scrollArea=$(e)},getScrollArea:function(){return this.scrollArea},getScrollLeft:function(){return this.scrollArea.scrollLeft()},getScrollTop:function(){return this.scrollArea.scrollTop()},getAbsoluteX:function(){return this.html.offset().left},getAbsoluteY:function(){return this.html.offset().top},getWidth:function(){return this.html.width()},getHeight:function(){return this.html.height()},addFigure:function(e,t,n){e.getCanvas()!==this&&(e.setCanvas(this),e.getShapeElement(),e instanceof draw2d.shape.basic.Line?(this.lines.add(e),this.linesToRepaintAfterDragDrop=this.lines):(this.figures.add(e),"undefined"!=typeof n&&e.setPosition(t,n)),e.repaint(),e.fireMoveEvent())},removeFigure:function(e){this.editPolicy.each($.proxy(function(t,n){"function"==typeof n.unselect&&n.unselect(this,e)},this)),e instanceof draw2d.shape.basic.Line?this.lines.remove(e):this.figures.remove(e),e.setCanvas(null),e instanceof draw2d.Connection&&e.disconnect()},getLines:function(){return this.lines},getFigures:function(){return this.figures},getLine:function(e){for(var t=this.lines.getSize(),n=0;t>n;n++){var i=this.lines.get(n);if(i.getId()===e)return i}return null},getFigure:function(e){var t=null;return this.figures.each(function(n,i){return i.id===e?(t=i,!1):void 0}),t},getIntersection:function(e){var t=new draw2d.util.ArrayList;return this.lineIntersections.each($.proxy(function(n,i){i.line===e&&i.intersection.each(function(e,n){t.add({x:n.x,y:n.y,justTouching:n.justTouching,other:i.other})})},this)),t},snapToHelper:function(e,t){return this.editPolicy.each($.proxy(function(n,i){t=i.snap(this,e,t)},this)),t},registerPort:function(e){e.targets=this.dropTargets,this.commonPorts.contains(e)||(this.commonPorts.add(e),this.dropTargets.add(e))},unregisterPort:function(e){e.targets=null,this.commonPorts.remove(e),this.dropTargets.remove(e)},getAllPorts:function(){return this.commonPorts},getCommandStack:function(){return this.commandStack},getCurrentSelection:function(){return this.selection.getPrimary()},getAllSelection:function(){return this.selection.getAll()},getSelection:function(){return this.selection},setCurrentSelection:function(e){this.selection.each($.proxy(function(e,t){this.editPolicy.each($.proxy(function(e,n){"function"==typeof n.unselect&&n.unselect(this,t)},this))},this)),this.editPolicy.each($.proxy(function(t,n){"function"==typeof n.select&&n.select(this,e)},this))},addSelectionListener:function(e){if(null!==e)if("function"==typeof e)this.selectionListeners.add({onSelectionChanged:e});else{if("function"!=typeof e.onSelectionChanged)throw"Object doesn't implement required callback method [onSelectionChanged]";this.selectionListeners.add(e)}},removeSelectionListener:function(e){this.selectionListeners=this.selectionListeners.grep(function(t){return t!==e&&t.onSelectionChanged!==e})},getBestFigure:function(e,t,n){var i=null,o=null,s=0,a=null;if(!GPLViewModel.isViewer()){for(s=0,len=this.resizeHandles.getSize();len>s;s++)if(o=this.resizeHandles.get(s),o.isVisible()===!0&&o.hitTest(e,t)===!0&&o!==n)return o;for(s=0,len=this.commonPorts.getSize();len>s;s++)if(o=this.commonPorts.get(s),o!==n&&o.isVisible()===!0&&o.hitTest(e,t)===!0)return o;if(i=this.getBestLine(e,t,n),null!==i)return i}for(s=0;s<this.figures.getSize();s++){var r=this.figures.get(s);r.isVisible()===!0&&r.hitTest(e,t+$(window).scrollTop())===!0&&r!==n?null===i?i=r:i.getZOrder()<r.getZOrder()&&(i=r):(a=r.getChildren(),a.each(function(n,o){return o.isVisible()===!0&&o.hitTest(e,t)===!0?(i=o,!1):!0}))}if(null!==i)return i;var l=this.lines.getSize();for(s=0;l>s;s++){var u=this.lines.get(s);a=u.getChildren(),a.each(function(n,o){return o.isVisible()===!0&&o.hitTest(e,t)===!0?(i=o,!1):!0})}return i},getBestLine:function(e,t,n){for(var i=null,o=this.lines.getSize(),s=0;o>s;s++){var a=this.lines.get(s);if(a.isVisible()===!0&&a.hitTest(e,t)===!0&&a!==n&&null===i){i=a;break}}return i},hideSnapToHelperLines:function(){this.hideSnapToHelperLineHorizontal(),this.hideSnapToHelperLineVertical()},hideSnapToHelperLineHorizontal:function(){},hideSnapToHelperLineVertical:function(){},onDragEnter:function(){},onDrag:function(){},onDragLeave:function(){},onDrop:function(){},onKeyDown:function(e,t){if(46==e){if(GPLViewModel.isViewer())return;this.processDelete()}else if(90==e&&t){if(GPLViewModel.isViewer())return;this.undoAction()}else if(89==e&&t){if(GPLViewModel.isViewer())return;this.commandStack.redo(),this.validateAllPorts()}else if(83==e&&t){if(GPLViewModel.isViewer())return;event.preventDefault(),this.openSaveDialog()}else if(70==e&&t){if(GPLViewModel.isViewer())return;event.preventDefault(),this.saveWork()}else if(187===e)event.preventDefault(),$("#zoomSlider").jqxSlider("incrementValue");else if(189===e)event.preventDefault(),$("#zoomSlider").jqxSlider("decrementValue");else if(75===e&&t){if(GPLViewModel.isViewer())return;event.preventDefault(),this.displayJSON(!0)}else if(77===e&&t){if(GPLViewModel.isViewer())return;event.preventDefault();var n=new draw2d.io.png.Writer,i=n.marshal(this,!1);$("#preview").html("").append(i)}else if(65===e&&t){if(GPLViewModel.isViewer())return;event.preventDefault(),this.activateSequence(!0)}else if(66===e&&t){if(GPLViewModel.isViewer())return;event.preventDefault(),this.saveAndPublish()}},onDoubleClick:function(e,t){var n=this.getBestFigure(e,t);null!==n&&n.onDoubleClick()},onClick:function(e,t){var n=this.getBestFigure(e,t);null===n&&(n=this.getBestLine(e,t)),null!==n&&(n.onClick(),this.editPolicy.each($.proxy(function(i,o){"function"==typeof o.onClick&&o.onClick(n,e,t)},this)))},onRightMouseDown:function(e,t,n,i){var o=this.getBestFigure(e,t);null!==o&&(o.onContextMenu(e,t),o.editPolicy.each($.proxy(function(s,a){a.onRightMouseDown&&a.onRightMouseDown(o,e,t,n,i)},this))),this.editPolicy.each($.proxy(function(s,a){a.onRightMouseDown(o,e,t,n,i)},this))}}),draw2d.Selection=Class.extend({NAME:"draw2d.Selection",init:function(){this.primary=null,this.all=new draw2d.util.ArrayList},clear:function(){this.primary=null,this.all=new draw2d.util.ArrayList},getPrimary:function(){return this.primary},setPrimary:function(e){this.primary=e,this.add(e)},remove:function(e){this.all.remove(e),this.primary===e&&(this.primary=null)},add:function(e){null===e||this.all.contains(e)||this.all.add(e)},contains:function(e){return this.all.contains(e)},getAll:function(){return this.all.clone()},each:function(e){this.all.each(e)}}),draw2d.Figure=Class.extend({NAME:"draw2d.Figure",MIN_TIMER_INTERVAL:50,init:function(e,t){void 0==this.id&&(this.id=draw2d.util.UUID.create()),this.isResizeHandle=!1,this.command=null,this.canvas=null,this.shape=null,this.children=new draw2d.util.ArrayList,this.selectable=!0,this.deleteable=!0,this.resizeable=!1,this.draggable=!0,this.visible=!0,this.canSnapToHelper=!0,this.snapToGridAnchor=new draw2d.geo.Point(0,0),this.editPolicy=new draw2d.util.ArrayList,this.timerId=-1,this.timerInterval=0,this.parent=null,this.userData=null,this.x=0,this.y=0,this.minHeight=5,this.minWidth=5,this.rotationAngle=0,this.cssClass=this.NAME.replace(new RegExp("[.]","g"),"_"),"undefined"!=typeof t?(this.width=e,this.height=t):(this.width=this.getMinWidth(),this.height=this.getMinHeight()),this.alpha=1,this.isInDragDrop=!1,this.originalAlpha=this.alpha,this.ox=0,this.oy=0,this.repaintBlocked=!1,this.selectionHandles=new draw2d.util.ArrayList,this.moveListener=new draw2d.util.ArrayList,this.resizeListener=new draw2d.util.ArrayList,this.installEditPolicy(new draw2d.policy.figure.AntSelectionFeedbackPolicy)},select:function(e){return"undefined"==typeof e&&(e=!0),this.editPolicy.each($.proxy(function(t,n){n instanceof draw2d.policy.figure.SelectionFeedbackPolicy&&n.onSelect(this.canvas,this,e)},this)),null!==this.canvas&&this.canvas.getSelection().add(this),this},unselect:function(){return this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.SelectionFeedbackPolicy&&t.onUnselect(this.canvas,this)},this)),null!==this.canvas&&this.canvas.getSelection().remove(this),this},setUserData:function(e){this.userData=e},getUserData:function(){return this.userData},getId:function(){return this.id},setId:function(e){return this.id=e,this},getCssClass:function(){return this.cssClass},setCssClass:function(e){return this.cssClass=null===e?null:$.trim(e),null===this.shape?this:(null===this.cssClass?this.shape.node.removeAttribute("class"):this.shape.node.setAttribute("class",this.cssClass),this)
},hasCssClass:function(e){return null===this.cssClass?!1:new RegExp(" "+$.trim(e)+" ").test(" "+this.cssClass+" ")},addCssClass:function(e){return e=$.trim(e),this.hasCssClass(e)||(null===this.cssClass?this.setCssClass(e):this.setCssClass(this.cssClass+" "+e)),this},removeCssClass:function(e){e=$.trim(e);var t=" "+this.cssClass.replace(/[\t\r\n]/g," ")+" ";if(this.hasCssClass(e)){for(;t.indexOf(" "+e+" ")>=0;)t=t.replace(" "+e+" "," ");this.setCssClass(t.replace(/^\s+|\s+$/g,""))}return this},toggleCssClass:function(e){e=$.trim(e);var t=" "+this.cssClass.replace(/[\t\r\n]/g," ")+" ";if(this.hasCssClass(e)){for(;t.indexOf(" "+e+" ")>=0;)t=t.replace(" "+e+" "," ");this.setCssClass(t.replace(/^\s+|\s+$/g,""))}else this.setCssClass(this.cssClass+" "+e);return this},setCanvas:function(e){return null===e&&null!==this.shape&&(this.unselect(),this.shape.remove(),this.shape=null),this.canvas=e,null!==this.canvas&&this.getShapeElement(),null===e?this.stopTimer():this.timerInterval>=this.MIN_TIMER_INTERVAL&&this.startTimer(this.timerInterval),this.children.each(function(t,n){n.figure.setCanvas(e)}),this},getCanvas:function(){return this.canvas},startTimer:function(e){return this.stopTimer(),this.timerInterval=Math.max(this.MIN_TIMER_INTERVAL,e),null!==this.canvas&&(this.timerId=window.setInterval($.proxy(this.onTimer,this),this.timerInterval)),this},stopTimer:function(){return this.timerId>=0&&(window.clearInterval(this.timerId),this.timerId=-1),this},onTimer:function(){},toFront:function(){if(this.getShapeElement().toFront(),null!==this.canvas){var e=this.canvas.getFigures(),t=this.canvas.getLines();null!==e.remove(this)?e.add(this):null!==t.remove(this)&&t.add(this)}return this.children.each(function(e,t){t.figure.toFront()}),this},installEditPolicy:function(e){return e instanceof draw2d.policy.figure.SelectionFeedbackPolicy&&this.editPolicy.grep($.proxy(function(e){var t=!(e instanceof draw2d.policy.figure.SelectionFeedbackPolicy);return t||e.onUninstall(this),t},this)),e.onInstall(this),this.editPolicy.add(e),this},addFigure:function(e,t){if("undefined"==typeof t||null===t)throw"Second parameter 'locator' is requried for method 'Figure#addFigure'";return e.setDraggable(!1),e.setSelectable(!1),e.setParent(this),this.children.add({figure:e,locator:t}),null!==this.canvas&&e.setCanvas(this.canvas),this.repaint(),this},removeFigure:function(e){if("undefined"==typeof e||null===e)return debug.warn("The parameter child is required for Figure.removeFigure"),void 0;e.setParent(null),e.setCanvas(null);var t=this.children.getSize();return this.children.grep(function(t){return t.figure!==e}),t===this.children.getSize()&&debug.warn("Child figure is not part of the shape. Remove not possible."),this.repaint(),this},getChildren:function(){var e=new draw2d.util.ArrayList;return this.children.each(function(t,n){e.add(n.figure)}),e},resetChildren:function(){return this.children.each(function(e,t){t.figure.setCanvas(null)}),this.children=new draw2d.util.ArrayList,this.repaint(),this},getShapeElement:function(){return null!==this.shape?this.shape:(this.shape=this.createShapeElement(),null!==this.cssClass&&this.shape.node.setAttribute("class",this.cssClass),this.shape)},createShapeElement:function(){throw"Inherited class ["+this.NAME+"] must override the abstract method createShapeElement"},repaint:function(e){return this.visible!==!0?(this.shape.hide(),void 0):(this.shape.show(),e.opacity=this.alpha,this.shape.attr(e),this.applyTransformation(),this.children.each(function(e,t){t.locator.relocate(e,t.figure)}),void 0)},applyTransformation:function(){},setGlow:function(){return this},onDragStart:function(){return this.isInDragDrop=!1,this.command=this.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE)),null!==this.command?(this.ox=this.getX(),this.oy=this.getY(),this.isInDragDrop=!0,this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.onDragStart(this.canvas,this)},this)),!0):!1},onDrag:function(e,t){if(this.editPolicy.each($.proxy(function(n,i){if(i instanceof draw2d.policy.figure.DragDropEditPolicy){var o=i.adjustPosition(this,this.ox+e,this.oy+t);e=o.x-this.ox,t=o.y-this.oy}},this)),this.x=this.ox+e,this.y=this.oy+t,this.getCanSnapToHelper()){var n=new draw2d.geo.Point(this.x,this.y);n=this.getCanvas().snapToHelper(this,n),this.x=n.x,this.y=n.y}this.setPosition(this.x,this.y),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.onDrag(this.canvas,this)},this))},onPanning:function(){},onDragEnd:function(){this.setAlpha(this.originalAlpha),this.command.setPosition(this.x,this.y),this.isInDragDrop=!1,this.canvas.getCommandStack().execute(this.command),this.command=null,this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.onDragEnd(this.canvas,this)},this)),this.fireMoveEvent()},onDragEnter:function(){return null},onDragLeave:function(){},onDrop:function(){},onMouseEnter:function(){},onMouseLeave:function(){},onDoubleClick:function(){},onClick:function(){},onContextMenu:function(){},onPopOver:function(){},setAlpha:function(e){return e=Math.min(1,Math.max(0,parseFloat(e))),e!==this.alpha?(this.alpha=e,this.repaint(),this):void 0},getAlpha:function(){return this.alpha},setRotationAngle:function(e){return this.rotationAngle=e,this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this.repaint(),this},getRotationAngle:function(){return this.rotationAngle},setVisible:function(e){return this.visible=!!e,this.repaint(),this},isVisible:function(){return this.visible&&null!==this.shape},getZOrder:function(){if(null===this.shape)return-1;for(var e=0,t=this.shape.node;null!==(t=t.previousSibling);)e++;return e},setCanSnapToHelper:function(e){return this.canSnapToHelper=!!e,this},getCanSnapToHelper:function(){return this.canSnapToHelper},getSnapToGridAnchor:function(){return this.snapToGridAnchor},setSnapToGridAnchor:function(e){this.snapToGridAnchor=e},getWidth:function(){return this.width},getHeight:function(){return this.height},getMinWidth:function(){return this.minWidth},setMinWidth:function(e){return this.minWidth=parseFloat(e),this},getMinHeight:function(){return this.minHeight},setMinHeight:function(e){return this.minHeight=parseFloat(e),this},getX:function(){return this.x},getY:function(){return this.y},getAbsoluteX:function(){return null===this.parent?this.getX()||0:this.getX()+this.parent.getAbsoluteX()},getAbsoluteY:function(){return null===this.parent?this.getY()||0:this.getY()+this.parent.getAbsoluteY()},getAbsolutePosition:function(){return new draw2d.geo.Point(this.getAbsoluteX(),this.getAbsoluteY())},getAbsoluteBounds:function(){return new draw2d.geo.Rectangle(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},setPosition:function(e,t){return e instanceof draw2d.geo.Point?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t),this.repaint(),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this.fireMoveEvent(),this},getPosition:function(){return new draw2d.geo.Point(this.getX(),this.getY())},translate:function(e,t){return this.setPosition(this.getX()+e,this.getY()+t),this},setDimension:function(e,t){return e=Math.max(this.getMinWidth(),e),t=Math.max(this.getMinHeight(),t),this.width!==e||this.height!==t?(this.editPolicy.each($.proxy(function(n,i){if(i instanceof draw2d.policy.figure.DragDropEditPolicy){var o=i.adjustDimension(this,e,t);e=o.w,t=o.h}},this)),this.width=Math.max(this.getMinWidth(),e),this.height=Math.max(this.getMinHeight(),t),this.repaint(),this.fireResizeEvent(),this.fireMoveEvent(),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this):void 0},getBoundingBox:function(){return new draw2d.geo.Rectangle(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},hitTest:function(e,t,n){return"number"==typeof n?this.getBoundingBox().scale(n,n).hitTest(e,t):this.getBoundingBox().hitTest(e,t)},setDraggable:function(e){return this.draggable=!!e,this},isDraggable:function(){return this.draggable},isResizeable:function(){return this.resizeable},setResizeable:function(e){return this.resizeable=!!e,this},isSelectable:function(){return this.selectable},setSelectable:function(e){return this.selectable=!!e,this},isStrechable:function(){return!0},isDeleteable:function(){return this.deleteable},setDeleteable:function(e){return this.deleteable=!!e,this},setParent:function(e){return this.parent=e,this},getParent:function(){return this.parent},attachResizeListener:function(e){return null!==e?(this.resizeListener.add(e),this):void 0},detachResizeListener:function(e){return null!==e?(this.resizeListener.remove(e),this):void 0},fireResizeEvent:function(){return this.resizeListener.each($.proxy(function(e,t){t.onOtherFigureIsResizing(this)},this)),this},onOtherFigureIsResizing:function(){},attachMoveListener:function(e){return null!==e?(this.moveListener.contains(e)||this.moveListener.add(e),this):void 0},detachMoveListener:function(e){return null!==e?(this.moveListener.remove(e),this):void 0},fireMoveEvent:function(){return this.moveListener.each($.proxy(function(e,t){t.onOtherFigureIsMoving(this)},this)),this},onOtherFigureIsMoving:function(){},createCommand:function(e){return null===e?null:e.getPolicy()===draw2d.command.CommandType.MOVE?this.isDraggable()?new draw2d.command.CommandMove(this):null:e.getPolicy()===draw2d.command.CommandType.DELETE?this.isDeleteable()?new draw2d.command.CommandDelete(this):null:e.getPolicy()===draw2d.command.CommandType.RESIZE?this.isResizeable()?new draw2d.command.CommandResize(this):null:null},getPersistentAttributes:function(){var e={type:this.NAME,id:this.id,x:this.getX(),y:this.getY(),width:this.width,height:this.height,userData:this.userData};return null!==this.cssClass&&(e.cssClass=this.cssClass),e},setPersistentAttributes:function(e){return this.id=e.id,this.x=parseFloat(e.x),this.y=parseFloat(e.y),"undefined"!=typeof e.width&&(this.width=parseFloat(e.width)),"undefined"!=typeof e.height&&(this.height=parseFloat(e.height)),"undefined"!=typeof e.userData&&(this.userData=e.userData),"undefined"!=typeof e.cssClass&&this.setCssClass(e.cssClass),this}}),draw2d.shape.node.Node=draw2d.Figure.extend({NAME:"draw2d.shape.node.Node",init:function(e,t){this.inputPorts=new draw2d.util.ArrayList,this.outputPorts=new draw2d.util.ArrayList,this.hybridPorts=new draw2d.util.ArrayList,this.portRelayoutRequired=!0,this.cachedPorts=null,this._super(e,t)},onDoubleClick:function(){var e=this.getWidth(),t=this.getHeight();this.setRotationAngle((this.getRotationAngle()+90)%360),this.setDimension(t,e),this.portRelayoutRequired=!0},toFront:function(){return this._super(),this.getPorts().each(function(e,t){t.getConnections().each(function(e,t){t.toFront()}),t.toFront()}),this},getPorts:function(){return null===this.cachedPorts&&(this.cachedPorts=new draw2d.util.ArrayList,this.cachedPorts.addAll(this.inputPorts),this.cachedPorts.addAll(this.outputPorts),this.cachedPorts.addAll(this.hybridPorts),this.children.each($.proxy(function(e,t){this.cachedPorts.addAll(t.figure.getPorts())},this))),this.cachedPorts},getInputPorts:function(){return this.inputPorts.clone().addAll(this.hybridPorts)},getOutputPorts:function(){return this.outputPorts.clone().addAll(this.hybridPorts)},getPort:function(e){var t=null;return this.getPorts().each(function(n,i){return i.getName()===e?(t=i,!1):void 0}),t},getInputPort:function(e){if("number"==typeof e)return this.inputPorts.get(e);for(var t=0;t<this.inputPorts.getSize();t++){var n=this.inputPorts.get(t);if(n.getName()===e)return n}return null},getOutputPort:function(e){if("number"==typeof e)return this.outputPorts.get(e);for(var t=0;t<this.outputPorts.getSize();t++){var n=this.outputPorts.get(t);if(n.getName()===e)return n}return null},getHybridPort:function(e){if("number"==typeof e)return this.hybridPorts.get(e);for(var t=0;t<this.hybridPorts.getSize();t++){var n=this.hybridPorts.get(t);if(n.getName()===e)return n}return null},addPort:function(e,t){if(!(e instanceof draw2d.Port))throw"Argument is not typeof 'draw2d.Port'. \nFunction: draw2d.shape.node.Node#addPort";this.cachedPorts=null,this.portRelayoutRequired=!0,e instanceof draw2d.InputPort?this.inputPorts.add(e):e instanceof draw2d.OutputPort?this.outputPorts.add(e):e instanceof draw2d.HybridPort&&this.hybridPorts.add(e),"undefined"!=typeof t&&t instanceof draw2d.layout.locator.Locator&&e.setLocator(t),e.setParent(this),e.setCanvas(this.canvas),e.setDeleteable(!1),null!==this.canvas&&(e.getShapeElement(),this.canvas.registerPort(e))},removePort:function(e){if(this.portRelayoutRequired=!0,this.inputPorts.remove(e),this.outputPorts.remove(e),this.hybridPorts.remove(e),null!==e.getCanvas()){e.getCanvas().unregisterPort(e);for(var t=e.getConnections(),n=0;n<t.getSize();++n)e.getCanvas().removeFigure(t.get(n))}e.setCanvas(null)},createPortWithTooltip:function(e,t,n,i,o,s,a){var r=null,l=0;switch(e){case"input":r=new draw2d.InputPort,r.setDraggable(!1),l=this.inputPorts.getSize(),"Control Point"!==t&&r.setMaxFanOut(1);break;case"output":r=new draw2d.OutputPort,l=this.outputPorts.getSize();break;case"hybrid":r=new draw2d.HybridPort,l=this.hybridPorts.getSize(),r.setMaxFanOut(1);break;default:throw"Unknown type ["+e+"] of port requested"}return r.tooltip=t,r.propertyRepresented=t,a&&r.setRequired(a),s&&(r.alternateProperty=s),r.setValue(n),"Math"==n&&(console.log(n),console.log(i)),r.setName(o),this.addPort(r,i),this.setDimension(this.width,this.height),r},createPort:function(e,t){var n=null,i=0;switch(e){case"input":n=new draw2d.InputPort,i=this.inputPorts.getSize();break;case"output":n=new draw2d.OutputPort,i=this.outputPorts.getSize();break;case"hybrid":n=new draw2d.HybridPort,i=this.hybridPorts.getSize();break;default:throw"Unknown type ["+e+"] of port requested"}return n.tooltip=tooltip,n.setName(e+i),this.addPort(n,t),this.setDimension(this.width,this.height),this.layoutPorts(),n},getConnections:function(){for(var e=new draw2d.util.ArrayList,t=this.getPorts(),n=0;n<t.getSize();n++)for(var i=t.get(n),o=0,s=i.getConnections().getSize();s>o;o++)e.contains(i.getConnections().get(o))||e.add(i.getConnections().get(o));return e},setCanvas:function(e){var t=this.canvas;this._super(e);var n=this.getPorts();null!==t&&n.each(function(e,n){t.unregisterPort(n)}),null!==e?(n.each(function(t,n){n.setCanvas(e),e.registerPort(n)}),this.setDimension(this.width,this.height)):n.each(function(e,t){t.setCanvas(null)})},setRotationAngle:function(e){this.portRelayoutRequired=!0,this._super(e),this.layoutPorts()},setDimension:function(e,t){this.portRelayoutRequired=!0,this._super(e,t)},onPortValueChanged:function(){},repaint:function(e){this.repaintBlocked!==!0&&null!==this.shape&&(this._super(e),this.layoutPorts())},layoutPorts:function(){this.portRelayoutRequired!==!1&&(this.portRelayoutRequired=!1,this.outputPorts.each(function(e,t){t.locator.relocate(e,t)}),this.inputPorts.each(function(e,t){t.locator.relocate(e,t)}),this.hybridPorts.each(function(e,t){t.locator.relocate(e,t)}))}}),draw2d.VectorFigure=draw2d.shape.node.Node.extend({NAME:"draw2d.VectorFigure",init:function(e,t){this.stroke=1,this.bgColor=new draw2d.util.Color(255,255,255),this.lineColor=new draw2d.util.Color(128,128,255),this.color=new draw2d.util.Color(128,128,128),this.strokeBeforeGlow=this.stroke,this.glowIsActive=!1,this._super(e,t)},setGlow:function(e){return e===this.glowIsActive?this:(this.glowIsActive=e,e===!0?(this.strokeBeforeGlow=this.getStroke(),this.setStroke(2.5*this.strokeBeforeGlow)):this.setStroke(this.strokeBeforeGlow),this)},repaint:function(e){return this.repaintBlocked!==!0&&null!==this.shape?("undefined"==typeof e&&(e={}),e.x=this.getAbsoluteX(),e.y=this.getAbsoluteY(),"undefined"==typeof e.stroke&&(e.stroke=null===this.color||0===this.stroke?"none":this.color.hash()),"undefined"==typeof e["stroke-width"]&&(e["stroke-width"]=this.stroke),"undefined"==typeof e.fill&&(e.fill=this.bgColor.hash()),this._super(e),this):void 0},setBackgroundColor:function(e){return this.bgColor=new draw2d.util.Color(e),this.repaint(),this},getBackgroundColor:function(){return this.bgColor},setStroke:function(e){return this.stroke=e,this.repaint(),this},getStroke:function(){return this.stroke},setColor:function(e){return this.color=new draw2d.util.Color(e),this.repaint(),this},getColor:function(){return this.color},getPersistentAttributes:function(){var e=this._super();return e.color=this.color.hash(),e.stroke=this.stroke,e.alpha=this.alpha,e},setPersistentAttributes:function(e){return this._super(e),"undefined"!=typeof e.bgColor&&this.setBackgroundColor(e.bgColor),"undefined"!=typeof e.color&&this.setColor(e.color),"undefined"!=typeof e.stroke&&this.setStroke(parseFloat(e.stroke)),"undefined"!=typeof e.alpha&&this.setAlpha(parseFloat(e.alpha)),this}}),draw2d.shape.basic.Rectangle=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Rectangle",init:function(e,t){this.radius=2,this.dasharray=null,this._super(),this.setBackgroundColor(new draw2d.util.Color(100,100,100)),this.setColor("#1B1B1B"),"undefined"==typeof e?this.setDimension(50,90):this.setDimension(e,t)},repaint:function(e){this.repaintBlocked!==!0&&null!==this.shape&&("undefined"==typeof e&&(e={}),null!==this.dasharray&&(e["stroke-dasharray"]=this.dasharray),e.width=this.getWidth(),e.height=this.getHeight(),e.r=this.radius,this._super(e))},applyTransformation:function(){if(this.shape.transform("R"+this.rotationAngle),90===this.getRotationAngle()||270===this.getRotationAngle()){var e=this.getHeight()/this.getWidth(),t="...S"+e+","+1/e+","+(this.getAbsoluteX()+this.getWidth()/2)+","+(this.getAbsoluteY()+this.getHeight()/2);this.shape.transform(t)}},createShapeElement:function(){return this.canvas.paper.rect(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight())},setRadius:function(e){return this.radius=e,this.repaint(),this},getRadius:function(){return this.radius},setDashArray:function(e){this.dasharray=e,this.repaint()},getPersistentAttributes:function(){var e=this._super();return e.radius=this.radius,e},setPersistentAttributes:function(e){this._super(e),"number"==typeof e.radius&&(this.radius=e.radius)}}),draw2d.SetFigure=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.SetFigure",init:function(e,t){this.svgNodes=null,this.originalWidth=null,this.originalHeight=null,this.scaleX=1,this.scaleY=1,this._super(e,t),this.setStroke(0),this.setBackgroundColor(null)},setCanvas:function(e){null===e&&null!==this.svgNodes&&(this.svgNodes.remove(),this.svgNodes=null),this._super(e)},setCssClass:function(e){return this._super(e),null===this.svgNodes?this:(null===this.cssClass?this.svgNodes.forEach(function(e){e.node.removeAttribute("class")}):this.svgNodes.forEach(function(t){t.node.setAttribute("class",e)}),this)},repaint:function(e){this.repaintBlocked!==!0&&null!==this.shape&&(null!==this.originalWidth&&(this.scaleX=this.width/this.originalWidth,this.scaleY=this.height/this.originalHeight),"undefined"==typeof e&&(e={}),this.applyAlpha(),this.visible===!0?this.svgNodes.show():this.svgNodes.hide(),this._super(e))},applyAlpha:function(){this.svgNodes.attr({opacity:this.alpha})},applyTransformation:function(){var e="S"+this.scaleX+","+this.scaleY+",0,0 R"+this.rotationAngle+","+(0|this.getWidth()/2)+","+(0|this.getHeight()/2)+"T"+this.getAbsoluteX()+","+this.getAbsoluteY();if(this.svgNodes.transform(e),90===this.rotationAngle||270===this.rotationAngle){var t=this.svgNodes.getBBox(!0),n=t.height/t.width,i=t.width/t.height,o="...S"+n+","+i+","+(this.getAbsoluteX()+this.getWidth()/2)+","+(this.getAbsoluteY()+this.getHeight()/2);this.svgNodes.transform(o)}},toFront:function(){return this._super(),null!==this.svgNodes&&this.svgNodes.toFront(),this.getPorts().each(function(e,t){t.getConnections().each(function(e,t){t.toFront()}),t.toFront()}),this},createShapeElement:function(){var e=this.canvas.paper.rect(this.getX(),this.getY(),this.getWidth(),this.getHeight());if(this.svgNodes=this.createSet(),"undefined"==typeof this.svgNodes.forEach){var t=this.canvas.paper.set();t.push(this.svgNodes),this.svgNodes=t}this.setCssClass(this.cssClass);var n=this.svgNodes.getBBox();return this.originalWidth=n.width,this.originalHeight=n.height,e},createSet:function(){return this.canvas.paper.set()}}),draw2d.SVGFigure=draw2d.SetFigure.extend({NAME:"draw2d.SVGFigure",init:function(e,t){this._super(e,t)},createSet:function(){return this.importSVG(this.canvas,this.getSVG())},importSVG:function(e,t){var n=e.paper.set();try{if("undefined"==typeof t)throw"No data was provided.";if(t=t.replace(/\n|\r|\t/gi,""),!t.match(/<svg(.*?)>(.*)<\/svg>/i))throw"The data you entered doesn't contain valid SVG.";var i=new RegExp('<svg width="(.*?)" height="(.*?)" .*?>',"gi"),o=i.exec(t);o&&this.setDimension(parseInt(o[1],10),parseInt(o[2],10));for(var s=new RegExp('([a-z0-9-]+)="(.*?)"',"gi"),a=new RegExp("([a-z0-9-]+) ?: ?([^ ;]+)[ ;]?","gi"),r=new RegExp("<(line|rect|polyline|circle|ellipse|path|polygon|image|text).*?(/>|.*</text>)","gi");o=r.exec(t);){for(var l=null,u=null,d={},c=RegExp.$1;s.exec(o);)switch(RegExp.$1){case"stroke-dasharray":d[RegExp.$1]="- ";break;case"style":u=RegExp.$2;break;default:d[RegExp.$1]=RegExp.$2}if(null!==u)for(;a.exec(u);)d[RegExp.$1]=RegExp.$2;switch("undefined"==typeof d["stroke-width"]&&(d["stroke-width"]="undefined"==typeof d.stroke?0:1),c){case"rect":l=e.paper.rect();break;case"circle":l=e.paper.circle();break;case"ellipse":l=e.paper.ellipse();break;case"path":d.fill="none",l=e.paper.path(d.d);break;case"line":d.d="M "+d.x1+" "+d.y1+"L"+d.x2+" "+d.y2,d.fill="none",l=e.paper.path(d.d);break;case"polyline":var p=d.points;d.d="M "+p.replace(" "," L"),l=e.paper.path(d.d);break;case"polygon":l=e.paper.polygon(d.points);break;case"image":l=e.paper.image();break;case"text":l=e.paper.text(),d["text-anchor"]="start",d.y=parseInt(d.y,10)+l.getBBox().height/2}null!==l&&(l.attr(d),n.push(l))}}catch(h){alert("The SVG data you entered was invalid! ("+h+")")}return n}}),draw2d.shape.basic.Oval=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Oval",init:function(e,t){this._super(),this.setBackgroundColor("#C02B1D"),this.setColor("#1B1B1B"),"number"==typeof t&&"number"==typeof e?this.setDimension(e,t):this.setDimension(50,50)},createShapeElement:function(){var e=this.getWidth()/2,t=this.getHeight()/2;return this.canvas.paper.ellipse(this.getAbsoluteX()+e,this.getAbsoluteY()+t,e,t)},repaint:function(e){this.repaintBlocked!==!0&&null!==this.shape&&("undefined"==typeof e&&(e={}),"undefined"==typeof e.rx&&(e.rx=this.width/2,e.ry=this.height/2),"undefined"==typeof e.cx&&(e.cx=this.getAbsoluteX()+e.rx,e.cy=this.getAbsoluteY()+e.ry),this._super(e))},intersectionWithLine:function(e,t){var n=this.getWidth()/2,i=this.getHeight()/2,o=new draw2d.util.ArrayList,s=new draw2d.geo.Point(e.x,e.y),a=t.subtract(e),r=new draw2d.geo.Point(this.getAbsoluteX()+n,this.getAbsoluteY()+i),l=s.subtract(r),u=new draw2d.geo.Point(a.x/(n*n),a.y/(i*i)),d=new draw2d.geo.Point(l.x/(n*n),l.y/(i*i)),c=a.dot(u),p=a.dot(d),h=l.dot(d)-1,m=p*p-c*h;if(0>m);else if(m>0){var y=Math.sqrt(m),f=(-p-y)/c,g=(-p+y)/c;(0>f||f>1)&&(0>g||g>1)||(f>=0&&1>=f&&o.add(e.lerp(t,f)),g>=0&&1>=g&&o.add(e.lerp(t,g)))}else{var P=-p/c;P>=0&&1>=P&&o.add(e.lerp(t,P))}return o}}),draw2d.shape.basic.Circle=draw2d.shape.basic.Oval.extend({NAME:"draw2d.shape.basic.Circle",init:function(e){this._super(),"number"==typeof e?this.setDimension(e,e):this.setDimension(40,40)},setDimension:function(e,t){e>t?this._super(e,e):this._super(t,t)},setDiameter:function(e){var t=this.getCenter();return this.setDimension(e,e),this.setCenter(t),this},getDiameter:function(){return this.getWidth()},setRadius:function(e){return this.setDiameter(2*e),this},getCenter:function(){var e=this.getDiameter()/2;return this.getPosition().translate(e,e)},setCenter:function(e,t){var n=new draw2d.geo.Point(e,t),i=this.getDiameter()/2;return n.translate(-i,-i),this.setPosition(n),this},isStrechable:function(){return!1},onClick:function(){}}),draw2d.shape.basic.Label=draw2d.SetFigure.extend({NAME:"draw2d.shape.basic.Label",FONT_FALLBACK:{Georgia:"Georgia, serif","Palatino Linotype":'"Palatino Linotype", "Book Antiqua", Palatino, serif',"Times New Roman":'"Times New Roman", Times, serif',Arial:"Arial, Helvetica, sans-serif","Arial Black":'"Arial Black", Gadget, sans-serif',"Comic Sans MS":'"Comic Sans MS", cursive, sans-serif',Impact:"Impact, Charcoal, sans-serif","Lucida Sans Unicode":'"Lucida Sans Unicode", "Lucida Grande", sans-serif',"Tahoma, Geneva":"Tahoma, Geneva, sans-seri","Trebuchet MS":'"Trebuchet MS", Helvetica, sans-serif',Verdana:"Verdana, Geneva, sans-serif","Courier New":'"Courier New", Courier, monospace',"Lucida Console":'"Lucida Console", Monaco, monospace'},init:function(e){this._super(),this.text="string"==typeof e?e:"",this.cachedWidth=null,this.cachedHeight=null,this.cachedMinWidth=null,this.cachedMinHeight=null,this.fontSize=9,this.fontColor=new draw2d.util.Color("#080808"),this.fontFamily=null,this.padding=4,this.bold=!1,this.setStroke(0),this.setDimension(3,3),this.editor=null,this.installEditPolicy(new draw2d.policy.figure.AntSelectionFeedbackPolicy)},createSet:function(){return this.canvas.paper.text(0,0,this.text)},setCanvas:function(e){this.clearCache(),this._super(e),this.clearCache()},repaint:function(e){if(this.repaintBlocked!==!0&&null!==this.shape){var t={};t.text=this.text,t["font-weight"]=this.bold===!0?"bold":"normal",t["text-anchor"]="start",t["font-size"]=this.fontSize,null!==this.fontFamily&&(t["font-family"]=this.fontFamily),t.fill=this.fontColor.hash(),this.svgNodes.attr(t),this.svgNodes.attr({x:this.padding,y:this.getHeight()/2}),this._super(e)}},applyTransformation:function(){this.shape.transform("R"+this.rotationAngle),this.svgNodes.transform("R"+this.rotationAngle+"T"+this.getAbsoluteX()+","+this.getAbsoluteY())},isResizeable:function(){return!1},setFontSize:function(e){return this.clearCache(),this.fontSize=e,this.repaint(),this.fireResizeEvent(),this.fireMoveEvent(),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this},getFontSize:function(){return this.fontSize},setBold:function(e){return this.clearCache(),this.bold=e,this.repaint(),this},setFontColor:function(e){return this.fontColor=new draw2d.util.Color(e),this.repaint(),this},getFontColor:function(){return this.fontColor},setPadding:function(e){return this.clearCache(),this.padding=e,this.repaint(),this},getPadding:function(){return this.padding},setFontFamily:function(e){return this.clearCache(),"undefined"!=typeof e&&null!==e&&"undefined"!=typeof this.FONT_FALLBACK[e]&&(e=this.FONT_FALLBACK[e]),this.fontFamily=e,this.repaint(),this},setDimension:function(e,t){return this.clearCache(),this._super(e,t),this},clearCache:function(){this.cachedMinWidth=null,this.cachedMinHeight=null,this.cachedWidth=null,this.cachedHeight=null},getMinWidth:function(){return null===this.shape?0:(null===this.cachedMinWidth&&(this.cachedMinWidth=this.svgNodes.getBBox(!0).width+2*this.padding+2*this.getStroke()),this.cachedMinWidth)},getMinHeight:function(){return null===this.shape?0:(null===this.cachedMinHeight&&(this.cachedMinHeight=this.svgNodes.getBBox(!0).height+2*this.padding+2*this.getStroke()),this.cachedMinHeight)},getWidth:function(){return null===this.shape?0:(null===this.cachedWidth&&(this.cachedWidth=Math.max(this.width,this.getMinWidth())),this.cachedWidth)},getHeight:function(){return null===this.shape?0:(null===this.cachedHeight&&(this.cachedHeight=Math.max(this.height,this.getMinHeight())),this.cachedHeight)},installEditor:function(e){return this.editor=e,this},onDoubleClick:function(){null!==this.editor&&this.editor.start(this)},getText:function(){return this.text},setText:function(e){this.clearCache(),this.text=e,this.repaint(),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this.fireResizeEvent(),null!==this.parent&&this.parent.repaint()},setHTML:function(e,t,n,i,o,s,a){var r=this.getCanvas();void 0==r&&(r=a);var l=this.getBoundingBox();l.setPosition(r.fromCanvasToDocumentCoordinate(l.x,l.y));var u=r.getScrollArea();u.is($("body"))&&l.translate(r.getScrollLeft(),r.getScrollTop()),l.translate(-1,-1),l.resize(2,2);var d={position:"absolute",top:l.y,left:l.x,"min-width":l.w,height:l.h,"z-index":101};this.setText(e),$("#"+this.id).remove(),this.div=$("<div id="+this.id+">"+e+"</div>").appendTo("#canv"),this.div.css(d),s&&this.div.css(s);var c=this;this.div.dblclick(function(){c.editor.start(c,c.getText(),this.style.left,this.style.top,this.style.width,this.style.height)}),GPLViewModel.isViewer()||(this.div.draggable(),$(this.div).on("drag",function(e){var t=c.getCanvas().fromDocumentToCanvasCoordinate(e.clientX+window.scrollX,e.clientY+window.scrollY);c.setPosition($(this).position().left,t.y)})),this.setVisible(!1)},hitTest:function(e,t){if(0===this.rotationAngle)return this._super(e,t);var n=this.shape.matrix,i=this.getBoundingBox().getVertices();i.each(function(e,t){var i=n.x(t.x,t.y),o=n.y(t.x,t.y);t.x=i,t.y=o});var o=4,s=0,a=o-1,r=!1;for(s=0;o>s;s++){var l=i.get(s),u=i.get(a);(l.y<t&&u.y>=t||u.y<t&&l.y>=t)&&(l.x<=e||u.x<=e)&&l.x+(t-l.y)/(u.y-l.y)*(u.x-l.x)<e&&(r=!r),a=s}return r},getPersistentAttributes:function(){var e=this._super();return e.text=this.text,e.fontSize=this.fontSize,e.fontColor=this.fontColor.hash(),e},setPersistentAttributes:function(e){this._super(e),"undefined"!=typeof e.text&&this.setText(e.text),"undefined"!=typeof e.font&&(this.setText(e.label2.Value),this.setBold(e.font["font-weight"]),this.setFontSize(e.font["font-size"]),this.setFontColor(e.font.color)),"undefined"!=typeof e.fontFamily&&this.setFontFamily(e.fontFamily),"undefined"!=typeof e.fontSize&&this.setFontSize(e.fontSize),"undefined"!=typeof e.fontColor&&this.setFontColor(e.fontColor)}}),draw2d.shape.basic.Line=draw2d.Figure.extend({NAME:"draw2d.shape.basic.Line",DEFAULT_COLOR:new draw2d.util.Color(0,0,0),init:function(e,t,n,i){this.repaintBlocked=!1,this.corona=10,this.isGlowing=!1,this.lineColor=this.DEFAULT_COLOR,this.stroke=1,this.outlineStroke=0,this.outlineColor=new draw2d.util.Color(null),this.outlineVisible=!1,this.dasharray=null,"number"==typeof i?(this.start=new draw2d.geo.Point(e,t),this.end=new draw2d.geo.Point(n,i)):(this.start=new draw2d.geo.Point(30,30),this.end=new draw2d.geo.Point(100,100)),this.vertices=new draw2d.util.ArrayList,this.vertices.add(this.start),this.vertices.add(this.end),this._super(),this.installEditPolicy(new draw2d.policy.line.LineSelectionFeedbackPolicy),this.setSelectable(!0),this.setDeleteable(!0)},setOutlineColor:function(e){return this.outlineColor=new draw2d.util.Color(e),this.repaint(),this},getOutlineColor:function(){return this.outlineColor},setOutlineStroke:function(e){return this.outlineStroke=e,this.repaint(),this},getOutlineStroke:function(){return this.outlineStroke},onDrag:function(e,t,n,i){null!==this.command&&(this.command.setTranslation(e,t),this.vertices.each(function(e,t){t.translate(n,i)}),this.start=this.vertices.first().clone(),this.end=this.vertices.last().clone(),this.svgPathString=null,this._super(e,t,n,i))},onDragEnd:function(){this.setAlpha(this.originalAlpha),this.isInDragDrop=!1,null!==this.command&&(this.getVertices().each($.proxy(function(e,t){t.translate(-this.command.dx,-this.command.dy)},this)),this.canvas.getCommandStack().execute(this.command),this.command=null,this.isMoving=!1,this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.onDragEnd(this.canvas,this)},this)),this.fireMoveEvent())},onClick:function(){},setDashArray:function(e){return this.dasharray=e,this},setCoronaWidth:function(e){return this.corona=e,this},createShapeElement:function(){var e=this.canvas.paper.set();
return e.push(this.canvas.paper.path("M"+this.start.x+" "+this.start.y+"L"+this.end.x+" "+this.end.y)),e.push(this.canvas.paper.path("M"+this.start.x+" "+this.start.y+"L"+this.end.x+" "+this.end.y)),e.node=e.items[1].node,e},repaint:function(e){this.repaintBlocked!==!0&&null!==this.shape&&("undefined"==typeof e?e={stroke:this.lineColor.hash(),"stroke-width":this.stroke,path:["M",this.start.x,this.start.y,"L",this.end.x,this.end.y].join(" ")}:("undefined"==typeof e.path&&(e.path=["M",this.start.x,this.start.y,"L",this.end.x,this.end.y].join(" ")),e.stroke=this.lineColor.hash(),e["stroke-width"]=this.stroke),null!==this.dasharray&&(e["stroke-dasharray"]=this.dasharray),this._super(e),this.outlineStroke>0?(this.shape.items[0].attr({"stroke-width":this.outlineStroke+this.stroke,stroke:this.outlineColor.hash()}),this.outlineVisible===!1&&this.shape.items[0].show(),this.outlineVisible=!0):this.outlineVisible===!0&&(this.shape.items[0].attr({"stroke-width":0,stroke:"none"}),this.shape.items[0].hide()))},setGlow:function(e){return this.isGlowing!==e?(e===!0?(this._lineColor=this.lineColor,this._stroke=this.stroke,this.setColor(new draw2d.util.Color("#3f72bf")),this.setStroke(0|4*this.stroke)):(this.setColor(this._lineColor),this.setStroke(this._stroke)),this.isGlowing=e,this):void 0},isResizeable:function(){return!0},setStroke:function(e){return this.stroke=parseFloat(e),this.repaint(),this},getStroke:function(){return this.stroke},setColor:function(e){return this.lineColor=new draw2d.util.Color(e),this.repaint(),this},getColor:function(){return this.lineColor},translate:function(e,t){return this.vertices.each(function(n,i){i.translate(e,t)}),this.start=this.vertices.first().clone(),this.end=this.vertices.last().clone(),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this.svgPathString=null,this.repaint(),this},setStartPoint:function(e,t){return this.start.x!==e||this.start.y!==t?(this.start.setPosition(e,t),this.repaint(),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this):void 0},setEndPoint:function(e,t){return this.end.x!==e||this.end.y!==t?(this.end.setPosition(e,t),this.repaint(),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this):void 0},getStartX:function(){return this.start.x},getStartY:function(){return this.start.y},getStartPoint:function(){return this.start.clone()},getEndX:function(){return this.end.x},getEndY:function(){return this.end.y},getEndPoint:function(){return this.end.clone()},getVertex:function(e){return this.vertices.get(e)},getVertices:function(){return this.vertices},getPoints:function(){return this.getVertices()},setVertices:function(e){return this.vertices=e.clone(!0),this.start=this.vertices.first().clone(),this.end=this.vertices.last().clone(),this.svgPathString=null,this.repaint(),this.selectionHandles.isEmpty()||this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.SelectionFeedbackPolicy&&(t.onUnselect(this.canvas,this),t.onSelect(this.canvas,this))},this)),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this},getSegments:function(){var e=new draw2d.util.ArrayList;return e.add({start:this.getStartPoint(),end:this.getEndPoint()}),e},getLength:function(){return null!==this.shape?this.shape.getTotalLength():Math.sqrt((this.start.x-this.end.x)*(this.start.x-this.end.x)+(this.start.y-this.end.y)*(this.start.y-this.end.y))},getAngle:function(){var e=this.getLength(),t=-(180/Math.PI)*Math.asin((this.start.y-this.end.y)/e);return 0>t?t=this.end.x<this.start.x?Math.abs(t)+180:360-Math.abs(t):this.end.x<this.start.x&&(t=180-t),t},createCommand:function(e){return e.getPolicy()===draw2d.command.CommandType.MOVE&&this.isDraggable()?new draw2d.command.CommandMoveLine(this):e.getPolicy()===draw2d.command.CommandType.DELETE?this.isDeleteable()===!1?null:new draw2d.command.CommandDelete(this):null},hitTest:function(e,t){return draw2d.shape.basic.Line.hit(this.corona+this.stroke,this.start.x,this.start.y,this.end.x,this.end.y,e,t)},intersection:function(e){var t=new draw2d.util.ArrayList;if(e===this)return t;var n=this.getSegments(),i=e.getSegments();return n.each(function(e,n){i.each(function(e,i){var o=draw2d.shape.basic.Line.intersection(n.start,n.end,i.start,i.end);null!==o&&t.add(o)})}),t},getPersistentAttributes:function(){var e=this._super();return delete e.x,delete e.y,delete e.width,delete e.height,e.stroke=this.stroke,e.color=this.getColor().hash(),e.outlineStroke=this.outlineStroke,e.outlineColor=this.outlineColor.hash(),this.editPolicy.getSize()>0&&(e.policy=this.editPolicy.getFirstElement().NAME),e},setPersistentAttributes:function(memento){if(this._super(memento),"undefined"!=typeof memento.stroke&&this.setStroke(parseFloat(memento.stroke)),"undefined"!=typeof memento.color&&this.setColor(memento.color),"undefined"!=typeof memento.outlineStroke&&this.setOutlineStroke(memento.outlineStroke),"undefined"!=typeof memento.outlineColor&&this.setOutlineColor(memento.outlineColor),"undefined"!=typeof memento.policy)try{this.installEditPolicy(eval("new "+memento.policy+"()"))}catch(exc){debug.warn("Unable to install edit policy '"+memento.policy+"' forced by "+this.NAME+".setPersistendAttributes. Using default.")}}}),draw2d.shape.basic.Line.intersection=function(e,t,n,i){var o=null,s=(i.x-n.x)*(e.y-n.y)-(i.y-n.y)*(e.x-n.x),a=(t.x-e.x)*(e.y-n.y)-(t.y-e.y)*(e.x-n.x),r=(i.y-n.y)*(t.x-e.x)-(i.x-n.x)*(t.y-e.y);if(0!=r){var l=s/r,u=a/r;l>=0&&1>=l&&u>=0&&1>=u&&(o=new draw2d.geo.Point(0|e.x+l*(t.x-e.x),0|e.y+l*(t.y-e.y)),o.justTouching=0==l||1==l||0==u||1==u)}return o},draw2d.shape.basic.Line.hit=function(e,t,n,i,o,s,a){i-=t,o-=n,s-=t,a-=n;var r,l=s*i+a*o;0>=l?r=0:(s=i-s,a=o-a,l=s*i+a*o,r=0>=l?0:l*l/(i*i+o*o));var u=s*s+a*a-r;return 0>u&&(u=0),Math.sqrt(u)<e},draw2d.shape.basic.PolyLine=draw2d.shape.basic.Line.extend({NAME:"draw2d.shape.basic.PolyLine",init:function(e){this.svgPathString=null,this.oldPoint=null,this.router=e||draw2d.shape.basic.PolyLine.DEFAULT_ROUTER,this.routingRequired=!0,this.radius=.2,this.lineSegments=new draw2d.util.ArrayList,this._super()},setRadius:function(e){return this.radius=e,this.svgPathString=null,this.repaint(),this},getRadius:function(){return this.radius},setStartPoint:function(e,t){this.repaintBlocked=!0,this._super(e,t),this.calculatePath(),this.repaintBlocked=!1,this.repaint()},setEndPoint:function(e,t){this.repaintBlocked=!0,this._super(e,t),this.calculatePath(),this.repaintBlocked=!1,this.repaint()},addVertex:function(e,t){return this.vertices.add(new draw2d.geo.Point(e,t)),this.start=this.vertices.first().clone(),this.end=this.vertices.last().clone(),this.svgPathString=null,this.repaint(),this.selectionHandles.isEmpty()||this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.SelectionFeedbackPolicy&&(t.onUnselect(this.canvas,this),t.onSelect(this.canvas,this))},this)),this},setVertex:function(e,t,n){t instanceof draw2d.geo.Point&&(n=t.y,t=t.x);var i=this.vertices.get(e);if(null!==i&&(i.x!==t||i.y!==n))return i.x=parseFloat(t),i.y=parseFloat(n),this.start=this.vertices.first().clone(),this.end=this.vertices.last().clone(),this.svgPathString=null,this.routingRequired=!0,this.repaint(),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this},insertVertexAt:function(e,t,n){var i=new draw2d.geo.Point(t,n);return this.vertices.insertElementAt(i,e),this.start=this.vertices.first().clone(),this.end=this.vertices.last().clone(),this.svgPathString=null,this.repaint(),this.selectionHandles.isEmpty()||this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.SelectionFeedbackPolicy&&(t.onUnselect(this.canvas,this),t.onSelect(this.canvas,this))},this)),this},removeVertexAt:function(e){var t=this.vertices.removeElementAt(e);return this.start=this.vertices.first().clone(),this.end=this.vertices.last().clone(),this.svgPathString=null,this.repaint(),this.selectionHandles.isEmpty()||this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.SelectionFeedbackPolicy&&(t.onUnselect(this.canvas,this),t.onSelect(this.canvas,this))},this)),t},setRouter:function(e){return null!==this.router&&this.router.onUninstall(this),this.router="undefined"==typeof e||null===e?new draw2d.layout.connection.DirectRouter:e,this.router.onInstall(this),this.routingRequired=!0,this.repaint(),this},getRouter:function(){return this.router},calculatePath:function(){if(null!==this.shape){this.svgPathString=null;var e=this.vertices;this.oldPoint=null,this.lineSegments=new draw2d.util.ArrayList,this.vertices=new draw2d.util.ArrayList,this.router.route(this,e),this.routingRequired=!1}},repaint:function(e){"undefined"==typeof e&&(e={}),this.repaintBlocked!==!0&&null!==this.shape&&((null===this.svgPathString||this.routingRequired===!0)&&this.calculatePath(),$.extend(e,{path:this.svgPathString,"stroke-linecap":"round","stroke-linejoin":"round"},e),this._super(e))},onDragEnter:function(){return this},onDragLeave:function(){},getSegments:function(){return this.lineSegments},addPoint:function(e,t){"undefined"!=typeof t&&(e=new draw2d.geo.Point(e,t)),this.vertices.add(e),null!==this.oldPoint&&this.lineSegments.add({start:this.oldPoint,end:e}),this.svgPathString=null,this.oldPoint=e},onOtherFigureIsMoving:function(e){this.repaintBlocked=!0,this._super(e),this.calculatePath(),this.repaintBlocked=!1,this.repaint()},hitSegment:function(e,t){for(var n=0;n<this.lineSegments.getSize();n++){var i=this.lineSegments.get(n);if(draw2d.shape.basic.Line.hit(this.corona,i.start.x,i.start.y,i.end.x,i.end.y,e,t))return{index:n,start:i.start,end:i.end}}return null},hitTest:function(e,t){return null!==this.hitSegment(e,t)},createCommand:function(e){if(e.getPolicy()===draw2d.command.CommandType.DELETE){if(this.isDeleteable()===!0)return new draw2d.command.CommandDelete(this)}else if(e.getPolicy()===draw2d.command.CommandType.MOVE_VERTEX){if(this.isResizeable()===!0)return new draw2d.command.CommandMoveVertex(this)}else if(e.getPolicy()===draw2d.command.CommandType.MOVE_VERTICES&&this.isResizeable()===!0)return new draw2d.command.CommandMoveVertices(this);return this._super(e)},getPersistentAttributes:function(){var e=this._super();return e.router=this.router.NAME,e.radius=this.radius,e=this.router.getPersistentAttributes(this,e)},setPersistentAttributes:function(memento){if(this._super(memento),"undefined"!=typeof memento.router)try{this.setRouter(eval("new "+memento.router+"()"))}catch(exc){debug.warn("Unable to install router '"+memento.router+"' forced by "+this.NAME+".setPersistendAttributes. Using default")}"undefined"!=typeof memento.radius&&this.setRadius(memento.radius),this.router.setPersistentAttributes(this,memento),this.start=this.vertices.first().clone(),this.end=this.vertices.last().clone()}}),draw2d.shape.basic.PolyLine.DEFAULT_ROUTER=new draw2d.layout.connection.InteractiveManhattanConnectionRouter,draw2d.shape.basic.Polygon=draw2d.VectorFigure.extend({NAME:"draw2d.shape.basic.Polygon",init:function(){this._super(),this.vertices=new draw2d.util.ArrayList,this.addVertex(new draw2d.geo.Point(10,10)),this.addVertex(new draw2d.geo.Point(20,10)),this.addVertex(new draw2d.geo.Point(20,40)),this.svgPathString=null,this.installEditPolicy(new draw2d.policy.figure.VertexSelectionFeedbackPolicy)},createShapeElement:function(){return this.canvas.paper.path("M0 10L100 100")},calculatePath:function(){for(var e=this.vertices.getSize(),t=this.vertices.get(0),n=["M",t.x," ",t.y],i=1;e>i;i++)t=this.vertices.get(i),n.push("L",t.x," ",t.y);return n.push("Z"),this.svgPathString=n.join(""),this},repaint:function(e){null!==this.shape&&(null===this.svgPathString&&this.calculatePath(),"undefined"==typeof e&&(e={}),"undefined"==typeof e.path&&(e.path=this.svgPathString),this._super(e))},translate:function(e,t){return this.vertices.each(function(n,i){i.translate(e,t)}),this.svgPathString=null,this.repaint(),this.updateBoundingBox(),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this.fireMoveEvent(),this},setPosition:function(e,t){var n=e-this.minX,i=t-this.minY;return this.translate(n,i),this},setDimension:function(e,t){var n=this.width,i=this.height;this._super(e,t);var o=1/n*this.width,s=1/i*this.height;return this.vertices.each($.proxy(function(e,t){var n=(t.getX()-this.x)*o,i=(t.getY()-this.y)*s;t.setPosition(this.x+n,this.y+i)},this)),this.svgPathString=null,this.repaint(),this},getVertices:function(){return this.vertices},setVertex:function(e,t,n){var i=this.vertices.get(e);if(null!==i&&(i.x!==t||i.y!==n))return i.x=parseFloat(t),i.y=parseFloat(n),this.svgPathString=null,this.repaint(),this.updateBoundingBox(),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this},addVertex:function(e,t){var n=null;return n=e instanceof draw2d.geo.Point?e.clone():new draw2d.geo.Point(e,t),this.vertices.add(n),this.svgPathString=null,this.repaint(),this.updateBoundingBox(),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.moved(this.canvas,this)},this)),this},insertVertexAt:function(e,t,n){var i=new draw2d.geo.Point(t,n);return this.vertices.insertElementAt(i,e),this.svgPathString=null,this.repaint(),this.updateBoundingBox(),this.selectionHandles.isEmpty()||this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.SelectionFeedbackPolicy&&(t.onUnselect(this.canvas,this),t.onSelect(this.canvas,this))},this)),this},removeVertexAt:function(e){if(this.vertices.getSize()<=3)return null;var t=this.vertices.removeElementAt(e);return this.svgPathString=null,this.repaint(),this.updateBoundingBox(),this.selectionHandles.isEmpty()||this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.SelectionFeedbackPolicy&&(t.onUnselect(this.canvas,this),t.onSelect(this.canvas,this))},this)),t},updateBoundingBox:function(){this.minX=this.x=Math.min.apply(Math,$.map(this.vertices.asArray(),function(e){return e.x})),this.minY=this.y=Math.min.apply(Math,$.map(this.vertices.asArray(),function(e){return e.y})),this.maxX=Math.max.apply(Math,$.map(this.vertices.asArray(),function(e){return e.x})),this.maxY=Math.max.apply(Math,$.map(this.vertices.asArray(),function(e){return e.y})),this.width=this.maxX-this.minX,this.height=this.maxY-this.minY},createCommand:function(e){return e.getPolicy()===draw2d.command.CommandType.MOVE_VERTEX&&this.isResizeable()===!0?new draw2d.command.CommandMoveVertex(this):this._super(e)},getPersistentAttributes:function(){var e=this._super();return e.vertices=[],this.vertices.each(function(t,n){e.vertices.push({x:n.x,y:n.y})}),e},setPersistentAttributes:function(e){this._super(e),"undefined"!=typeof e.vertices&&(this.vertices=new draw2d.util.ArrayList,$.each(e.vertices,$.proxy(function(e,t){this.addVertex(t.x,t.y)},this)))}}),draw2d.shape.basic.Image=draw2d.shape.node.Node.extend({NAME:"draw2d.shape.basic.Image",init:function(e,t,n){this._super(t,n),this.path=e},repaint:function(e){this.repaintBlocked!==!0&&null!==this.shape&&("undefined"==typeof e&&(e={}),e.x=this.getAbsoluteX(),e.y=this.getAbsoluteY(),e.width=this.getWidth(),e.height=this.getHeight(),this._super(e))},createShapeElement:function(){return this.canvas.paper.image(this.path,this.getX(),this.getY(),this.getWidth(),this.getHeight())},onClick:function(){},onDoubleClick:function(){},setRotationAngle:function(){},properties:[{name:"left",type:"number",action:function(e){e.obj.set("left",e.property)},defaultvalue:100},{name:"top",type:"number",action:function(e){e.obj.set("top",e.property)},defaultvalue:100},{name:"width",type:"number",action:function(e){e.obj.set("width",e.property/e.obj.scaleX)},defaultvalue:200},{name:"height",type:"number",action:function(e){e.obj.set("height",e.property/e.obj.scaleY)},defaultvalue:100},{name:"scaleX",type:"number",action:function(e){e.obj.set("scaleX",e.property)},defaultvalue:1},{name:"scaleY",type:"number",action:function(e){e.obj.set("scaleY",e.property)},defaultvalue:1},{name:"fill",type:"string",action:function(e){e.obj.set("fill",e.property)},defaultvalue:"#D3DAE5"},{name:"stroke",type:"string",action:function(e){e.obj.set("stroke",e.property)},defaultvalue:"#000000"},{name:"angle",type:"number",action:function(e){e.obj.set("angle",e.property)},defaultvalue:0}]}),draw2d.Connection=draw2d.shape.basic.PolyLine.extend({NAME:"draw2d.Connection",init:function(){this._super(),this.sourcePort=null,this.targetPort=null,this.oldPoint=null,this.sourceDecorator=null,this.targetDecorator=null,this.sourceDecoratorNode=null,this.targetDecoratorNode=null,this.setColor("#1B1B1B"),this.setStroke(1),this.isMoving=!1},disconnect:function(){null!==this.sourcePort&&(this.sourcePort.detachMoveListener(this),this.fireSourcePortRouteEvent()),null!==this.targetPort&&(this.targetPort.detachMoveListener(this),this.fireTargetPortRouteEvent())},reconnect:function(){null!==this.sourcePort&&(this.sourcePort.attachMoveListener(this),this.fireSourcePortRouteEvent()),null!==this.targetPort&&(this.targetPort.attachMoveListener(this),this.fireTargetPortRouteEvent()),this.routingRequired=!0,this.repaint()},isResizeable:function(){return this.isDraggable()},addFigure:function(e,t){if(!(t instanceof draw2d.layout.locator.ConnectionLocator))throw"Locator must implement the class draw2d.layout.locator.ConnectionLocator";this._super(e,t)},setSourceDecorator:function(e){this.sourceDecorator=e,this.routingRequired=!0,null!==this.sourceDecoratorNode&&(this.sourceDecoratorNode.remove(),this.sourceDecoratorNode=null),this.repaint()},getSourceDecorator:function(){return this.sourceDecorator},setTargetDecorator:function(e){this.targetDecorator=e,this.routingRequired=!0,null!==this.targetDecoratorNode&&(this.targetDecoratorNode.remove(),this.targetDecoratorNode=null),this.repaint()},getTargetDecorator:function(){return this.targetDecorator},calculatePath:function(){null!==this.sourcePort&&null!==this.targetPort&&this._super()},repaint:function(e){if(this.repaintBlocked!==!0&&null!==this.shape&&null!==this.sourcePort&&null!==this.targetPort){if(this._super(e),null!==this.targetDecorator&&null===this.targetDecoratorNode&&(this.targetDecoratorNode=this.targetDecorator.paint(this.getCanvas().paper)),null!==this.sourceDecorator&&null===this.sourceDecoratorNode&&(this.sourceDecoratorNode=this.sourceDecorator.paint(this.getCanvas().paper)),null!==this.sourceDecoratorNode){var t=this.getVertices().get(0);this.sourceDecoratorNode.transform("r"+this.getStartAngle()+","+t.x+","+t.y+" t"+t.x+","+t.y),this.sourceDecoratorNode.attr({stroke:"#"+this.lineColor.hex(),opacity:this.alpha}),this.sourceDecoratorNode.forEach($.proxy(function(e){e.node.setAttribute("class",null!==this.cssClass?this.cssClass:"")},this))}if(null!==this.targetDecoratorNode){var n=this.getVertices().getLastElement();this.targetDecoratorNode.transform("r"+this.getEndAngle()+","+n.x+","+n.y+" t"+n.x+","+n.y),this.targetDecoratorNode.attr({stroke:"#"+this.lineColor.hex(),opacity:this.alpha}),this.targetDecoratorNode.forEach($.proxy(function(e){e.node.setAttribute("class",null!==this.cssClass?this.cssClass:"")},this))}}},getAbsoluteX:function(){return 0},getAbsoluteY:function(){return 0},postProcess:function(e){this.router.postProcess(this,this.getCanvas(),e)},onDragEnter:function(e){return e instanceof draw2d.shape.basic.LineResizeHandle?null:this},onDragLeave:function(){},getStartPoint:function(){return this.isMoving===!1?this.sourcePort.getConnectionAnchorLocation(this.targetPort.getConnectionAnchorReferencePoint()):this._super()},getEndPoint:function(){return this.isMoving===!1?this.targetPort.getConnectionAnchorLocation(this.sourcePort.getConnectionAnchorReferencePoint()):this._super()},setSource:function(e){null!==this.sourcePort&&(this.sourcePort.detachMoveListener(this),this.sourcePort.onDisconnect(this)),this.sourcePort=e,null!==this.sourcePort&&(this.routingRequired=!0,this.fireSourcePortRouteEvent(),this.sourcePort.attachMoveListener(this),null!==this.canvas&&this.sourcePort.onConnect(this),this.setStartPoint(e.getAbsoluteX(),e.getAbsoluteY()))},getSource:function(){return this.sourcePort},setTarget:function(e){null!==this.targetPort&&(this.targetPort.detachMoveListener(this),this.targetPort.onDisconnect(this)),this.targetPort=e,null!==this.targetPort&&(this.routingRequired=!0,this.fireTargetPortRouteEvent(),this.targetPort.attachMoveListener(this),null!==this.canvas&&this.targetPort.onConnect(this),this.setEndPoint(e.getAbsoluteX(),e.getAbsoluteY()))},getTarget:function(){return this.targetPort},sharingPorts:function(e){return this.sourcePort==e.sourcePort||this.sourcePort==e.targetPort||this.targetPort==e.sourcePort||this.targetPort==e.targetPort},setCanvas:function(e){this._super(e),null!==this.sourceDecoratorNode&&(this.sourceDecoratorNode.remove(),this.sourceDecoratorNode=null),null!==this.targetDecoratorNode&&(this.targetDecoratorNode.remove(),this.targetDecoratorNode=null),null===this.canvas?(this.router.onUninstall(this),null!==this.sourcePort&&(this.sourcePort.detachMoveListener(this),this.sourcePort.onDisconnect(this)),null!==this.targetPort&&(this.targetPort.detachMoveListener(this),this.targetPort.onDisconnect(this))):(this.router.onInstall(this),null!==this.sourcePort&&(this.sourcePort.attachMoveListener(this),this.sourcePort.onConnect(this)),null!==this.targetPort&&(this.targetPort.attachMoveListener(this),this.targetPort.onConnect(this)))},onOtherFigureIsMoving:function(e){e===this.sourcePort?this.setStartPoint(this.sourcePort.getAbsoluteX(),this.sourcePort.getAbsoluteY()):this.setEndPoint(this.targetPort.getAbsoluteX(),this.targetPort.getAbsoluteY()),this._super(e)},getStartAngle:function(){if(0===this.lineSegments.getSize())return 0;var e=this.lineSegments.get(0).start,t=this.lineSegments.get(0).end;this.router instanceof draw2d.layout.connection.SplineConnectionRouter&&(t=this.lineSegments.get(5).end);var n=Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)),i=-(180/Math.PI)*Math.asin((e.y-t.y)/n);return 0>i?i=t.x<e.x?Math.abs(i)+180:360-Math.abs(i):t.x<e.x&&(i=180-i),i},getEndAngle:function(){if(0===this.lineSegments.getSize())return 90;var e=this.lineSegments.get(this.lineSegments.getSize()-1).end,t=this.lineSegments.get(this.lineSegments.getSize()-1).start;this.router instanceof draw2d.layout.connection.SplineConnectionRouter&&(t=this.lineSegments.get(this.lineSegments.getSize()-5).end);var n=Math.sqrt((e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y)),i=-(180/Math.PI)*Math.asin((e.y-t.y)/n);return 0>i?i=t.x<e.x?Math.abs(i)+180:360-Math.abs(i):t.x<e.x&&(i=180-i),i},fireSourcePortRouteEvent:function(){for(var e=this.sourcePort.getConnections(),t=0;t<e.getSize();t++)e.get(t).repaint()},fireTargetPortRouteEvent:function(){for(var e=this.targetPort.getConnections(),t=0;t<e.getSize();t++)e.get(t).repaint()},createCommand:function(e){return e.getPolicy()===draw2d.command.CommandType.MOVE_BASEPOINT?new draw2d.command.CommandReconnect(this):this._super(e)},getPersistentAttributes:function(){for(var e=this._super(),t=this.getSource().getParent();null!==t.getParent();)t=t.getParent();e.source={node:t.getId(),port:this.getSource().getName()};for(var t=this.getTarget().getParent();null!==t.getParent();)t=t.getParent();return e.target={node:t.getId(),port:this.getTarget().getName()},e},setPersistentAttributes:function(e){this._super(e)}}),draw2d.Connection.createConnection=function(){return new draw2d.Connection},draw2d.Connection.DEFAULT_ROUTER=new draw2d.layout.connection.InteractiveManhattanConnectionRouter,draw2d.ResizeHandle=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.ResizeHandle",DEFAULT_COLOR:"#00bdee",init:function(e,t){this._super(),this.isResizeHandle=!0,this.owner=e,this.type=t,this.command=null,this.commandMove=null,this.commandResize=null,this.setDimension(),this.setBackgroundColor(this.DEFAULT_COLOR),this.setColor("#7A7A7A"),this.setStroke(1),this.setSelectable(!1),this.setRadius(0)},select:function(){},unselect:function(){},getSnapToDirection:function(){switch(this.type){case 1:return draw2d.SnapToHelper.NORTH_WEST;case 2:return draw2d.SnapToHelper.NORTH;case 3:return draw2d.SnapToHelper.NORTH_EAST;case 4:return draw2d.SnapToHelper.EAST;case 5:return draw2d.SnapToHelper.SOUTH_EAST;case 6:return draw2d.SnapToHelper.SOUTH;case 7:return draw2d.SnapToHelper.SOUTH_WEST;case 8:return draw2d.SnapToHelper.WEST;case 9:return draw2d.SnapToHelper.NSEW;default:return draw2d.SnapToHelper.EAST}},createShapeElement:function(){var e=this._super();switch(this.type){case 1:e.attr({cursor:"nw-resize"});break;case 2:e.attr({cursor:"n-resize"});break;case 3:e.attr({cursor:"ne-resize"});break;case 4:e.attr({cursor:"e-resize"});break;case 5:e.attr({cursor:"se-resize"});break;case 6:e.attr({cursor:"s-resize"});break;case 7:e.attr({cursor:"sw-resize"});break;case 8:e.attr({cursor:"w-resize"});break;default:e.attr({cursor:"move"})}return e},onDragStart:function(){return this.isDraggable()?(this.ox=this.getAbsoluteX(),this.oy=this.getAbsoluteY(),this.commandMove=this.owner.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE)),this.commandResize=this.owner.createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.RESIZE)),!0):!1},onDrag:function(e,t,n,i){if(this.isDraggable()!==!1){var o=this.getAbsoluteX(),s=this.getAbsoluteY();this._super(e,t,n,i);var a=this.getAbsoluteX()-o,r=this.getAbsoluteY()-s,l=this.owner,u=l.getAbsoluteX(),d=l.getAbsoluteY(),c=l.getWidth(),p=l.getHeight();switch(this.type){case 1:l.setDimension(c-a,p-r),l.setPosition(u+(c-l.getWidth()),d+(p-l.getHeight()));break;case 2:l.setDimension(c,p-r),l.setPosition(u,d+(p-l.getHeight()));break;case 3:l.setDimension(c+a,p-r),l.setPosition(u,d+(p-l.getHeight()));break;case 4:l.setDimension(c+a,p);break;case 5:l.setDimension(c+a,p+r);break;case 6:l.setDimension(c,p+r);break;case 7:l.setDimension(c-a,p+r),l.setPosition(u+(c-l.getWidth()),d);break;case 8:l.setDimension(c-a,p),l.setPosition(u+(c-l.getWidth()),d)}}},onDragEnd:function(){this.isDraggable()&&(null!==this.commandMove&&(this.commandMove.setPosition(this.owner.getX(),this.owner.getY()),this.canvas.getCommandStack().execute(this.commandMove),this.commandMove=null),null!==this.commandResize&&(this.commandResize.setDimension(this.owner.getWidth(),this.owner.getHeight()),this.canvas.getCommandStack().execute(this.commandResize),this.commandResize=null),this.canvas.hideSnapToHelperLines())},setPosition:function(e,t){e instanceof draw2d.geo.Point?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t),this.repaint()},setDimension:function(e,t){"undefined"!=typeof t?this._super(e,t):draw2d.isTouchDevice?this._super(15,15):this._super(.5,.5);var n=this.getWidth(),i=n/2;switch(this.type){case 1:this.setSnapToGridAnchor(new draw2d.geo.Point(n,n));break;case 2:this.setSnapToGridAnchor(new draw2d.geo.Point(i,n));break;case 3:this.setSnapToGridAnchor(new draw2d.geo.Point(0,n));break;case 4:this.setSnapToGridAnchor(new draw2d.geo.Point(0,i));break;case 5:this.setSnapToGridAnchor(new draw2d.geo.Point(0,0));break;case 6:this.setSnapToGridAnchor(new draw2d.geo.Point(i,0));break;case 7:this.setSnapToGridAnchor(new draw2d.geo.Point(n,0));break;case 8:this.setSnapToGridAnchor(new draw2d.geo.Point(n,i));break;case 9:this.setSnapToGridAnchor(new draw2d.geo.Point(i,i))}},show:function(e){this.setCanvas(e),this.canvas.resizeHandles.add(this),this.shape.toFront()},hide:function(){null!==this.shape&&(this.canvas.resizeHandles.remove(this),this.setCanvas(null))},repaint:function(e){this.repaintBlocked!==!0&&null!==this.shape&&("undefined"==typeof e&&(e={}),e.fill=this.getAlpha()<.9?"#e6e6e8":"90-#b8c8ec-#e6e6e8",this._super(e))},supportsSnapToHelper:function(){return!0},onKeyDown:function(e,t){this.canvas.onKeyDown(e,t)},fireMoveEvent:function(){}}),draw2d.shape.basic.LineResizeHandle=draw2d.shape.basic.Circle.extend({NAME:"draw2d.shape.basic.LineResizeHandle",init:function(e){this._super(),this.owner=e,this.isResizeHandle=!0,draw2d.isTouchDevice?this.setDimension(20,20):this.setDimension(2,2),this.setBackgroundColor("#00bdee"),this.setColor("#7A7A7A"),this.setStroke(1),this.setSelectable(!1),this.currentTarget=null},createShapeElement:function(){var e=this._super();return e.attr({cursor:"move"}),e},select:function(){},unselect:function(){},getRelatedPort:function(){return null},getOppositePort:function(){return null},repaint:function(e){this.repaintBlocked!==!0&&null!==this.shape&&("undefined"==typeof e&&(e={}),e.fill=this.getAlpha()<.9?"#b4e391":"r(.4,.3)#b4e391-#61c419:60-#299a0b",this._super(e))},onDragStart:function(){return this.command=this.getCanvas().getCurrentSelection().createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE_BASEPOINT)),!0},onDrag:function(e,t,n,i){this.setPosition(this.x+n,this.y+i);var o=this.getOppositePort(),s=null!==o?o.getDropTarget(this.getX(),this.getY(),null):null;return s!==this.currentTarget&&(null!==this.currentTarget&&(this.currentTarget.onDragLeave(o),this.currentTarget.setGlow(!1)),null!==s&&(this.currentTarget=s.onDragEnter(o),null!==this.currentTarget&&this.currentTarget.setGlow(!0))),!0},onDragEnd:function(){if(!this.isDraggable())return!1;var e=this.getOppositePort();return null!==e&&null!==this.currentTarget&&(this.onDrop(this.currentTarget),this.currentTarget.onDragLeave(e),this.currentTarget.setGlow(!1),this.currentTarget=null),this.owner.isMoving=!1,this.getCanvas().getCurrentSelection()instanceof draw2d.Connection?null!==this.command&&this.command.cancel():null!==this.command&&this.getCanvas().getCommandStack().execute(this.command),this.command=null,this.getCanvas().hideSnapToHelperLines(),!0},relocate:function(){},supportsSnapToHelper:function(){return this.getCanvas().getCurrentSelection()instanceof draw2d.Connection?!1:!0},show:function(e,t,n){this.setCanvas(e),this.setPosition(t,n),this.shape.toFront(),this.canvas.resizeHandles.add(this)},hide:function(){null!==this.shape&&(this.canvas.resizeHandles.remove(this),this.setCanvas(null))},onKeyDown:function(e,t){this.canvas.onKeyDown(e,t)},fireMoveEvent:function(){}}),draw2d.shape.basic.LineStartResizeHandle=draw2d.shape.basic.LineResizeHandle.extend({NAME:"draw2d.shape.basic.LineStartResizeHandle",init:function(e){this._super(e)},getRelatedPort:function(){return this.owner instanceof draw2d.Connection?this.owner.getSource():null},getOppositePort:function(){return this.owner instanceof draw2d.Connection?this.owner.getTarget():null},onDrag:function(e,t,n,i){this._super(e,t,n,i);var o=this.owner.getStartPoint();return o.translate(n,i),this.owner.setStartPoint(o.x,o.y),this.owner.isMoving=!0,!0},onDrop:function(e){this.owner.isMoving=!1,this.owner instanceof draw2d.Connection&&null!==this.command&&(this.command.setNewPorts(e,this.owner.getTarget()),this.getCanvas().getCommandStack().execute(this.command)),this.command=null},relocate:function(){var e=this.getWidth()/2,t=this.getHeight()/2,n=this.owner.getStartPoint();this.setPosition(n.x-e,n.y-t)}}),draw2d.shape.basic.LineEndResizeHandle=draw2d.shape.basic.LineResizeHandle.extend({NAME:"draw2d.shape.basic.LineEndResizeHandle",init:function(e){this._super(e)},getRelatedPort:function(){return this.owner instanceof draw2d.Connection?this.owner.getTarget():null},getOppositePort:function(){return this.owner instanceof draw2d.Connection?this.owner.getSource():null},onDrag:function(e,t,n,i){this._super(e,t,n,i);var o=this.owner.getEndPoint();return o.translate(n,i),this.owner.setEndPoint(o.x,o.y),this.owner.isMoving=!0,!0},onDrop:function(e){this.owner.isMoving=!1,this.owner instanceof draw2d.Connection&&null!==this.command&&(this.command.setNewPorts(this.owner.getSource(),e),this.getCanvas().getCommandStack().execute(this.command)),this.command=null
},relocate:function(){var e=this.getWidth()/2,t=this.getHeight()/2,n=this.owner.getEndPoint();this.setPosition(n.x-e,n.y-t)}}),draw2d.shape.basic.VertexResizeHandle=draw2d.ResizeHandle.extend({NAME:"draw2d.shape.basic.VertexResizeHandle",SNAP_THRESHOLD:3,LINE_COLOR:"#1387E6",FADEOUT_DURATION:300,init:function(e,t){this._super(e),this.index=t,this.isDead=!1,this.vline=null,this.hline=null},onDoubleClick:function(){var e=new draw2d.command.CommandRemoveVertex(this.owner,this.index);this.getCanvas().getCommandStack().execute(e),this.isDead=!0},onDragStart:function(){this.isDead!==!0&&(this._super(),this.command=this.getCanvas().getCurrentSelection().createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.MOVE_VERTEX)),null!=this.command&&(this.command.setIndex(this.index),this.setAlpha(.2),this.shape.attr({cursor:"crosshair"})),this.vertex=this.owner.getVertices().get(this.index).clone())},onDrag:function(e,t,n,i){if(this.isDead===!0||null==this.command)return!1;this.setPosition(this.x+n,this.y+i),this.vertex.translate(n,i),this.owner.setVertex(this.index,this.vertex.x,this.vertex.y),this.command.updatePosition(this.vertex.x,this.vertex.y);var o=this.owner.getVertices(),s=o.getSize(),a=o.get((this.index-1+s)%s),r=o.get((this.index+1)%s);return Math.abs(a.x-this.vertex.x)<this.SNAP_THRESHOLD?this.showVerticalLine(a.x):Math.abs(r.x-this.vertex.x)<this.SNAP_THRESHOLD?this.showVerticalLine(r.x):this.hideVerticalLine(),Math.abs(a.y-this.vertex.y)<this.SNAP_THRESHOLD?this.showHorizontalLine(a.y):Math.abs(r.y-this.vertex.y)<this.SNAP_THRESHOLD?this.showHorizontalLine(r.y):this.hideHorizontalLine(),!0},onDragEnd:function(){if(this.isDead===!0||null===this.command)return!1;this.shape.attr({cursor:"move"}),this.hideVerticalLine(),this.hideHorizontalLine();var e=this.owner.getVertices(),t=e.getSize(),n=e.get((this.index-1+t)%t),i=e.get((this.index+1)%t);Math.abs(n.x-this.vertex.x)<this.SNAP_THRESHOLD?this.command.updatePosition(n.x,this.vertex.y):Math.abs(i.x-this.vertex.x)<this.SNAP_THRESHOLD&&this.command.updatePosition(i.x,this.vertex.y),Math.abs(n.y-this.vertex.y)<this.SNAP_THRESHOLD?this.command.updatePosition(this.vertex.x,n.y):Math.abs(i.y-this.vertex.y)<this.SNAP_THRESHOLD&&this.command.updatePosition(this.vertex.x,i.y);var o=this.getCanvas().getCommandStack();o.startTransaction();try{o.execute(this.command),this.command=null,this.getCanvas().hideSnapToHelperLines();var s=this.getEnclosingAngle();if(s>178){var a=new draw2d.command.CommandRemoveVertex(this.owner,this.index);o.execute(a)}}finally{o.commitTransaction()}return this.setAlpha(1),!0},relocate:function(){var e=this.getWidth()/2,t=this.getHeight()/2,n=this.owner.getVertices().get(this.index);this.setPosition(n.x-e,n.y-t)},getEnclosingAngle:function(){var e=this.owner.getVertices(),t=this.vertex.getScaled(-1),n=e.getSize(),i=e.get((this.index-1+n)%n).getTranslated(t),o=e.get((this.index+1)%n).getTranslated(t),s=i.dot(o),a=Math.acos(s/(i.length()*o.length()));return 180*a/Math.PI},showVerticalLine:function(e){null==this.vline&&(this.vline=this.canvas.paper.path("M "+e+" 0 l 0 "+this.canvas.getHeight()).attr({stroke:this.LINE_COLOR,"stroke-width":1}))},hideVerticalLine:function(){if(null!=this.vline){var e=this.vline;e.animate({opacity:.1},this.FADEOUT_DURATION,function(){e.remove()}),this.vline=null}},showHorizontalLine:function(e){null==this.hline&&(this.hline=this.canvas.paper.path("M 0 "+e+" l "+this.canvas.getWidth()+" 0").attr({stroke:this.LINE_COLOR,"stroke-width":1}))},hideHorizontalLine:function(){if(null!=this.hline){var e=this.hline;e.animate({opacity:.1},this.FADEOUT_DURATION,function(){e.remove()}),this.hline=null}}}),draw2d.Port=draw2d.shape.basic.Circle.extend({NAME:"draw2d.Port",DEFAULT_BORDER_COLOR:new draw2d.util.Color("#1B1B1B"),init:function(e){this.locator=null,this.lighterBgColor=null,this._super(),draw2d.isTouchDevice?this.setDimension(25,25):this.setDimension(2,2),this.ox=this.x,this.oy=this.y,this.coronaWidth=1,this.corona=null,this.currentTargetPort=null,this.currentTarget=null,this.setBackgroundColor("#4f6870"),this.setStroke(1),this.setColor(this.DEFAULT_BORDER_COLOR),this.setSelectable(!1),this.name="undefined"==typeof e?null:e,this.connectionAnchor=new draw2d.layout.anchor.ConnectionAnchor(this),this.value=null,this.maxFanOut=Number.MAX_VALUE,this.setCanSnapToHelper(!1),this.installEditPolicy(new draw2d.policy.port.IntrusivePortsFeedbackPolicy)},setMaxFanOut:function(e){return this.maxFanOut=Math.max(1,e),this},getMaxFanOut:function(){return this.maxFanOut},setConnectionAnchor:function(e){return("undefined"==typeof e||null===e)&&(e=new draw2d.layout.anchor.ConnectionAnchor),this.connectionAnchor=e,this.connectionAnchor.setOwner(this),this},getConnectionAnchorLocation:function(e){return this.connectionAnchor.getLocation(e)},getConnectionAnchorReferencePoint:function(){return this.connectionAnchor.getReferencePoint()},getConnectionDirection:function(){return this.getParent().getBoundingBox().getDirection(this.getAbsolutePosition())},setLocator:function(e){return this.locator=e,this},setBackgroundColor:function(e){return this._super(e),this.lighterBgColor=this.bgColor.lighter(.3).hash(),this},setValue:function(e){return this.value=e,null!==this.getParent()&&this.getParent().onPortValueChanged(this),this},getValue:function(){return this.value},repaint:function(e){this.repaintBlocked!==!0&&null!==this.shape&&("undefined"==typeof e&&(e={}),e.cx=this.getAbsoluteX(),e.cy=this.getAbsoluteY(),e.rx=this.width/2,e.ry=e.rx,e.cursor="move",e.title=this.tooltip,e.fill=this.getAlpha()<.9?this.bgColor.hash():["90",this.bgColor.hash(),this.lighterBgColor].join("-"),this._super(e))},onMouseEnter:function(){this.setStroke(2)},onMouseLeave:function(){this.setStroke(1)},onDoubleClick:function(){this.parent.onDoubleClick()},onClick:function(){this.parent.onClick()},getConnections:function(){for(var e=new draw2d.util.ArrayList,t=this.moveListener.getSize(),n=0;t>n;n++){var i=this.moveListener.get(n);i instanceof draw2d.Connection&&e.add(i)}return e},setParent:function(e){this._super(e),null!==this.parent&&this.parent.detachMoveListener(this),null!==this.parent&&this.parent.attachMoveListener(this)},getCoronaWidth:function(){return this.coronaWidth},setCoronaWidth:function(e){this.coronaWidth=e},onDragStart:function(){return this.getConnections().getSize()>=this.maxFanOut?!1:(this.isInDragDrop===!0&&this.onDragEnd(),this.getShapeElement().toFront(),this.ox=this.x,this.oy=this.y,this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.onDragStart(this.canvas,this)},this)),!0)},onDrag:function(e,t){this.isInDragDrop=!0,this._super(e,t);var n=this.getDropTarget(this.getAbsoluteX(),this.getAbsoluteY(),this);n!==this.currentTarget&&(null!==this.currentTarget&&(this.currentTarget.onDragLeave(this),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.port.PortFeedbackPolicy&&t.onHoverLeave(this.canvas,this,this.currentTarget)},this))),null!==n?(this.currentTarget=n.onDragEnter(this),null!==this.currentTarget&&(this.currentTargetPort=n,this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.port.PortFeedbackPolicy&&t.onHoverEnter(this.canvas,this,this.currentTarget)},this)))):this.currentTarget=null)},onDragEnd:function(){this.setAlpha(1),this.setPosition(this.ox,this.oy),this.isInDragDrop=!1,this.currentTarget&&this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.port.PortFeedbackPolicy&&t.onHoverLeave(this.canvas,this,this.currentTarget)},this)),this.editPolicy.each($.proxy(function(e,t){t instanceof draw2d.policy.figure.DragDropEditPolicy&&t.onDragEnd(this.canvas,this)},this)),this.currentTarget=null},onDragEnter:function(e){if(!(e instanceof draw2d.Port))return null;if(this.getConnections().getSize()>=this.maxFanOut)return null;var t=new draw2d.command.CommandType(draw2d.command.CommandType.CONNECT);t.canvas=this.parent.getCanvas(),t.source=this,t.target=e;var n=e.createCommand(t);return null===n?null:this},onDragLeave:function(e){!(e instanceof draw2d.Port)},onDrop:function(e){if(e instanceof draw2d.Port&&!(this.getParent()instanceof draw2d.shape.node.IconObject&&e.getParent()instanceof draw2d.shape.node.IconObject)){var t=new draw2d.command.CommandType(draw2d.command.CommandType.CONNECT);t.canvas=this.parent.getCanvas(),t.source=e,t.target=this;var n=e,i=this,o=null;if("Control"==t.source.parent.shapeCat){if(n=this,i=e,n.getConnections().getSize()>0)return iToast.showWarn("Warning","Control Point port is already assigned."),void 0;o=GPLViewModel.getProp(i.parent.id).upi()}else o=GPLViewModel.getDProp(i.parent.id,"_id"),o=null==o?GPLViewModel.getProp(i.parent.id).upi():o.Value();"draw2d.shape.node.ConstantValueObj"==this.parent.NAME&&(o=this.value),GPLViewModel.setSourceTarget(i.parent.id,n.parent.id,n.propertyRepresented,o);var s=this.createCommand(t);if(null!==s&&this.parent.getCanvas().getCommandStack().execute(s),this.setGlow(!1),window.app.view.updateFigure(i.parent.id,!0),window.app.view.updateFigure(n.parent.id,!1),"Control"==i.parent.shapeCat&&window.app.view.updateFigure(i.parent.id,!1),"draw2d.shape.node.ConstantValueObj"==this.parent.NAME)GPLViewModel.getProp(this.parent.id).constantWorks(n);else if("draw2d.shape.node.ConstantInternalReference"==this.parent.NAME){var a=this.parent.props()["Internal Reference"].Value;GPLViewModel.getProp(this.parent.id).constantWorks(n,a)}else{var r=this;o>0&&$.ajax({url:"/api/points/"+o,type:"get",async:!0,cache:!1,success:function(e){GPLViewModel.getProp(n.parent.id).previousVersion(JSON.stringify(n.parent.getPersistentAttributes().props));var t={point:n.parent.props(),oldPoint:n.parent.props(),refPoint:e,property:n.propertyRepresented},i={};try{i=Config.Update.formatPoint(t)}catch(o){r.parent.getCanvas().getCommandStack().undo(),iToast.showError("Error","Cannot resolve a line segment due to value type mismatch.")}GPLViewModel.getProp(n.parent.id).setProps(i),GPLViewModel.getProp(n.parent.id).updated(!0)}})}}},onConnect:function(){},onDisconnect:function(){},onOtherFigureIsMoving:function(){this.repaint(),this.fireMoveEvent()},getName:function(){return this.name},setName:function(e){this.name=e},hitTest:function(e,t){var n=this.getAbsoluteX()-this.coronaWidth-this.getWidth()/2,i=this.getAbsoluteY()-this.coronaWidth-this.getHeight()/2,o=n+this.getWidth()+2*this.coronaWidth,s=i+this.getHeight()+2*this.coronaWidth;return e>=n&&o>=e&&t>=i&&s>=t},setGlow:function(e){return e===!0&&null===this.corona?(this.corona=new draw2d.Corona,this.corona.setDimension(this.getWidth()+2*this.getCoronaWidth(),this.getWidth()+2*this.getCoronaWidth()),this.corona.setPosition(this.getAbsoluteX()-this.getCoronaWidth()-this.getWidth()/2,this.getAbsoluteY()-this.getCoronaWidth()-this.getHeight()/2),this.corona.setCanvas(this.getCanvas()),this.corona.getShapeElement(),this.corona.repaint()):e===!1&&null!==this.corona&&(this.corona.setCanvas(null),this.parent.getCanvas().removeFigure(this.corona),this.corona=null),this},createCommand:function(e){return e.getPolicy()===draw2d.command.CommandType.MOVE?this.isDraggable()?new draw2d.command.CommandMovePort(this):null:e.getPolicy()===draw2d.command.CommandType.CONNECT?e.source.parent.id===e.target.parent.id?null:new draw2d.command.CommandConnect(e.canvas,e.source,e.target,e.source):null},fireMoveEvent:function(){this.isInDragDrop!==!0&&this._super()},getDropTarget:function(e,t,n){for(var i=0;i<this.targets.getSize();i++){var o=this.targets.get(i);if(o!==n&&o.hitTest(e,t)===!0)return o}return null},getDropTargets:function(){return this.targets.clone().grep($.proxy(function(e){return e!==this},this))},setRequired:function(e){this.isRequired=e},getRequired:function(){return this.isRequired}}),draw2d.Corona=draw2d.shape.basic.Circle.extend({init:function(){this._super(),this.setAlpha(.3),this.setBackgroundColor(new draw2d.util.Color(178,225,255)),this.setColor(new draw2d.util.Color(102,182,252))},setAlpha:function(e){return this._super(Math.min(.3,e)),this.setDeleteable(!1),this.setDraggable(!1),this.setResizeable(!1),this.setSelectable(!1),this}}),draw2d.InputPort=draw2d.Port.extend({NAME:"draw2d.InputPort",init:function(e){this._super(e),this.locator=new draw2d.layout.locator.InputPortLocator},onDragEnter:function(e){return e instanceof draw2d.OutputPort?this._super(e):e instanceof draw2d.HybridPort?this._super(e):null},onDragLeave:function(e){e instanceof draw2d.OutputPort?this._super(e):e instanceof draw2d.HybridPort&&this._super(e)},createCommand:function(e){return e.getPolicy()===draw2d.command.CommandType.CONNECT?e.source.getParent().getId()===e.target.getParent().getId()?null:e.source instanceof draw2d.OutputPort?new draw2d.command.CommandConnect(e.canvas,e.source,e.target):e.source instanceof draw2d.HybridPort?new draw2d.command.CommandConnect(e.canvas,e.source,e.target):null:this._super(e)}}),draw2d.OutputPort=draw2d.Port.extend({NAME:"draw2d.OutputPort",init:function(e){this._super(e),this.locator=new draw2d.layout.locator.OutputPortLocator},onDragEnter:function(e){return e instanceof draw2d.InputPort?this._super(e):e instanceof draw2d.HybridPort?this._super(e):null},onDragLeave:function(e){e instanceof draw2d.InputPort?this._super(e):e instanceof draw2d.HybridPort&&this._super(e)},createCommand:function(e){return e.getPolicy()===draw2d.command.CommandType.CONNECT?e.source instanceof draw2d.InputPort?new draw2d.command.CommandConnect(e.canvas,e.target,e.source):e.source instanceof draw2d.HybridPort?new draw2d.command.CommandConnect(e.canvas,e.target,e.source):null:this._super(e)}}),draw2d.layout.anchor.ConnectionAnchor=Class.extend({NAME:"draw2d.layout.anchor.ConnectionAnchor",init:function(e){this.owner=e},getLocation:function(){return this.getReferencePoint()},getOwner:function(){return this.owner},setOwner:function(e){if("undefined"==typeof e)throw"Missing parameter for 'owner' in ConnectionAnchor.setOwner";this.owner=e},getBox:function(){return this.getOwner().getAbsoluteBounds()},getReferencePoint:function(){return this.getOwner().getAbsolutePosition()}}),draw2d.shape.icon.Icon=draw2d.SetFigure.extend({NAME:"draw2d.shape.icon.Icon",init:function(e,t){this._super(e,t),this.setBackgroundColor("#333333")},repaint:function(e){this.repaintBlocked!==!0&&null!==this.shape&&("undefined"==typeof e&&(e={}),e.fill="none",null!==this.svgNodes&&this.svgNodes.attr({fill:this.bgColor.hash(),stroke:"none"}),this._super(e))},applyTransformation:function(){this.isResizeable()===!0?this.svgNodes.transform("S"+this.scaleX+","+this.scaleY+","+this.getAbsoluteX()+","+this.getAbsoluteY()+"t"+(this.getAbsoluteX()-this.offsetX)+","+(this.getAbsoluteY()-this.offsetY)):this.svgNodes.transform("T"+(this.getAbsoluteX()-this.offsetX)+","+(this.getAbsoluteY()-this.offsetY))},createShapeElement:function(){var e=this._super(),t=this.svgNodes.getBBox();return this.offsetX=t.x,this.offsetY=t.y,e},setDimension:function(e,t){e>t?this._super(e,e):this._super(t,t)}}),draw2d.io.Writer=Class.extend({init:function(){},marshal:function(){return""},formatXml:function(e){var t="",n=/(>)(<)(\/*)/g;e=e.replace(n,"$1\r\n$2$3");var i=0;return jQuery.each(e.split("\r\n"),function(e,n){var o=0;n.match(/.+<\/\w[^>]*>$/)?o=0:n.match(/^<\/\w/)?0!=i&&(i-=1):o=n.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var s="",a=0;i>a;a++)s+="  ";t+=s+n+"\r\n",i+=o}),t}}),draw2d.io.Reader=Class.extend({init:function(){},unmarshal:function(){}}),draw2d.io.json.Writer=draw2d.io.Writer.extend({init:function(){this._super()},marshal:function(e){var t=[],n=e.getFigures(),i=0,o=null;for(i=0;i<n.getSize();i++)o=n.get(i),t.push(o.getPersistentAttributes());var s=e.getLines();return s.each(function(e,n){t.push(n.getPersistentAttributes())}),t}}),draw2d.io.json.Reader=draw2d.io.Reader.extend({init:function(e){this.canv=e,this.gplObjects=[],this.trackUPIs=[],this.uniqueUPIs=[],this._super()},addFigure:{doWork:function(e,t,n,i){if(this.canvs=t,n.type){var o=getProperFigureClass(n),s=null,a=null;for(var r in n){var l=n[r],u=null;"source"===r?(u=this.canvs.getFigure(l.node),s=u.getPort(l.port),s.value=l.value):"target"===r&&(u=this.canvs.getFigure(l.node),a=u.getPort(l.port),a.value=l.value)}if(null!==s&&null!==a&&(o.setSource(s),s.name&&o.setTarget(a)),o.setPersistentAttributes(n),GPLViewModel.isViewer()?o.setDraggable(!1):o.setDraggable(!0),this.canvs.addFigure(o),!(o instanceof draw2d.shape.basic.Label||o instanceof draw2d.Connection)){var d=GPLViewModel.getProp(o.id);d.setPersistentAttributes(o.memento),e.trackUPIs.push({upi:n.props.UPI.Value,id:n.id}),-1==e.uniqueUPIs.indexOf(n.props.UPI.Value)&&0!=n.props.UPI.Value&&(e.uniqueUPIs.push(n.props.UPI.Value),e.gplObjects.push({"Screen Object":0,upi:parseInt(n.props.UPI.Value),"Quality Label":""}))}}i()}},unmarshal:function(e,t){var n={trackUPIs:this.trackUPIs,uniqueUPIs:this.uniqueUPIs,gplObjects:this.gplObjects};async.each(e,this.addFigure.doWork.bind(this.addFigure,n,this.canv),function(){t(n)})}}),draw2d.ui.LabelEditor=Class.extend({init:function(){},start:function(e){this.html=$('<textarea id="inplaceeditor">'),this.html.val(e.getText()),this.html.hide(),$("body").append(this.html)}}),draw2d.ui.LabelInplaceEditor=draw2d.ui.LabelEditor.extend({init:function(e){this._super(),this.listener=$.extend({onCommit:function(){},onCancel:function(){}},e)},start:function(e){this.label=e,this.commitCallback=$.proxy(this.commit,this),$("body").bind("click",this.commitCallback),this.html=$('<textarea id="inplaceeditor">'),this.html.val(e.getText()),this.html.hide(),$("body").append(this.html),this.html.autoResize({animate:!1}),this.html.bind("keyup",$.proxy(function(e){switch(e.which){case 27:this.cancel()}},this)),this.html.bind("blur",this.commitCallback),this.html.bind("click",function(e){e.stopPropagation(),e.preventDefault()});var t=this.label.getCanvas(),n=this.label.getBoundingBox();n.setPosition(t.fromCanvasToDocumentCoordinate(n.x,n.y));var i=t.getScrollArea();i.is($("body"))&&n.translate(t.getScrollLeft(),t.getScrollTop()),n.translate(-1,-1),n.resize(2,2),this.html.css({position:"absolute",top:n.y,left:n.x,"min-width":n.w*(1/t.getZoom()),height:Math.max(25,n.h*(1/t.getZoom()))}),this.html.fadeIn($.proxy(function(){this.html.focus()},this))},commit:function(){this.html.unbind("blur",this.commitCallback),$("body").unbind("click",this.commitCallback);var e=this.html.val();this.label.setText(e),this.html.fadeOut($.proxy(function(){this.html.remove(),this.html=null,this.listener.onCommit(this.label.getText())},this))},cancel:function(){this.html.unbind("blur",this.commitCallback),$("body").unbind("click",this.commitCallback),this.html.fadeOut($.proxy(function(){this.html.remove(),this.html=null,this.listener.onCancel()},this))}}),draw2d.ui.PropEditor=draw2d.ui.LabelEditor.extend({init:function(){this._super()},start:function(e,t,n,i,o,s){this.label=e,this.commitCallback=$.proxy(this.commit,this),$("body").bind("click",this.commitCallback),$("body").bind("dblclick",this.commitCallback);var a={position:"absolute",top:i,left:n,width:o,height:s,"z-index":999};this.div=$('<div class="editable" id="inplaceeditor">'+t+"</div>").appendTo("#canv"),this.div.css(a),this.div.hide(),tinymce.init({selector:"div.editable",inline:!0,plugins:["textcolor"],toolbar:"fontsizeselect | bold italic | forecolor backcolor",menubar:!1,statusbar:!1,fontsize_formats:"8pt 10pt 12pt 14pt"}),this.div.bind("keyup",$.proxy(function(e){switch(e.which){case 46:this.div.remove(),this.div=null;var t=new draw2d.command.CommandDelete(this.label),n=this.label.getCanvas();n&&n.getCommandStack().execute(t)}},this)),this.div.fadeIn($.proxy(function(){this.div.focus(),tinymce.get("inplaceeditor").focus()},this)),$("#"+this.label.id).fadeOut()},commit:function(e){if("svg"==e.target.localName){var t=tinymce.activeEditor.getContent();$("body").unbind("click",this.commitCallback),$("body").unbind("dblclick",this.commitCallback),this.label.setText(t),$("#"+this.label.id).html(t),this.div.fadeOut($.proxy(function(){this.div.remove(),this.div=null},this)),$("#"+this.label.id).fadeIn()}}}),draw2d.HybridPort=draw2d.Port.extend({NAME:"draw2d.HybridPort",init:function(e){this._super(e),this.locator=new draw2d.layout.locator.InputPortLocator},onDragEnter:function(e){return e instanceof draw2d.Port?this._super(e):null},onDragLeave:function(e){e instanceof draw2d.Port&&e instanceof draw2d.Port&&this._super(e)},createCommand:function(e){return e.getPolicy()===draw2d.command.CommandType.CONNECT?e.source.getParent().getId()===e.target.getParent().getId()?null:e.source instanceof draw2d.InputPort?new draw2d.command.CommandConnect(e.canvas,e.target,e.source):e.source instanceof draw2d.OutputPort?new draw2d.command.CommandConnect(e.canvas,e.source,e.target):e.source instanceof draw2d.HybridPort?new draw2d.command.CommandConnect(e.canvas,e.source,e.target):null:this._super(e)}}),draw2d.io.png.Writer=draw2d.io.Writer.extend({init:function(){this._super()},marshal:function(e,t){var n=e.getCurrentSelection();e.setCurrentSelection(null),e.installEditPolicy(new draw2d.policy.canvas.SnapToGeometryEditPolicy);var i=e.getHtmlContainer().html().replace(/>\s+/g,">").replace(/\s+</g,"<");return i=t?i.replace('height="1000"'," ").replace('width="3000"'," "):i.replace('height="1000"','height="400" ').replace('width="3000"','width="600" viewBox="0 0 800 400" '),i=this.formatXml(i),i=i.replace(/<desc>.*<\/desc>/g,"<desc>Create with JS graph library and RaphaelJS</desc>"),e.setCurrentSelection(n),e.installEditPolicy(new draw2d.policy.canvas.SnapToGridEditPolicy),i}});var TimerLabel=draw2d.shape.basic.Label.extend({init:function(){this._super(),this.setDimension(100,100),this.counter=0,this.startTimer(500),this.setText("Counter: 0")},onTimer:function(){this.setText("  Counter: "+ ++this.counter)}});if(draw2d.shape.note.PostIt2=draw2d.shape.basic.Label.extend({NAME:"draw2d.shape.note.PostIt2",init:function(e,t){this._super(),this.id=void 0==t?draw2d.util.UUID.create():t,this.setDimension(30,40),this.repaint(),GPLViewModel.isViewer()?this.setDraggable(!1):(this.installEditor(new draw2d.ui.LabelInplaceEditor),this.setDraggable(!0)),this.setAlpha(0),GPLViewModel.addProp(this.id,this.NAME)}}),draw2d.shape.node.IconObject=draw2d.shape.icon.Icon.extend({NAME:"draw2d.shape.node.IconObject",imgsrc:null,icon:"",memento:{},shapeCat:"",NonPoint:!0,refType:"",minRequiredConnection:1,requiredPorts:[],internalExclude:!1,customTopLocator:draw2d.layout.locator.Locator.extend({init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getBoundingBox(),o=t.getBoundingBox();t.setPosition(i.w/2-o.w/2,-(o.h+2)+5)}}),init:function(e){this._super(),this.imgsrc=e;var t=new draw2d.shape.basic.Image;t.init(e,60,60),this.addFigure(t,new draw2d.layout.locator.CenterLocator(this)),this.setDimension(10,22),this.topLocator=new this.customTopLocator(this),this.label=new draw2d.shape.basic.Label("1"),this.label.setFontColor("#1f5908"),this.label.setFontSize(9),this.label.setFontFamily("Trebuchet"),this.label.setBold(!0),this.addFigure(this.label,this.topLocator)},onDoubleClick:function(){if(!GPLViewModel.isViewer()){var e=this.canvas.getFigures();for(l=0;l<e.getSize();l++){var t=null;t=e.get(l),t.unselect()}this.select(),GPLViewModel.selectProp(this.id),GPLViewModel.beforeEditProp=JSON.stringify(this.getPersistentAttributes(),null,2);var n=GPLViewModel.selectedProp(),i=n.propertiesArray(),o=this.props();n.previousVersion(JSON.stringify(this.getPersistentAttributes().props)),n.iconChange(this.iconChange);var s=[],a=this.shapeCat;n.shapeCategory=a,ko.utils.arrayFirst(GPLViewModel.propertiesCol(),function(e){var t=window.app.view.getFigure(e.id());null!=t&&(a!=t.shapeCat||t.internalExclude||e.id()==GPLViewModel.selectedProp().id()||-1!=s.indexOfKey(e.lbl())||s.push(new KeyVal(e.lbl(),e.id())))}),n.internalRefs(s),n.isAccessed(!0);for(var r=[],l=0;l<this.iconList.length;l++)for(var u in this.iconList[l]){var d="Constant";u.indexOf("ExternalPoint")>-1&&(d="External Point"),u.indexOf("ExternalGPL")>-1&&(d="External GPL"),u.indexOf("InternalRef")>-1&&(d="Internal Reference"),r.push(new KeyVal(d,u))}n.referenceList(r),console.log(this.NAME,this.refType),n.referenceType(this.refType),n.getPointDetails(n.upi());for(var c in o)i.push(new PropValue(c,o[c].Value));n.propertiesArray(i);var p=window.open("/pointSelector/nonpointproperties","NonPointPropertyWindow","height=590,width=452");p.onload=function(){p.draw2d.pointProperties.init(n,!0)}}},openPointReview:function(){var e=GPLViewModel.getProp(this.id).upi();GPLViewModel.openPointReview(e)},setGivenName:function(e){this.label.setText(e)},getPersistentAttributes:function(){var e=GPLViewModel.getProp(this.id);return e.getPersistentAttributes()},setPersistentAttributes:function(e){this._super(e),this.memento=e},props:function(e){e=e||{};var t=GPLViewModel.getProp(this.id);return e["Reference Type"]={Value:t.referenceType()||this.refType},e["Value Type"]={Value:t.valueType()},e.UPI={Value:t.upi()},e}}),draw2d.shape.node.InputObj=draw2d.shape.node.IconObject.extend({NAME:"draw2d.shape.node.InputObj",shapeCat:"Monitor",GivenName:"Input",iconList:[{MonitorExternalPoint:"draw2d.shape.node.InputObjExternalPoint"},{MonitorExternalGPL:"draw2d.shape.node.InputObjExternalGPL"},{MonitorInternalRef:"draw2d.shape.node.InputObjInternalReference"}],DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(e,t){this.applyConsiderRotation(t,23,14)}}),init:function(e,t){this.id=t,this._super(e),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("? ? ? ? QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.rightLocator),this.outputLocator=new this.MyOutputPortLocator,this.createPortWithTooltip("output","Monitor Point","both",this.outputLocator,t+"_0",null,!0),this.setResizeable(!1),GPLViewModel.addProp(t,this.NAME),GPLViewModel.getProp(t).givenName(this.GivenName),this.iconChange={prop:["Reference Type"],values:this.iconList}}}),draw2d.shape.node.InputObjExternalPoint=draw2d.shape.node.InputObj.extend({NAME:"draw2d.shape.node.InputObjExternalPoint",init:function(e){this.id=e,this._super("/img/icons/MonitorExternalPoint.svg",e),this.refType="MonitorExternalPoint"},props:function(){var e={},t=GPLViewModel.getProp(this.id);return"MonitorInternalRef"===t.referenceType()&&(e["Internal Reference"]={Value:t.internalRef()}),this._super(e)}}),draw2d.shape.node.InputObjExternalGPL=draw2d.shape.node.InputObj.extend({NAME:"draw2d.shape.node.InputObjExternalGPL",init:function(e){this.id=e,this._super("/img/icons/MonitorExternalGPL.svg",e),this.refType="MonitorExternalGPL"}}),draw2d.shape.node.InputObjInternalReference=draw2d.shape.node.InputObj.extend({NAME:"draw2d.shape.node.InputObjInternalReference",internalExclude:!0,init:function(e){this.id=e,this._super("/img/icons/MonitorInternalRef.svg",e),this.refType="MonitorInternalRef"}}),draw2d.shape.node.OutputObj=draw2d.shape.node.IconObject.extend({NAME:"draw2d.shape.node.OutputObj",shapeCat:"Control",GivenName:"Output",iconList:[{ControlExternalPoint:"draw2d.shape.node.OutputObjExternalPoint"},{ControlExternalGPL:"draw2d.shape.node.OutputObjExternalGPL"},{ControlInternalRef:"draw2d.shape.node.OutputObjInternalReference"}],DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),controlPointRefUPI:"1213",MyInputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(e,t){this.applyConsiderRotation(t,-2,14)}}),init:function(e,t){this.id=t,this._super(e),this.setDimension(10,22),this.leftLocator=new draw2d.layout.locator.LeftLocator(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("? ? ? ? ?"):new draw2d.shape.basic.Label("? ? ? ? QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.leftLocator),this.inputLocator=new this.MyInputPortLocator,this.createPortWithTooltip("hybrid","Control Point","controlPointRefUPI",this.inputLocator,t+"_0",null,!0),this.setResizeable(!1),GPLViewModel.addProp(t,this.NAME),GPLViewModel.getProp(t).givenName(this.GivenName),this.iconChange={prop:["Reference Type"],values:this.iconList}}}),draw2d.shape.node.OutputObjExternalPoint=draw2d.shape.node.OutputObj.extend({NAME:"draw2d.shape.node.OutputObjExternalPoint",init:function(e){this.id=e,this._super("/img/icons/ControlExternalPoint.svg",e),this.refType="ControlExternalPoint"}}),draw2d.shape.node.OutputObjExternalGPL=draw2d.shape.node.OutputObj.extend({NAME:"draw2d.shape.node.OutputObjExternalGPL",init:function(e){this.id=e,this._super("/img/icons/ControlExternalGPL.svg",e),this.refType="ControlExternalGPL"}}),draw2d.shape.node.OutputObjInternalReference=draw2d.shape.node.OutputObj.extend({NAME:"draw2d.shape.node.OutputObjInternalReference",init:function(e){this.id=e,this._super("/img/icons/ControlInternalRef.svg",e),this.refType="ControlInternalRef"},props:function(){var e={},t=GPLViewModel.getProp(this.id);return e["Internal Reference"]={Value:t.internalRef()},this._super(e)}}),draw2d.shape.node.ConstantValueObj=draw2d.shape.node.IconObject.extend({NAME:"draw2d.shape.node.ConstantValueObj",shapeCat:"Constant",iconList:[{Constant:"draw2d.shape.node.ConstantValueObj"},{ConstantInternalRef:"draw2d.shape.node.ConstantInternalReference"}],GivenName:"Constant",DEFAULT_COLOR:new draw2d.util.Color("#4D90FE"),MyOutputPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(){this._super()},relocate:function(e,t){this.applyConsiderRotation(t,25,14)}}),init:function(e,t){this.id=t,this._super(e),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("? ? ? ? QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.rightLocator),this.outputLocator=new this.MyOutputPortLocator,this.createPortWithTooltip("output","Constant","Constant",this.outputLocator,t+"_0",null,!0),this.setResizeable(!1),GPLViewModel.addProp(t,this.NAME),GPLViewModel.addDProp(t,"Label",{Value:this.label.getText()}),GPLViewModel.getProp(t).givenName(this.GivenName),GPLViewModel.getProp(t).shapeCategory=this.shapeCat,this.iconChange={prop:["Reference Type"],values:this.iconList}},props:function(){var e={},t=GPLViewModel.getProp(this.id);return e["Reference Type"]={Value:t.referenceType()},"ConstantInternalRef"===t.referenceType()?(e["Internal Reference"]={Value:t.internalRef()},this._super(e)):(e["Constant Value"]=t.isEnum()?{Value:t.constantEnum()}:{Value:t.constantFloat()},this._super(e))}}),draw2d.shape.node.ConstantInternalReference=draw2d.shape.node.ConstantValueObj.extend({NAME:"draw2d.shape.node.ConstantInternalReference",init:function(e){this.id=e,this._super("/img/icons/ConstantInternalRef.svg",e),this.refType="ConstantInternalRef"}}),draw2d.shape.node.Object=draw2d.shape.basic.Rectangle.extend({NAME:"draw2d.shape.node.Object",maxConnection:4,minRequiredConnection:1,requiredPorts:[],imgsrc:null,icon:"",iconChange:{},iconChangeProperty:["Calculation Type"],customTopLocator:draw2d.layout.locator.Locator.extend({init:function(e){this._super(e)},relocate:function(e,t){var n=this.getParent(),i=n.getBoundingBox(),o=t.getBoundingBox();t.setPosition(i.w/2-o.w/2,-(o.h+2)+5)}}),CustomPortLocator:draw2d.layout.locator.PortLocator.extend({init:function(e,t){this._super(),this.x=e,this.y=t},x:0,y:0,relocate:function(e,t){this.applyConsiderRotation(t,this.x,this.y)}}),init:function(e,t){this.id=t,this._super(),null==this.imgsrc&&(this.imgsrc=e),this.setDimension(30,45),this.labelLocator=new this.customTopLocator(this),this.label=new draw2d.shape.basic.Label("1"),this.label.setFontColor("#1f5908"),this.label.setFontSize(9),this.label.setFontFamily("Trebuchet"),this.label.setBold(!0),this.addFigure(this.label,this.labelLocator);
var n=new draw2d.shape.basic.Image;n.init(e,60,60),this.addFigure(n,new draw2d.layout.locator.CenterLocator(this)),this.setResizeable(!1),GPLViewModel.addProp(t,this.NAME),GPLViewModel.getProp(t).givenName(this.GivenName),this.iconChange={prop:this.iconChangeProperty,values:this.iconList}},getPersistentAttributes:function(){var e=GPLViewModel.getProp(this.id);return e.getPersistentAttributes()},onDoubleClick:function(){for(var e=this.canvas.getFigures(),t=0;t<e.getSize();t++){var n=null;n=e.get(t),n.unselect()}this.select(),GPLViewModel.selectProp(this.id);var i=GPLViewModel.selectedProp().upi();GPLViewModel.selectedProp().isAccessed()||GPLViewModel.setProps(this.id,i,this.GivenName),GPLViewModel.beforeEditProp=JSON.stringify(this.getPersistentAttributes(),null,2),GPLViewModel.selectedProp().previousVersion(JSON.stringify(this.getPersistentAttributes().props)),GPLViewModel.selectedProp().iconChange(this.iconChange);var o=GPLViewModel.getSelectedDProp("Point Type"),s=window.open("/pointSelector/properties/"+i+"/"+o,"PointPropertiesWindow","height=600,width=482");s.onload=function(){s.draw2d.pointProperties.init(GPLViewModel.selectedProp(),!1)}},memento:{},setPersistentAttributes:function(e){this._super(e),this.memento=e},props:function(){var e=GPLViewModel.getProp(this.id);this.propertiesArray={},propArray=e.propertiesArray();for(var t in propArray)propArray[t].Name&&(this.propertiesArray[propArray[t].Name]=propArray[t].Value());return this.propertiesArray},propsOriginal:function(){var e=GPLViewModel.getOriginalProp(this.id);this.propertiesArray={},propArray=e.propertiesArray();for(var t in propArray)propArray[t].Name&&(this.propertiesArray[propArray[t].Name]=propArray[t].Value());return this.propertiesArray}}),draw2d.shape.node.BinarySelectorObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.BinarySelectorObject",init:function(e,t){this._super(e,t),this.setBackgroundColor(new draw2d.util.Color("#f9f4ae")),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,45),t+"_0"),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("StText QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.rightLocator)},GivenName:"Binary Selector",templateUrl:"SingleSetPointBinarySelPropWin"}),draw2d.shape.node.SingleSetPointBinarySelectorObject=draw2d.shape.node.BinarySelectorObject.extend({NAME:"draw2d.shape.node.SingleSetPointBinarySelectorObject",templateUrl:"SingleSetPointBinarySelPropWin",icon:"Single%20Setpoint",iconList:[{"single setpoint":"single setpoint"},{"dual setpoint":"dual setpoint"}],init:function(e,t){this._super(e,t),this.maxConnection=4,this.minRequiredConnection=2,this.createPortWithTooltip("hybrid","Monitor Point","monitorpoint",new this.CustomPortLocator(0,14),t+"_1",null,!0),this.createPortWithTooltip("hybrid","Setpoint Input","setpoint",new this.CustomPortLocator(0,34),t+"_2",null,!0),this.createPortWithTooltip("output","Control Point","controlpoint",new this.CustomPortLocator(30,22),t+"_"+(this.maxConnection-1))}}),draw2d.shape.node.DualSetPointBinarySelectorObject=draw2d.shape.node.BinarySelectorObject.extend({NAME:"draw2d.shape.node.DualSetPointBinarySelectorObject",Icon:"Dual%20Setpoint",init:function(e,t){this._super(e,t),this.maxConnection=3,this.createPortWithTooltip("hybrid","Monitor Point","monitorpoint",new this.CustomPortLocator(0,24),t+"_1",null,!0),this.createPortWithTooltip("output","Control Point","controlpoint",new this.CustomPortLocator(30,25),t+"_"+(this.maxConnection-1))}}),draw2d.shape.node.DelayPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.DelayPointObject",Icon:"Delay",iconList:[{delay:"delay"}],init:function(e,t){this._super(e,t),this.maxConnection=4,this.minRequiredConnection=2,this.setBackgroundColor(new draw2d.util.Color("#9672df")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("StText QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,45),t+"_0"),this.createPortWithTooltip("hybrid","Monitor Point","monitorpoint",new this.CustomPortLocator(0,15),t+"_1",null,!0),this.createPortWithTooltip("hybrid","Trigger Point","triggerpoint",new this.CustomPortLocator(0,34),t+"_2",null,!0),this.createPortWithTooltip("output","Control Point","controlpoint",new this.CustomPortLocator(30,22),t+"_"+(this.maxConnection-1)),this.addFigure(this.displayText,this.rightLocator)},GivenName:"Delay"}),draw2d.shape.node.PulsedDelayPointObject=draw2d.shape.node.DelayPointObject.extend({NAME:"draw2d.shape.node.PulsedDelayPointObject",Icon:"Pulsed",iconList:[{pulsed:"pulsed"}],init:function(e,t){this._super(e,t)}}),draw2d.shape.node.LogicalPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.LogicalPointObject",Icon:"Logical",iconList:[{logical:"logical"}],init:function(e,t){this._super(e,t),this.maxConnection=7,this.minRequiredConnection=1,this.requiredPorts=[1,2,3,4,5],this.setBackgroundColor(new draw2d.util.Color("#c5ef7b")),this.setDimension(40,105),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("Value QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.rightLocator),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(20,105),t+"_0"),this.createPortWithTooltip("hybrid","Input Point 1","inputpoint1",new this.CustomPortLocator(0,14),t+"_1"),this.createPortWithTooltip("hybrid","Input Point 2","inputpoint2",new this.CustomPortLocator(0,34),t+"_2"),this.createPortWithTooltip("hybrid","Input Point 3","inputpoint3",new this.CustomPortLocator(0,54),t+"_3"),this.createPortWithTooltip("hybrid","Input Point 4","inputpoint4",new this.CustomPortLocator(0,74),t+"_4"),this.createPortWithTooltip("hybrid","Input Point 5","inputpoint5",new this.CustomPortLocator(0,94),t+"_5"),this.createPortWithTooltip("output","Control Point","controlpoint",new this.CustomPortLocator(39,54),t+"_"+(this.maxConnection-1))},GivenName:"Logic"}),draw2d.shape.node.MultiplexerPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.MultiplexerPointObject",Icon:"Multiplexer",iconList:[{multiplexer:"multiplexer"}],init:function(e,t){this._super(e,t),this.setDimension(30,60),this.maxConnection=5,this.minRequiredConnection=3,this.setBackgroundColor(new draw2d.util.Color("#d8804b")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("512.6 QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.rightLocator),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,60),t+"_0"),this.createPortWithTooltip("hybrid","Input Point 1","Float",new this.CustomPortLocator(0,14),t+"_1","Input 1 Constant"),this.createPortWithTooltip("hybrid","Input Point 2","Float",new this.CustomPortLocator(0,34),t+"_2","Input 2 Constant"),this.createPortWithTooltip("hybrid","Select Input","both",new this.CustomPortLocator(0,54),t+"_3"),this.createPortWithTooltip("output","Control Point","controlpoint",new this.CustomPortLocator(30,34),t+"_"+(this.maxConnection-1))},GivenName:"Multiplexer",templateUrl:"MultiplexerPropWin"}),draw2d.shape.node.RampPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.RampPointObject",Icon:"Ramp",iconList:[{ramp:"ramp"}],init:function(e,t){this._super(e,t),this.maxConnection=3,this.minRequiredConnection=1,this.setBackgroundColor(new draw2d.util.Color("#a48246")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("512.6 QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.rightLocator),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,45),t+"_0"),this.createPortWithTooltip("hybrid","Monitor Point","monitorpoint",new this.CustomPortLocator(0,24),t+"_1",null,!0),this.createPortWithTooltip("output","Control Point","controlpoint",null,t+"_"+(this.maxConnection-1))},GivenName:"Ramp"}),draw2d.shape.node.TotalizerPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.TotalizerPointObject",Icon:"Totalizer",iconList:[{totalizer:"totalizer"}],init:function(e,t){this._super(e,t),this.maxConnection=3,this.minRequiredConnection=1,this.setBackgroundColor(new draw2d.util.Color("#abf6f7")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("512.6 QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.rightLocator),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,45),t+"_0"),this.createPortWithTooltip("hybrid","Monitor Point","monitorpoint",new this.CustomPortLocator(0,24),t+"_1",null,!0),this.createPortWithTooltip("output","Control Point","controlpoint",null,t+"_"+(this.maxConnection-1))},GivenName:"Totalizer",templateUrl:"TotalizerPropWin"}),draw2d.shape.node.AveragePointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.AveragePointObject",Icon:"Average",iconList:[{average:"average"},{sum:"sum"}],init:function(e,t){this._super(e,t),this.maxConnection=7,this.minRequiredConnection=1,this.requiredPorts=[1,2,3,4,5],this.setBackgroundColor(new draw2d.util.Color("#9aeeef")),this.setDimension(40,105),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("512.6 QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.rightLocator),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(20,105),t+"_0"),this.createPortWithTooltip("hybrid","Input Point 1","inputpoint1",new this.CustomPortLocator(0,14),t+"_1"),this.createPortWithTooltip("hybrid","Input Point 2","inputpoint2",new this.CustomPortLocator(0,35),t+"_2"),this.createPortWithTooltip("hybrid","Input Point 3","inputpoint3",new this.CustomPortLocator(0,55),t+"_3"),this.createPortWithTooltip("hybrid","Input Point 4","inputpoint4",new this.CustomPortLocator(0,75),t+"_4"),this.createPortWithTooltip("hybrid","Input Point 5","inputpoint5",new this.CustomPortLocator(0,95),t+"_5"),this.createPortWithTooltip("output","Control Point","controlpoint",new this.CustomPortLocator(43,54),t+"_"+(this.maxConnection-1)),this.calculationType="draw2d.shape.node.AveragePointObject"==this.NAME?"Average":"Summation"},GivenName:"Average"}),draw2d.shape.node.SummationPointObject=draw2d.shape.node.AveragePointObject.extend({NAME:"draw2d.shape.node.SummationPointObject",Icon:"Sum",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.SelectValueLargestPointObject=draw2d.shape.node.AveragePointObject.extend({NAME:"draw2d.shape.node.SelectValueLargestPointObject",icon:"SelectValue",iconList:[{"High Value":"draw2d.shape.node.SelectValueLargestPointObject"},{"Low Value":"draw2d.shape.node.SelectValueSmallestPointObject"}],init:function(e,t){this._super(e,t),this.setBackgroundColor(new draw2d.util.Color("#fadd19"))},GivenName:"Select Value"}),draw2d.shape.node.SelectValueSmallestPointObject=draw2d.shape.node.SelectValueLargestPointObject.extend({NAME:"draw2d.shape.node.SelectValueSmallestPointObject",Icon:"Low%20Value",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.MathPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.MathPointObject",init:function(e,t){this._super(e,t),this.maxConnection=4,this.minRequiredConnection=2,this.setBackgroundColor(new draw2d.util.Color("#dcd7d1")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("512.6 QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.rightLocator),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,47),t+"_0"),this.createPortWithTooltip("hybrid","Input Point 1","both",new this.CustomPortLocator(-2,14),t+"_1","Input 1 Constant",!0),this.createPortWithTooltip("hybrid","Input Point 2","both",new this.CustomPortLocator(-2,34),t+"_2","Input 2 Constant",!0),this.createPortWithTooltip("output","Control Point","output",new this.CustomPortLocator(30,24),t+"_"+(this.maxConnection-1))},GivenName:"Math",iconChangeProperty:["Calculation Type","Square Root"],iconList:[{Addfalse:"draw2d.shape.node.AdditionPointObject"},{Subtractfalse:"draw2d.shape.node.SubtractionPointObject"},{Multiplyfalse:"draw2d.shape.node.MultiplicationPointObject"},{Dividefalse:"draw2d.shape.node.DivisionPointObject"},{Addtrue:"draw2d.shape.node.AdditionPointSRObject"},{Subtracttrue:"draw2d.shape.node.SubtractionPointSRObject"},{Multiplytrue:"draw2d.shape.node.MultiplicationPointSRObject"},{Dividetrue:"draw2d.shape.node.DivisionPointSRObject"}]}),draw2d.shape.node.AdditionPointSRObject=draw2d.shape.node.MathPointObject.extend({NAME:"draw2d.shape.node.AdditionPointSRObject",Icon:"AddTrue",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AdditionPointObject=draw2d.shape.node.MathPointObject.extend({NAME:"draw2d.shape.node.AdditionPointObject",Icon:"AddFalse",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.SubtractionPointObject=draw2d.shape.node.MathPointObject.extend({NAME:"draw2d.shape.node.SubtractionPointObject",Icon:"SubtractFalse",init:function(e,t){this._super(e,t),this.calculationType="Minus"}}),draw2d.shape.node.SubtractionPointSRObject=draw2d.shape.node.MathPointObject.extend({NAME:"draw2d.shape.node.SubtractionPointSRObject",Icon:"SubtractTrue",init:function(e,t){this._super(e,t),this.calculationType="Minus"}}),draw2d.shape.node.MultiplicationPointObject=draw2d.shape.node.MathPointObject.extend({NAME:"draw2d.shape.node.MultiplicationPointObject",Icon:"MultiplyFalse",init:function(e,t){this._super(e,t),this.calculationType="Multiply"}}),draw2d.shape.node.MultiplicationPointSRObject=draw2d.shape.node.MathPointObject.extend({NAME:"draw2d.shape.node.MultiplicationPointSRObject",Icon:"MultiplyTrue",init:function(e,t){this._super(e,t),this.calculationType="Multiply"}}),draw2d.shape.node.DivisionPointObject=draw2d.shape.node.MathPointObject.extend({NAME:"draw2d.shape.node.DivisionPointObject",Icon:"DivideFalse",init:function(e,t){this._super(e,t),this.calculationType="Divide"}}),draw2d.shape.node.DivisionPointSRObject=draw2d.shape.node.MathPointObject.extend({NAME:"draw2d.shape.node.DivisionPointSRObject",Icon:"DivideTrue",init:function(e,t){this._super(e,t),this.calculationType="Divide"}}),draw2d.shape.node.ProportionalPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.ProportionalPointObject",icon:"",iconChangeProperty:["Calculation Type","Reverse Action"],iconList:[{"p onlytrue":"draw2d.shape.node.ProportionalPointObject"},{PItrue:"draw2d.shape.node.ProportionalPointObject"},{PIDtrue:"draw2d.shape.node.ProportionalPointObject"},{"p onlyfalse":"draw2d.shape.node.ProportionalReversePointObject"},{PIfalse:"draw2d.shape.node.ProportionalReversePointObject"},{PIDfalse:"draw2d.shape.node.ProportionalReversePointObject"}],init:function(e,t){this._super(e,t),this.maxConnection=4,this.minRequiredConnection=2,this.setBackgroundColor(new draw2d.util.Color("#0e0881")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("512.6 QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.rightLocator),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,45),t+"_0"),this.createPortWithTooltip("hybrid","Monitor Point","monitorpoint",new this.CustomPortLocator(0,14),t+"_1",null,!0),this.createPortWithTooltip("hybrid","Setpoint Input","setpoint",new this.CustomPortLocator(0,34),t+"_2",null,!0),this.createPortWithTooltip("output","Control Point","controlpoint",new this.CustomPortLocator(30,24),t+"_"+(this.maxConnection-1))},GivenName:"Proportional"}),draw2d.shape.node.ProportionalReversePointObject=draw2d.shape.node.ProportionalPointObject.extend({NAME:"draw2d.shape.node.ProportionalReversePointObject",Icon:"P%20OnlyTrue",init:function(e,t){this._super(e,t),this.calculationType="Proportional",this.reverseActing=!0}}),draw2d.shape.node.SetPointAdjustPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.SetPointAdjustPointObject",icon:"SetPointAdjust",iconChangeProperty:["Reverse Action"],iconList:[{"false":"draw2d.shape.node.SetPointAdjustNormalPointObject"},{"true":"draw2d.shape.node.SetPointAdjustReversedPointObject"}],init:function(e,t){this._super(e,t),this.maxConnection=3,this.setBackgroundColor(new draw2d.util.Color("#37903b")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("StText QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.addFigure(this.displayText,this.rightLocator),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,45),t+"_0"),this.createPortWithTooltip("hybrid","Monitor Point","monitorpoint",new this.CustomPortLocator(0,24),t+"_1",null,!0),this.createPortWithTooltip("output","Control Point","controlpoint",new this.CustomPortLocator(30,24),t+"_"+(this.maxConnection-1))},GivenName:"Setpoint Adjust"}),draw2d.shape.node.SetPointAdjustNormalPointObject=draw2d.shape.node.SetPointAdjustPointObject.extend({NAME:"draw2d.shape.node.SetPointAdjustNormalPointObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.SetPointAdjustReversedPointObject=draw2d.shape.node.SetPointAdjustPointObject.extend({NAME:"draw2d.shape.node.SetPointAdjustReversedPointObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.SingleSetPointAnalogSelectorObject=draw2d.shape.node.SingleSetPointBinarySelectorObject.extend({NAME:"draw2d.shape.node.SingleSetPointAnalogSelectorObject",Icon:"Single%20Setpoint",iconList:[{"single setpoint":"single setpoint"},{"dual setpoint":"dual setpoint"}],GivenName:"Analog Selector",init:function(e,t){this._super(e,t),this.setBackgroundColor(new draw2d.util.Color("#c1e411")),this.displayText.setText("512.6 QC"),this.GivenName="Analog Selector",this.presentValue="0.00000"}}),draw2d.shape.node.DualSetPointAnalogSelectorObject=draw2d.shape.node.DualSetPointBinarySelectorObject.extend({NAME:"draw2d.shape.node.DualSetPointAnalogSelectorObject",Icon:"Dual%20Setpoint",GivenName:"Analog Selector",init:function(e,t){this._super(e,t),this.setBackgroundColor(new draw2d.util.Color("#c1e411")),this.displayText.setText("512.6 QC"),this.GivenName="Analog Selector",this.presentValue="0.00000"}}),draw2d.shape.node.EconomizerPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.EconomizerPointObject",Icon:"Economizer",iconList:[{economizer:"economizer"}],init:function(e,t){this._super(e,t),this.setDimension(30,60),this.maxConnection=5,this.minRequiredConnection=3,this.setBackgroundColor(new draw2d.util.Color("#3899c7")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=new draw2d.shape.basic.Label("512.6 QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.createPortWithTooltip("hybrid","Shutdown Point","ShutDownPointRefUPI",new this.CustomPortLocator(15,60),t+"_0"),this.createPortWithTooltip("hybrid","Return Air Point","returnairpoint",new this.CustomPortLocator(0,14),t+"_1",null,!0),this.createPortWithTooltip("hybrid","Mixed Air Point","mixedairpoint",new this.CustomPortLocator(0,34),t+"_2",null,!0),this.createPortWithTooltip("hybrid","Outside Air Point","outsideairpoint",new this.CustomPortLocator(0,54),t+"_3",null,!0),this.createPortWithTooltip("output","Control Point","controlpoint",null,t+"_"+(this.maxConnection-1)),this.presentValue="0.00000",this.addFigure(this.displayText,this.rightLocator)},GivenName:"Economizer"}),draw2d.shape.node.EnthalpyPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.EnthalpyPointObject",icon:"Enthalpy",iconList:[{enthalpy:"enthalpy"},{enthalpydewpoint:"enthalpydewpoint"},{enthalpywetbulb:"enthalpywetbulb"}],init:function(e,t){this._super(e,t),this.minRequiredConnection=2,this.maxConnection=4,this.setBackgroundColor(new draw2d.util.Color("#8bb069")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("512.6 QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,45),t+"_0"),this.createPortWithTooltip("hybrid","Humidity Point","humiditypoint",new this.CustomPortLocator(0,14),t+"_1",null,!0),this.createPortWithTooltip("hybrid","Dry Bulb Point","drybulbpoint",new this.CustomPortLocator(0,34),t+"_2",null,!0),this.createPortWithTooltip("output","Control Point","controlpoint",null,t+"_"+(this.maxConnection-1)),this.addFigure(this.displayText,this.rightLocator),this.presentValue="0.00000"},GivenName:"Enthalpy"}),draw2d.shape.node.EnthalpyDewPointObject=draw2d.shape.node.EnthalpyPointObject.extend({NAME:"draw2d.shape.node.EnthalpyDewPointObject",Icon:"EnthalpyDewPoint",init:function(e,t){this._super(e,t),this.calculationType="EnthalpyDewPoint"}}),draw2d.shape.node.EnthalpyWetBulbObject=draw2d.shape.node.EnthalpyPointObject.extend({NAME:"draw2d.shape.node.EnthalpyWetBulbObject",Icon:"EnthalpyWetBulb",init:function(e,t){this._super(e,t),this.calculationType="EnthalpyWetBulb"}}),draw2d.shape.node.ComparatorPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.ComparatorPointObject",iconList:[{">":"draw2d.shape.node.GreaterComparatorPointObject"},{"<":"draw2d.shape.node.LessComparatorPointObject"},{">=":"draw2d.shape.node.GreaterOrEqualComparatorPointObject"},{"<=":"draw2d.shape.node.LessOrEqualComparatorPointObject"},{"=":"draw2d.shape.node.EqualComparatorPointObject"},{"<>":"draw2d.shape.node.NotEqualComparatorPointObject"}],init:function(e,t){this._super(e,t),this.maxConnection=4,this.minRequiredConnection=2,this.setBackgroundColor(new draw2d.util.Color("#fdfcdd")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("StText QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,45),t+"_0"),this.createPortWithTooltip("hybrid","Input Point 1","inputpoint1",new this.CustomPortLocator(0,14),t+"_1",null,!0),this.createPortWithTooltip("hybrid","Input Point 2","float",new this.CustomPortLocator(0,34),t+"_2","Input 2 Constant",!0),this.createPortWithTooltip("output","Control Point","controlpoint",null,t+"_"+(this.maxConnection-1)),this.addFigure(this.displayText,this.rightLocator),this.presentValue="0.00000"},GivenName:"Comparator",iconInterpreter:function(e){switch(e){case">":return"greater";case">=":return"greaterOrEqual";case"=":return"equal";case"<>":return"notequal";case"<":return"less";case"<=":return"lessOrEqual"}}}),draw2d.shape.node.GreaterComparatorPointObject=draw2d.shape.node.ComparatorPointObject.extend({NAME:"draw2d.shape.node.GreaterComparatorPointObject",Icon:"Greater",init:function(e,t){this._super(e,t),this.calculationType="Greater"}}),draw2d.shape.node.LessComparatorPointObject=draw2d.shape.node.ComparatorPointObject.extend({NAME:"draw2d.shape.node.LessComparatorPointObject",Icon:"Less",init:function(e,t){this._super(e,t),this.calculationType="Less"}}),draw2d.shape.node.GreaterOrEqualComparatorPointObject=draw2d.shape.node.ComparatorPointObject.extend({NAME:"draw2d.shape.node.GreaterOrEqualComparatorPointObject",Icon:"GreaterOrEqual",init:function(e,t){this._super(e,t),this.calculationType="GreaterOrEqual"}}),draw2d.shape.node.LessOrEqualComparatorPointObject=draw2d.shape.node.ComparatorPointObject.extend({NAME:"draw2d.shape.node.LessOrEqualComparatorPointObject",Icon:"LessOrEqual",init:function(e,t){this._super(e,t),this.calculationType="LessOrEqual"}}),draw2d.shape.node.EqualComparatorPointObject=draw2d.shape.node.ComparatorPointObject.extend({NAME:"draw2d.shape.node.EqualComparatorPointObject",Icon:"Equal",init:function(e,t){this._super(e,t),this.calculationType="Equal"}}),draw2d.shape.node.NotEqualComparatorPointObject=draw2d.shape.node.ComparatorPointObject.extend({NAME:"draw2d.shape.node.NotEqualComparatorPointObject",Icon:"NotEqual",init:function(e,t){this._super(e,t),this.calculationType="NotEqual"}}),draw2d.shape.node.DigitalLogicPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.DigitalLogicPointObject",init:function(e,t){this._super(e,t),this.maxConnection=4,this.minRequiredConnection=2,this.setBackgroundColor(new draw2d.util.Color("#768557")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("StText QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,45),t+"_0"),this.createPortWithTooltip("hybrid","Input Point 1","operandpoint1",new this.CustomPortLocator(0,13),t+"_1",null,!0),this.createPortWithTooltip("hybrid","Input Point 2","operandpoint2",new this.CustomPortLocator(0,32),t+"_2",null,!0),this.createPortWithTooltip("output","Control Point","controlpoint",new this.CustomPortLocator(30,22),t+"_"+(this.maxConnection-1)),this.addFigure(this.displayText,this.rightLocator),this.presentValue="0.00000"},iconChangeProperty:["Calculation Type"],iconList:[{And:"draw2d.shape.node.AndDigitalLogicPointObject"},{Or:"draw2d.shape.node.OrDigitalLogicPointObject"},{"X-Or":"draw2d.shape.node.XorDigitalLogicPointObject"}],GivenName:"Digital Logic"}),draw2d.shape.node.AndDigitalLogicPointObject=draw2d.shape.node.DigitalLogicPointObject.extend({NAME:"draw2d.shape.node.AndDigitalLogicPointObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.OrDigitalLogicPointObject=draw2d.shape.node.DigitalLogicPointObject.extend({NAME:"draw2d.shape.node.OrDigitalLogicPointObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.XorDigitalLogicPointObject=draw2d.shape.node.DigitalLogicPointObject.extend({NAME:"draw2d.shape.node.XorDigitalLogicPointObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusPointObject=draw2d.shape.node.Object.extend({NAME:"draw2d.shape.node.AlarmStatusPointObject",icon:"AlarmStatus",iconChangeProperty:["In Alarm","In Out of Service","In Fault","In Override"],iconList:[{truetruetruetrue:"draw2d.shape.node.AlarmStatusAllTrueObject"},{truefalsefalsefalse:"draw2d.shape.node.AlarmStatusInAlarmObject"},{falsetruefalsefalse:"draw2d.shape.node.AlarmStatusInFaultObject"},{falsefalsetruefalse:"draw2d.shape.node.AlarmStatusInOutofServiceObject"},{falsefalsefalsetrue:"draw2d.shape.node.AlarmStatusInOverrideObject"},{truetruefalsefalse:"draw2d.shape.node.AlarmStatusInAlarmInFaultObject"},{truetruetruefalse:"draw2d.shape.node.AlarmStatusInAlarmInFaultInOutofServiceObject"},{falsetruetruefalse:"draw2d.shape.node.AlarmStatusInFaultInOutofServiceObject"},{falsetruetruetrue:"draw2d.shape.node.AlarmStatusInFaultInOutofServiceInOverrideObject"},{falsefalsetruetrue:"draw2d.shape.node.AlarmStatusInOutofServiceInOverrideObject"},{falsetruefalsetrue:"draw2d.shape.node.AlarmStatusInFaultInOverrideObject"},{truetruefalsetrue:"draw2d.shape.node.AlarmStatusInAlarmInFaultInOverrideObject"},{truefalsefalsetrue:"draw2d.shape.node.AlarmStatusInAlarmInOverrideObject"},{truefalsetruefalse:"draw2d.shape.node.AlarmStatusInAlarmInOutofServiceObject"},{truefalsetruetrue:"draw2d.shape.node.AlarmStatusInAlarmInOutofServiceInOverrideObject"},{falsefalsefalsefalse:"draw2d.shape.node.AlarmStatusPointObject"}],init:function(e,t){this.maxConnection=3,this._super(e,t),this.setBackgroundColor(new draw2d.util.Color("#b72a2a")),this.rightLocator=new draw2d.layout.locator.RightLocatorFigure(this),this.displayText=GPLViewModel.isViewer()?new draw2d.shape.basic.Label("?????"):new draw2d.shape.basic.Label("Value QC"),this.displayText.setColor("#0d0d0d"),this.displayText.setFontColor("#0d0d0d"),this.displayText.setFontSize(9),this.createPortWithTooltip("hybrid","Shutdown Point","shutDownPointRefUPI",new this.CustomPortLocator(15,45),t+"_0"),this.createPortWithTooltip("hybrid","Monitor Point","monitorPointRefUPI",new this.CustomPortLocator(0,24),t+"_1",null,!0),this.createPortWithTooltip("output","Control Point","controlpoint",null,t+"_"+(this.maxConnection-1)),this.addFigure(this.displayText,this.rightLocator)},GivenName:"Alarm Status"}),draw2d.shape.node.AlarmStatusInAlarmObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInAlarmObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInFaultObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInFaultObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInOutofServiceObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInOutofServiceObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInOverrideObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInOverrideObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInAlarmInFaultObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInAlarmInFaultObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInAlarmInFaultInOutofServiceObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInAlarmInFaultInOutofServiceObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusAllTrueObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusAllTrueObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInFaultInOverrideObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInFaultInOverrideObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInOutofServiceInOverrideObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInOutofServiceInOverrideObject",init:function(e,t){this._super(e,t)
}}),draw2d.shape.node.AlarmStatusInFaultInOutofServiceObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInFaultInOutofServiceObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInAlarmInOverrideObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInAlarmInOverrideObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInAlarmInOutofServiceObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInAlarmInOutofServiceObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInFaultInOutofServiceInOverrideObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInFaultInOutofServiceInOverrideObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInFaultInOutofServiceInOverrideObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInFaultInOutofServiceInOverrideObject",init:function(e,t){this._super(e,t)}}),draw2d.shape.node.AlarmStatusInAlarmInFaultInOverrideObject=draw2d.shape.node.AlarmStatusPointObject.extend({NAME:"draw2d.shape.node.AlarmStatusInAlarmInFaultInOverrideObject",init:function(e,t){this._super(e,t)}}),function(e){function t(t,n,i,o){var s={data:o||(n?n.data:{}),_wrap:n?n._wrap:null,tmpl:null,parent:n||null,nodes:[],calls:u,nest:d,wrap:c,html:p,update:h};return t&&e.extend(s,t,{nodes:[],parent:n}),i&&(s.tmpl=i,s._ctnt=s._ctnt||s.tmpl(e,s),s.key=++b,(M.length?v:P)[b]=s),s}function n(t,o,s){var a,r=s?e.map(s,function(e){return"string"==typeof e?t.key?e.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+f+'="'+t.key+'" $2'):e:n(e,t,e._ctnt)}):t;return o?r:(r=r.join(""),r.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(t,n,o,s){a=e(o).get(),l(a),n&&(a=i(n).concat(a)),s&&(a=a.concat(i(s)))}),a?a:i(r))}function i(t){var n=document.createElement("div");return n.innerHTML=t,e.makeArray(n.childNodes)}function o(t){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+e.trim(t).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(t,n,i,o,s,r,l){var u,d,c,p=e.tmpl.tag[i];if(!p)throw"Template command not found: "+i;return u=p._default||[],r&&!/\w$/.test(s)&&(s+=r,r=""),s?(s=a(s),l=l?","+a(l)+")":r?")":"",d=r?s.indexOf(".")>-1?s+r:"("+s+").call($item"+l:s,c=r?d:"(typeof("+s+")==='function'?("+s+").call($item):("+s+"))"):c=d=u.$1||"null",o=a(o),"');"+p[n?"close":"open"].split("$notnull_1").join(s?"typeof("+s+")!=='undefined' && ("+s+")!=null":"true").split("$1a").join(c).split("$1").join(d).split("$2").join(o?o.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(e,t,n,i){return i=i?","+i+")":n?")":"",i?"("+t+").call($item"+i:e}):u.$2||"")+"_.push('"})+"');}return _;")}function s(t,i){t._wrap=n(t,!0,e.isArray(i)?i:[g.test(i)?i:e(i).html()]).join("")}function a(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function r(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}function l(n){function i(n){function i(e){e+=u,a=d[e]=d[e]||t(a,P[a.parent.key+u]||a.parent,null,!0)}var o,s,a,r,l=n;if(r=n.getAttribute(f)){for(;l.parentNode&&1===(l=l.parentNode).nodeType&&!(o=l.getAttribute(f)););o!==r&&(l=l.parentNode?11===l.nodeType?0:l.getAttribute(f)||0:0,(a=P[r])||(a=v[r],a=t(a,P[l]||v[l],null,!0),a.key=++b,P[b]=a),T&&i(r)),n.removeAttribute(f)}else T&&(a=e.data(n,"tmplItem"))&&(i(a.key),P[a.key]=a,l=e.data(n.parentNode,"tmplItem"),l=l?l.key:0);if(a){for(s=a;s&&s.key!=l;)s.nodes.push(n),s=s.parent;delete a._ctnt,delete a._wrap,e.data(n,"tmplItem",a)}}var o,s,a,r,l,u="_"+T,d={};for(a=0,r=n.length;r>a;a++)if(1===(o=n[a]).nodeType){for(s=o.getElementsByTagName("*"),l=s.length-1;l>=0;l--)i(s[l]);i(o)}}function u(e,t,n,i){return e?(M.push({_:e,tmpl:t,item:this,data:n,options:i}),void 0):M.pop()}function d(t,n,i){return e.tmpl(e.template(t),n,i,this)}function c(t,n){var i=t.options||{};return i.wrapped=n,e.tmpl(e.template(t.tmpl),t.data,i,t.item)}function p(t,n){var i=this._wrap;return e.map(e(e.isArray(i)?i.join(""):i).filter(t||"*"),function(e){return n?e.innerText||e.textContent:e.outerHTML||r(e)})}function h(){var t=this.nodes;e.tmpl(null,null,null,this).insertBefore(t[0]),e(t).remove()}var m,y=e.fn.domManip,f="_tmplitem",g=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,P={},v={},w={key:0,data:{}},b=0,T=0,M=[];e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,n){e.fn[t]=function(i){var o,s,a,r,l=[],u=e(i),d=1===this.length&&this[0].parentNode;if(m=P||{},d&&11===d.nodeType&&1===d.childNodes.length&&1===u.length)u[n](this[0]),l=this;else{for(s=0,a=u.length;a>s;s++)T=s,o=(s>0?this.clone(!0):this).get(),e.fn[n].apply(e(u[s]),o),l=l.concat(o);T=0,l=this.pushStack(l,t,u.selector)}return r=m,m=null,e.tmpl.complete(r),l}}),e.fn.extend({tmpl:function(t,n,i){return e.tmpl(this[0],t,n,i)},tmplItem:function(){return e.tmplItem(this[0])},template:function(t){return e.template(t,this[0])},domManip:function(t,n,i){if(t[0]&&t[0].nodeType){for(var o,s=e.makeArray(arguments),a=t.length,r=0;a>r&&!(o=e.data(t[r++],"tmplItem")););a>1&&(s[0]=[e.makeArray(t)]),o&&T&&(s[2]=function(t){e.tmpl.afterManip(this,t,i)}),y.apply(this,s)}else y.apply(this,arguments);return T=0,!m&&e.tmpl.complete(P),this}}),e.extend({tmpl:function(i,o,a,r){var l,u=!r;if(u)r=w,i=e.template[i]||e.template(null,i),v={};else if(!i)return i=r.tmpl,P[r.key]=r,r.nodes=[],r.wrapped&&s(r,r.wrapped),e(n(r,null,r.tmpl(e,r)));return i?("function"==typeof o&&(o=o.call(r||{})),a&&a.wrapped&&s(a,a.wrapped),l=e.isArray(o)?e.map(o,function(e){return e?t(a,r,i,e):null}):[t(a,r,i,o)],u?e(n(r,null,l)):l):[]},tmplItem:function(t){var n;for(t instanceof e&&(t=t[0]);t&&1===t.nodeType&&!(n=e.data(t,"tmplItem"))&&(t=t.parentNode););return n||w},template:function(t,n){return n?("string"==typeof n?n=o(n):n instanceof e&&(n=n[0]||{}),n.nodeType&&(n=e.data(n,"tmpl")||e.data(n,"tmpl",o(n.innerHTML))),"string"==typeof t?e.template[t]=n:n):t?"string"!=typeof t?e.template(null,t):e.template[t]||e.template(null,g.test(t)?t:e(t)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),e.extend(e.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){P={}},afterManip:function(t,n,i){var o=11===n.nodeType?e.makeArray(n.childNodes):1===n.nodeType?[n]:[];i.call(t,n),l(o),T++}})}(jQuery),function(e,t){var n=e;n.version="0.9.3",n.protocol=1,n.transports=[],n.j=[],n.sockets={},n.connect=function(e,i){var o,s,a=n.util.parseUri(e);t&&t.location&&(a.protocol=a.protocol||t.location.protocol.slice(0,-1),a.host=a.host||(t.document?t.document.domain:t.location.hostname),a.port=a.port||t.location.port),o=n.util.uniqueUri(a);var r={host:a.host,secure:"https"==a.protocol,port:a.port||("https"==a.protocol?443:80),query:a.query||""};return n.util.merge(r,i),(r["force new connection"]||!n.sockets[o])&&(s=new n.Socket(r)),!r["force new connection"]&&s&&(n.sockets[o]=s),s=s||n.sockets[o],s.of(a.path.length>1?a.path:"")}}("object"==typeof module?module.exports:this.io={},this),function(e,t){var n=e.util={},i=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,o=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.parseUri=function(e){for(var t=i.exec(e||""),n={},s=14;s--;)n[o[s]]=t[s]||"";return n},n.uniqueUri=function(e){var n=e.protocol,i=e.host,o=e.port;return"document"in t?(i=i||document.domain,o=o||("https"==n&&"https:"!==document.location.protocol?443:document.location.port)):(i=i||"localhost",o||"https"!=n||(o=443)),(n||"http")+"://"+i+":"+(o||80)},n.query=function(e,t){var i=n.chunkQuery(e||""),o=[];n.merge(i,n.chunkQuery(t||""));for(var s in i)i.hasOwnProperty(s)&&o.push(s+"="+i[s]);return o.length?"?"+o.join("&"):""},n.chunkQuery=function(e){for(var t,n={},i=e.split("&"),o=0,s=i.length;s>o;++o)t=i[o].split("="),t[0]&&(n[t[0]]=t[1]);return n};var s=!1;n.load=function(e){return"document"in t&&"complete"===document.readyState||s?e():(n.on(t,"load",e,!1),void 0)},n.on=function(e,t,n,i){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,i)},n.request=function(e){if(e&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!e||n.ua.hasCORS))return new XMLHttpRequest;if(!e)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}return null},"undefined"!=typeof window&&n.load(function(){s=!0}),n.defer=function(e){return n.ua.webkit&&"undefined"==typeof importScripts?(n.load(function(){setTimeout(e,100)}),void 0):e()},n.merge=function(e,t,i,o){var s,a=o||[],r="undefined"==typeof i?2:i;for(s in t)t.hasOwnProperty(s)&&n.indexOf(a,s)<0&&("object"==typeof e[s]&&r?n.merge(e[s],t[s],r-1,a):(e[s]=t[s],a.push(t[s])));return e},n.mixin=function(e,t){n.merge(e.prototype,t.prototype)},n.inherit=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},n.intersect=function(e,t){for(var i=[],o=e.length>t.length?e:t,s=e.length>t.length?t:e,a=0,r=s.length;r>a;a++)~n.indexOf(o,s[a])&&i.push(s[a]);return i},n.indexOf=function(e,t,n){for(var i=e.length,n=0>n?0>n+i?0:n+i:n||0;i>n&&e[n]!==t;n++);return n>=i?-1:n},n.toArray=function(e){for(var t=[],n=0,i=e.length;i>n;n++)t.push(e[n]);return t},n.ua={},n.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return void 0!=e.withCredentials}(),n.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(e,t){function n(){}e.EventEmitter=n,n.prototype.on=function(e,n){return this.$events||(this.$events={}),this.$events[e]?t.util.isArray(this.$events[e])?this.$events[e].push(n):this.$events[e]=[this.$events[e],n]:this.$events[e]=n,this},n.prototype.addListener=n.prototype.on,n.prototype.once=function(e,t){function n(){i.removeListener(e,n),t.apply(this,arguments)}var i=this;return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,n){if(this.$events&&this.$events[e]){var i=this.$events[e];if(t.util.isArray(i)){for(var o=-1,s=0,a=i.length;a>s;s++)if(i[s]===n||i[s].listener&&i[s].listener===n){o=s;break}if(0>o)return this;i.splice(o,1),i.length||delete this.$events[e]}else(i===n||i.listener&&i.listener===n)&&delete this.$events[e]}return this},n.prototype.removeAllListeners=function(e){return this.$events&&this.$events[e]&&(this.$events[e]=null),this},n.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),t.util.isArray(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},n.prototype.emit=function(e){if(!this.$events)return!1;var n=this.$events[e];if(!n)return!1;var i=Array.prototype.slice.call(arguments,1);if("function"==typeof n)n.apply(this,i);else{if(!t.util.isArray(n))return!1;for(var o=n.slice(),s=0,a=o.length;a>s;s++)o[s].apply(this,i)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){"use strict";function f(e){return 10>e?"0"+e:e}function date(e){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+f(e.getUTCMonth()+1)+"-"+f(e.getUTCDate())+"T"+f(e.getUTCHours())+":"+f(e.getUTCMinutes())+":"+f(e.getUTCSeconds())+"Z":null}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,i,o,s,a,r=gap,l=t[e];switch(l instanceof Date&&(l=date(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(s=l.length,n=0;s>n;n+=1)a[n]=str(n,l)||"null";return o=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+r+"]":"["+a.join(",")+"]",gap=r,o}if(rep&&"object"==typeof rep)for(s=rep.length,n=0;s>n;n+=1)"string"==typeof rep[n]&&(i=rep[n],o=str(i,l),o&&a.push(quote(i)+(gap?": ":":")+o));else for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(o=str(i,l),o&&a.push(quote(i)+(gap?": ":":")+o));return o=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+r+"}":"{"+a.join(",")+"}",gap=r,o}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(e,t,n){var i;if(gap="",indent="","number"==typeof n)for(i=0;n>i;i+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})},JSON.parse=function(text,reviver){function walk(e,t){var n,i,o=e[t];if(o&&"object"==typeof o)for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(i=walk(o,n),void 0!==i?o[n]=i:delete o[n]);return reviver.call(e,t,o)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof JSON?JSON:void 0),function(e,t){var n=e.parser={},i=n.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],o=n.reasons=["transport not supported","client not handshaken","unauthorized"],s=n.advice=["reconnect"],a=t.JSON,r=t.util.indexOf;n.encodePacket=function(e){var t=r(i,e.type),n=e.id||"",l=e.endpoint||"",u=e.ack,d=null;switch(e.type){case"error":var c=e.reason?r(o,e.reason):"",p=e.advice?r(s,e.advice):"";(""!==c||""!==p)&&(d=c+(""!==p?"+"+p:""));break;case"message":""!==e.data&&(d=e.data);break;case"event":var h={name:e.name};e.args&&e.args.length&&(h.args=e.args),d=a.stringify(h);break;case"json":d=a.stringify(e.data);break;case"connect":e.qs&&(d=e.qs);break;case"ack":d=e.ackId+(e.args&&e.args.length?"+"+a.stringify(e.args):"")}var m=[t,n+("data"==u?"+":""),l];return null!==d&&void 0!==d&&m.push(d),m.join(":")},n.encodePayload=function(e){var t="";if(1==e.length)return e[0];for(var n=0,i=e.length;i>n;n++){var o=e[n];t+=""+o.length+""+e[n]}return t};var l=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;n.decodePacket=function(e){var t=e.match(l);if(!t)return{};var n=t[2]||"",e=t[5]||"",r={type:i[t[1]],endpoint:t[4]||""};switch(n&&(r.id=n,r.ack=t[3]?"data":!0),r.type){case"error":var t=e.split("+");r.reason=o[t[0]]||"",r.advice=s[t[1]]||"";break;case"message":r.data=e||"";break;case"event":try{var u=a.parse(e);r.name=u.name,r.args=u.args}catch(d){}r.args=r.args||[];break;case"json":try{r.data=a.parse(e)}catch(d){}break;case"connect":r.qs=e||"";break;case"ack":var t=e.match(/^([0-9]+)(\+)?(.*)/);if(t&&(r.ackId=t[1],r.args=[],t[3]))try{r.args=t[3]?a.parse(t[3]):[]}catch(d){}break;case"disconnect":case"heartbeat":}return r},n.decodePayload=function(e){if(""==e.charAt(0)){for(var t=[],i=1,o="";i<e.length;i++)""==e.charAt(i)?(t.push(n.decodePacket(e.substr(i+1).substr(0,o))),i+=Number(o)+1,o=""):o+=e.charAt(i);return t}return[n.decodePacket(e)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t){function n(e,t){this.socket=e,this.sessid=t}e.Transport=n,t.util.mixin(n,t.EventEmitter),n.prototype.onData=function(e){if(this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout(),""!==e){var n=t.parser.decodePayload(e);if(n&&n.length)for(var i=0,o=n.length;o>i;i++)this.onPacket(n[i])}return this},n.prototype.onPacket=function(e){return this.socket.setHeartbeatTimeout(),"heartbeat"==e.type?this.onHeartbeat():("connect"==e.type&&""==e.endpoint&&this.onConnect(),this.socket.onPacket(e),this)},n.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var e=this;this.closeTimeout=setTimeout(function(){e.onDisconnect()},this.socket.closeTimeout)}},n.prototype.onDisconnect=function(){return this.close&&this.open&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},n.prototype.onConnect=function(){return this.socket.onConnect(),this},n.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},n.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},n.prototype.packet=function(e){this.send(t.parser.encodePacket(e))},n.prototype.onHeartbeat=function(){this.packet({type:"heartbeat"})},n.prototype.onOpen=function(){this.open=!0,this.clearCloseTimeout(),this.socket.onOpen()},n.prototype.onClose=function(){this.open=!1,this.socket.onClose(),this.onDisconnect()},n.prototype.prepareUrl=function(){var e=this.socket.options;return this.scheme()+"://"+e.host+":"+e.port+"/"+e.resource+"/"+t.protocol+"/"+this.name+"/"+this.sessid},n.prototype.ready=function(e,t){t.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(e){if(this.options={port:80,secure:!1,document:"document"in n?document:!1,resource:"socket.io",transports:t.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":1/0,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!0,"auto connect":!0,"flash policy port":10843},t.util.merge(this.options,e),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1,this.options["sync disconnect on unload"]&&(!this.isXDomain()||t.util.ua.hasCORS)){var i=this;t.util.on(n,"unload",function(){i.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function o(){}e.Socket=i,t.util.mixin(i,t.EventEmitter),i.prototype.of=function(e){return this.namespaces[e]||(this.namespaces[e]=new t.SocketNamespace(this,e),""!==e&&this.namespaces[e].packet({type:"connect"})),this.namespaces[e]},i.prototype.publish=function(){this.emit.apply(this,arguments);var e;for(var t in this.namespaces)this.namespaces.hasOwnProperty(t)&&(e=this.of(t),e.$emit.apply(e,arguments))},i.prototype.handshake=function(e){function n(t){t instanceof Error?i.onError(t.message):e.apply(null,t.split(":"))}var i=this,s=this.options,a=["http"+(s.secure?"s":"")+":/",s.host+":"+s.port,s.resource,t.protocol,t.util.query(this.options.query,"t="+ +new Date)].join("/");if(this.isXDomain()&&!t.util.ua.hasCORS){var r=document.getElementsByTagName("script")[0],l=document.createElement("script");l.src=a+"&jsonp="+t.j.length,r.parentNode.insertBefore(l,r),t.j.push(function(e){n(e),l.parentNode.removeChild(l)})}else{var u=t.util.request();u.open("GET",a,!0),u.withCredentials=!0,u.onreadystatechange=function(){4==u.readyState&&(u.onreadystatechange=o,200==u.status?n(u.responseText):!i.reconnecting&&i.onError(u.responseText))},u.send(null)}},i.prototype.getTransport=function(e){for(var n,i=e||this.transports,o=0;n=i[o];o++)if(t.Transport[n]&&t.Transport[n].check(this)&&(!this.isXDomain()||t.Transport[n].xdomainCheck()))return new t.Transport[n](this,this.sessionid);return null},i.prototype.connect=function(e){if(this.connecting)return this;var n=this;return this.handshake(function(i,o,s,a){function r(e){return n.transport&&n.transport.clearTimeouts(),n.transport=n.getTransport(e),n.transport?(n.transport.ready(n,function(){n.connecting=!0,n.publish("connecting",n.transport.name),n.transport.open(),n.options["connect timeout"]&&(n.connectTimeoutTimer=setTimeout(function(){if(!n.connected&&(n.connecting=!1,n.options["try multiple transports"])){n.remainingTransports||(n.remainingTransports=n.transports.slice(0));for(var e=n.remainingTransports;e.length>0&&e.splice(0,1)[0]!=n.transport.name;);e.length?r(e):n.publish("connect_failed")}},n.options["connect timeout"]))}),void 0):n.publish("connect_failed")}n.sessionid=i,n.closeTimeout=1e3*s,n.heartbeatTimeout=1e3*o,n.transports=a?t.util.intersect(a.split(","),n.options.transports):n.options.transports,n.setHeartbeatTimeout(),r(n.transports),n.once("connect",function(){clearTimeout(n.connectTimeoutTimer),e&&"function"==typeof e&&e()})}),this},i.prototype.setHeartbeatTimeout=function(){clearTimeout(this.heartbeatTimeoutTimer);var e=this;this.heartbeatTimeoutTimer=setTimeout(function(){e.transport.onClose()},this.heartbeatTimeout)},i.prototype.packet=function(e){return this.connected&&!this.doBuffer?this.transport.packet(e):this.buffer.push(e),this},i.prototype.setBuffer=function(e){this.doBuffer=e,!e&&this.connected&&this.buffer.length&&(this.transport.payload(this.buffer),this.buffer=[])},i.prototype.disconnect=function(){return(this.connected||this.connecting)&&(this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted")),this},i.prototype.disconnectSync=function(){var e=t.util.request(),n=this.resource+"/"+t.protocol+"/"+this.sessionid;e.open("GET",n,!0),this.onDisconnect("booted")},i.prototype.isXDomain=function(){var e=n.location.port||("https:"==n.location.protocol?443:80);return this.options.host!==n.location.hostname||this.options.port!=e},i.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},i.prototype.onOpen=function(){this.open=!0},i.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},i.prototype.onPacket=function(e){this.of(e.endpoint).onPacket(e)},i.prototype.onError=function(e){e&&e.advice&&"reconnect"===e.advice&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",e&&e.reason?e.reason:e)},i.prototype.onDisconnect=function(e){var t=this.connected,n=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1,(t||n)&&(this.transport.close(),this.transport.clearTimeouts(),t&&(this.publish("disconnect",e),"booted"!=e&&this.options.reconnect&&!this.reconnecting&&this.reconnect()))},i.prototype.reconnect=function(){function e(){if(n.connected){for(var e in n.namespaces)n.namespaces.hasOwnProperty(e)&&""!==e&&n.namespaces[e].packet({type:"connect"});n.publish("reconnect",n.transport.name,n.reconnectionAttempts)}clearTimeout(n.reconnectionTimer),n.removeListener("connect_failed",t),n.removeListener("connect",t),n.reconnecting=!1,delete n.reconnectionAttempts,delete n.reconnectionDelay,delete n.reconnectionTimer,delete n.redoTransports,n.options["try multiple transports"]=o}function t(){return n.reconnecting?n.connected?e():n.connecting&&n.reconnecting?n.reconnectionTimer=setTimeout(t,1e3):(n.reconnectionAttempts++>=i?n.redoTransports?(n.publish("reconnect_failed"),e()):(n.on("connect_failed",t),n.options["try multiple transports"]=!0,n.transport=n.getTransport(),n.redoTransports=!0,n.connect()):(n.reconnectionDelay<s&&(n.reconnectionDelay*=2),n.connect(),n.publish("reconnecting",n.reconnectionDelay,n.reconnectionAttempts),n.reconnectionTimer=setTimeout(t,n.reconnectionDelay)),void 0):void 0}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var n=this,i=this.options["max reconnection attempts"],o=this.options["try multiple transports"],s=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(t,this.reconnectionDelay),this.on("connect",t)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(e,t){this.socket=e,this.name=t||"",this.flags={},this.json=new i(this,"json"),this.ackPackets=0,this.acks={}}function i(e,t){this.namespace=e,this.name=t}e.SocketNamespace=n,t.util.mixin(n,t.EventEmitter),n.prototype.$emit=t.EventEmitter.prototype.emit,n.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},n.prototype.packet=function(e){return e.endpoint=this.name,this.socket.packet(e),this.flags={},this},n.prototype.send=function(e,t){var n={type:this.flags.json?"json":"message",data:e};return"function"==typeof t&&(n.id=++this.ackPackets,n.ack=!0,this.acks[n.id]=t),this.packet(n)},n.prototype.emit=function(e){var t=Array.prototype.slice.call(arguments,1),n=t[t.length-1],i={type:"event",name:e};return"function"==typeof n&&(i.id=++this.ackPackets,i.ack="data",this.acks[i.id]=n,t=t.slice(0,t.length-1)),i.args=t,this.packet(i)},n.prototype.disconnect=function(){return""===this.name?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},n.prototype.onPacket=function(e){function n(){i.packet({type:"ack",args:t.util.toArray(arguments),ackId:e.id})}var i=this;switch(e.type){case"connect":this.$emit("connect");break;case"disconnect":""===this.name?this.socket.onDisconnect(e.reason||"booted"):this.$emit("disconnect",e.reason);break;case"message":case"json":var o=["message",e.data];"data"==e.ack?o.push(n):e.ack&&this.packet({type:"ack",ackId:e.id}),this.$emit.apply(this,o);break;case"event":var o=[e.name].concat(e.args);"data"==e.ack&&o.push(n),this.$emit.apply(this,o);break;case"ack":this.acks[e.ackId]&&(this.acks[e.ackId].apply(this,e.args),delete this.acks[e.ackId]);break;case"error":e.advice?this.socket.onError(e):"unauthorized"==e.reason?this.$emit("connect_failed",e.reason):this.$emit("error",e.reason)}},i.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},i.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(){t.Transport.apply(this,arguments)}e.websocket=i,t.util.inherit(i,t.Transport),i.prototype.name="websocket",i.prototype.open=function(){var e,i=t.util.query(this.socket.options.query),o=this;return e||(e=n.MozWebSocket||n.WebSocket),this.websocket=new e(this.prepareUrl()+i),this.websocket.onopen=function(){o.onOpen(),o.socket.setBuffer(!1)},this.websocket.onmessage=function(e){o.onData(e.data)},this.websocket.onclose=function(){o.onClose(),o.socket.setBuffer(!0)},this.websocket.onerror=function(e){o.onError(e)},this},i.prototype.send=function(e){return this.websocket.send(e),this},i.prototype.payload=function(e){for(var t=0,n=e.length;n>t;t++)this.packet(e[t]);return this},i.prototype.close=function(){return this.websocket.close(),this},i.prototype.onError=function(e){this.socket.onError(e)},i.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},i.check=function(){return"WebSocket"in n&&!("__addTask"in WebSocket)||"MozWebSocket"in n},i.xdomainCheck=function(){return!0},t.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(){t.Transport.websocket.apply(this,arguments)}e.flashsocket=n,t.util.inherit(n,t.Transport.websocket),n.prototype.name="flashsocket",n.prototype.open=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.open.apply(e,n)}),this},n.prototype.send=function(){var e=this,n=arguments;return WebSocket.__addTask(function(){t.Transport.websocket.prototype.send.apply(e,n)}),this},n.prototype.close=function(){return WebSocket.__tasks.length=0,t.Transport.websocket.prototype.close.call(this),this},n.prototype.ready=function(e,i){function o(){var t=e.options,o=t["flash policy port"],a=["http"+(t.secure?"s":"")+":/",t.host+":"+t.port,t.resource,"static/flashsocket","WebSocketMain"+(e.isXDomain()?"Insecure":"")+".swf"];n.loaded||("undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=a.join("/")),843!==o&&WebSocket.loadFlashPolicyFile("xmlsocket://"+t.host+":"+o),WebSocket.__initialize(),n.loaded=!0),i.call(s)}var s=this;return document.body?o():(t.util.load(o),void 0)},n.check=function(){return"undefined"!=typeof WebSocket&&"__initialize"in WebSocket&&swfobject?swfobject.getFlashPlayerVersion().major>=10:!1},n.xdomainCheck=function(){return!0},"undefined"!=typeof window&&(WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0),t.transports.push("flashsocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),"undefined"!=typeof window)var swfobject=function(){function e(){if(!H){try{var e=L.getElementsByTagName("body")[0].appendChild(f("span"));e.parentNode.removeChild(e)}catch(t){return}H=!0;for(var n=F.length,i=0;n>i;i++)F[i]()}}function t(e){H?e():F[F.length]=e}function n(e){if(typeof _.addEventListener!=S)_.addEventListener("load",e,!1);else if(typeof L.addEventListener!=S)L.addEventListener("load",e,!1);else if(typeof _.attachEvent!=S)g(_,"onload",e);else if("function"==typeof _.onload){var t=_.onload;_.onload=function(){t(),e()}}else _.onload=e}function i(){U?o():s()}function o(){var e=L.getElementsByTagName("body")[0],t=f(V);t.setAttribute("type",A);var n=e.appendChild(t);if(n){var i=0;!function(){if(typeof n.GetVariable!=S){var o=n.GetVariable("$version");o&&(o=o.split(" ")[1].split(","),z.pv=[parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10)])}else if(10>i)return i++,setTimeout(arguments.callee,10),void 0;e.removeChild(t),n=null,s()}()}else s()}function s(){var e=J.length;if(e>0)for(var t=0;e>t;t++){var n=J[t].id,i=J[t].callbackFn,o={success:!1,id:n};if(z.pv[0]>0){var s=y(n);if(s)if(!P(J[t].swfVersion)||z.wk&&z.wk<312)if(J[t].expressInstall&&r()){var d={};d.data=J[t].expressInstall,d.width=s.getAttribute("width")||"0",d.height=s.getAttribute("height")||"0",s.getAttribute("class")&&(d.styleclass=s.getAttribute("class")),s.getAttribute("align")&&(d.align=s.getAttribute("align"));for(var c={},p=s.getElementsByTagName("param"),h=p.length,m=0;h>m;m++)"movie"!=p[m].getAttribute("name").toLowerCase()&&(c[p[m].getAttribute("name")]=p[m].getAttribute("value"));l(d,c,n,i)}else u(s),i&&i(o);else w(n,!0),i&&(o.success=!0,o.ref=a(n),i(o))}else if(w(n,!0),i){var f=a(n);f&&typeof f.SetVariable!=S&&(o.success=!0,o.ref=f),i(o)}}}function a(e){var t=null,n=y(e);if(n&&"OBJECT"==n.nodeName)if(typeof n.SetVariable!=S)t=n;else{var i=n.getElementsByTagName(V)[0];i&&(t=i)}return t}function r(){return!$&&P("6.0.65")&&(z.win||z.mac)&&!(z.wk&&z.wk<312)}function l(e,t,n,i){$=!0,C=i||null,x={success:!1,id:n};var o=y(n);if(o){"OBJECT"==o.nodeName?(T=d(o),M=null):(T=o,M=n),e.id=O,(typeof e.width==S||!/%$/.test(e.width)&&parseInt(e.width,10)<310)&&(e.width="310"),(typeof e.height==S||!/%$/.test(e.height)&&parseInt(e.height,10)<137)&&(e.height="137"),L.title=L.title.slice(0,47)+" - Flash Player Installation";
var s=z.ie&&z.win?["Active"].concat("").join("X"):"PlugIn",a="MMredirectURL="+_.location.toString().replace(/&/g,"%26")+"&MMplayerType="+s+"&MMdoctitle="+L.title;if(typeof t.flashvars!=S?t.flashvars+="&"+a:t.flashvars=a,z.ie&&z.win&&4!=o.readyState){var r=f("div");n+="SWFObjectNew",r.setAttribute("id",n),o.parentNode.insertBefore(r,o),o.style.display="none",function(){4==o.readyState?o.parentNode.removeChild(o):setTimeout(arguments.callee,10)}()}c(e,t,n)}}function u(e){if(z.ie&&z.win&&4!=e.readyState){var t=f("div");e.parentNode.insertBefore(t,e),t.parentNode.replaceChild(d(e),t),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}else e.parentNode.replaceChild(d(e),e)}function d(e){var t=f("div");if(z.win&&z.ie)t.innerHTML=e.innerHTML;else{var n=e.getElementsByTagName(V)[0];if(n){var i=n.childNodes;if(i)for(var o=i.length,s=0;o>s;s++)1==i[s].nodeType&&"PARAM"==i[s].nodeName||8==i[s].nodeType||t.appendChild(i[s].cloneNode(!0))}}return t}function c(e,t,n){var i,o=y(n);if(z.wk&&z.wk<312)return i;if(o)if(typeof e.id==S&&(e.id=n),z.ie&&z.win){var s="";for(var a in e)e[a]!=Object.prototype[a]&&("data"==a.toLowerCase()?t.movie=e[a]:"styleclass"==a.toLowerCase()?s+=' class="'+e[a]+'"':"classid"!=a.toLowerCase()&&(s+=" "+a+'="'+e[a]+'"'));var r="";for(var l in t)t[l]!=Object.prototype[l]&&(r+='<param name="'+l+'" value="'+t[l]+'" />');o.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+s+">"+r+"</object>",B[B.length]=e.id,i=y(e.id)}else{var u=f(V);u.setAttribute("type",A);for(var d in e)e[d]!=Object.prototype[d]&&("styleclass"==d.toLowerCase()?u.setAttribute("class",e[d]):"classid"!=d.toLowerCase()&&u.setAttribute(d,e[d]));for(var c in t)t[c]!=Object.prototype[c]&&"movie"!=c.toLowerCase()&&p(u,c,t[c]);o.parentNode.replaceChild(u,o),i=u}return i}function p(e,t,n){var i=f("param");i.setAttribute("name",t),i.setAttribute("value",n),e.appendChild(i)}function h(e){var t=y(e);t&&"OBJECT"==t.nodeName&&(z.ie&&z.win?(t.style.display="none",function(){4==t.readyState?m(e):setTimeout(arguments.callee,10)}()):t.parentNode.removeChild(t))}function m(e){var t=y(e);if(t){for(var n in t)"function"==typeof t[n]&&(t[n]=null);t.parentNode.removeChild(t)}}function y(e){var t=null;try{t=L.getElementById(e)}catch(n){}return t}function f(e){return L.createElement(e)}function g(e,t,n){e.attachEvent(t,n),j[j.length]=[e,t,n]}function P(e){var t=z.pv,n=e.split(".");return n[0]=parseInt(n[0],10),n[1]=parseInt(n[1],10)||0,n[2]=parseInt(n[2],10)||0,t[0]>n[0]||t[0]==n[0]&&t[1]>n[1]||t[0]==n[0]&&t[1]==n[1]&&t[2]>=n[2]?!0:!1}function v(e,t,n,i){if(!z.ie||!z.mac){var o=L.getElementsByTagName("head")[0];if(o){var s=n&&"string"==typeof n?n:"screen";if(i&&(D=null,E=null),!D||E!=s){var a=f("style");a.setAttribute("type","text/css"),a.setAttribute("media",s),D=o.appendChild(a),z.ie&&z.win&&typeof L.styleSheets!=S&&L.styleSheets.length>0&&(D=L.styleSheets[L.styleSheets.length-1]),E=s}z.ie&&z.win?D&&typeof D.addRule==V&&D.addRule(e,t):D&&typeof L.createTextNode!=S&&D.appendChild(L.createTextNode(e+" {"+t+"}"))}}}function w(e,t){if(G){var n=t?"visible":"hidden";H&&y(e)?y(e).style.visibility=n:v("#"+e,"visibility:"+n)}}function b(e){var t=/[\\\"<>\.;]/,n=null!=t.exec(e);return n&&typeof encodeURIComponent!=S?encodeURIComponent(e):e}var T,M,C,x,D,E,S="undefined",V="object",k="Shockwave Flash",R="ShockwaveFlash.ShockwaveFlash",A="application/x-shockwave-flash",O="SWFObjectExprInst",I="onreadystatechange",_=window,L=document,N=navigator,U=!1,F=[i],J=[],B=[],j=[],H=!1,$=!1,G=!0,z=function(){var e=typeof L.getElementById!=S&&typeof L.getElementsByTagName!=S&&typeof L.createElement!=S,t=N.userAgent.toLowerCase(),n=N.platform.toLowerCase(),i=n?/win/.test(n):/win/.test(t),o=n?/mac/.test(n):/mac/.test(t),s=/webkit/.test(t)?parseFloat(t.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,a=!1,r=[0,0,0],l=null;if(typeof N.plugins!=S&&typeof N.plugins[k]==V)l=N.plugins[k].description,!l||typeof N.mimeTypes!=S&&N.mimeTypes[A]&&!N.mimeTypes[A].enabledPlugin||(U=!0,a=!1,l=l.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),r[0]=parseInt(l.replace(/^(.*)\..*$/,"$1"),10),r[1]=parseInt(l.replace(/^.*\.(.*)\s.*$/,"$1"),10),r[2]=/[a-zA-Z]/.test(l)?parseInt(l.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof _[["Active"].concat("Object").join("X")]!=S)try{var u=new(window[["Active"].concat("Object").join("X")])(R);u&&(l=u.GetVariable("$version"),l&&(a=!0,l=l.split(" ")[1].split(","),r=[parseInt(l[0],10),parseInt(l[1],10),parseInt(l[2],10)]))}catch(d){}return{w3:e,pv:r,wk:s,ie:a,win:i,mac:o}}();return!function(){z.w3&&((typeof L.readyState!=S&&"complete"==L.readyState||typeof L.readyState==S&&(L.getElementsByTagName("body")[0]||L.body))&&e(),H||(typeof L.addEventListener!=S&&L.addEventListener("DOMContentLoaded",e,!1),z.ie&&z.win&&(L.attachEvent(I,function(){"complete"==L.readyState&&(L.detachEvent(I,arguments.callee),e())}),_==top&&!function(){if(!H){try{L.documentElement.doScroll("left")}catch(t){return setTimeout(arguments.callee,0),void 0}e()}}()),z.wk&&!function(){return H?void 0:/loaded|complete/.test(L.readyState)?(e(),void 0):(setTimeout(arguments.callee,0),void 0)}(),n(e)))}(),!function(){z.ie&&z.win&&window.attachEvent("onunload",function(){for(var e=j.length,t=0;e>t;t++)j[t][0].detachEvent(j[t][1],j[t][2]);for(var n=B.length,i=0;n>i;i++)h(B[i]);for(var o in z)z[o]=null;z=null;for(var s in swfobject)swfobject[s]=null;swfobject=null})}(),{registerObject:function(e,t,n,i){if(z.w3&&e&&t){var o={};o.id=e,o.swfVersion=t,o.expressInstall=n,o.callbackFn=i,J[J.length]=o,w(e,!1)}else i&&i({success:!1,id:e})},getObjectById:function(e){return z.w3?a(e):void 0},embedSWF:function(e,n,i,o,s,a,u,d,p,h){var m={success:!1,id:n};z.w3&&!(z.wk&&z.wk<312)&&e&&n&&i&&o&&s?(w(n,!1),t(function(){i+="",o+="";var t={};if(p&&typeof p===V)for(var y in p)t[y]=p[y];t.data=e,t.width=i,t.height=o;var f={};if(d&&typeof d===V)for(var g in d)f[g]=d[g];if(u&&typeof u===V)for(var v in u)typeof f.flashvars!=S?f.flashvars+="&"+v+"="+u[v]:f.flashvars=v+"="+u[v];if(P(s)){var b=c(t,f,n);t.id==n&&w(n,!0),m.success=!0,m.ref=b}else{if(a&&r())return t.data=a,l(t,f,n,h),void 0;w(n,!0)}h&&h(m)})):h&&h(m)},switchOffAutoHideShow:function(){G=!1},ua:z,getFlashPlayerVersion:function(){return{major:z.pv[0],minor:z.pv[1],release:z.pv[2]}},hasFlashPlayerVersion:P,createSWF:function(e,t,n){return z.w3?c(e,t,n):void 0},showExpressInstall:function(e,t,n,i){z.w3&&r()&&l(e,t,n,i)},removeSWF:function(e){z.w3&&h(e)},createCSS:function(e,t,n,i){z.w3&&v(e,t,n,i)},addDomLoadEvent:t,addLoadEvent:n,getQueryParamValue:function(e){var t=L.location.search||L.location.hash;if(t){if(/\?/.test(t)&&(t=t.split("?")[1]),null==e)return b(t);for(var n=t.split("&"),i=0;i<n.length;i++)if(n[i].substring(0,n[i].indexOf("="))==e)return b(n[i].substring(n[i].indexOf("=")+1))}return""},expressInstallCallback:function(){if($){var e=y(O);e&&T&&(e.parentNode.replaceChild(T,e),M&&(w(M,!0),z.ie&&z.win&&(T.style.display="block")),C&&C(x)),$=!1}}}}();!function(){if("undefined"!=typeof window&&!window.WebSocket){var e=window.console;if(e&&e.log&&e.error||(e={log:function(){},error:function(){}}),!swfobject.hasFlashPlayerVersion("10.0.0"))return e.error("Flash Player >= 10.0.0 is required."),void 0;"file:"==location.protocol&&e.error("WARNING: web-socket-js doesn't work in file:///... URL unless you set Flash Security Settings properly. Open the page via Web server i.e. http://..."),WebSocket=function(e,t,n,i,o){var s=this;s.__id=WebSocket.__nextId++,WebSocket.__instances[s.__id]=s,s.readyState=WebSocket.CONNECTING,s.bufferedAmount=0,s.__events={},t?"string"==typeof t&&(t=[t]):t=[],setTimeout(function(){WebSocket.__addTask(function(){WebSocket.__flash.create(s.__id,e,t,n||null,i||0,o||null)})},0)},WebSocket.prototype.send=function(e){if(this.readyState==WebSocket.CONNECTING)throw"INVALID_STATE_ERR: Web Socket connection has not been established";var t=WebSocket.__flash.send(this.__id,encodeURIComponent(e));return 0>t?!0:(this.bufferedAmount+=t,!1)},WebSocket.prototype.close=function(){this.readyState!=WebSocket.CLOSED&&this.readyState!=WebSocket.CLOSING&&(this.readyState=WebSocket.CLOSING,WebSocket.__flash.close(this.__id))},WebSocket.prototype.addEventListener=function(e,t){e in this.__events||(this.__events[e]=[]),this.__events[e].push(t)},WebSocket.prototype.removeEventListener=function(e,t){if(e in this.__events)for(var n=this.__events[e],i=n.length-1;i>=0;--i)if(n[i]===t){n.splice(i,1);break}},WebSocket.prototype.dispatchEvent=function(e){for(var t=this.__events[e.type]||[],n=0;n<t.length;++n)t[n](e);var i=this["on"+e.type];i&&i(e)},WebSocket.prototype.__handleEvent=function(e){"readyState"in e&&(this.readyState=e.readyState),"protocol"in e&&(this.protocol=e.protocol);var t;if("open"==e.type||"error"==e.type)t=this.__createSimpleEvent(e.type);else if("close"==e.type)t=this.__createSimpleEvent("close");else{if("message"!=e.type)throw"unknown event type: "+e.type;var n=decodeURIComponent(e.message);t=this.__createMessageEvent("message",n)}this.dispatchEvent(t)},WebSocket.prototype.__createSimpleEvent=function(e){if(document.createEvent&&window.Event){var t=document.createEvent("Event");return t.initEvent(e,!1,!1),t}return{type:e,bubbles:!1,cancelable:!1}},WebSocket.prototype.__createMessageEvent=function(e,t){if(document.createEvent&&window.MessageEvent&&!window.opera){var n=document.createEvent("MessageEvent");return n.initMessageEvent("message",!1,!1,t,null,null,window,null),n}return{type:e,data:t,bubbles:!1,cancelable:!1}},WebSocket.CONNECTING=0,WebSocket.OPEN=1,WebSocket.CLOSING=2,WebSocket.CLOSED=3,WebSocket.__flash=null,WebSocket.__instances={},WebSocket.__tasks=[],WebSocket.__nextId=0,WebSocket.loadFlashPolicyFile=function(e){WebSocket.__addTask(function(){WebSocket.__flash.loadManualPolicyFile(e)})},WebSocket.__initialize=function(){if(!WebSocket.__flash){if(WebSocket.__swfLocation&&(window.WEB_SOCKET_SWF_LOCATION=WebSocket.__swfLocation),!window.WEB_SOCKET_SWF_LOCATION)return e.error("[WebSocket] set WEB_SOCKET_SWF_LOCATION to location of WebSocketMain.swf"),void 0;var t=document.createElement("div");t.id="webSocketContainer",t.style.position="absolute",WebSocket.__isFlashLite()?(t.style.left="0px",t.style.top="0px"):(t.style.left="-100px",t.style.top="-100px");var n=document.createElement("div");n.id="webSocketFlash",t.appendChild(n),document.body.appendChild(t),swfobject.embedSWF(WEB_SOCKET_SWF_LOCATION,"webSocketFlash","1","1","10.0.0",null,null,{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always"},null,function(t){t.success||e.error("[WebSocket] swfobject.embedSWF failed")})}},WebSocket.__onFlashInitialized=function(){setTimeout(function(){WebSocket.__flash=document.getElementById("webSocketFlash"),WebSocket.__flash.setCallerUrl(location.href),WebSocket.__flash.setDebug(!!window.WEB_SOCKET_DEBUG);for(var e=0;e<WebSocket.__tasks.length;++e)WebSocket.__tasks[e]();WebSocket.__tasks=[]},0)},WebSocket.__onFlashEvent=function(){return setTimeout(function(){try{for(var t=WebSocket.__flash.receiveEvents(),n=0;n<t.length;++n)WebSocket.__instances[t[n].webSocketId].__handleEvent(t[n])}catch(i){e.error(i)}},0),!0},WebSocket.__log=function(t){e.log(decodeURIComponent(t))},WebSocket.__error=function(t){e.error(decodeURIComponent(t))},WebSocket.__addTask=function(e){WebSocket.__flash?e():WebSocket.__tasks.push(e)},WebSocket.__isFlashLite=function(){if(!window.navigator||!window.navigator.mimeTypes)return!1;var e=window.navigator.mimeTypes["application/x-shockwave-flash"];return e&&e.enabledPlugin&&e.enabledPlugin.filename?e.enabledPlugin.filename.match(/flashlite/i)?!0:!1:!1},window.WEB_SOCKET_DISABLE_AUTO_INITIALIZATION||(window.addEventListener?window.addEventListener("load",function(){WebSocket.__initialize()},!1):window.attachEvent("onload",function(){WebSocket.__initialize()}))}}(),function(e,t,n){function i(e){e&&(t.Transport.apply(this,arguments),this.sendBuffer=[])}function o(){}e.XHR=i,t.util.inherit(i,t.Transport),i.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},i.prototype.payload=function(e){for(var n=[],i=0,o=e.length;o>i;i++)n.push(t.parser.encodePacket(e[i]));this.send(t.parser.encodePayload(n))},i.prototype.send=function(e){return this.post(e),this},i.prototype.post=function(e){function t(){4==this.readyState&&(this.onreadystatechange=o,s.posting=!1,200==this.status?s.socket.setBuffer(!1):s.onClose())}function i(){this.onload=o,s.socket.setBuffer(!1)}var s=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),n.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=i:this.sendXHR.onreadystatechange=t,this.sendXHR.send(e)},i.prototype.close=function(){return this.onClose(),this},i.prototype.request=function(e){var n=t.util.request(this.socket.isXDomain()),i=t.util.query(this.socket.options.query,"t="+ +new Date);if(n.open(e||"GET",this.prepareUrl()+i,!0),"POST"==e)try{n.setRequestHeader?n.setRequestHeader("Content-type","text/plain;charset=UTF-8"):n.contentType="text/plain"}catch(o){}return n},i.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},i.check=function(e,i){try{var o=t.util.request(i),s=n.XDomainRequest&&o instanceof XDomainRequest,a=e&&e.options&&e.options.secure?"https:":"http:",r=a!=n.location.protocol;if(o&&(!s||!r))return!0}catch(l){}return!1},i.xdomainCheck=function(){return i.check(null,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(){t.Transport.XHR.apply(this,arguments)}e.htmlfile=n,t.util.inherit(n,t.Transport.XHR),n.prototype.name="htmlfile",n.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var e=this.doc.createElement("div");e.className="socketio",this.doc.body.appendChild(e),this.iframe=this.doc.createElement("iframe"),e.appendChild(this.iframe);var n=this,i=t.util.query(this.socket.options.query,"t="+ +new Date);this.iframe.src=this.prepareUrl()+i,t.util.on(window,"unload",function(){n.destroy()})},n.prototype._=function(e,t){this.onData(e);try{var n=t.getElementsByTagName("script")[0];n.parentNode.removeChild(n)}catch(i){}},n.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(e){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},n.prototype.close=function(){return this.destroy(),t.Transport.XHR.prototype.close.call(this)},n.check=function(){if("undefined"!=typeof window&&["Active"].concat("Object").join("X")in window)try{var e=new(window[["Active"].concat("Object").join("X")])("htmlfile");return e&&t.Transport.XHR.check()}catch(n){}return!1},n.xdomainCheck=function(){return!1},t.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function i(){t.Transport.XHR.apply(this,arguments)}function o(){}e["xhr-polling"]=i,t.util.inherit(i,t.Transport.XHR),t.util.merge(i,t.Transport.XHR),i.prototype.name="xhr-polling",i.prototype.open=function(){var e=this;return t.Transport.XHR.prototype.open.call(e),!1},i.prototype.get=function(){function e(){4==this.readyState&&(this.onreadystatechange=o,200==this.status?(s.onData(this.responseText),s.get()):s.onClose())}function t(){this.onload=o,this.onerror=o,s.onData(this.responseText),s.get()}function i(){s.onClose()}if(this.open){var s=this;this.xhr=this.request(),n.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=t,this.xhr.onerror=i):this.xhr.onreadystatechange=e,this.xhr.send(null)}},i.prototype.onClose=function(){if(t.Transport.XHR.prototype.onClose.call(this),this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=o;try{this.xhr.abort()}catch(e){}this.xhr=null}},i.prototype.ready=function(e,n){var i=this;t.util.defer(function(){n.call(i)})},t.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t,n){function i(){t.Transport["xhr-polling"].apply(this,arguments),this.index=t.j.length;var e=this;t.j.push(function(t){e._(t)})}var o=n.document&&"MozAppearance"in n.document.documentElement.style;e["jsonp-polling"]=i,t.util.inherit(i,t.Transport["xhr-polling"]),i.prototype.name="jsonp-polling",i.prototype.post=function(e){function n(){i(),o.socket.setBuffer(!1)}function i(){o.iframe&&o.form.removeChild(o.iframe);try{a=document.createElement('<iframe name="'+o.iframeId+'">')}catch(e){a=document.createElement("iframe"),a.name=o.iframeId}a.id=o.iframeId,o.form.appendChild(a),o.iframe=a}var o=this,s=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);if(!this.form){var a,r=document.createElement("form"),l=document.createElement("textarea"),u=this.iframeId="socketio_iframe_"+this.index;r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=u,r.method="POST",r.setAttribute("accept-charset","utf-8"),l.name="d",r.appendChild(l),document.body.appendChild(r),this.form=r,this.area=l}this.form.action=this.prepareUrl()+s,i(),this.area.value=t.JSON.stringify(e);try{this.form.submit()}catch(d){}this.iframe.attachEvent?a.onreadystatechange=function(){"complete"==o.iframe.readyState&&n()}:this.iframe.onload=n,this.socket.setBuffer(!0)},i.prototype.get=function(){var e=this,n=document.createElement("script"),i=t.util.query(this.socket.options.query,"t="+ +new Date+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),n.async=!0,n.src=this.prepareUrl()+i,n.onerror=function(){e.onClose()};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(n,s),this.script=n,o&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype._=function(e){return this.onData(e),this.open&&this.get(),this},i.prototype.ready=function(e,n){var i=this;return o?(t.util.load(function(){n.call(i)}),void 0):n.call(this)},i.check=function(){return"document"in n},i.xdomainCheck=function(){return!0},t.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this);var PropValue=function(e,t){return{Name:e,Value:ko.observable(t)}},KeyVal=function(e,t){this.key=e,this.val=t};Array.prototype.indexOfKey=function(e){for(var t=0;t<this.length;t++)if(this[t].key===e)return t;return-1},Array.prototype.indexOfVal=function(e){for(var t=0;t<this.length;t++)if(this[t].val===e)return t;return-1},Array.prototype.clear=function(){for(;this.length>0;)this.pop()};var dorsettGPL={};dorsettGPL.Application=Class.extend({NAME:"dorsettGPL.Application",init:function(){this.view=new dorsettGPL.View("canvas");var e=this;this.view.getSequence(function(t){return null!=t?"undefined"==typeof t["Sequence Details"]?($.blockUI({message:"<h4>No Sequence Data Found For this point</h4>"}),$("body").trigger({type:"sequenceLoaded",msg:"fail"}),$("#loadingScreen").hide(),void 0):(e.initializeSequence(t),void 0):void 0}),this.view.sequenceUPI=iddd,this.toolbar=new dorsettGPL.Toolbar("toolbar",this,this.view),this.filter=new dorsettGPL.FilterPane("filter_actions",this.view)},initializeSequence:function(e){var t=this;GPLViewModel.sequencePoint=e,GPLViewModel.defaultShowLabel(Boolean(e["Show Label"].Value)),GPLViewModel.defaultShowValue(Boolean(e["Show Value"].Value)),t.view.originalSequencePoint=JSON.stringify(e),t.getAdditionalQueries(e),"true"===isOld?(GPLViewModel.isViewer(!0),GPLViewModel.devicePointName(e["Device Point"].PointName),GPLViewModel.devicePoint(e["Device Point"].Value),GPLViewModel.description(e.Description.Value)):(GPLViewModel.isNewSequence=!0,GPLViewModel.devicePointName(point["Device Point"].PointName),GPLViewModel.devicePoint(point["Device Point"].Value),$("#loadingScreen").addClass("animated fadeOutDown").hide("slow"),$("#viewMode").hide(),$("#toolbarOpen").show(),$("#accordion").show(),$("#myPanel").pullOutContentPanel({pocp_scrollbars:!1,pocp_showonload:!0,pocp_pg_overlay:!1,pocp_clickout:!1})),$("body").trigger({type:"sequenceLoaded",msg:"success"})},getAdditionalQueries:function(e){var t=this;$.ajax({url:"/api/system/qualitycodes",cache:!0,async:!0,success:function(e){t.view.qualityCodes=e},error:function(){iToast.showError("Error","User Authentication Failed.")}}),$.ajax({url:"/api/system/controllers",type:"get",async:!0,cache:!0,success:function(t){GPLViewModel.controllers([new KeyVal("[Not Selected]",0)]),$.each(t,function(e,t){GPLViewModel.controllers.push(new KeyVal(t["Controller Name"],t["Controller ID"]))}),GPLViewModel.defaultController(parseInt(e.Controller.eValue))},error:function(){iToast.showError("Error","User Authentication Failed.")}})}}),dorsettGPL.View=draw2d.Canvas.extend({sequenceUPI:"",sequenceDetails:{},backgroundColor:"#d8d8d8",originalSequencePoint:{},qualityCodes:{},socketObj:{},init:function(e){this._super(e,2e3,2e3),this.setScrollArea("#"+e),this.givenNames=new draw2d.util.ArrayList,this.installEditPolicy(new draw2d.policy.canvas.SnapToGeometryEditPolicy),GPLViewModel.bgColor(this.backgroundColor);var t=this;$("#modal-addPoint").on("hidden.bs.modal",function(e){t.dropCancel&&t.revertDrop(),"true"==$(e.target).attr("data-refresh")&&$(e.target).removeData("bs.modal")})},checkName:function(){var e=$("#lblname")[0];if(""==$(e).val())return alert("Field cannot be left empty"),void 0;var t=GPLViewModel.getProp(this.newFigureId);t.lbl($(e).val());var n=Config.Templates.Points[this.newFigureName];for(var i in n)t.propertiesArray.push(new PropValue(i,n[i]))},revertDrop:function(){var e=this.getFigure(this.newFigureId),t=new draw2d.command.CommandDelete(e);this.getCommandStack().execute(t)},newFigureId:"",newFigureName:"",dropCancel:!0,onDragEnter:function(){$("#myPanel").hide(),$("#toolbarOpen").hide()},onDrag:function(){},onDrop:function(e,t,n){var i=1,o="",s=!1,a=getProperFigureClass({type:$(e).data("shape"),id:draw2d.util.UUID.create()});if(a.setDraggable(!0),this.newFigureName=a.GivenName,a instanceof draw2d.shape.basic.Label||"Input"==a.GivenName||"Output"==a.GivenName||"Constant"==a.GivenName||(s=!0),a instanceof draw2d.shape.basic.Label||(a.setColor("#ff0000"),a.setStroke(1)),s){var r,l,u,d,c=GPLViewModel.sequencePoint.Name.split("_"),p="pointname1";c[0]&&(r=c[0]),c[1]?l=c[1]:p="pointname2",c[2]?u=c[2]:p="pointname3",c[3]?d=c[3]:p="pointname4";var h={requiredLabel:p,pointTypeSupplied:a.GivenName,dp:GPLViewModel.devicePoint(),dpName:GPLViewModel.devicePointName(),isPointTypeSupplied:!0,Name:GPLViewModel.sequencePoint.Name,record:{name1:r,name2:l,name3:u,name4:d}};$("#addForm").load("/api/points/pointTypes/addpointwizard1",h),$("#modal-addPoint").modal({keyboard:!1,show:!0})}else{o=a.GivenName+i;for(var m=0;m<this.figures.data.length;m++)this.figures.data[m]instanceof draw2d.shape.node.IconObject&&(this.figures.data[m].GivenName==a.GivenName&&this.givenNames.indexOf(a.GivenName)&&i++,o=a.GivenName+i,this.givenNames.add(o))}var y=new draw2d.command.CommandAdd(this,a,t-15,n-15+$(document).scrollTop());this.getCommandStack().execute(y),a instanceof draw2d.shape.basic.Label||s||GPLViewModel.getProp(a.id).lbl(o),s&&(GPLViewModel.getProp(a.id).isNewlyAdded=!0),a instanceof draw2d.shape.basic.Label||(GPLViewModel.getProp(a.id).showLabel(GPLViewModel.defaultShowLabel()),GPLViewModel.getProp(a.id).showValue(GPLViewModel.defaultShowValue())),this.newFigureId=a.id,$("#myPanel").show(),$("#toolbarOpen").show()},assignProperties:function(e,t){var n=GPLViewModel.getProp(this.newFigureId);for(var i in e)n.propertiesArray.push(new PropValue(i,e[i]));GPLViewModel.getProp(this.newFigureId).lbl(t),$("#modal-addPoint").modal("hide")},applyChanges:function(e,t){var n=GPLViewModel.selectedProp();if(n.isAccessed(!0),n.isNewlyAdded!==!1||n instanceof draw2d.shape.node.IconObject||n.updated(!0),n.lbl(t.lbl()),e)if(n.shape=t.shape,n.upi(t.upi()),n.valueType(t.valueType()),n.internalRef(t.internalRef()),n.referenceType(t.referenceType()),n.segment(t.segment()),console.log(t.referenceType(),t.valueType(),t.constantFloat()),"Constant"===t.referenceType())"Float"===t.valueType()?n.constantFloat(t.constantFloat()):n.constantEnum(t.constantEnum());else if(t.referenceType().indexOf("InternalRef")>-1){var i=t.internalRef(),o=n.internalRefs().indexOfVal(i);n.lbl(n.internalRefs()[o].key)}else console.log(t.valu()),n.valu(t.valu());n.showLabel(t.showLabel()),n.showValue(t.showValue()),n.propertiesArray(t.propertiesArray());var s="",a=n.iconChange().prop;if(_.each(a,function(e){var t=GPLViewModel.getSelectedDProp(e);s+=t.toString()}),""!=s)for(var r=n.iconChange().values,l=0;l<r.length;l++)for(var u in r[l])if(s==u.toString()){var d=this.getFigure(n.id());"function"==typeof d.iconInterpreter&&(s=d.iconInterpreter(s)),n.iconChangeFn(d.icon+s),d.NAME=r[l][u],"undefined"!==d.refType&&(d.refType=u);break}},cancelChanges:function(){var e=GPLViewModel.selectedProp();e.setPersistentAttributes(JSON.parse(GPLViewModel.beforeEditProp))},displayJSON:function(e){var t=JSON.stringify(this.viewJSON(),null,2);e&&$("#preview").text(t)},viewJSON:function(){var e=[],t=this.getFigures();""!=GPLViewModel.devicePointName()&&$.ajax({url:"/api/points/"+GPLViewModel.devicePoint(),success:function(e){GPLViewModel.devicePointName(e.Name)}});var n=new draw2d.util.Color($("#canvas").css("background-color"));e.push({idd:this.sequenceUPI,deviceUPI:GPLViewModel.devicePoint(),devicePointName:GPLViewModel.devicePointName(),backgroundColor:n.rgb2hex($("#canvas").css("background-color"))});for(var i=0;i<t.getSize();i++){var o=null;o=t.get(i);var s=o.getPersistentAttributes();if(o instanceof draw2d.shape.node.Object){var a=s.props._id;void 0===a&&(a=s.props.UPI.Value),delete s.props,s.props={UPI:{Value:a}}}e.push(s)}var r=this.getLines();return r.each(function(t,n){e.push(n.getPersistentAttributes())}),e},saveWork:function(){$("#modal-SaveDialog").modal("hide"),this.activateSequence(!1,!0,function(){iToast.showSuccess("Success","Your work has been saved."),GPLViewModel.showSwitchViewConfirmDialog=!1,$("#viewMode").jqxSwitchButton("check")})},openSaveDialog:function(){$("#modal-SaveDialog").modal("show")},discardChanges:function(){var e=this;$.blockUI({message:"<img class='center' src='/img/busy.gif' width='30px' height='30px' alt='Busy...'><h4>Discarding Changes...</h4>",onBlock:function(){$("#modal-SaveDialog").modal("hide");var t=JSON.parse(e.originalSequencePoint);t["Sequence Details"][0].isActivated=!0,t["Sequence Details"][0].Edits&&(delete t["Sequence Details"][0].Edits,delete t["Sequence Details"][0]["Edit Version"]),e.updateSequence(t,JSON.parse(e.originalSequencePoint),!1,function(){GPLViewModel.showSwitchViewConfirmDialog=!1,$("#viewMode").jqxSwitchButton("check"),$.unblockUI(),iToast.showCool("Discarded","All changes made to the sequence has been discarded.")})}})},saveAndPublish:function(){var e=this;$.blockUI({message:"<img class='center' src='/img/busy.gif' width='30px' height='30px' alt='Busy...'><h4>Activatiion in Progress...</h4>",onBlock:function(){$("#modal-SaveDialog").modal("hide"),e.validateSequence(function(t){t&&e.activateSequence(!0,!1,function(){GPLViewModel.showSwitchViewConfirmDialog=!1,$("#viewMode").jqxSwitchButton("check"),$.unblockUI()})})}})},drawFigures:function(e){var t=this;this.sequenceDetails=e;var n=new draw2d.io.json.Reader(t);n.unmarshal(e,function(n){if(t.socketObj=n,GPLViewModel.isViewer()){var i={};i.socketid=socket.socket.sessionid,i.display={},i.display["Screen Objects"]=n.gplObjects,socket.emit("displayOpen",{data:i});var o=GPLViewModel.getAllConstantProp();async.each(o,function(e){e.setValueText(e.valu())})}t.sequenceUPI=e[0].idd,GPLViewModel.devicePoint(e[0].deviceUPI),e[0].backgroundColor&&GPLViewModel.bgColor(e[0].backgroundColor)}),$.unblockUI({fadeOut:200}),$("#loadingScreen").addClass("animated fadeOutDown"),$("#loadingScreen").hide("slow")},getSequence:function(e){"false"===isOld?e(point):$.ajax({url:"/api/points/"+iddd,type:"get",async:!0,cache:!0,success:function(t){e(t)},error:function(){iToast.showError("Error","User Authentication Failed."),e(null)}})},updateFigure:function(e,t){for(var n=this.getFigures(),i=0;i<n.getSize();i++){var o=n.get(i),s=0;if(o.id==e){for(var a=this.getLines(),r=0;r<a.getSize();r++){var l=a.get(r),u=-1;t&&e==l.sourcePort.name.split("_")[0]&&(l.sourcePort.getRequired()?s++:(u=parseInt(l.sourcePort.name.split("_")[1]),o.requiredPorts.indexOf(u)>-1&&s++)),t||e!=l.targetPort.name.split("_")[0]||(l.targetPort.getRequired()?s++:(u=parseInt(l.targetPort.name.split("_")[1]),o.requiredPorts.indexOf(u)>-1&&s++))}s>=o.minRequiredConnection&&(o.setStroke(1),o.setColor("#000000"),o instanceof draw2d.shape.node.IconObject&&o.setStroke(0));break}}},validateSequence:function(e){for(var t=!0,n=this.getFigures(),i=0;i<n.getSize();i++){var o=n.get(i);if((o instanceof draw2d.shape.node.Object||o instanceof draw2d.shape.node.IconObject)&&("#ff0000"==o.getColor().hash().toLowerCase()&&(t=!1,iToast.showWarn("Warning","<b>"+GPLViewModel.getProp(o.id).lbl()+"</b> ("+o.GivenName+") is missing some properties."),$.unblockUI()),o instanceof draw2d.shape.node.IconObject))try{0===GPLViewModel.getDProp(o.id,"UPI").Value().Value&&(t=!1,iToast.showWarn("Warning","<b>"+GPLViewModel.getProp(o.id).lbl()+"</b> ("+o.GivenName+") is missing required point definition."),$.unblockUI())}catch(s){t=!1,iToast.showWarn("Warning","<b>"+GPLViewModel.getProp(o.id).lbl()+"</b> ("+o.GivenName+") is missing required point definition."),$.unblockUI()}}if(t)for(var a=this.getLines(),r=0;r<a.getSize();r++){var l=a.get(r);l.setColor("#000000"),l.setStroke(1);var u=l.sourcePort.name.split("_")[0],d=GPLViewModel.getProp(u);if(0==d.upi()&&d instanceof draw2d.shape.node.ConstantValueObj){t=!1;var c=parseFloat(d.getProperty("Constant Value").Value().Value);"number"==typeof c&&(t=!0)}if(!t){l.setColor("#e80d0d"),l.setStroke(3),iToast.showWarn("Warning","Please correct connections in red."),$.unblockUI();break}}t&&e&&e(t),!t&&e&&e(t)},updateSequence:function(e,t,n,i){$.ajax({url:"/api/points/update",type:"Post",contentType:"application/json",data:JSON.stringify({newPoint:e,oldPoint:t}),success:function(e){return e.err?(iToast.showError("Error",e.err),$.unblockUI(),null):(n&&iToast.showSuccess("Success","Sequence has been updated."),"function"==typeof i?i():void 0)}})},activateSequence:function(e,t,n){var i=GPLViewModel.sequencePoint,o=JSON.parse(this.originalSequencePoint);if(e)i["Sequence Details"]=this.viewJSON(),i["Sequence Details"][0].isActivated=!0,i["Sequence Details"][0].Edits&&delete i["Sequence Details"][0].Edits;else{o["Sequence Details"][0].isActivated=!1,o["Sequence Details"][0].Edits={},o["Sequence Details"][0].Edits["Orphaned Figures"]=[];for(var s=0;s<this.figures.getSize();s++){var a=this.figures.get(s);a instanceof draw2d.shape.node.Object&&GPLViewModel.getProp(a.id).isNewlyAdded&&o["Sequence Details"][0].Edits["Orphaned Figures"].push(a.props())}o["Sequence Details"][0]["Edit Version"]=this.viewJSON(),o["Sequence Details"][0].Edits["Deleted Figures"]=[],ko.utils.arrayForEach(GPLViewModel.deletedFigures(),function(e){o["Sequence Details"][0].Edits["Deleted Figures"].push(e)}),$.ajax({url:"/api/points/update",type:"Post",contentType:"application/json",data:JSON.stringify({newPoint:o,oldPoint:i}),success:function(e){return e.err?(iToast.showError("Error",e.err),$.unblockUI(),null):n()}})}if(!t){GPLViewModel.isNewSequence?$.ajax({url:"/api/points/addPoint",contentType:"application/json",type:"Post",async:!1,data:JSON.stringify(i),success:function(e){return e.err?(iToast.showError("Error",e.err),$.unblockUI(),null):"function"==typeof n?n():(iToast.showSuccess("Success","Sequence has been added."),null)}}):this.updateSequence(i,o,!0,n);for(var r=this.getFigures(),l=0;l<r.getSize();l++){var u=r.get(l);if(u instanceof draw2d.shape.node.Object)if(GPLViewModel.getProp(u.id).isNewlyAdded){var d=u.getPersistentAttributes().props;
d._gplSeq=parseInt(i._id),$.ajax({url:"/api/points/addPoint",contentType:"application/json",type:"Post",async:!0,data:JSON.stringify(d),success:function(e){e.err?iToast.showError("Error",e.err):(GPLViewModel.getProp(u.id).isNewlyAdded=!1,iToast.showSuccess("Success","<b>"+GPLViewModel.getProp(u.id).lbl()+"</b> ("+u.GivenName+") has been added as Point."))}})}else if(GPLViewModel.getProp(u.id).updated()){var c=u.getPersistentAttributes().props;o={};var p=GPLViewModel.getProp(u.id).upi();$.ajax({url:"/api/points/"+p,type:"get",async:!1,cache:!1,success:function(e){o=e}});for(var h in o)"object"==typeof o[h]&&JSON.stringify(o[h])!==JSON.stringify(c[h])&&(c[h]["Activity Log"]={log:"Created"});$.ajax({url:"/api/points/update",type:"Post",contentType:"application/json",data:JSON.stringify({newPoint:c,oldPoint:o}),success:function(e){e.err?iToast.showError("Error",e.err):GPLViewModel.getProp(u.id).updated(!1)}})}}var m=GPLViewModel.getAllDeletedProps();_.each(m,function(e){iToast.showNotification("Notification","Deleting <b>"+e.lbl()+"</b> ("+e.givenName()+")",{icon:"comment",iconColor:"green"}),$.ajax({url:"/api/points/deletePoint",contentType:"application/json",type:"Post",async:!0,data:JSON.stringify({upi:e.upi(),type:"soft"}),success:function(t){t.err?iToast.showError("Error",t.err):(iToast.showSuccess("Success","<b>"+e.lbl()+"</b> ("+e.givenName()+") has been deleted."),e.delete=!1,e.justDeleted=!0)},complete:function(){iToast.showCool("Cool","Activation Complete.")}})})}},deleteSelected:function(e){this.commandStack.execute(this.selection.getPrimary().createCommand(new draw2d.command.CommandType(draw2d.command.CommandType.DELETE))),e instanceof draw2d.shape.basic.Label==!1?this.validateAllPorts(function(){$.unblockUI()}):$.unblockUI()},validateAllPorts:function(e){for(var t=this.getFigures(),n=0;n<t.getSize();n++){var i=t.get(n);if(!(i instanceof draw2d.shape.basic.Label)){for(var o=0,s=this.getLines(),a=0;a<s.getSize();a++){var r=s.get(a),l=-1;i.id==r.sourcePort.name.split("_")[0]&&(r.sourcePort.getRequired()?o++:(l=parseInt(r.sourcePort.name.split("_")[1]),i.requiredPorts.indexOf(l)>-1&&o++)),i.id==r.targetPort.name.split("_")[0]&&(r.targetPort.getRequired()?o++:(l=parseInt(r.targetPort.name.split("_")[1]),i.requiredPorts.indexOf(l)>-1&&o++))}o>=i.minRequiredConnection?(i.setStroke(1),i.setColor("#000000"),i instanceof draw2d.shape.node.IconObject&&i.setStroke(0)):(i.setColor("#ff0000"),i.setStroke(1))}}return"function"==typeof e?e():void 0},processDelete:function(){var e=this;$.blockUI({message:"<img class='center' src='/img/busy.gif' width='30px' height='30px' alt='Busy...'><h4>Deleting and Running Re-Validation...</h4>",onBlock:function(){if(null!==e.selection.getPrimary()){var t=e.selection.getPrimary();if(t instanceof draw2d.Connection){var n=t.targetPort;n.parent instanceof draw2d.shape.node.OutputObj&&(n=t.sourcePort),GPLViewModel.ensureAllUnderlyingProperties(n.parent.id);var i={point:n.parent.props(),oldPoint:n.parent.props(),refPoint:null,property:n.propertyRepresented},o=Config.Update.formatPoint(i);GPLViewModel.getProp(n.parent.id).setProps(o),GPLViewModel.getProp(n.parent.id).updated(!0)}var s=-1;if(t instanceof draw2d.shape.node.Object)if(GPLViewModel.getProp(t.id).isNewlyAdded)s=GPLViewModel.getProp(t.id).getProperty("_id").Value(),$.ajax({url:"/api/points/freeupi",contentType:"application/json",data:JSON.stringify({upi:s}),type:"POST",success:function(n){"success"==n.msg?e.deleteSelected(t):iToast.showError("Error",n.err)}});else{GPLViewModel.getProp(t.id).delete=!0;var a=GPLViewModel.getProp(t.id).getPersistentAttributes();a.figureType=t.GivenName,void 0==a.props.UPI&&(a.props.UPI={Value:GPLViewModel.getProp(t.id).upi()}),a.Lines=[];for(var r=e.getLines(),l=0;l<r.getSize();l++){var u=r.get(l);t.id==u.sourcePort.name.split("_")[0]&&a.Lines.push(u.getPersistentAttributes()),t.id==u.targetPort.name.split("_")[0]&&a.Lines.push(u.getPersistentAttributes())}var d={};ko.utils.arrayForEach(GPLViewModel.propertiesCol(),function(e){e.id()==t.id&&(d=e)}),GPLViewModel.propertiesCol.remove(d),GPLViewModel.deletedFigures.push(a),e.deleteSelected(t)}else e.deleteSelected(t)}}})},undoDelete:function(){var e=GPLViewModel.getJustDeletedProp();_.each(e,function(e){$.ajax({url:"/api/points/restorePoint",contentType:"application/json",type:"Post",data:JSON.stringify({upi:e.upi()}),success:function(t){t.err?iToast.showError("Error",t.err):(iToast.showSuccess("Success","<b>"+e.lbl()+"</b> ("+e.givenName()+") has been restored."),GPLViewModel.getProp(e.id()).justDeleted=!1)}})})},undoAction:function(){this.commandStack.undo(),this.undoDelete(),this.validateAllPorts();var e=this,t={};ko.utils.arrayForEach(GPLViewModel.deletedFigures(),function(n){null!==e.getFigure(n.id)&&(t=n)}),GPLViewModel.deletedFigures.remove(t)},restorePoint:function(e){var t=e;$.blockUI({message:"<h4>Restoring point...</h4>",onBlock:function(){var e=getProperFigureClass(t);e.setPersistentAttributes(t),e.setDraggable(!0),window.app.view.addFigure(e),GPLViewModel.getProp(e.id).lbl(t.label),GPLViewModel.getProp(e.id).upi(t.props.UPI.Value);for(var n=0;n<t.Lines.length;n++){var i=t.Lines[n],o=new draw2d.Connection(i.id),s=null,a=null;for(var r in i){var l=i[r],u=null;"source"===r?(u=window.app.view.getFigure(l.node),s=u.getPort(l.port),s.value=l.value):"target"===r&&(u=window.app.view.getFigure(l.node),a=u.getPort(l.port),a.value=l.value)}null!==s&&null!==a&&(o.setSource(s),s.name&&o.setTarget(a)),window.app.view.addFigure(o),window.app.view.validateAllPorts()}GPLViewModel.getProp(t.id).setPersistentAttributes(t),GPLViewModel.deletedFigures.remove(t),$.unblockUI({fadeOut:200})}})}}),dorsettGPL.FilterPane=Class.extend({DEFAULT_LABEL:"Properties",init:function(e,t){this.html=$("#"+e),this.view=t,this.currentFigure=null,t.getCommandStack().addEventListener(this),t.addSelectionListener(this)},onSelectionChanged:function(e){null!==this.currentFigure&&"undefined"!=typeof this.currentFigure.isExtFigure&&this.currentFigure.filters.each($.proxy(function(e,t){t.removePane()},this)),null!==e&&"undefined"!=typeof e.isExtFigure&&(e.filters.each($.proxy(function(t,n){n.insertPane(e,this.html)},this)),$('[data-toggle="collapse"]').click(function(){"open"==$(this).attr("data-start")?($(this).html($(this).attr("data-close-text")),$($(this).attr("data-target")).addClass("in")):($(this).html($(this).attr("data-open-text")),$($(this).attr("data-target")).removeClass("in")),$(this).attr("data-start","open"==$(this).attr("data-start")?"close":"open")}),$('[data-toggle="collapse"]').each(function(){"open"==$(this).attr("data-start")?$(this).html($(this).attr("data-open-text")):$(this).html($(this).attr("data-close-text"))})),this.currentFigure=e,null!==e&&this.currentFigure.isExtFigure&&$("#filterPane").pullOutContentPanel({pocp_scrollbars:!0,pocp_showonload:!0,pocp_pg_overlay:!1,pocp_clickout:!0})},stackChanged:function(){}}),dorsettGPL.Toolbar=Class.extend({init:function(e,t,n){this.html=$("#"+e),this.view=n,this.app=t,this.view.getCommandStack().addEventListener(this),this.view.addSelectionListener(this),$("#saveAction").click(function(){}),$("#undoAction").click(function(){}),$("#redoAction").click(function(){}),$("#zoomInAction").click($.proxy(function(){this.view.setZoom(.95*this.view.zoomFactor)},this)),$("#resetZoomAction").click($.proxy(function(){this.view.setZoom(1)},this)),$("#zoomOutAction").click($.proxy(function(){this.view.setZoom(1.05*this.view.zoomFactor)},this)),$("#deleteAction").click($.proxy(function(){n.processDelete()},this))},onSelectionChanged:function(){this.app.setCurrentFigure=null},displayJSON:function(){var e=new dorsett.io.json.Writer;$("#json").text(JSON.stringify(e.marshal(this.view),null,2))},stackChanged:function(){}}),draw2d.filter={},draw2d.filter.Filter=Class.extend({NAME:"draw2d.filter.Filter",init:function(){},apply:function(){},onInstall:function(){},insertPane:function(){},removePane:function(){},getPersistentAttributes:function(){var e={};return e.name=this.NAME,e},setPersistentAttributes:function(){}}),draw2d.filter.StrokeFilter=draw2d.filter.Filter.extend({NAME:"draw2d.filter.StrokeFilter",init:function(){this._super(),this.colorPicker=null},insertPane:function(e,t){t.append('<div id="stroke_filter_conainer" class="panel panel-default"> <div class="panel-heading filter-heading" data-toggle="collapse" data-target="#stroke_width_panel">     Stroke    <span id="button_remove_StrokeFilter" class="btn btn-mini glyphicon glyphicon-remove-circle pull-right" ></span></div> <div class="panel-body collapse in" id="stroke_width_panel">   <div class="form-group">      <div class="input-group" ></div>        <input id="filter_stroke" type="text" value="'+e.getStroke()+'" name="filter_stroke" class="form-control" />       <div class="input-group">          <span class="input-group-addon">#</span>          <input id="filter_stroke_color" type="text" value="" name="stroke-color" class="form-control color"/>       </div>   </div> </div></div>'),$("input[name='filter_stroke']").TouchSpin({min:0,max:20,step:1,boostat:e.getStroke(),maxboostedstep:10,postfix:"px"}),$("input[name='filter_stroke']").on("change",$.proxy(function(){this.setStroke(parseInt($("input[name='filter_stroke']").val()))},e));var n=this.colorPicker=new jscolor.color(document.getElementById("filter_stroke_color"),{});this.colorPicker.fromString(e.getColor().hash()),this.colorPicker.onImmediateChange=$.proxy(function(){this.setColor("#"+n.toString())},e),$("#button_remove_StrokeFilter").on("click",$.proxy(function(){e.removeFilter(this),e.setStroke(0),$("#stroke_filter_conainer").animate({height:"0",opacity:0,"margin-bottom":0},500,function(){$("#stroke_filter_conainer").remove()})},this))},removePane:function(){null!==this.colorPicker&&this.colorPicker.hidePicker()},onInstall:function(e){e.setStroke(1)}}),draw2d.filter.BlurFilter=draw2d.filter.Filter.extend({NAME:"draw2d.filter.BlurFilter",init:function(){this._super(),this.cssScope=this.NAME.replace(/[.]/g,"_")},insertPane:function(e,t){t.append('<div id="'+this.cssScope+'_filter_container" class="panel panel-default"> <div class="panel-heading filter-heading" data-toggle="collapse" data-target="#'+this.cssScope+'_width_panel">     Blur    <span id="button_remove_'+this.cssScope+'" class="btn btn-mini glyphicon glyphicon-remove-circle pull-right" ></span></div> <div class="panel-body collapse in" id="'+this.cssScope+'_blur_panel">   <div class="form-group">      <div class="input-group" ></div>        <input id="filter_blur" type="text" value="'+e.getBlur()+'"  name="filter_blur" class="form-control" />   </div> </div></div>'),$("#filter_blur").TouchSpin({min:0,max:5,step:1}),$("#filter_blur").on("change",$.proxy(function(){console.log($("#filter_blur").val()),this.setBlur(parseInt($("#filter_blur").val()))},e)),$("#button_remove_"+this.cssScope).on("click",$.proxy(function(){e.removeFilter(this),e.setBlur(0),$("#"+this.cssScope+"_filter_container").animate({height:"0",opacity:0,"margin-bottom":0},500,function(){$("#"+this.cssScope+"_filter_container").remove()})},this))}}),draw2d.filter.FillColorFilter=draw2d.filter.Filter.extend({NAME:"draw2d.filter.FillColorFilter",init:function(){this._super(),this.colorPicker=null},insertPane:function(e,t){t.append('<div id="fill_color_container" class="panel panel-info">   <div class="panel-heading filter-heading" data-toggle="collapse" data-target="#color-fill-panel">     Background Color   </div>   <div class="panel-body collapse" id="color-fill-panel">       <div class="form-group">           <div id="bgColor-picker">               <br /><input id="filter_bgColor_fill" type="text" value="'+e.getBackgroundColor().hashString+'" name="filter_bgColor_fill" class="form-control color"/>           </div>       </div>   </div></div>');var n=function(){var t=$(this).chromoselector("getColor");$(this).css({"background-color":t.getHexString(),color:t.getTextColor().getHexString(),"text-shadow":"0 1px 0 "+t.getTextColor().getTextColor().getHexString()}),e.setBackgroundColor(t.getHexString())};$("#filter_bgColor_fill").chromoselector({target:"#bgColor-picker",autoshow:!0,width:155,resizable:!1,preview:!1,create:n,update:n}).chromoselector("show",0)},onInstall:function(){},removePane:function(){null!==this.colorPicker&&this.colorPicker.hidePicker(),$("#fill_color_container").remove()},getPersistentAttributes:function(e){var t={};return t.name=this.NAME,t.bgColor=e.getBackgroundColor(),t},setPersistentAttributes:function(e,t){e.setBackgroundColor(t.bgColor.hashString)}}),draw2d.filter.FontColorFilter=draw2d.filter.Filter.extend({NAME:"draw2d.filter.FontColorFilter",init:function(){this._super(),this.colorPicker=null},insertPane:function(e,t){t.append('<div id="font_color_container" class="panel panel-info">   <div class="panel-heading filter-heading" data-toggle="collapse" data-target="#font_color_fill_panel">     Font Color   </div>   <div class="panel-body collapse" id="font_color_fill_panel">       <div class="form-group">           <div id="font-color-picker">               <br /><input id="filter_color_fill" type="text" value="'+e.getFontColor().hashString+'" name="filter_color_fill" class="form-control color"/>           </div>       </div>   </div></div>');var n=function(){var t=$(this).chromoselector("getColor");$(this).css({"background-color":t.getHexString(),color:t.getTextColor().getHexString(),"text-shadow":"0 1px 0 "+t.getTextColor().getTextColor().getHexString()}),e.setFontColor(t.getHexString())};$("#filter_color_fill").chromoselector({target:"#font-color-picker",width:175,resizable:!1,preview:!1,create:n,update:n}).chromoselector("show",0)},onInstall:function(){},removePane:function(){null!==this.colorPicker&&this.colorPicker.hidePicker(),$("#font_color_container").remove()}}),draw2d.filter.FontSizeFilter=draw2d.filter.Filter.extend({NAME:"draw2d.filter.FontSizeFilter",init:function(){this._super()},insertPane:function(e,t){t.append('<div id="fontsize_filter_container" class="panel panel-info"> <div class="panel-heading filter-heading" data-toggle="collapse" data-target="#fontsize_width_panel">     Font Size</div> <div class="panel-body collapse" id="fontsize_width_panel">   <div class="form-group">       <br /><input id="filter_fontsize" type="text" value="'+e.getFontSize()+'" name="filter_fontsize" class="form-control" />   </div> </div></div>'),$("#filter_fontsize").TouchSpin({min:4,max:300,step:1,boostat:e.getFontSize(),maxboostedstep:10,postfix:"px"}),$("input[name='filter_fontsize']").on("change",$.proxy(function(){this.setFontSize(parseInt($("input[name='filter_fontsize']").val()))},e))},removePane:function(){$("#fontsize_filter_container").remove()},onInstall:function(){}}),draw2d.filter.DynamicPointFilter=draw2d.filter.Filter.extend({NAME:"draw2d.filter.DynamicPointFilter",init:function(){this._super()},insertPane:function(e,t){t.append('<div id="dynamicpoint_filter_container" class="panel panel-info"> <div class="panel-heading filter-heading" data-toggle="collapse" data-target="#dynamicpoint_width_panel">     Dynamic Point</div> <div class="panel-body collapse" id="dynamicpoint_width_panel">   <div class="form-group">      <div class="input-group" ></div>        <br/><button id="dynamic_point" class="form-control btn-primary btn-sm">'+e.getUserData().pointname+"</button>   </div> </div></div>");var n=function(t,n){e.setText(n),e.setUserData({pointname:n,upi:t}),$("#dynamic_point").text(n)};$("#dynamic_point").on("click",$.proxy(function(){var t=window.open("/pointselector/gpl/"+e.getUserData().upi,"myPointWindow","width=722,height=600");t.onload=function(){t.draw2d.pointSelector.init(n)}},this))},removePane:function(){$("#dynamicpoint_filter_container").remove()},onInstall:function(){}}),draw2d.filter.OpacityFilter=draw2d.filter.Filter.extend({NAME:"draw2d.filter.OpacityFilter",init:function(){this._super()},insertPane:function(e,t){t.append('<div id="opacity_container" class="panel panel-default"> <div class="panel-heading filter-heading" data-toggle="collapse" data-target="#opacity_panel">    Opacity    <span id="button_remove_OpacityFilter" class="btn btn-mini glyphicon glyphicon-remove-circle pull-right" ></span></div> <div class="panel-body collapse in" id="opacity_panel">   <div class="form-group">      <div class="input-group" ></div>       <div class="input-group">         <input class="form-control" id="filter_opacity" type="text" value="'+parseInt(100*e.getAlpha())+'" />      </div>   </div> </div></div>'),$("#filter_opacity").TouchSpin({min:0,max:100,step:5,boostat:parseInt(100*e.getAlpha()),maxboostedstep:10,postfix:"%"}),$("#filter_opacity").on("change",$.proxy(function(){this.setAlpha(parseInt($("#filter_opacity").val())/100)},e)),$("#button_remove_OpacityFilter").on("click",$.proxy(function(){e.removeFilter(this),e.setAlpha(1),$("#opacity_container").animate({height:"0",opacity:0,"margin-bottom":0},500,function(){$("#opacity_container").remove()})},this))},removePane:function(){}}),draw2d.filter.LinearGradientFilter=draw2d.filter.Filter.extend({NAME:"draw2d.filter.LinearGradientFilter",init:function(){this._super(),this.colorPicker1=null,this.colorPicker2=null,this.startColor="#f0f0f0",this.endColor="#3f3f3f",this.angle=0,this.cssScope=this.NAME.replace(/[.]/g,"_")},insertPane:function(e,t){t.append('<div id="'+this.cssScope+'_container" class="panel panel-default"> <div class="panel-heading filter-heading" data-toggle="collapse" data-target="#'+this.cssScope+'_panel">     Linear Gradient    <span id="button_remove_'+this.cssScope+'" class="btn btn-mini glyphicon glyphicon-remove-circle pull-right" ></span></div> <div class="panel-body collapse in" id="'+this.cssScope+'_panel">   <div class="form-group">      <div class="input-group" ></div>       <div class="input-group text-center" style="width:100%" >           <div id="'+this.cssScope+'_angle" />      </div>        <div class="input-group">          <span class="input-group-addon">#</span>          <input id="'+this.cssScope+'_color1" type="text" value="'+this.startColor+'" class="form-control color"/>       </div>       <div class="input-group">          <span class="input-group-addon">#</span>          <input id="'+this.cssScope+'_color2" type="text" value="'+this.endColor+'" class="form-control color"/>       </div>   </div> </div></div>'),$("#"+this.cssScope+"_angle").anglepicker({start:function(){},change:$.proxy(function(t,n){this.angle=n.value,e.repaint()},this),stop:function(){},value:this.angle});var n=this.colorPicker1=new jscolor.color($("#"+this.cssScope+"_color1")[0],{});this.colorPicker1.fromString(this.startColor),this.colorPicker1.onImmediateChange=$.proxy(function(){this.startColor="#"+n.toString(),e.repaint()},this);var i=this.colorPicker2=new jscolor.color($("#"+this.cssScope+"_color2")[0],{});this.colorPicker2.fromString(this.endColor),this.colorPicker2.onImmediateChange=$.proxy(function(){this.endColor="#"+i.toString(),e.repaint()},this),$("#button_remove_"+this.cssScope).on("click",$.proxy(function(){e.removeFilter(this),$("#"+this.cssScope+"_container").animate({height:"0",opacity:0,"margin-bottom":0},500,function(){$("#"+this.cssScope+"_container").remove()})},this))},apply:function(e,t){t.fill=this.angle+"-"+this.endColor+"-"+this.startColor},removePane:function(){null!==this.colorPicker1&&this.colorPicker1.hidePicker(),null!==this.colorPicker2&&this.colorPicker2.hidePicker()},onInstall:function(e){e.setStroke(1)},getPersistentAttributes:function(e){var t=this._super(e);return t.startColor=this.startColor,t.endColor=this.endColor,t.angle=this.angle,t},setPersistentAttributes:function(e,t){return this._super(e,t),this.startColor=t.startColor,this.endColor=t.endColor,this.angle=t.angle,t}}),draw2d.shape.basic.ExtPolygon=draw2d.shape.basic.Polygon.extend({NAME:"ExtPolygon",init:function(){this._super(),this.setUserData({name:"Figure_"+this.id}),this.filters=new draw2d.util.ArrayList,this.filters.add(new StrokeFilter),this.filters.add(new FillColorFilter),this.installEditPolicy(new draw2d.policy.figure.RectangleSelectionFeedbackPolicy)},removeFilter:function(e){this.filters.remove(e)},addFilter:function(e){var t=!1;this.filters.each($.proxy(function(n,i){t=t||i.NAME===e.NAME},this)),t!==!0&&(this.filters.add(e),e.onInstall(this),this.repaint())},onDoubleClick:function(){this.installEditPolicy(new draw2d.policy.figure.VertexSelectionFeedbackPolicy)},unselect:function(){return this._super(),this.installEditPolicy(new draw2d.policy.figure.RectangleSelectionFeedbackPolicy),this},repaint:function(e){null!==this.shape&&(null===this.svgPathString&&this.calculatePath(),"undefined"==typeof e&&(e={}),e.path=this.svgPathString,this.filters.each($.proxy(function(t,n){n.apply(this,e)},this)),this._super(e))},getPersistentAttributes:function(){var e=this._super();return e.filters=[],this.filters.each($.proxy(function(t,n){var i=n.getPersistentAttributes(this);e.filters.push(i)},this)),e},setPersistentAttributes:function(memento){this._super(memento),"undefined"!=typeof memento.filters&&(this.filters=new draw2d.util.ArrayList,$.each(memento.filters,$.proxy(function(i,e){var filter=eval("new "+e.name+"()");filter.setPersistentAttributes(this,e),this.filters.add(filter)},this)))}}),draw2d.shape.note.ExtLabel=draw2d.shape.basic.Label.extend({NAME:"draw2d.shape.note.ExtLabel",isExtFigure:!0,init:function(e){this.id=void 0==e?draw2d.util.UUID.create():e,this.blur=0,this._super("This is label."),this.setUserData({name:"Label_"+this.id}),this.filters=new draw2d.util.ArrayList,this.filters.add(new draw2d.filter.FontColorFilter),this.filters.add(new draw2d.filter.FontSizeFilter),GPLViewModel.isViewer()||this.installEditor(new draw2d.ui.LabelInplaceEditor),GPLViewModel.addProp(this.id,this.NAME)},getPotentialFilters:function(){return[{label:"Opacity",impl:"draw2d.filter.OpacityFilter"},{label:"Blur",impl:"draw2d.filter.BlurFilter"},{label:"Font Size",impl:"draw2d.filter.FontSizeFilter"},{label:"Font Color",impl:"draw2d.filter.FontColorFilter"}]},setBlur:function(e){this.blur=e,this.repaint()},getBlur:function(){return this.blur},removeFilter:function(e){return this.filters.remove(e),this},addFilter:function(e){var t=!1;return this.filters.each($.proxy(function(n,i){t=t||i.NAME===e.NAME},this)),t!==!0?(this.filters.add(e),e.onInstall(this),this.repaint(),this):void 0},repaint:function(e){null!==this.shape&&("undefined"==typeof e&&(e={}),this.filters.each($.proxy(function(t,n){n.apply(this,e)},this)),this._super(e))},getPersistentAttributes:function(){var e=this._super();return e.filters=[],this.filters.each($.proxy(function(t,n){var i=n.getPersistentAttributes(this);e.filters.push(i)},this)),e},setPersistentAttributes:function(memento){this._super(memento),"undefined"!=typeof memento.filters&&(this.filters=new draw2d.util.ArrayList,$.each(memento.filters,$.proxy(function(i,e){var filter=eval("new "+e.name+"()");filter.setPersistentAttributes(this,e),this.filters.add(filter)},this)))}}),draw2d.shape.note.ExtDynamicPoint=draw2d.shape.basic.Label.extend({NAME:"draw2d.shape.note.ExtDynamicPoint",isExtFigure:!0,init:function(e){this.id=void 0==e?draw2d.util.UUID.create():e,this.blur=0,this._super("[Dynamic Point]"),this.setBold(!0),this.setFontSize(12),this.setBackgroundColor("#cccccc"),this.setUserData({pointname:"[Not Selected]",upi:0}),this.filters=new draw2d.util.ArrayList,this.filters.add(new draw2d.filter.FontColorFilter),this.filters.add(new draw2d.filter.FontSizeFilter),this.filters.add(new draw2d.filter.DynamicPointFilter),this.filters.add(new draw2d.filter.FillColorFilter),GPLViewModel.isViewer()?this.setDraggable(!1):(this.installEditor(new draw2d.ui.LabelInplaceEditor),this.setDraggable(!0)),GPLViewModel.addProp(this.id,this.NAME)},setBlur:function(e){this.blur=e,this.repaint()},getBlur:function(){return this.blur},removeFilter:function(e){return this.filters.remove(e),this},addFilter:function(e){var t=!1;return this.filters.each($.proxy(function(n,i){t=t||i.NAME===e.NAME},this)),t!==!0?(this.filters.add(e),e.onInstall(this),this.repaint(),this):void 0},repaint:function(e){null!==this.shape&&("undefined"==typeof e&&(e={}),this.filters.each($.proxy(function(t,n){n.apply(this,e)},this)),this._super(e))},getPersistentAttributes:function(){var e=this._super();return e.filters=[],this.filters.each($.proxy(function(t,n){var i=n.getPersistentAttributes(this);e.filters.push(i)},this)),e},setPersistentAttributes:function(memento){this._super(memento),"undefined"!=typeof memento.filters&&(this.filters=new draw2d.util.ArrayList,$.each(memento.filters,$.proxy(function(i,e){var filter=eval("new "+e.name+"()");filter.setPersistentAttributes(this,e),this.filters.add(filter)},this)))},openPointReview:function(){var e=this.getUserData().upi;GPLViewModel.openPointReview(e)}});var socket=io.connect("http://"+window.location.hostname+":8085");socket.on("connect",function(){if(GPLViewModel.isViewer()){var e={};e.socketid=socket.socket.sessionid,e.display={},e.display["Screen Objects"]=window.app.view.socketObj.gplObjects,socket.emit("displayOpen",{data:e})}}),socket.on("recieveUpdate",function(e){if(GPLViewModel.isViewer()){var t=GPLViewModel.getAllPropByUPI(e.upi);async.each(t,function(t){"none"==e.dynamic["Quality Label"]?t.setValueText(e.dynamic.Value):_.each(window.app.view.qualityCodes.Entries,function(n){n["Quality Code Label"]==e.dynamic["Quality Label"]&&t.setValueText(e.dynamic.Value,n)})})}}),$(window).on("unload",function(){socket.disconnect()}),$(function(){GPLViewModel={mouseUpDetected:!1,sequencePoint:{},isViewer:ko.observable(!1),internalPropertiesCol:ko.observableArray([]),propertiesCol:ko.observableArray([]),propertiesColOriginal:ko.observableArray([]),selectedProp:ko.observable(new Properties("iddd")),beforeEditProp:{},beforeEditIcon:"",selectedChange:ko.observable(!1),templateUrl:ko.observable(),devicePointName:ko.observable(),devicePoint:ko.observable(0),defaultShowValue:ko.observable(!0),defaultShowLabel:ko.observable(!0),defaultController:ko.observable(0),deletedFigures:ko.observableArray([]),description:ko.observable("[Description goes here]"),isNewSequence:!1,switchViewModeCancel:!1,showSwitchViewConfirmDialog:!1,callDevicePoint:function(){var e=GPLViewModel.devicePoint(),t=window.open("/pointselector/devicePoints/"+e,"myPointWindow","width=722,height=600");t.onload=function(){t.dorsett.pointSelector.init(GPLViewModel.setDevicePoint)}},setDevicePoint:function(e,t){GPLViewModel.sequencePoint["Device Point"].isReadOnly=!1,GPLViewModel.sequencePoint["Device Point"].Value=e,GPLViewModel.sequencePoint["Device Point"].PointName=t,GPLViewModel.devicePoint(e),GPLViewModel.devicePointName(t)},getSPropCheck:function(e,t){return e[t].Value=this.checked,!0},getSPropValue:function(data,prop,attr){return attr?eval("this.sequencePoint[prop]."+attr):this.sequencePoint[prop]?this.sequencePoint[prop].Value:""},updateInterval:function(e){if(e)GPLViewModel.sequencePoint["Update Interval"].Value+=60*Number(this.value);else{var t=GPLViewModel.sequencePoint["Update Interval"].Value;GPLViewModel.sequencePoint["Update Interval"].Value=t>60?t-t%60+Number(this.value):Number(this.value)}},getSelectedSPropEvalue:function(e){return null!=this.sequencePoint?this.getSPropValue(null,e).eValue:void 0},changeSelect:function(e){0!=this.selectedIndex&&null!=GPLViewModel.getSPropValue(e)&&(GPLViewModel.sequencePoint[e].Value=this.selectedOptions[0].text,GPLViewModel.sequencePoint[e].eValue=this.selectedOptions[0].value)},getProp:function(e){return ko.utils.arrayFirst(this.propertiesCol(),function(t){return t.id()==e})},getOriginalProp:function(e){return ko.utils.arrayFirst(this.propertiesColOriginal(),function(t){return t.id()==e})},getAllDeletedProps:function(){return ko.utils.arrayFilter(this.propertiesCol(),function(e){return e.delete===!0})},getJustDeletedProp:function(){return ko.utils.arrayFilter(this.propertiesCol(),function(e){return e.justDeleted===!0})},getPropByUPI:function(e,t){return ko.utils.arrayFirst(this.propertiesCol(),function(n){return n.upi()==e&&n.id()!=t})},getAllPropByUPI:function(e){return ko.utils.arrayFilter(this.propertiesCol(),function(t){return t.upi()==e})},getAllConstantProp:function(){return ko.utils.arrayFilter(this.propertiesCol(),function(e){return"Constant"==e.shapeCategory})},addProp:function(e,t){var n=new Properties(e,t);this.propertiesCol.push(n),this.propertiesColOriginal.push(n)},removeProp:function(e,t){this.propertiesCol.pop(e),this.propertiesCol.push(t),console.log(this.getSelectedDProp("Alarm State"))},selectProp:function(e){this.selectedProp(this.getProp(e))},addDProp:function(e,t,n){this.getProp(e).propertiesArray.push(new PropValue(t,n))},getDProp:function(e,t){return ko.utils.arrayFirst(this.getProp(e).propertiesArray(),function(e){return e.Name==t})},setPropValue:function(e,t,n,i){var o=ko.utils.arrayFirst(this.getProp(e).propertiesArray(),function(e){return e.Name==t});n?o.Value().Value=i:o.Value(i)},setProps:function(e,t,n){var i=this.getProp(e).propertiesArray();if(t>0)$.ajax({url:"/api/points/"+t,type:"get",async:!1,cache:!1,success:function(n){if(console.log(n.message),"No Point Found"===n.message){var o=GPLViewModel.sequencePoint["Sequence Details"][0].Edits;for(var s in o)if(o[s]._id===t){n=o[s];for(var a in n)i.push(new PropValue(a,n[a]));GPLViewModel.getProp(e).isNewlyAdded=!0;var r=GPLViewModel.sequencePoint["Update Interval"].Value;GPLViewModel.getDProp(e,"Update Interval").Value().Value=r;break}}for(var a in n)i.push(new PropValue(a,n[a]))}});else{var o=Config.Templates.Points[n];for(var s in o)i.push(new PropValue(s,o[s]))}this.getProp(e).propertiesArray(i)},ensureAllUnderlyingProperties:function(e){var t=this.getProp(e).propertiesArray().length;0==t&&this.setProps(e,0,this.getProp(e).givenName()),(1==t||3==t)&&this.setProps(e,this.getProp(e).upi(),this.getProp(e).givenName())},setSourceTarget:function(e,t,n,i){if(void 0!=n){this.ensureAllUnderlyingProperties(t);var o=this.getDProp(t,n);null==o&&(this.setProps(t,this.getProp(t).upi(),this.getProp(t).givenName()),o=this.getDProp(t,n)),o.Value().Value=this.getDProp(e,"_id")?this.getDProp(e,"_id").Value():i}},getSelectedPropValue:function(propName){return eval("GPLViewModel.selectedProp()."+propName+"()")},getSelectedDProp:function(e,t){var n=ko.utils.arrayFirst(GPLViewModel.selectedProp().propertiesArray(),function(t){return t.Name==e});return n&&t?n.Value:n&&"Reference Type"==e?n.Value():n?n.Value().Value:""},isFloat:function(e){return""==GPLViewModel.getSelectedDProp(e,!0)?!1:1==GPLViewModel.getSelectedDProp(e,!0)().ValueType},isEnum2:function(e){return""==GPLViewModel.getSelectedDProp(e,!0)?!1:5==GPLViewModel.getSelectedDProp(e,!0)().ValueType},dropdownRange:function(e){var t=[];try{var n=GPLViewModel.getSelectedDProp(e,!0)();for(var i in n.ValueOptions)t.push(new KeyVal(i,n.ValueOptions[i]))}catch(o){}return t},getSelectedDPropEvalue:function(e){var t=ko.utils.arrayFirst(GPLViewModel.selectedProp().propertiesArray(),function(t){return t.Name==e});return t?t.Value().eValue:""},getSelectedDPropCompValue:function(e){var t=ko.utils.arrayFirst(GPLViewModel.selectedProp().propertiesArray(),function(t){return t.Name==e});return t?t.Value().CompValue:""},saveProp:function(){{ko.utils.arrayIndexOf(this.propertiesCol(),function(e){return e.id()==GPLViewModel.selectedProp().id()})}},bgColor:ko.observable("#ffffff"),controllers:ko.observableArray([new KeyVal("[Not Selected]",0)]),controlPriorities:ko.observableArray([new KeyVal("Loading",-1)]),openPointSelector:function(){var e=window.open("/pointselector/gpl/"+GPLViewModel.selectedProp().upi(),"myPointWindow","width=722,height=600");e.onload=function(){e.dorsett.pointSelector.init(setPoint)}},openPointReview:function(e){var t="/pointreview";$.ajax({url:t,async:!1,type:"post",data:{id:e},success:function(e){var t="";t=e.tabOpen?window.open(e.url,"pointReviewWindow"):window.open(e.url,"","width=482,height=600"),t.focus()}})},changeVal:function(e){GPLViewModel.getDProp(f.id,"Value").Value().Value=e},changeController:function(e){for(var t=window.app.view.getFigures(),n=0;n<t.getSize();n++){var i=t.get(n);
if(i instanceof dorsett.shape.node.Object){if(null==GPLViewModel.getDProp(i.id,e)){var o=GPLViewModel.getProp(i.id).upi();GPLViewModel.setProps(i.id,o,i.GivenName)}GPLViewModel.getDProp(i.id,e).Value().Value=GPLViewModel.sequencePoint[e].Value,GPLViewModel.getDProp(i.id,e).Value().eValue=GPLViewModel.sequencePoint[e].eValue,GPLViewModel.getProp(i.id).updated(!0)}}$("#divSeqProp").unblock()},applyAll:function(){$("#divSeqProp").block({message:"<img src='/img/busy.gif' alt='Busy...'>",onBlock:function(){var e=this.toString();if("Controller"==e||"Update Interval"==e)return GPLViewModel.changeController(e),void 0;for(var t=window.app.view.getFigures(),n=0;n<t.getSize();n++){var i=t.get(n);i instanceof dorsett.shape.basic.Label||("Show Label"==e?GPLViewModel.getProp(i.id).showLabel(GPLViewModel.sequencePoint[e].Value):GPLViewModel.getProp(i.id).showValue(GPLViewModel.sequencePoint[e].Value))}$("#divSeqProp").unblock()}})},restoreFigure:function(){window.app.view.restorePoint(this)},purgeFigure:function(){GPLViewModel.deletedFigures.remove(this)},switchCancel:function(){$("#viewMode").jqxSwitchButton({checked:!1}),this.switchViewModeCancel=!0,$("#modal-ConfirmDialog").modal("hide")},switchToViewMode:function(){$("#modal-ConfirmDialog").modal("hide"),this.switchViewModeCancel=!1,$.blockUI({message:"<h4>Switching to View Mode...Please Wait</h4>",onBlock:function(){$.ajax({url:"/gpl/unlockSequence",type:"POST",data:JSON.stringify({id:iddd}),contentType:"application/json",success:function(){GPLViewModel.isViewer(!0)}})}})},discardChangesDialog:function(){$("#modal-SaveDialog").modal("hide"),$("#modal-ConfirmDiscardDialog").modal("show"),this.switchViewModeCancel=!1,GPLViewModel.showSwitchViewConfirmDialog=!1},discardChanges:function(){window.app.view.discardChanges()}},GPLViewModel.selectedProp.subscribe(function(){GPLViewModel.selectedChange(!0)}),GPLViewModel.defaultShowLabel.subscribe(function(e){GPLViewModel.sequencePoint["Show Label"].Value=e}),GPLViewModel.defaultShowValue.subscribe(function(e){GPLViewModel.sequencePoint["Show Value"].Value=e}),GPLViewModel.isViewer.subscribe(function(e){window.app.view.clear(),GPLViewModel.deletedFigures([]),GPLViewModel.propertiesCol([]),GPLViewModel.propertiesColOriginal([]),$.ajax({url:"/api/points/"+iddd,type:"get",async:!0,cache:!0,success:function(e){GPLViewModel.sequencePoint=e},error:function(){iToast.showError("Error","User Authentication Failed."),callback(null)}}),e?$(".editMode").hide():($(".editMode").show(),tinymce.init({selector:"div.editmode",inline:!1,plugins:["textcolor"],toolbar:"bold italic | forecolor backcolor",menubar:!1,statusbar:!1,fontsize_formats:"8pt 10pt 12pt 14pt",setup:function(e){e.on("keyup",function(){GPLViewModel.sequencePoint.Description.Value=e.getContent(),GPLViewModel.description(e.getContent())})}}),GPLViewModel.sequencePoint["Sequence Details"][0].Edits?$("#discardChanges").removeAttr("disabled"):$("#discardChanges").attr("disabled","disabled"));var t=GPLViewModel.sequencePoint["Sequence Details"][0].isActivated;if(e||t!==!1)window.app.view.drawFigures(GPLViewModel.sequencePoint["Sequence Details"]);else{window.app.view.drawFigures(GPLViewModel.sequencePoint["Sequence Details"][0]["Edit Version"]);var n=GPLViewModel.sequencePoint["Sequence Details"][0].Edits["Orphaned Figures"];ko.utils.arrayForEach(n,function(e){GPLViewModel.getPropByUPI(e._id).setProps(e),GPLViewModel.getAllPropByUPI(e._id)[0].isNewlyAdded=!0});var i=GPLViewModel.sequencePoint["Sequence Details"][0].Edits["Deleted Figures"];ko.utils.arrayForEach(i,function(e){GPLViewModel.deletedFigures.push(e)}),iToast.showWarn("Edit Version...","Previously Saved Version has been loaded")}$("#zoomSlider").jqxSlider("setValue",5)}),GPLViewModel.bgColor.subscribe(function(e){$("#canvas").css({"background-color":e})}),ko.applyBindings(GPLViewModel),window.app=new dorsettGPL.Application}),window.onload=function(){$(".dragAround").draggable(),$("#zoomSlider").jqxSlider({width:200,showButtons:!1,showTicks:!1,min:0,max:10,value:5,mode:"fixed"}),$("#viewMode").jqxSwitchButton({width:200,onLabel:"View Mode",offLabel:"Edit Mode",checked:!0}),$("a#zoom100").on("click",function(){$("#zoomSlider").jqxSlider("setValue",5)}),$("a#zoomIn").on("click",function(){$("#zoomSlider").jqxSlider("incrementValue")}),$("a#zoomOut").on("click",function(){$("#zoomSlider").jqxSlider("decrementValue")}),$("#canvas").mousewheel(function(e,t){return t>0?$("#zoomSlider").jqxSlider("incrementValue"):$("#zoomSlider").jqxSlider("decrementValue"),!1}),$("#zoomSlider").on("change",function(e){switch(e.args.value){case 0:window.app.view.setZoom(1.5);break;case 1:window.app.view.setZoom(1.4);break;case 2:window.app.view.setZoom(1.3);break;case 3:window.app.view.setZoom(1.2);break;case 4:window.app.view.setZoom(1.1);break;case 5:window.app.view.setZoom(1);break;case 6:window.app.view.setZoom(.9);break;case 7:window.app.view.setZoom(.8);break;case 8:window.app.view.setZoom(.6);break;case 9:window.app.view.setZoom(.4);break;case 10:window.app.view.setZoom(.2)}5==e.args.value?$("a#zoom100").hide():$("a#zoom100").show()}),$.blockUI.defaults.css={position:"fixed",top:"40%",left:"40%",border:"none",padding:"5px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.6,color:"#fff"};var e=new draw2d.policy.canvas.BoundingboxSelectionPolicy;$("#viewMode").on("checked",function(){GPLViewModel.showSwitchViewConfirmDialog?$("#modal-ConfirmDialog").modal("show"):(GPLViewModel.switchToViewMode(),window.app.view.uninstallEditPolicy(e))}),$("#viewMode").on("unchecked",function(){GPLViewModel.switchViewModeCancel||(window.app.view.installEditPolicy(e),$.blockUI({message:"<h4>Switching to Edit Mode...Please Wait</h4>",onBlock:function(){$.ajax({url:"/gpl/getLockInfo/"+iddd,type:"GET",success:function(e){if(e.locked){var t="Cannot switch to Edit Mode. In Use By "+e.lockedBy;iToast.showNotification("Notification",t,{icon:"lock",theme:"jetblack"})}else $.ajax({url:"/gpl/lockSequence",type:"POST",data:JSON.stringify({id:iddd}),contentType:"application/json",success:function(){GPLViewModel.isViewer(!1)}})}})}}))}),$("#sequenceProp").click(function(){$("#modal-sequenceProp").modal("show")}),$("#loadEditVersion").click(function(){iToast.showCool(".....","Edit Version Work in Progress")}),$("a#toolbarOpen").on("click",function(){$("#myPanel").pullOutContentPanel({pocp_scrollbars:!1,pocp_showonload:!0,pocp_pg_overlay:!1,pocp_clickout:!1})});var t=function(){var e=$(this).chromoselector("getColor");$(this).css({"background-color":e.getHexString(),color:e.getTextColor().getHexString(),"text-shadow":"0 1px 0 "+e.getTextColor().getTextColor().getHexString()}),GPLViewModel.bgColor(e.getHexString())};$("#bgColor").chromoselector({target:"#picker",autoshow:!1,width:155,resizable:!1,preview:!1,create:t,update:t}).chromoselector("show",0)};